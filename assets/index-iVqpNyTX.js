const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainMenu-BO84kNvb.js","assets/GameModals-aTi5PvrA.js","assets/GameReviewModal-N_rHnb-G.js","assets/GameScreen-Qui9wBU6.js","assets/ChatBox-CVwkBmzV.js","assets/OnlineLobby-CwYVoEcU.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function FR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fv={exports:{}},Oh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS;function VO(){if(MS)return Oh;MS=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var c=null;if(o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:c,ref:s!==void 0?s:null,props:o}}return Oh.Fragment=e,Oh.jsx=t,Oh.jsxs=t,Oh}var VS;function LO(){return VS||(VS=1,fv.exports=VO()),fv.exports}var I=LO(),mv={exports:{}},Me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LS;function UO(){if(LS)return Me;LS=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),T=Symbol.iterator;function R(O){return O===null||typeof O!="object"?null:(O=T&&O[T]||O["@@iterator"],typeof O=="function"?O:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,Y={};function le(O,W,ne){this.props=O,this.context=W,this.refs=Y,this.updater=ne||P}le.prototype.isReactComponent={},le.prototype.setState=function(O,W){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,W,"setState")},le.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function Ee(){}Ee.prototype=le.prototype;function oe(O,W,ne){this.props=O,this.context=W,this.refs=Y,this.updater=ne||P}var de=oe.prototype=new Ee;de.constructor=oe,q(de,le.prototype),de.isPureReactComponent=!0;var Pe=Array.isArray;function Re(){}var k={H:null,A:null,T:null,S:null},x=Object.prototype.hasOwnProperty;function N(O,W,ne){var ae=ne.ref;return{$$typeof:n,type:O,key:W,ref:ae!==void 0?ae:null,props:ne}}function V(O,W){return N(O.type,W,O.props)}function L(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function C(O){var W={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ne){return W[ne]})}var A=/\/+/g;function se(O,W){return typeof O=="object"&&O!==null&&O.key!=null?C(""+O.key):W.toString(36)}function Ae(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(Re,Re):(O.status="pending",O.then(function(W){O.status==="pending"&&(O.status="fulfilled",O.value=W)},function(W){O.status==="pending"&&(O.status="rejected",O.reason=W)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function H(O,W,ne,ae,me){var _e=typeof O;(_e==="undefined"||_e==="boolean")&&(O=null);var Se=!1;if(O===null)Se=!0;else switch(_e){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(O.$$typeof){case n:case e:Se=!0;break;case _:return Se=O._init,H(Se(O._payload),W,ne,ae,me)}}if(Se)return me=me(O),Se=ae===""?"."+se(O,0):ae,Pe(me)?(ne="",Se!=null&&(ne=Se.replace(A,"$&/")+"/"),H(me,W,ne,"",function(hn){return hn})):me!=null&&(L(me)&&(me=V(me,ne+(me.key==null||O&&O.key===me.key?"":(""+me.key).replace(A,"$&/")+"/")+Se)),W.push(me)),1;Se=0;var _t=ae===""?".":ae+":";if(Pe(O))for(var tt=0;tt<O.length;tt++)ae=O[tt],_e=_t+se(ae,tt),Se+=H(ae,W,ne,_e,me);else if(tt=R(O),typeof tt=="function")for(O=tt.call(O),tt=0;!(ae=O.next()).done;)ae=ae.value,_e=_t+se(ae,tt++),Se+=H(ae,W,ne,_e,me);else if(_e==="object"){if(typeof O.then=="function")return H(Ae(O),W,ne,ae,me);throw W=String(O),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return Se}function ee(O,W,ne){if(O==null)return O;var ae=[],me=0;return H(O,ae,"","",function(_e){return W.call(ne,_e,me++)}),ae}function X(O){if(O._status===-1){var W=O._result;W=W(),W.then(function(ne){(O._status===0||O._status===-1)&&(O._status=1,O._result=ne)},function(ne){(O._status===0||O._status===-1)&&(O._status=2,O._result=ne)}),O._status===-1&&(O._status=0,O._result=W)}if(O._status===1)return O._result.default;throw O._result}var Oe=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},Be={map:ee,forEach:function(O,W,ne){ee(O,function(){W.apply(this,arguments)},ne)},count:function(O){var W=0;return ee(O,function(){W++}),W},toArray:function(O){return ee(O,function(W){return W})||[]},only:function(O){if(!L(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Me.Activity=v,Me.Children=Be,Me.Component=le,Me.Fragment=t,Me.Profiler=s,Me.PureComponent=oe,Me.StrictMode=i,Me.Suspense=d,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Me.__COMPILER_RUNTIME={__proto__:null,c:function(O){return k.H.useMemoCache(O)}},Me.cache=function(O){return function(){return O.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(O,W,ne){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var ae=q({},O.props),me=O.key;if(W!=null)for(_e in W.key!==void 0&&(me=""+W.key),W)!x.call(W,_e)||_e==="key"||_e==="__self"||_e==="__source"||_e==="ref"&&W.ref===void 0||(ae[_e]=W[_e]);var _e=arguments.length-2;if(_e===1)ae.children=ne;else if(1<_e){for(var Se=Array(_e),_t=0;_t<_e;_t++)Se[_t]=arguments[_t+2];ae.children=Se}return N(O.type,me,ae)},Me.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:o,_context:O},O},Me.createElement=function(O,W,ne){var ae,me={},_e=null;if(W!=null)for(ae in W.key!==void 0&&(_e=""+W.key),W)x.call(W,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(me[ae]=W[ae]);var Se=arguments.length-2;if(Se===1)me.children=ne;else if(1<Se){for(var _t=Array(Se),tt=0;tt<Se;tt++)_t[tt]=arguments[tt+2];me.children=_t}if(O&&O.defaultProps)for(ae in Se=O.defaultProps,Se)me[ae]===void 0&&(me[ae]=Se[ae]);return N(O,_e,me)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(O){return{$$typeof:h,render:O}},Me.isValidElement=L,Me.lazy=function(O){return{$$typeof:_,_payload:{_status:-1,_result:O},_init:X}},Me.memo=function(O,W){return{$$typeof:p,type:O,compare:W===void 0?null:W}},Me.startTransition=function(O){var W=k.T,ne={};k.T=ne;try{var ae=O(),me=k.S;me!==null&&me(ne,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(Re,Oe)}catch(_e){Oe(_e)}finally{W!==null&&ne.types!==null&&(W.types=ne.types),k.T=W}},Me.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Me.use=function(O){return k.H.use(O)},Me.useActionState=function(O,W,ne){return k.H.useActionState(O,W,ne)},Me.useCallback=function(O,W){return k.H.useCallback(O,W)},Me.useContext=function(O){return k.H.useContext(O)},Me.useDebugValue=function(){},Me.useDeferredValue=function(O,W){return k.H.useDeferredValue(O,W)},Me.useEffect=function(O,W){return k.H.useEffect(O,W)},Me.useEffectEvent=function(O){return k.H.useEffectEvent(O)},Me.useId=function(){return k.H.useId()},Me.useImperativeHandle=function(O,W,ne){return k.H.useImperativeHandle(O,W,ne)},Me.useInsertionEffect=function(O,W){return k.H.useInsertionEffect(O,W)},Me.useLayoutEffect=function(O,W){return k.H.useLayoutEffect(O,W)},Me.useMemo=function(O,W){return k.H.useMemo(O,W)},Me.useOptimistic=function(O,W){return k.H.useOptimistic(O,W)},Me.useReducer=function(O,W,ne){return k.H.useReducer(O,W,ne)},Me.useRef=function(O){return k.H.useRef(O)},Me.useState=function(O){return k.H.useState(O)},Me.useSyncExternalStore=function(O,W,ne){return k.H.useSyncExternalStore(O,W,ne)},Me.useTransition=function(){return k.H.useTransition()},Me.version="19.2.0",Me}var US;function J0(){return US||(US=1,mv.exports=UO()),mv.exports}var ye=J0();const cn=FR(ye);var pv={exports:{}},Mh={},gv={exports:{}},_v={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BS;function BO(){return BS||(BS=1,(function(n){function e(H,ee){var X=H.length;H.push(ee);e:for(;0<X;){var Oe=X-1>>>1,Be=H[Oe];if(0<s(Be,ee))H[Oe]=ee,H[X]=Be,X=Oe;else break e}}function t(H){return H.length===0?null:H[0]}function i(H){if(H.length===0)return null;var ee=H[0],X=H.pop();if(X!==ee){H[0]=X;e:for(var Oe=0,Be=H.length,O=Be>>>1;Oe<O;){var W=2*(Oe+1)-1,ne=H[W],ae=W+1,me=H[ae];if(0>s(ne,X))ae<Be&&0>s(me,ne)?(H[Oe]=me,H[ae]=X,Oe=ae):(H[Oe]=ne,H[W]=X,Oe=W);else if(ae<Be&&0>s(me,X))H[Oe]=me,H[ae]=X,Oe=ae;else break e}}return ee}function s(H,ee){var X=H.sortIndex-ee.sortIndex;return X!==0?X:H.id-ee.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var d=[],p=[],_=1,v=null,T=3,R=!1,P=!1,q=!1,Y=!1,le=typeof setTimeout=="function"?setTimeout:null,Ee=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;function de(H){for(var ee=t(p);ee!==null;){if(ee.callback===null)i(p);else if(ee.startTime<=H)i(p),ee.sortIndex=ee.expirationTime,e(d,ee);else break;ee=t(p)}}function Pe(H){if(q=!1,de(H),!P)if(t(d)!==null)P=!0,Re||(Re=!0,C());else{var ee=t(p);ee!==null&&Ae(Pe,ee.startTime-H)}}var Re=!1,k=-1,x=5,N=-1;function V(){return Y?!0:!(n.unstable_now()-N<x)}function L(){if(Y=!1,Re){var H=n.unstable_now();N=H;var ee=!0;try{e:{P=!1,q&&(q=!1,Ee(k),k=-1),R=!0;var X=T;try{t:{for(de(H),v=t(d);v!==null&&!(v.expirationTime>H&&V());){var Oe=v.callback;if(typeof Oe=="function"){v.callback=null,T=v.priorityLevel;var Be=Oe(v.expirationTime<=H);if(H=n.unstable_now(),typeof Be=="function"){v.callback=Be,de(H),ee=!0;break t}v===t(d)&&i(d),de(H)}else i(d);v=t(d)}if(v!==null)ee=!0;else{var O=t(p);O!==null&&Ae(Pe,O.startTime-H),ee=!1}}break e}finally{v=null,T=X,R=!1}ee=void 0}}finally{ee?C():Re=!1}}}var C;if(typeof oe=="function")C=function(){oe(L)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,se=A.port2;A.port1.onmessage=L,C=function(){se.postMessage(null)}}else C=function(){le(L,0)};function Ae(H,ee){k=le(function(){H(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(H){switch(T){case 1:case 2:case 3:var ee=3;break;default:ee=T}var X=T;T=ee;try{return H()}finally{T=X}},n.unstable_requestPaint=function(){Y=!0},n.unstable_runWithPriority=function(H,ee){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var X=T;T=H;try{return ee()}finally{T=X}},n.unstable_scheduleCallback=function(H,ee,X){var Oe=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Oe+X:Oe):X=Oe,H){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=X+Be,H={id:_++,callback:ee,priorityLevel:H,startTime:X,expirationTime:Be,sortIndex:-1},X>Oe?(H.sortIndex=X,e(p,H),t(d)===null&&H===t(p)&&(q?(Ee(k),k=-1):q=!0,Ae(Pe,X-Oe))):(H.sortIndex=Be,e(d,H),P||R||(P=!0,Re||(Re=!0,C()))),H},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(H){var ee=T;return function(){var X=T;T=ee;try{return H.apply(this,arguments)}finally{T=X}}}})(_v)),_v}var FS;function FO(){return FS||(FS=1,gv.exports=BO()),gv.exports}var yv={exports:{}},Un={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jS;function jO(){if(jS)return Un;jS=1;var n=J0();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,p,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:d,containerInfo:p,implementation:_}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Un.createPortal=function(d,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(d,p,null,_)},Un.flushSync=function(d){var p=c.T,_=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=p,i.p=_,i.d.f()}},Un.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(d,p))},Un.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Un.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var _=p.as,v=h(_,p.crossOrigin),T=typeof p.integrity=="string"?p.integrity:void 0,R=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:T,fetchPriority:R}):_==="script"&&i.d.X(d,{crossOrigin:v,integrity:T,fetchPriority:R,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Un.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=h(p.as,p.crossOrigin);i.d.M(d,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(d)},Un.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,v=h(_,p.crossOrigin);i.d.L(d,_,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Un.preloadModule=function(d,p){if(typeof d=="string")if(p){var _=h(p.as,p.crossOrigin);i.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(d)},Un.requestFormReset=function(d){i.d.r(d)},Un.unstable_batchedUpdates=function(d,p){return d(p)},Un.useFormState=function(d,p,_){return c.H.useFormState(d,p,_)},Un.useFormStatus=function(){return c.H.useHostTransitionStatus()},Un.version="19.2.0",Un}var zS;function zO(){if(zS)return yv.exports;zS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),yv.exports=jO(),yv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qS;function qO(){if(qS)return Mh;qS=1;var n=FO(),e=J0(),t=zO();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,l=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(l=a.return),r=a.return;while(r)}return a.tag===3?l:null}function c(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function d(r){if(o(r)!==r)throw Error(i(188))}function p(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var l=r,u=a;;){var m=l.return;if(m===null)break;var g=m.alternate;if(g===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===l)return d(m),r;if(g===u)return d(m),a;g=g.sibling}throw Error(i(188))}if(l.return!==u.return)l=m,u=g;else{for(var E=!1,b=m.child;b;){if(b===l){E=!0,l=m,u=g;break}if(b===u){E=!0,u=m,l=g;break}b=b.sibling}if(!E){for(b=g.child;b;){if(b===l){E=!0,l=g,u=m;break}if(b===u){E=!0,u=g,l=m;break}b=b.sibling}if(!E)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:a}function _(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=_(r),a!==null)return a;r=r.sibling}return null}var v=Object.assign,T=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),le=Symbol.for("react.profiler"),Ee=Symbol.for("react.consumer"),oe=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),Re=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function C(r){return r===null||typeof r!="object"?null:(r=L&&r[L]||r["@@iterator"],typeof r=="function"?r:null)}var A=Symbol.for("react.client.reference");function se(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===A?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case q:return"Fragment";case le:return"Profiler";case Y:return"StrictMode";case Pe:return"Suspense";case Re:return"SuspenseList";case N:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case P:return"Portal";case oe:return r.displayName||"Context";case Ee:return(r._context.displayName||"Context")+".Consumer";case de:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case k:return a=r.displayName||null,a!==null?a:se(r.type)||"Memo";case x:a=r._payload,r=r._init;try{return se(r(a))}catch{}}return null}var Ae=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},Oe=[],Be=-1;function O(r){return{current:r}}function W(r){0>Be||(r.current=Oe[Be],Oe[Be]=null,Be--)}function ne(r,a){Be++,Oe[Be]=r.current,r.current=a}var ae=O(null),me=O(null),_e=O(null),Se=O(null);function _t(r,a){switch(ne(_e,a),ne(me,r),ne(ae,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?rS(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=rS(a),r=sS(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}W(ae),ne(ae,r)}function tt(){W(ae),W(me),W(_e)}function hn(r){r.memoizedState!==null&&ne(Se,r);var a=ae.current,l=sS(a,r.type);a!==l&&(ne(me,r),ne(ae,l))}function tr(r){me.current===r&&(W(ae),W(me)),Se.current===r&&(W(Se),Nh._currentValue=X)}var go,Ll;function nr(r){if(go===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);go=a&&a[1]||"",Ll=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+go+r+Ll}var _o=!1;function Ul(r,a){if(!r||_o)return"";_o=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch($){var G=$}Reflect.construct(r,[],te)}else{try{te.call()}catch($){G=$}r.call(te.prototype)}}else{try{throw Error()}catch($){G=$}(te=r())&&typeof te.catch=="function"&&te.catch(function(){})}}catch($){if($&&G&&typeof $.stack=="string")return[$.stack,G.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),E=g[0],b=g[1];if(E&&b){var D=E.split(`
`),j=b.split(`
`);for(m=u=0;u<D.length&&!D[u].includes("DetermineComponentFrameRoot");)u++;for(;m<j.length&&!j[m].includes("DetermineComponentFrameRoot");)m++;if(u===D.length||m===j.length)for(u=D.length-1,m=j.length-1;1<=u&&0<=m&&D[u]!==j[m];)m--;for(;1<=u&&0<=m;u--,m--)if(D[u]!==j[m]){if(u!==1||m!==1)do if(u--,m--,0>m||D[u]!==j[m]){var J=`
`+D[u].replace(" at new "," at ");return r.displayName&&J.includes("<anonymous>")&&(J=J.replace("<anonymous>",r.displayName)),J}while(1<=u&&0<=m);break}}}finally{_o=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?nr(l):""}function u_(r,a){switch(r.tag){case 26:case 27:case 5:return nr(r.type);case 16:return nr("Lazy");case 13:return r.child!==a&&a!==null?nr("Suspense Fallback"):nr("Suspense");case 19:return nr("SuspenseList");case 0:case 15:return Ul(r.type,!1);case 11:return Ul(r.type.render,!1);case 1:return Ul(r.type,!0);case 31:return nr("Activity");default:return""}}function Df(r){try{var a="",l=null;do a+=u_(r,l),l=r,r=r.return;while(r);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Bl=Object.prototype.hasOwnProperty,yo=n.unstable_scheduleCallback,Fl=n.unstable_cancelCallback,h_=n.unstable_shouldYield,Pu=n.unstable_requestPaint,Sn=n.unstable_now,kf=n.unstable_getCurrentPriorityLevel,sn=n.unstable_ImmediatePriority,dn=n.unstable_UserBlockingPriority,Wr=n.unstable_NormalPriority,Pf=n.unstable_LowPriority,Ou=n.unstable_IdlePriority,d_=n.log,vo=n.unstable_setDisableYieldValue,zs=null,Vn=null;function Mi(r){if(typeof d_=="function"&&vo(r),Vn&&typeof Vn.setStrictMode=="function")try{Vn.setStrictMode(zs,r)}catch{}}var zn=Math.clz32?Math.clz32:Of,f_=Math.log,Mu=Math.LN2;function Of(r){return r>>>=0,r===0?32:31-(f_(r)/Mu|0)|0}var Eo=256,gr=262144,qs=4194304;function ir(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Vi(r,a,l){var u=r.pendingLanes;if(u===0)return 0;var m=0,g=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var b=u&134217727;return b!==0?(u=b&~g,u!==0?m=ir(u):(E&=b,E!==0?m=ir(E):l||(l=b&~r,l!==0&&(m=ir(l))))):(b=u&~g,b!==0?m=ir(b):E!==0?m=ir(E):l||(l=u&~r,l!==0&&(m=ir(l)))),m===0?0:a!==0&&a!==m&&(a&g)===0&&(g=m&-m,l=a&-a,g>=l||g===32&&(l&4194048)!==0)?a:m}function Gs(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function jl(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vu(){var r=qs;return qs<<=1,(qs&62914560)===0&&(qs=4194304),r}function Yr(r){for(var a=[],l=0;31>l;l++)a.push(r);return a}function Hs(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function An(r,a,l,u,m,g){var E=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var b=r.entanglements,D=r.expirationTimes,j=r.hiddenUpdates;for(l=E&~l;0<l;){var J=31-zn(l),te=1<<J;b[J]=0,D[J]=-1;var G=j[J];if(G!==null)for(j[J]=null,J=0;J<G.length;J++){var $=G[J];$!==null&&($.lane&=-536870913)}l&=~te}u!==0&&Lu(r,u,0),g!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=g&~(E&~a))}function Lu(r,a,l){r.pendingLanes|=a,r.suspendedLanes&=~a;var u=31-zn(a);r.entangledLanes|=a,r.entanglements[u]=r.entanglements[u]|1073741824|l&261930}function $s(r,a){var l=r.entangledLanes|=a;for(r=r.entanglements;l;){var u=31-zn(l),m=1<<u;m&a|r[u]&a&&(r[u]|=a),l&=~m}}function Ks(r,a){var l=a&-a;return l=(l&42)!==0?1:Uu(l),(l&(r.suspendedLanes|a))!==0?0:l}function Uu(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Bu(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Xr(){var r=ee.p;return r!==0?r:(r=window.event,r===void 0?32:RS(r.type))}function Mf(r,a){var l=ee.p;try{return ee.p=r,a()}finally{ee.p=l}}var _r=Math.random().toString(36).slice(2),Vt="__reactFiber$"+_r,Cn="__reactProps$"+_r,yr="__reactContainer$"+_r,Qs="__reactEvents$"+_r,vr="__reactListeners$"+_r,Vf="__reactHandles$"+_r,Fu="__reactResources$"+_r,Jr="__reactMarker$"+_r;function wo(r){delete r[Vt],delete r[Cn],delete r[Qs],delete r[vr],delete r[Vf]}function Zr(r){var a=r[Vt];if(a)return a;for(var l=r.parentNode;l;){if(a=l[yr]||l[Vt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(r=dS(r);r!==null;){if(l=r[Vt])return l;r=dS(r)}return a}r=l,l=r.parentNode}return null}function es(r){if(r=r[Vt]||r[yr]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function To(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function rr(r){var a=r[Fu];return a||(a=r[Fu]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ht(r){r[Jr]=!0}var zl=new Set,Ws={};function qn(r,a){Er(r,a),Er(r+"Capture",a)}function Er(r,a){for(Ws[r]=a,r=0;r<a.length;r++)zl.add(a[r])}var m_=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ju={},zu={};function Lf(r){return Bl.call(zu,r)?!0:Bl.call(ju,r)?!1:m_.test(r)?zu[r]=!0:(ju[r]=!0,!1)}function Ys(r,a,l){if(Lf(a))if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+l)}}function Xs(r,a,l){if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+l)}}function Li(r,a,l,u){if(u===null)r.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(a,l,""+u)}}function Gn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Uf(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function p_(r,a,l){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,g=u.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return m.call(this)},set:function(E){l=""+E,g.call(this,E)}}),Object.defineProperty(r,a,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(E){l=""+E},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function ql(r){if(!r._valueTracker){var a=Uf(r)?"checked":"value";r._valueTracker=p_(r,a,""+r[a])}}function qu(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return r&&(u=Uf(r)?r.checked?"true":"false":r.value),r=u,r!==l?(a.setValue(r),!0):!1}function Gl(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ts=/[\n"\\]/g;function Lt(r){return r.replace(ts,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Js(r,a,l,u,m,g,E,b){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),a!=null?E==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Gn(a)):r.value!==""+Gn(a)&&(r.value=""+Gn(a)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),a!=null?Hl(r,E,Gn(a)):l!=null?Hl(r,E,Gn(l)):u!=null&&r.removeAttribute("value"),m==null&&g!=null&&(r.defaultChecked=!!g),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?r.name=""+Gn(b):r.removeAttribute("name")}function bo(r,a,l,u,m,g,E,b){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(r.type=g),a!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||a!=null)){ql(r);return}l=l!=null?""+Gn(l):"",a=a!=null?""+Gn(a):l,b||a===r.value||(r.value=a),r.defaultValue=a}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=b?r.checked:!!u,r.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ql(r)}function Hl(r,a,l){a==="number"&&Gl(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function nt(r,a,l,u){if(r=r.options,a){a={};for(var m=0;m<l.length;m++)a["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=a.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&u&&(r[l].defaultSelected=!0)}else{for(l=""+Gn(l),a=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,u&&(r[m].defaultSelected=!0);return}a!==null||r[m].disabled||(a=r[m])}a!==null&&(a.selected=!0)}}function Io(r,a,l){if(a!=null&&(a=""+Gn(a),a!==r.value&&(r.value=a),l==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=l!=null?""+Gn(l):""}function Zs(r,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(i(92));if(Ae(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=Gn(a),r.defaultValue=l,u=r.textContent,u===l&&u!==""&&u!==null&&(r.value=u),ql(r)}function Ui(r,a){if(a){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=a;return}}r.textContent=a}var g_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gu(r,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":u?r.setProperty(a,l):typeof l!="number"||l===0||g_.has(a)?a==="float"?r.cssFloat=l:r[a]=(""+l).trim():r[a]=l+"px"}function Bf(r,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var m in a)u=a[m],a.hasOwnProperty(m)&&l[m]!==u&&Gu(r,m,u)}else for(var g in a)a.hasOwnProperty(g)&&Gu(r,g,a[g])}function Hu(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var __=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),y_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wr(r){return y_.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function fn(){}var $l=null;function Kl(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ns=null,vi=null;function Ff(r){var a=es(r);if(a&&(r=a.stateNode)){var l=r[Cn]||null;e:switch(r=a.stateNode,a.type){case"input":if(Js(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Lt(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==r&&u.form===r.form){var m=u[Cn]||null;if(!m)throw Error(i(90));Js(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===r.form&&qu(u)}break e;case"textarea":Io(r,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&nt(r,!!l.multiple,a,!1)}}}var $u=!1;function jf(r,a,l){if($u)return r(a,l);$u=!0;try{var u=r(a);return u}finally{if($u=!1,(ns!==null||vi!==null)&&(Lm(),ns&&(a=ns,r=vi,vi=ns=null,Ff(a),r)))for(a=0;a<r.length;a++)Ff(r[a])}}function ni(r,a){var l=r.stateNode;if(l===null)return null;var u=l[Cn]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ku=!1;if(sr)try{var Tr={};Object.defineProperty(Tr,"passive",{get:function(){Ku=!0}}),window.addEventListener("test",Tr,Tr),window.removeEventListener("test",Tr,Tr)}catch{Ku=!1}var Ei=null,Ql=null,br=null;function ea(){if(br)return br;var r,a=Ql,l=a.length,u,m="value"in Ei?Ei.value:Ei.textContent,g=m.length;for(r=0;r<l&&a[r]===m[r];r++);var E=l-r;for(u=1;u<=E&&a[l-u]===m[g-u];u++);return br=m.slice(r,1<u?1-u:void 0)}function So(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function ta(){return!0}function Tt(){return!1}function Ln(r){function a(l,u,m,g,E){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var b in r)r.hasOwnProperty(b)&&(l=r[b],this[b]=l?l(g):g[b]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?ta:Tt,this.isPropagationStopped=Tt,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ta)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ta)},persist:function(){},isPersistent:ta}),a}var is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ao=Ln(is),na=v({},is,{view:0,detail:0}),zf=Ln(na),ia,Wl,Hn,Co=v({},na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sa,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Hn&&(Hn&&r.type==="mousemove"?(ia=r.screenX-Hn.screenX,Wl=r.screenY-Hn.screenY):Wl=ia=0,Hn=r),ia)},movementY:function(r){return"movementY"in r?r.movementY:Wl}}),qf=Ln(Co),Ro=v({},Co,{dataTransfer:0}),Gf=Ln(Ro),Qu=v({},na,{relatedTarget:0}),ra=Ln(Qu),Hf=v({},is,{animationName:0,elapsedTime:0,pseudoElement:0}),Yl=Ln(Hf),v_=v({},is,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),$f=Ln(v_),xo=v({},is,{data:0}),Wu=Ln(xo),Kf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qf(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Xu[r])?!!a[r]:!1}function sa(){return Qf}var Wf=v({},na,{key:function(r){if(r.key){var a=Kf[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=So(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Yu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sa,charCode:function(r){return r.type==="keypress"?So(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?So(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Yf=Ln(Wf),rs=v({},Co,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ju=Ln(rs),Xf=v({},na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sa}),Jf=Ln(Xf),Zf=v({},is,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xl=Ln(Zf),$n=v({},Co,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),em=Ln($n),tm=v({},is,{newState:0,oldState:0}),aa=Ln(tm),f=[9,13,27,32],y=sr&&"CompositionEvent"in window,w=null;sr&&"documentMode"in document&&(w=document.documentMode);var S=sr&&"TextEvent"in window&&!w,B=sr&&(!y||w&&8<w&&11>=w),Q=" ",he=!1;function lt(r,a){switch(r){case"keyup":return f.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xt(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var je=!1;function mn(r,a){switch(r){case"compositionend":return Xt(a);case"keypress":return a.which!==32?null:(he=!0,Q);case"textInput":return r=a.data,r===Q&&he?null:r;default:return null}}function pn(r,a){if(je)return r==="compositionend"||!y&&lt(r,a)?(r=ea(),br=Ql=Ei=null,je=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return B&&a.locale!=="ko"?null:a.data;default:return null}}var oa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ii(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!oa[r.type]:a==="textarea"}function No(r,a,l,u){ns?vi?vi.push(u):vi=[u]:ns=u,a=Gm(a,"onChange"),0<a.length&&(l=new Ao("onChange","change",null,l,u),r.push({event:l,listeners:a}))}var ss=null,Zu=null;function cP(r){JI(r,0)}function nm(r){var a=To(r);if(qu(a))return r}function _T(r,a){if(r==="change")return a}var yT=!1;if(sr){var E_;if(sr){var w_="oninput"in document;if(!w_){var vT=document.createElement("div");vT.setAttribute("oninput","return;"),w_=typeof vT.oninput=="function"}E_=w_}else E_=!1;yT=E_&&(!document.documentMode||9<document.documentMode)}function ET(){ss&&(ss.detachEvent("onpropertychange",wT),Zu=ss=null)}function wT(r){if(r.propertyName==="value"&&nm(Zu)){var a=[];No(a,Zu,r,Kl(r)),jf(cP,a)}}function uP(r,a,l){r==="focusin"?(ET(),ss=a,Zu=l,ss.attachEvent("onpropertychange",wT)):r==="focusout"&&ET()}function hP(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return nm(Zu)}function dP(r,a){if(r==="click")return nm(a)}function fP(r,a){if(r==="input"||r==="change")return nm(a)}function mP(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var wi=typeof Object.is=="function"?Object.is:mP;function eh(r,a){if(wi(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var l=Object.keys(r),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Bl.call(a,m)||!wi(r[m],a[m]))return!1}return!0}function TT(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function bT(r,a){var l=TT(r);r=0;for(var u;l;){if(l.nodeType===3){if(u=r+l.textContent.length,r<=a&&u>=a)return{node:l,offset:a-r};r=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=TT(l)}}function IT(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?IT(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function ST(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Gl(r.document);a instanceof r.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)r=a.contentWindow;else break;a=Gl(r.document)}return a}function T_(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var pP=sr&&"documentMode"in document&&11>=document.documentMode,Jl=null,b_=null,th=null,I_=!1;function AT(r,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;I_||Jl==null||Jl!==Gl(u)||(u=Jl,"selectionStart"in u&&T_(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),th&&eh(th,u)||(th=u,u=Gm(b_,"onSelect"),0<u.length&&(a=new Ao("onSelect","select",null,a,l),r.push({event:a,listeners:u}),a.target=Jl)))}function Do(r,a){var l={};return l[r.toLowerCase()]=a.toLowerCase(),l["Webkit"+r]="webkit"+a,l["Moz"+r]="moz"+a,l}var Zl={animationend:Do("Animation","AnimationEnd"),animationiteration:Do("Animation","AnimationIteration"),animationstart:Do("Animation","AnimationStart"),transitionrun:Do("Transition","TransitionRun"),transitionstart:Do("Transition","TransitionStart"),transitioncancel:Do("Transition","TransitionCancel"),transitionend:Do("Transition","TransitionEnd")},S_={},CT={};sr&&(CT=document.createElement("div").style,"AnimationEvent"in window||(delete Zl.animationend.animation,delete Zl.animationiteration.animation,delete Zl.animationstart.animation),"TransitionEvent"in window||delete Zl.transitionend.transition);function ko(r){if(S_[r])return S_[r];if(!Zl[r])return r;var a=Zl[r],l;for(l in a)if(a.hasOwnProperty(l)&&l in CT)return S_[r]=a[l];return r}var RT=ko("animationend"),xT=ko("animationiteration"),NT=ko("animationstart"),gP=ko("transitionrun"),_P=ko("transitionstart"),yP=ko("transitioncancel"),DT=ko("transitionend"),kT=new Map,A_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");A_.push("scrollEnd");function ar(r,a){kT.set(r,a),qn(a,[r])}var im=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Bi=[],ec=0,C_=0;function rm(){for(var r=ec,a=C_=ec=0;a<r;){var l=Bi[a];Bi[a++]=null;var u=Bi[a];Bi[a++]=null;var m=Bi[a];Bi[a++]=null;var g=Bi[a];if(Bi[a++]=null,u!==null&&m!==null){var E=u.pending;E===null?m.next=m:(m.next=E.next,E.next=m),u.pending=m}g!==0&&PT(l,m,g)}}function sm(r,a,l,u){Bi[ec++]=r,Bi[ec++]=a,Bi[ec++]=l,Bi[ec++]=u,C_|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function R_(r,a,l,u){return sm(r,a,l,u),am(r)}function Po(r,a){return sm(r,null,null,a),am(r)}function PT(r,a,l){r.lanes|=l;var u=r.alternate;u!==null&&(u.lanes|=l);for(var m=!1,g=r.return;g!==null;)g.childLanes|=l,u=g.alternate,u!==null&&(u.childLanes|=l),g.tag===22&&(r=g.stateNode,r===null||r._visibility&1||(m=!0)),r=g,g=g.return;return r.tag===3?(g=r.stateNode,m&&a!==null&&(m=31-zn(l),r=g.hiddenUpdates,u=r[m],u===null?r[m]=[a]:u.push(a),a.lane=l|536870912),g):null}function am(r){if(50<bh)throw bh=0,Ly=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var tc={};function vP(r,a,l,u){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ti(r,a,l,u){return new vP(r,a,l,u)}function x_(r){return r=r.prototype,!(!r||!r.isReactComponent)}function as(r,a){var l=r.alternate;return l===null?(l=Ti(r.tag,a,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=a,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,a=r.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function OT(r,a){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,a=l.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function om(r,a,l,u,m,g){var E=0;if(u=r,typeof r=="function")x_(r)&&(E=1);else if(typeof r=="string")E=IO(r,l,ae.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case N:return r=Ti(31,l,a,m),r.elementType=N,r.lanes=g,r;case q:return Oo(l.children,m,g,a);case Y:E=8,m|=24;break;case le:return r=Ti(12,l,a,m|2),r.elementType=le,r.lanes=g,r;case Pe:return r=Ti(13,l,a,m),r.elementType=Pe,r.lanes=g,r;case Re:return r=Ti(19,l,a,m),r.elementType=Re,r.lanes=g,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case oe:E=10;break e;case Ee:E=9;break e;case de:E=11;break e;case k:E=14;break e;case x:E=16,u=null;break e}E=29,l=Error(i(130,r===null?"null":typeof r,"")),u=null}return a=Ti(E,l,a,m),a.elementType=r,a.type=u,a.lanes=g,a}function Oo(r,a,l,u){return r=Ti(7,r,u,a),r.lanes=l,r}function N_(r,a,l){return r=Ti(6,r,null,a),r.lanes=l,r}function MT(r){var a=Ti(18,null,null,0);return a.stateNode=r,a}function D_(r,a,l){return a=Ti(4,r.children!==null?r.children:[],r.key,a),a.lanes=l,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var VT=new WeakMap;function Fi(r,a){if(typeof r=="object"&&r!==null){var l=VT.get(r);return l!==void 0?l:(a={value:r,source:a,stack:Df(a)},VT.set(r,a),a)}return{value:r,source:a,stack:Df(a)}}var nc=[],ic=0,lm=null,nh=0,ji=[],zi=0,la=null,Ir=1,Sr="";function os(r,a){nc[ic++]=nh,nc[ic++]=lm,lm=r,nh=a}function LT(r,a,l){ji[zi++]=Ir,ji[zi++]=Sr,ji[zi++]=la,la=r;var u=Ir;r=Sr;var m=32-zn(u)-1;u&=~(1<<m),l+=1;var g=32-zn(a)+m;if(30<g){var E=m-m%5;g=(u&(1<<E)-1).toString(32),u>>=E,m-=E,Ir=1<<32-zn(a)+m|l<<m|u,Sr=g+r}else Ir=1<<g|l<<m|u,Sr=r}function k_(r){r.return!==null&&(os(r,1),LT(r,1,0))}function P_(r){for(;r===lm;)lm=nc[--ic],nc[ic]=null,nh=nc[--ic],nc[ic]=null;for(;r===la;)la=ji[--zi],ji[zi]=null,Sr=ji[--zi],ji[zi]=null,Ir=ji[--zi],ji[zi]=null}function UT(r,a){ji[zi++]=Ir,ji[zi++]=Sr,ji[zi++]=la,Ir=a.id,Sr=a.overflow,la=r}var Rn=null,bt=null,Ze=!1,ca=null,qi=!1,O_=Error(i(519));function ua(r){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ih(Fi(a,r)),O_}function BT(r){var a=r.stateNode,l=r.type,u=r.memoizedProps;switch(a[Vt]=r,a[Cn]=u,l){case"dialog":Ke("cancel",a),Ke("close",a);break;case"iframe":case"object":case"embed":Ke("load",a);break;case"video":case"audio":for(l=0;l<Sh.length;l++)Ke(Sh[l],a);break;case"source":Ke("error",a);break;case"img":case"image":case"link":Ke("error",a),Ke("load",a);break;case"details":Ke("toggle",a);break;case"input":Ke("invalid",a),bo(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ke("invalid",a);break;case"textarea":Ke("invalid",a),Zs(a,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||nS(a.textContent,l)?(u.popover!=null&&(Ke("beforetoggle",a),Ke("toggle",a)),u.onScroll!=null&&Ke("scroll",a),u.onScrollEnd!=null&&Ke("scrollend",a),u.onClick!=null&&(a.onclick=fn),a=!0):a=!1,a||ua(r,!0)}function FT(r){for(Rn=r.return;Rn;)switch(Rn.tag){case 5:case 31:case 13:qi=!1;return;case 27:case 3:qi=!0;return;default:Rn=Rn.return}}function rc(r){if(r!==Rn)return!1;if(!Ze)return FT(r),Ze=!0,!1;var a=r.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Jy(r.type,r.memoizedProps)),l=!l),l&&bt&&ua(r),FT(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));bt=hS(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));bt=hS(r)}else a===27?(a=bt,Ia(r.type)?(r=iv,iv=null,bt=r):bt=a):bt=Rn?Hi(r.stateNode.nextSibling):null;return!0}function Mo(){bt=Rn=null,Ze=!1}function M_(){var r=ca;return r!==null&&(oi===null?oi=r:oi.push.apply(oi,r),ca=null),r}function ih(r){ca===null?ca=[r]:ca.push(r)}var V_=O(null),Vo=null,ls=null;function ha(r,a,l){ne(V_,a._currentValue),a._currentValue=l}function cs(r){r._currentValue=V_.current,W(V_)}function L_(r,a,l){for(;r!==null;){var u=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),r===l)break;r=r.return}}function U_(r,a,l,u){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var g=m.dependencies;if(g!==null){var E=m.child;g=g.firstContext;e:for(;g!==null;){var b=g;g=m;for(var D=0;D<a.length;D++)if(b.context===a[D]){g.lanes|=l,b=g.alternate,b!==null&&(b.lanes|=l),L_(g.return,l,r),u||(E=null);break e}g=b.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(i(341));E.lanes|=l,g=E.alternate,g!==null&&(g.lanes|=l),L_(E,l,r),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===r){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function sc(r,a,l,u){r=null;for(var m=a,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var b=m.type;wi(m.pendingProps.value,E.value)||(r!==null?r.push(b):r=[b])}}else if(m===Se.current){if(E=m.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Nh):r=[Nh])}m=m.return}r!==null&&U_(a,r,l,u),a.flags|=262144}function cm(r){for(r=r.firstContext;r!==null;){if(!wi(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Lo(r){Vo=r,ls=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function xn(r){return jT(Vo,r)}function um(r,a){return Vo===null&&Lo(r),jT(r,a)}function jT(r,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},ls===null){if(r===null)throw Error(i(308));ls=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else ls=ls.next=a;return l}var EP=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(l,u){r.push(u)}};this.abort=function(){a.aborted=!0,r.forEach(function(l){return l()})}},wP=n.unstable_scheduleCallback,TP=n.unstable_NormalPriority,Jt={$$typeof:oe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function B_(){return{controller:new EP,data:new Map,refCount:0}}function rh(r){r.refCount--,r.refCount===0&&wP(TP,function(){r.controller.abort()})}var sh=null,F_=0,ac=0,oc=null;function bP(r,a){if(sh===null){var l=sh=[];F_=0,ac=qy(),oc={status:"pending",value:void 0,then:function(u){l.push(u)}}}return F_++,a.then(zT,zT),a}function zT(){if(--F_===0&&sh!==null){oc!==null&&(oc.status="fulfilled");var r=sh;sh=null,ac=0,oc=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function IP(r,a){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return r.then(function(){u.status="fulfilled",u.value=a;for(var m=0;m<l.length;m++)(0,l[m])(a)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var qT=H.S;H.S=function(r,a){AI=Sn(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&bP(r,a),qT!==null&&qT(r,a)};var Uo=O(null);function j_(){var r=Uo.current;return r!==null?r:yt.pooledCache}function hm(r,a){a===null?ne(Uo,Uo.current):ne(Uo,a.pool)}function GT(){var r=j_();return r===null?null:{parent:Jt._currentValue,pool:r}}var lc=Error(i(460)),z_=Error(i(474)),dm=Error(i(542)),fm={then:function(){}};function HT(r){return r=r.status,r==="fulfilled"||r==="rejected"}function $T(r,a,l){switch(l=r[l],l===void 0?r.push(a):l!==a&&(a.then(fn,fn),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,QT(r),r;default:if(typeof a.status=="string")a.then(fn,fn);else{if(r=yt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(u){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=u}},function(u){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,QT(r),r}throw Fo=a,lc}}function Bo(r){try{var a=r._init;return a(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Fo=l,lc):l}}var Fo=null;function KT(){if(Fo===null)throw Error(i(459));var r=Fo;return Fo=null,r}function QT(r){if(r===lc||r===dm)throw Error(i(483))}var cc=null,ah=0;function mm(r){var a=ah;return ah+=1,cc===null&&(cc=[]),$T(cc,r,a)}function oh(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function pm(r,a){throw a.$$typeof===T?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function WT(r){function a(U,M){if(r){var F=U.deletions;F===null?(U.deletions=[M],U.flags|=16):F.push(M)}}function l(U,M){if(!r)return null;for(;M!==null;)a(U,M),M=M.sibling;return null}function u(U){for(var M=new Map;U!==null;)U.key!==null?M.set(U.key,U):M.set(U.index,U),U=U.sibling;return M}function m(U,M){return U=as(U,M),U.index=0,U.sibling=null,U}function g(U,M,F){return U.index=F,r?(F=U.alternate,F!==null?(F=F.index,F<M?(U.flags|=67108866,M):F):(U.flags|=67108866,M)):(U.flags|=1048576,M)}function E(U){return r&&U.alternate===null&&(U.flags|=67108866),U}function b(U,M,F,Z){return M===null||M.tag!==6?(M=N_(F,U.mode,Z),M.return=U,M):(M=m(M,F),M.return=U,M)}function D(U,M,F,Z){var xe=F.type;return xe===q?J(U,M,F.props.children,Z,F.key):M!==null&&(M.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===x&&Bo(xe)===M.type)?(M=m(M,F.props),oh(M,F),M.return=U,M):(M=om(F.type,F.key,F.props,null,U.mode,Z),oh(M,F),M.return=U,M)}function j(U,M,F,Z){return M===null||M.tag!==4||M.stateNode.containerInfo!==F.containerInfo||M.stateNode.implementation!==F.implementation?(M=D_(F,U.mode,Z),M.return=U,M):(M=m(M,F.children||[]),M.return=U,M)}function J(U,M,F,Z,xe){return M===null||M.tag!==7?(M=Oo(F,U.mode,Z,xe),M.return=U,M):(M=m(M,F),M.return=U,M)}function te(U,M,F){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=N_(""+M,U.mode,F),M.return=U,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case R:return F=om(M.type,M.key,M.props,null,U.mode,F),oh(F,M),F.return=U,F;case P:return M=D_(M,U.mode,F),M.return=U,M;case x:return M=Bo(M),te(U,M,F)}if(Ae(M)||C(M))return M=Oo(M,U.mode,F,null),M.return=U,M;if(typeof M.then=="function")return te(U,mm(M),F);if(M.$$typeof===oe)return te(U,um(U,M),F);pm(U,M)}return null}function G(U,M,F,Z){var xe=M!==null?M.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return xe!==null?null:b(U,M,""+F,Z);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case R:return F.key===xe?D(U,M,F,Z):null;case P:return F.key===xe?j(U,M,F,Z):null;case x:return F=Bo(F),G(U,M,F,Z)}if(Ae(F)||C(F))return xe!==null?null:J(U,M,F,Z,null);if(typeof F.then=="function")return G(U,M,mm(F),Z);if(F.$$typeof===oe)return G(U,M,um(U,F),Z);pm(U,F)}return null}function $(U,M,F,Z,xe){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return U=U.get(F)||null,b(M,U,""+Z,xe);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:return U=U.get(Z.key===null?F:Z.key)||null,D(M,U,Z,xe);case P:return U=U.get(Z.key===null?F:Z.key)||null,j(M,U,Z,xe);case x:return Z=Bo(Z),$(U,M,F,Z,xe)}if(Ae(Z)||C(Z))return U=U.get(F)||null,J(M,U,Z,xe,null);if(typeof Z.then=="function")return $(U,M,F,mm(Z),xe);if(Z.$$typeof===oe)return $(U,M,F,um(M,Z),xe);pm(M,Z)}return null}function Te(U,M,F,Z){for(var xe=null,it=null,Ie=M,Fe=M=0,We=null;Ie!==null&&Fe<F.length;Fe++){Ie.index>Fe?(We=Ie,Ie=null):We=Ie.sibling;var rt=G(U,Ie,F[Fe],Z);if(rt===null){Ie===null&&(Ie=We);break}r&&Ie&&rt.alternate===null&&a(U,Ie),M=g(rt,M,Fe),it===null?xe=rt:it.sibling=rt,it=rt,Ie=We}if(Fe===F.length)return l(U,Ie),Ze&&os(U,Fe),xe;if(Ie===null){for(;Fe<F.length;Fe++)Ie=te(U,F[Fe],Z),Ie!==null&&(M=g(Ie,M,Fe),it===null?xe=Ie:it.sibling=Ie,it=Ie);return Ze&&os(U,Fe),xe}for(Ie=u(Ie);Fe<F.length;Fe++)We=$(Ie,U,Fe,F[Fe],Z),We!==null&&(r&&We.alternate!==null&&Ie.delete(We.key===null?Fe:We.key),M=g(We,M,Fe),it===null?xe=We:it.sibling=We,it=We);return r&&Ie.forEach(function(xa){return a(U,xa)}),Ze&&os(U,Fe),xe}function Ne(U,M,F,Z){if(F==null)throw Error(i(151));for(var xe=null,it=null,Ie=M,Fe=M=0,We=null,rt=F.next();Ie!==null&&!rt.done;Fe++,rt=F.next()){Ie.index>Fe?(We=Ie,Ie=null):We=Ie.sibling;var xa=G(U,Ie,rt.value,Z);if(xa===null){Ie===null&&(Ie=We);break}r&&Ie&&xa.alternate===null&&a(U,Ie),M=g(xa,M,Fe),it===null?xe=xa:it.sibling=xa,it=xa,Ie=We}if(rt.done)return l(U,Ie),Ze&&os(U,Fe),xe;if(Ie===null){for(;!rt.done;Fe++,rt=F.next())rt=te(U,rt.value,Z),rt!==null&&(M=g(rt,M,Fe),it===null?xe=rt:it.sibling=rt,it=rt);return Ze&&os(U,Fe),xe}for(Ie=u(Ie);!rt.done;Fe++,rt=F.next())rt=$(Ie,U,Fe,rt.value,Z),rt!==null&&(r&&rt.alternate!==null&&Ie.delete(rt.key===null?Fe:rt.key),M=g(rt,M,Fe),it===null?xe=rt:it.sibling=rt,it=rt);return r&&Ie.forEach(function(MO){return a(U,MO)}),Ze&&os(U,Fe),xe}function pt(U,M,F,Z){if(typeof F=="object"&&F!==null&&F.type===q&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case R:e:{for(var xe=F.key;M!==null;){if(M.key===xe){if(xe=F.type,xe===q){if(M.tag===7){l(U,M.sibling),Z=m(M,F.props.children),Z.return=U,U=Z;break e}}else if(M.elementType===xe||typeof xe=="object"&&xe!==null&&xe.$$typeof===x&&Bo(xe)===M.type){l(U,M.sibling),Z=m(M,F.props),oh(Z,F),Z.return=U,U=Z;break e}l(U,M);break}else a(U,M);M=M.sibling}F.type===q?(Z=Oo(F.props.children,U.mode,Z,F.key),Z.return=U,U=Z):(Z=om(F.type,F.key,F.props,null,U.mode,Z),oh(Z,F),Z.return=U,U=Z)}return E(U);case P:e:{for(xe=F.key;M!==null;){if(M.key===xe)if(M.tag===4&&M.stateNode.containerInfo===F.containerInfo&&M.stateNode.implementation===F.implementation){l(U,M.sibling),Z=m(M,F.children||[]),Z.return=U,U=Z;break e}else{l(U,M);break}else a(U,M);M=M.sibling}Z=D_(F,U.mode,Z),Z.return=U,U=Z}return E(U);case x:return F=Bo(F),pt(U,M,F,Z)}if(Ae(F))return Te(U,M,F,Z);if(C(F)){if(xe=C(F),typeof xe!="function")throw Error(i(150));return F=xe.call(F),Ne(U,M,F,Z)}if(typeof F.then=="function")return pt(U,M,mm(F),Z);if(F.$$typeof===oe)return pt(U,M,um(U,F),Z);pm(U,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,M!==null&&M.tag===6?(l(U,M.sibling),Z=m(M,F),Z.return=U,U=Z):(l(U,M),Z=N_(F,U.mode,Z),Z.return=U,U=Z),E(U)):l(U,M)}return function(U,M,F,Z){try{ah=0;var xe=pt(U,M,F,Z);return cc=null,xe}catch(Ie){if(Ie===lc||Ie===dm)throw Ie;var it=Ti(29,Ie,null,U.mode);return it.lanes=Z,it.return=U,it}finally{}}}var jo=WT(!0),YT=WT(!1),da=!1;function q_(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function G_(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function fa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ma(r,a,l){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(ot&2)!==0){var m=u.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),u.pending=a,a=am(r),PT(r,null,l),a}return sm(r,u,a,l),am(r)}function lh(r,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,$s(r,l)}}function H_(r,a){var l=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?m=g=E:g=g.next=E,l=l.next}while(l!==null);g===null?m=g=a:g=g.next=a}else m=g=a;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=a:r.next=a,l.lastBaseUpdate=a}var $_=!1;function ch(){if($_){var r=oc;if(r!==null)throw r}}function uh(r,a,l,u){$_=!1;var m=r.updateQueue;da=!1;var g=m.firstBaseUpdate,E=m.lastBaseUpdate,b=m.shared.pending;if(b!==null){m.shared.pending=null;var D=b,j=D.next;D.next=null,E===null?g=j:E.next=j,E=D;var J=r.alternate;J!==null&&(J=J.updateQueue,b=J.lastBaseUpdate,b!==E&&(b===null?J.firstBaseUpdate=j:b.next=j,J.lastBaseUpdate=D))}if(g!==null){var te=m.baseState;E=0,J=j=D=null,b=g;do{var G=b.lane&-536870913,$=G!==b.lane;if($?(Qe&G)===G:(u&G)===G){G!==0&&G===ac&&($_=!0),J!==null&&(J=J.next={lane:0,tag:b.tag,payload:b.payload,callback:null,next:null});e:{var Te=r,Ne=b;G=a;var pt=l;switch(Ne.tag){case 1:if(Te=Ne.payload,typeof Te=="function"){te=Te.call(pt,te,G);break e}te=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Ne.payload,G=typeof Te=="function"?Te.call(pt,te,G):Te,G==null)break e;te=v({},te,G);break e;case 2:da=!0}}G=b.callback,G!==null&&(r.flags|=64,$&&(r.flags|=8192),$=m.callbacks,$===null?m.callbacks=[G]:$.push(G))}else $={lane:G,tag:b.tag,payload:b.payload,callback:b.callback,next:null},J===null?(j=J=$,D=te):J=J.next=$,E|=G;if(b=b.next,b===null){if(b=m.shared.pending,b===null)break;$=b,b=$.next,$.next=null,m.lastBaseUpdate=$,m.shared.pending=null}}while(!0);J===null&&(D=te),m.baseState=D,m.firstBaseUpdate=j,m.lastBaseUpdate=J,g===null&&(m.shared.lanes=0),va|=E,r.lanes=E,r.memoizedState=te}}function XT(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function JT(r,a){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)XT(l[r],a)}var uc=O(null),gm=O(0);function ZT(r,a){r=ys,ne(gm,r),ne(uc,a),ys=r|a.baseLanes}function K_(){ne(gm,ys),ne(uc,uc.current)}function Q_(){ys=gm.current,W(uc),W(gm)}var bi=O(null),Gi=null;function pa(r){var a=r.alternate;ne($t,$t.current&1),ne(bi,r),Gi===null&&(a===null||uc.current!==null||a.memoizedState!==null)&&(Gi=r)}function W_(r){ne($t,$t.current),ne(bi,r),Gi===null&&(Gi=r)}function eb(r){r.tag===22?(ne($t,$t.current),ne(bi,r),Gi===null&&(Gi=r)):ga()}function ga(){ne($t,$t.current),ne(bi,bi.current)}function Ii(r){W(bi),Gi===r&&(Gi=null),W($t)}var $t=O(0);function _m(r){for(var a=r;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||tv(l)||nv(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var us=0,Le=null,ft=null,Zt=null,ym=!1,hc=!1,zo=!1,vm=0,hh=0,dc=null,SP=0;function Ut(){throw Error(i(321))}function Y_(r,a){if(a===null)return!1;for(var l=0;l<a.length&&l<r.length;l++)if(!wi(r[l],a[l]))return!1;return!0}function X_(r,a,l,u,m,g){return us=g,Le=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,H.H=r===null||r.memoizedState===null?Lb:dy,zo=!1,g=l(u,m),zo=!1,hc&&(g=nb(a,l,u,m)),tb(r),g}function tb(r){H.H=mh;var a=ft!==null&&ft.next!==null;if(us=0,Zt=ft=Le=null,ym=!1,hh=0,dc=null,a)throw Error(i(300));r===null||en||(r=r.dependencies,r!==null&&cm(r)&&(en=!0))}function nb(r,a,l,u){Le=r;var m=0;do{if(hc&&(dc=null),hh=0,hc=!1,25<=m)throw Error(i(301));if(m+=1,Zt=ft=null,r.updateQueue!=null){var g=r.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}H.H=Ub,g=a(l,u)}while(hc);return g}function AP(){var r=H.H,a=r.useState()[0];return a=typeof a.then=="function"?dh(a):a,r=r.useState()[0],(ft!==null?ft.memoizedState:null)!==r&&(Le.flags|=1024),a}function J_(){var r=vm!==0;return vm=0,r}function Z_(r,a,l){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~l}function ey(r){if(ym){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}ym=!1}us=0,Zt=ft=Le=null,hc=!1,hh=vm=0,dc=null}function Kn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Le.memoizedState=Zt=r:Zt=Zt.next=r,Zt}function Kt(){if(ft===null){var r=Le.alternate;r=r!==null?r.memoizedState:null}else r=ft.next;var a=Zt===null?Le.memoizedState:Zt.next;if(a!==null)Zt=a,ft=r;else{if(r===null)throw Le.alternate===null?Error(i(467)):Error(i(310));ft=r,r={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},Zt===null?Le.memoizedState=Zt=r:Zt=Zt.next=r}return Zt}function Em(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dh(r){var a=hh;return hh+=1,dc===null&&(dc=[]),r=$T(dc,r,a),a=Le,(Zt===null?a.memoizedState:Zt.next)===null&&(a=a.alternate,H.H=a===null||a.memoizedState===null?Lb:dy),r}function wm(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return dh(r);if(r.$$typeof===oe)return xn(r)}throw Error(i(438,String(r)))}function ty(r){var a=null,l=Le.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Le.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=Em(),Le.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(r),u=0;u<r;u++)l[u]=V;return a.index++,l}function hs(r,a){return typeof a=="function"?a(r):a}function Tm(r){var a=Kt();return ny(a,ft,r)}function ny(r,a,l){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var m=r.baseQueue,g=u.pending;if(g!==null){if(m!==null){var E=m.next;m.next=g.next,g.next=E}a.baseQueue=m=g,u.pending=null}if(g=r.baseState,m===null)r.memoizedState=g;else{a=m.next;var b=E=null,D=null,j=a,J=!1;do{var te=j.lane&-536870913;if(te!==j.lane?(Qe&te)===te:(us&te)===te){var G=j.revertLane;if(G===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),te===ac&&(J=!0);else if((us&G)===G){j=j.next,G===ac&&(J=!0);continue}else te={lane:0,revertLane:j.revertLane,gesture:null,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},D===null?(b=D=te,E=g):D=D.next=te,Le.lanes|=G,va|=G;te=j.action,zo&&l(g,te),g=j.hasEagerState?j.eagerState:l(g,te)}else G={lane:te,revertLane:j.revertLane,gesture:j.gesture,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null},D===null?(b=D=G,E=g):D=D.next=G,Le.lanes|=te,va|=te;j=j.next}while(j!==null&&j!==a);if(D===null?E=g:D.next=b,!wi(g,r.memoizedState)&&(en=!0,J&&(l=oc,l!==null)))throw l;r.memoizedState=g,r.baseState=E,r.baseQueue=D,u.lastRenderedState=g}return m===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function iy(r){var a=Kt(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var u=l.dispatch,m=l.pending,g=a.memoizedState;if(m!==null){l.pending=null;var E=m=m.next;do g=r(g,E.action),E=E.next;while(E!==m);wi(g,a.memoizedState)||(en=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),l.lastRenderedState=g}return[g,u]}function ib(r,a,l){var u=Le,m=Kt(),g=Ze;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=a();var E=!wi((ft||m).memoizedState,l);if(E&&(m.memoizedState=l,en=!0),m=m.queue,ay(ab.bind(null,u,m,r),[r]),m.getSnapshot!==a||E||Zt!==null&&Zt.memoizedState.tag&1){if(u.flags|=2048,fc(9,{destroy:void 0},sb.bind(null,u,m,l,a),null),yt===null)throw Error(i(349));g||(us&127)!==0||rb(u,a,l)}return l}function rb(r,a,l){r.flags|=16384,r={getSnapshot:a,value:l},a=Le.updateQueue,a===null?(a=Em(),Le.updateQueue=a,a.stores=[r]):(l=a.stores,l===null?a.stores=[r]:l.push(r))}function sb(r,a,l,u){a.value=l,a.getSnapshot=u,ob(a)&&lb(r)}function ab(r,a,l){return l(function(){ob(a)&&lb(r)})}function ob(r){var a=r.getSnapshot;r=r.value;try{var l=a();return!wi(r,l)}catch{return!0}}function lb(r){var a=Po(r,2);a!==null&&li(a,r,2)}function ry(r){var a=Kn();if(typeof r=="function"){var l=r;if(r=l(),zo){Mi(!0);try{l()}finally{Mi(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:r},a}function cb(r,a,l,u){return r.baseState=l,ny(r,ft,typeof u=="function"?u:hs)}function CP(r,a,l,u,m){if(Sm(r))throw Error(i(485));if(r=a.action,r!==null){var g={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};H.T!==null?l(!0):g.isTransition=!1,u(g),l=a.pending,l===null?(g.next=a.pending=g,ub(a,g)):(g.next=l.next,a.pending=l.next=g)}}function ub(r,a){var l=a.action,u=a.payload,m=r.state;if(a.isTransition){var g=H.T,E={};H.T=E;try{var b=l(m,u),D=H.S;D!==null&&D(E,b),hb(r,a,b)}catch(j){sy(r,a,j)}finally{g!==null&&E.types!==null&&(g.types=E.types),H.T=g}}else try{g=l(m,u),hb(r,a,g)}catch(j){sy(r,a,j)}}function hb(r,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){db(r,a,u)},function(u){return sy(r,a,u)}):db(r,a,l)}function db(r,a,l){a.status="fulfilled",a.value=l,fb(a),r.state=l,a=r.pending,a!==null&&(l=a.next,l===a?r.pending=null:(l=l.next,a.next=l,ub(r,l)))}function sy(r,a,l){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,fb(a),a=a.next;while(a!==u)}r.action=null}function fb(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function mb(r,a){return a}function pb(r,a){if(Ze){var l=yt.formState;if(l!==null){e:{var u=Le;if(Ze){if(bt){t:{for(var m=bt,g=qi;m.nodeType!==8;){if(!g){m=null;break t}if(m=Hi(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){bt=Hi(m.nextSibling),u=m.data==="F!";break e}}ua(u)}u=!1}u&&(a=l[0])}}return l=Kn(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mb,lastRenderedState:a},l.queue=u,l=Ob.bind(null,Le,u),u.dispatch=l,u=ry(!1),g=hy.bind(null,Le,!1,u.queue),u=Kn(),m={state:a,dispatch:null,action:r,pending:null},u.queue=m,l=CP.bind(null,Le,m,g,l),m.dispatch=l,u.memoizedState=r,[a,l,!1]}function gb(r){var a=Kt();return _b(a,ft,r)}function _b(r,a,l){if(a=ny(r,a,mb)[0],r=Tm(hs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=dh(a)}catch(E){throw E===lc?dm:E}else u=a;a=Kt();var m=a.queue,g=m.dispatch;return l!==a.memoizedState&&(Le.flags|=2048,fc(9,{destroy:void 0},RP.bind(null,m,l),null)),[u,g,r]}function RP(r,a){r.action=a}function yb(r){var a=Kt(),l=ft;if(l!==null)return _b(a,l,r);Kt(),a=a.memoizedState,l=Kt();var u=l.queue.dispatch;return l.memoizedState=r,[a,u,!1]}function fc(r,a,l,u){return r={tag:r,create:l,deps:u,inst:a,next:null},a=Le.updateQueue,a===null&&(a=Em(),Le.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=r.next=r:(u=l.next,l.next=r,r.next=u,a.lastEffect=r),r}function vb(){return Kt().memoizedState}function bm(r,a,l,u){var m=Kn();Le.flags|=r,m.memoizedState=fc(1|a,{destroy:void 0},l,u===void 0?null:u)}function Im(r,a,l,u){var m=Kt();u=u===void 0?null:u;var g=m.memoizedState.inst;ft!==null&&u!==null&&Y_(u,ft.memoizedState.deps)?m.memoizedState=fc(a,g,l,u):(Le.flags|=r,m.memoizedState=fc(1|a,g,l,u))}function Eb(r,a){bm(8390656,8,r,a)}function ay(r,a){Im(2048,8,r,a)}function xP(r){Le.flags|=4;var a=Le.updateQueue;if(a===null)a=Em(),Le.updateQueue=a,a.events=[r];else{var l=a.events;l===null?a.events=[r]:l.push(r)}}function wb(r){var a=Kt().memoizedState;return xP({ref:a,nextImpl:r}),function(){if((ot&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function Tb(r,a){return Im(4,2,r,a)}function bb(r,a){return Im(4,4,r,a)}function Ib(r,a){if(typeof a=="function"){r=r();var l=a(r);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function Sb(r,a,l){l=l!=null?l.concat([r]):null,Im(4,4,Ib.bind(null,a,r),l)}function oy(){}function Ab(r,a){var l=Kt();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&Y_(a,u[1])?u[0]:(l.memoizedState=[r,a],r)}function Cb(r,a){var l=Kt();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&Y_(a,u[1]))return u[0];if(u=r(),zo){Mi(!0);try{r()}finally{Mi(!1)}}return l.memoizedState=[u,a],u}function ly(r,a,l){return l===void 0||(us&1073741824)!==0&&(Qe&261930)===0?r.memoizedState=a:(r.memoizedState=l,r=RI(),Le.lanes|=r,va|=r,l)}function Rb(r,a,l,u){return wi(l,a)?l:uc.current!==null?(r=ly(r,l,u),wi(r,a)||(en=!0),r):(us&42)===0||(us&1073741824)!==0&&(Qe&261930)===0?(en=!0,r.memoizedState=l):(r=RI(),Le.lanes|=r,va|=r,a)}function xb(r,a,l,u,m){var g=ee.p;ee.p=g!==0&&8>g?g:8;var E=H.T,b={};H.T=b,hy(r,!1,a,l);try{var D=m(),j=H.S;if(j!==null&&j(b,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var J=IP(D,u);fh(r,a,J,Ci(r))}else fh(r,a,u,Ci(r))}catch(te){fh(r,a,{then:function(){},status:"rejected",reason:te},Ci())}finally{ee.p=g,E!==null&&b.types!==null&&(E.types=b.types),H.T=E}}function NP(){}function cy(r,a,l,u){if(r.tag!==5)throw Error(i(476));var m=Nb(r).queue;xb(r,m,a,X,l===null?NP:function(){return Db(r),l(u)})}function Nb(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:X},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:l},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function Db(r){var a=Nb(r);a.next===null&&(a=r.alternate.memoizedState),fh(r,a.next.queue,{},Ci())}function uy(){return xn(Nh)}function kb(){return Kt().memoizedState}function Pb(){return Kt().memoizedState}function DP(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var l=Ci();r=fa(l);var u=ma(a,r,l);u!==null&&(li(u,a,l),lh(u,a,l)),a={cache:B_()},r.payload=a;return}a=a.return}}function kP(r,a,l){var u=Ci();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Sm(r)?Mb(a,l):(l=R_(r,a,l,u),l!==null&&(li(l,r,u),Vb(l,a,u)))}function Ob(r,a,l){var u=Ci();fh(r,a,l,u)}function fh(r,a,l,u){var m={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Sm(r))Mb(a,m);else{var g=r.alternate;if(r.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var E=a.lastRenderedState,b=g(E,l);if(m.hasEagerState=!0,m.eagerState=b,wi(b,E))return sm(r,a,m,0),yt===null&&rm(),!1}catch{}finally{}if(l=R_(r,a,m,u),l!==null)return li(l,r,u),Vb(l,a,u),!0}return!1}function hy(r,a,l,u){if(u={lane:2,revertLane:qy(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Sm(r)){if(a)throw Error(i(479))}else a=R_(r,l,u,2),a!==null&&li(a,r,2)}function Sm(r){var a=r.alternate;return r===Le||a!==null&&a===Le}function Mb(r,a){hc=ym=!0;var l=r.pending;l===null?a.next=a:(a.next=l.next,l.next=a),r.pending=a}function Vb(r,a,l){if((l&4194048)!==0){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,$s(r,l)}}var mh={readContext:xn,use:wm,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useLayoutEffect:Ut,useInsertionEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useSyncExternalStore:Ut,useId:Ut,useHostTransitionStatus:Ut,useFormState:Ut,useActionState:Ut,useOptimistic:Ut,useMemoCache:Ut,useCacheRefresh:Ut};mh.useEffectEvent=Ut;var Lb={readContext:xn,use:wm,useCallback:function(r,a){return Kn().memoizedState=[r,a===void 0?null:a],r},useContext:xn,useEffect:Eb,useImperativeHandle:function(r,a,l){l=l!=null?l.concat([r]):null,bm(4194308,4,Ib.bind(null,a,r),l)},useLayoutEffect:function(r,a){return bm(4194308,4,r,a)},useInsertionEffect:function(r,a){bm(4,2,r,a)},useMemo:function(r,a){var l=Kn();a=a===void 0?null:a;var u=r();if(zo){Mi(!0);try{r()}finally{Mi(!1)}}return l.memoizedState=[u,a],u},useReducer:function(r,a,l){var u=Kn();if(l!==void 0){var m=l(a);if(zo){Mi(!0);try{l(a)}finally{Mi(!1)}}}else m=a;return u.memoizedState=u.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},u.queue=r,r=r.dispatch=kP.bind(null,Le,r),[u.memoizedState,r]},useRef:function(r){var a=Kn();return r={current:r},a.memoizedState=r},useState:function(r){r=ry(r);var a=r.queue,l=Ob.bind(null,Le,a);return a.dispatch=l,[r.memoizedState,l]},useDebugValue:oy,useDeferredValue:function(r,a){var l=Kn();return ly(l,r,a)},useTransition:function(){var r=ry(!1);return r=xb.bind(null,Le,r.queue,!0,!1),Kn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,l){var u=Le,m=Kn();if(Ze){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),yt===null)throw Error(i(349));(Qe&127)!==0||rb(u,a,l)}m.memoizedState=l;var g={value:l,getSnapshot:a};return m.queue=g,Eb(ab.bind(null,u,g,r),[r]),u.flags|=2048,fc(9,{destroy:void 0},sb.bind(null,u,g,l,a),null),l},useId:function(){var r=Kn(),a=yt.identifierPrefix;if(Ze){var l=Sr,u=Ir;l=(u&~(1<<32-zn(u)-1)).toString(32)+l,a="_"+a+"R_"+l,l=vm++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=SP++,a="_"+a+"r_"+l.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:uy,useFormState:pb,useActionState:pb,useOptimistic:function(r){var a=Kn();a.memoizedState=a.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=hy.bind(null,Le,!0,l),l.dispatch=a,[r,a]},useMemoCache:ty,useCacheRefresh:function(){return Kn().memoizedState=DP.bind(null,Le)},useEffectEvent:function(r){var a=Kn(),l={impl:r};return a.memoizedState=l,function(){if((ot&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},dy={readContext:xn,use:wm,useCallback:Ab,useContext:xn,useEffect:ay,useImperativeHandle:Sb,useInsertionEffect:Tb,useLayoutEffect:bb,useMemo:Cb,useReducer:Tm,useRef:vb,useState:function(){return Tm(hs)},useDebugValue:oy,useDeferredValue:function(r,a){var l=Kt();return Rb(l,ft.memoizedState,r,a)},useTransition:function(){var r=Tm(hs)[0],a=Kt().memoizedState;return[typeof r=="boolean"?r:dh(r),a]},useSyncExternalStore:ib,useId:kb,useHostTransitionStatus:uy,useFormState:gb,useActionState:gb,useOptimistic:function(r,a){var l=Kt();return cb(l,ft,r,a)},useMemoCache:ty,useCacheRefresh:Pb};dy.useEffectEvent=wb;var Ub={readContext:xn,use:wm,useCallback:Ab,useContext:xn,useEffect:ay,useImperativeHandle:Sb,useInsertionEffect:Tb,useLayoutEffect:bb,useMemo:Cb,useReducer:iy,useRef:vb,useState:function(){return iy(hs)},useDebugValue:oy,useDeferredValue:function(r,a){var l=Kt();return ft===null?ly(l,r,a):Rb(l,ft.memoizedState,r,a)},useTransition:function(){var r=iy(hs)[0],a=Kt().memoizedState;return[typeof r=="boolean"?r:dh(r),a]},useSyncExternalStore:ib,useId:kb,useHostTransitionStatus:uy,useFormState:yb,useActionState:yb,useOptimistic:function(r,a){var l=Kt();return ft!==null?cb(l,ft,r,a):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:ty,useCacheRefresh:Pb};Ub.useEffectEvent=wb;function fy(r,a,l,u){a=r.memoizedState,l=l(u,a),l=l==null?a:v({},a,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var my={enqueueSetState:function(r,a,l){r=r._reactInternals;var u=Ci(),m=fa(u);m.payload=a,l!=null&&(m.callback=l),a=ma(r,m,u),a!==null&&(li(a,r,u),lh(a,r,u))},enqueueReplaceState:function(r,a,l){r=r._reactInternals;var u=Ci(),m=fa(u);m.tag=1,m.payload=a,l!=null&&(m.callback=l),a=ma(r,m,u),a!==null&&(li(a,r,u),lh(a,r,u))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var l=Ci(),u=fa(l);u.tag=2,a!=null&&(u.callback=a),a=ma(r,u,l),a!==null&&(li(a,r,l),lh(a,r,l))}};function Bb(r,a,l,u,m,g,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,g,E):a.prototype&&a.prototype.isPureReactComponent?!eh(l,u)||!eh(m,g):!0}function Fb(r,a,l,u){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==r&&my.enqueueReplaceState(a,a.state,null)}function qo(r,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(r=r.defaultProps){l===a&&(l=v({},l));for(var m in r)l[m]===void 0&&(l[m]=r[m])}return l}function jb(r){im(r)}function zb(r){console.error(r)}function qb(r){im(r)}function Am(r,a){try{var l=r.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function Gb(r,a,l){try{var u=r.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function py(r,a,l){return l=fa(l),l.tag=3,l.payload={element:null},l.callback=function(){Am(r,a)},l}function Hb(r){return r=fa(r),r.tag=3,r}function $b(r,a,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var g=u.value;r.payload=function(){return m(g)},r.callback=function(){Gb(a,l,u)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){Gb(a,l,u),typeof m!="function"&&(Ea===null?Ea=new Set([this]):Ea.add(this));var b=u.stack;this.componentDidCatch(u.value,{componentStack:b!==null?b:""})})}function PP(r,a,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&sc(a,l,m,!0),l=bi.current,l!==null){switch(l.tag){case 31:case 13:return Gi===null?Um():l.alternate===null&&Bt===0&&(Bt=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===fm?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),Fy(r,u,m)),!1;case 22:return l.flags|=65536,u===fm?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),Fy(r,u,m)),!1}throw Error(i(435,l.tag))}return Fy(r,u,m),Um(),!1}if(Ze)return a=bi.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,u!==O_&&(r=Error(i(422),{cause:u}),ih(Fi(r,l)))):(u!==O_&&(a=Error(i(423),{cause:u}),ih(Fi(a,l))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,u=Fi(u,l),m=py(r.stateNode,u,m),H_(r,m),Bt!==4&&(Bt=2)),!1;var g=Error(i(520),{cause:u});if(g=Fi(g,l),Th===null?Th=[g]:Th.push(g),Bt!==4&&(Bt=2),a===null)return!0;u=Fi(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,r=m&-m,l.lanes|=r,r=py(l.stateNode,u,r),H_(l,r),!1;case 1:if(a=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ea===null||!Ea.has(g))))return l.flags|=65536,m&=-m,l.lanes|=m,m=Hb(m),$b(m,r,l,u),H_(l,m),!1}l=l.return}while(l!==null);return!1}var gy=Error(i(461)),en=!1;function Nn(r,a,l,u){a.child=r===null?YT(a,null,l,u):jo(a,r.child,l,u)}function Kb(r,a,l,u,m){l=l.render;var g=a.ref;if("ref"in u){var E={};for(var b in u)b!=="ref"&&(E[b]=u[b])}else E=u;return Lo(a),u=X_(r,a,l,E,g,m),b=J_(),r!==null&&!en?(Z_(r,a,m),ds(r,a,m)):(Ze&&b&&k_(a),a.flags|=1,Nn(r,a,u,m),a.child)}function Qb(r,a,l,u,m){if(r===null){var g=l.type;return typeof g=="function"&&!x_(g)&&g.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=g,Wb(r,a,g,u,m)):(r=om(l.type,null,u,a,a.mode,m),r.ref=a.ref,r.return=a,a.child=r)}if(g=r.child,!Iy(r,m)){var E=g.memoizedProps;if(l=l.compare,l=l!==null?l:eh,l(E,u)&&r.ref===a.ref)return ds(r,a,m)}return a.flags|=1,r=as(g,u),r.ref=a.ref,r.return=a,a.child=r}function Wb(r,a,l,u,m){if(r!==null){var g=r.memoizedProps;if(eh(g,u)&&r.ref===a.ref)if(en=!1,a.pendingProps=u=g,Iy(r,m))(r.flags&131072)!==0&&(en=!0);else return a.lanes=r.lanes,ds(r,a,m)}return _y(r,a,l,u,m)}function Yb(r,a,l,u){var m=u.children,g=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((a.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,r!==null){for(u=a.child=r.child,m=0;u!==null;)m=m|u.lanes|u.childLanes,u=u.sibling;u=m&~g}else u=0,a.child=null;return Xb(r,a,g,l,u)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&hm(a,g!==null?g.cachePool:null),g!==null?ZT(a,g):K_(),eb(a);else return u=a.lanes=536870912,Xb(r,a,g!==null?g.baseLanes|l:l,l,u)}else g!==null?(hm(a,g.cachePool),ZT(a,g),ga(),a.memoizedState=null):(r!==null&&hm(a,null),K_(),ga());return Nn(r,a,m,l),a.child}function ph(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Xb(r,a,l,u,m){var g=j_();return g=g===null?null:{parent:Jt._currentValue,pool:g},a.memoizedState={baseLanes:l,cachePool:g},r!==null&&hm(a,null),K_(),eb(a),r!==null&&sc(r,a,u,!0),a.childLanes=m,null}function Cm(r,a){return a=xm({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function Jb(r,a,l){return jo(a,r.child,null,l),r=Cm(a,a.pendingProps),r.flags|=2,Ii(a),a.memoizedState=null,r}function OP(r,a,l){var u=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(Ze){if(u.mode==="hidden")return r=Cm(a,u),a.lanes=536870912,ph(null,r);if(W_(a),(r=bt)?(r=uS(r,qi),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:la!==null?{id:Ir,overflow:Sr}:null,retryLane:536870912,hydrationErrors:null},l=MT(r),l.return=a,a.child=l,Rn=a,bt=null)):r=null,r===null)throw ua(a);return a.lanes=536870912,null}return Cm(a,u)}var g=r.memoizedState;if(g!==null){var E=g.dehydrated;if(W_(a),m)if(a.flags&256)a.flags&=-257,a=Jb(r,a,l);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(i(558));else if(en||sc(r,a,l,!1),m=(l&r.childLanes)!==0,en||m){if(u=yt,u!==null&&(E=Ks(u,l),E!==0&&E!==g.retryLane))throw g.retryLane=E,Po(r,E),li(u,r,E),gy;Um(),a=Jb(r,a,l)}else r=g.treeContext,bt=Hi(E.nextSibling),Rn=a,Ze=!0,ca=null,qi=!1,r!==null&&UT(a,r),a=Cm(a,u),a.flags|=4096;return a}return r=as(r.child,{mode:u.mode,children:u.children}),r.ref=a.ref,a.child=r,r.return=a,r}function Rm(r,a){var l=a.ref;if(l===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(a.flags|=4194816)}}function _y(r,a,l,u,m){return Lo(a),l=X_(r,a,l,u,void 0,m),u=J_(),r!==null&&!en?(Z_(r,a,m),ds(r,a,m)):(Ze&&u&&k_(a),a.flags|=1,Nn(r,a,l,m),a.child)}function Zb(r,a,l,u,m,g){return Lo(a),a.updateQueue=null,l=nb(a,u,l,m),tb(r),u=J_(),r!==null&&!en?(Z_(r,a,g),ds(r,a,g)):(Ze&&u&&k_(a),a.flags|=1,Nn(r,a,l,g),a.child)}function eI(r,a,l,u,m){if(Lo(a),a.stateNode===null){var g=tc,E=l.contextType;typeof E=="object"&&E!==null&&(g=xn(E)),g=new l(u,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=my,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=u,g.state=a.memoizedState,g.refs={},q_(a),E=l.contextType,g.context=typeof E=="object"&&E!==null?xn(E):tc,g.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(fy(a,l,E,u),g.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&my.enqueueReplaceState(g,g.state,null),uh(a,u,g,m),ch(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(r===null){g=a.stateNode;var b=a.memoizedProps,D=qo(l,b);g.props=D;var j=g.context,J=l.contextType;E=tc,typeof J=="object"&&J!==null&&(E=xn(J));var te=l.getDerivedStateFromProps;J=typeof te=="function"||typeof g.getSnapshotBeforeUpdate=="function",b=a.pendingProps!==b,J||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b||j!==E)&&Fb(a,g,u,E),da=!1;var G=a.memoizedState;g.state=G,uh(a,u,g,m),ch(),j=a.memoizedState,b||G!==j||da?(typeof te=="function"&&(fy(a,l,te,u),j=a.memoizedState),(D=da||Bb(a,l,D,u,G,j,E))?(J||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=j),g.props=u,g.state=j,g.context=E,u=D):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{g=a.stateNode,G_(r,a),E=a.memoizedProps,J=qo(l,E),g.props=J,te=a.pendingProps,G=g.context,j=l.contextType,D=tc,typeof j=="object"&&j!==null&&(D=xn(j)),b=l.getDerivedStateFromProps,(j=typeof b=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==te||G!==D)&&Fb(a,g,u,D),da=!1,G=a.memoizedState,g.state=G,uh(a,u,g,m),ch();var $=a.memoizedState;E!==te||G!==$||da||r!==null&&r.dependencies!==null&&cm(r.dependencies)?(typeof b=="function"&&(fy(a,l,b,u),$=a.memoizedState),(J=da||Bb(a,l,J,u,G,$,D)||r!==null&&r.dependencies!==null&&cm(r.dependencies))?(j||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,$,D),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,$,D)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===r.memoizedProps&&G===r.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&G===r.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=$),g.props=u,g.state=$,g.context=D,u=J):(typeof g.componentDidUpdate!="function"||E===r.memoizedProps&&G===r.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&G===r.memoizedState||(a.flags|=1024),u=!1)}return g=u,Rm(r,a),u=(a.flags&128)!==0,g||u?(g=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,r!==null&&u?(a.child=jo(a,r.child,null,m),a.child=jo(a,null,l,m)):Nn(r,a,l,m),a.memoizedState=g.state,r=a.child):r=ds(r,a,m),r}function tI(r,a,l,u){return Mo(),a.flags|=256,Nn(r,a,l,u),a.child}var yy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vy(r){return{baseLanes:r,cachePool:GT()}}function Ey(r,a,l){return r=r!==null?r.childLanes&~l:0,a&&(r|=Ai),r}function nI(r,a,l){var u=a.pendingProps,m=!1,g=(a.flags&128)!==0,E;if((E=g)||(E=r!==null&&r.memoizedState===null?!1:($t.current&2)!==0),E&&(m=!0,a.flags&=-129),E=(a.flags&32)!==0,a.flags&=-33,r===null){if(Ze){if(m?pa(a):ga(),(r=bt)?(r=uS(r,qi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:la!==null?{id:Ir,overflow:Sr}:null,retryLane:536870912,hydrationErrors:null},l=MT(r),l.return=a,a.child=l,Rn=a,bt=null)):r=null,r===null)throw ua(a);return nv(r)?a.lanes=32:a.lanes=536870912,null}var b=u.children;return u=u.fallback,m?(ga(),m=a.mode,b=xm({mode:"hidden",children:b},m),u=Oo(u,m,l,null),b.return=a,u.return=a,b.sibling=u,a.child=b,u=a.child,u.memoizedState=vy(l),u.childLanes=Ey(r,E,l),a.memoizedState=yy,ph(null,u)):(pa(a),wy(a,b))}var D=r.memoizedState;if(D!==null&&(b=D.dehydrated,b!==null)){if(g)a.flags&256?(pa(a),a.flags&=-257,a=Ty(r,a,l)):a.memoizedState!==null?(ga(),a.child=r.child,a.flags|=128,a=null):(ga(),b=u.fallback,m=a.mode,u=xm({mode:"visible",children:u.children},m),b=Oo(b,m,l,null),b.flags|=2,u.return=a,b.return=a,u.sibling=b,a.child=u,jo(a,r.child,null,l),u=a.child,u.memoizedState=vy(l),u.childLanes=Ey(r,E,l),a.memoizedState=yy,a=ph(null,u));else if(pa(a),nv(b)){if(E=b.nextSibling&&b.nextSibling.dataset,E)var j=E.dgst;E=j,u=Error(i(419)),u.stack="",u.digest=E,ih({value:u,source:null,stack:null}),a=Ty(r,a,l)}else if(en||sc(r,a,l,!1),E=(l&r.childLanes)!==0,en||E){if(E=yt,E!==null&&(u=Ks(E,l),u!==0&&u!==D.retryLane))throw D.retryLane=u,Po(r,u),li(E,r,u),gy;tv(b)||Um(),a=Ty(r,a,l)}else tv(b)?(a.flags|=192,a.child=r.child,a=null):(r=D.treeContext,bt=Hi(b.nextSibling),Rn=a,Ze=!0,ca=null,qi=!1,r!==null&&UT(a,r),a=wy(a,u.children),a.flags|=4096);return a}return m?(ga(),b=u.fallback,m=a.mode,D=r.child,j=D.sibling,u=as(D,{mode:"hidden",children:u.children}),u.subtreeFlags=D.subtreeFlags&65011712,j!==null?b=as(j,b):(b=Oo(b,m,l,null),b.flags|=2),b.return=a,u.return=a,u.sibling=b,a.child=u,ph(null,u),u=a.child,b=r.child.memoizedState,b===null?b=vy(l):(m=b.cachePool,m!==null?(D=Jt._currentValue,m=m.parent!==D?{parent:D,pool:D}:m):m=GT(),b={baseLanes:b.baseLanes|l,cachePool:m}),u.memoizedState=b,u.childLanes=Ey(r,E,l),a.memoizedState=yy,ph(r.child,u)):(pa(a),l=r.child,r=l.sibling,l=as(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,r!==null&&(E=a.deletions,E===null?(a.deletions=[r],a.flags|=16):E.push(r)),a.child=l,a.memoizedState=null,l)}function wy(r,a){return a=xm({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function xm(r,a){return r=Ti(22,r,null,a),r.lanes=0,r}function Ty(r,a,l){return jo(a,r.child,null,l),r=wy(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function iI(r,a,l){r.lanes|=a;var u=r.alternate;u!==null&&(u.lanes|=a),L_(r.return,a,l)}function by(r,a,l,u,m,g){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m,treeForkCount:g}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=u,E.tail=l,E.tailMode=m,E.treeForkCount=g)}function rI(r,a,l){var u=a.pendingProps,m=u.revealOrder,g=u.tail;u=u.children;var E=$t.current,b=(E&2)!==0;if(b?(E=E&1|2,a.flags|=128):E&=1,ne($t,E),Nn(r,a,u,l),u=Ze?nh:0,!b&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&iI(r,l,a);else if(r.tag===19)iI(r,l,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(l=a.child,m=null;l!==null;)r=l.alternate,r!==null&&_m(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=a.child,a.child=null):(m=l.sibling,l.sibling=null),by(a,!1,m,l,g,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,m=a.child,a.child=null;m!==null;){if(r=m.alternate,r!==null&&_m(r)===null){a.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}by(a,!0,l,null,g,u);break;case"together":by(a,!1,null,null,void 0,u);break;default:a.memoizedState=null}return a.child}function ds(r,a,l){if(r!==null&&(a.dependencies=r.dependencies),va|=a.lanes,(l&a.childLanes)===0)if(r!==null){if(sc(r,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,l=as(r,r.pendingProps),a.child=l,l.return=a;r.sibling!==null;)r=r.sibling,l=l.sibling=as(r,r.pendingProps),l.return=a;l.sibling=null}return a.child}function Iy(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&cm(r)))}function MP(r,a,l){switch(a.tag){case 3:_t(a,a.stateNode.containerInfo),ha(a,Jt,r.memoizedState.cache),Mo();break;case 27:case 5:hn(a);break;case 4:_t(a,a.stateNode.containerInfo);break;case 10:ha(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,W_(a),null;break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(pa(a),a.flags|=128,null):(l&a.child.childLanes)!==0?nI(r,a,l):(pa(a),r=ds(r,a,l),r!==null?r.sibling:null);pa(a);break;case 19:var m=(r.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(sc(r,a,l,!1),u=(l&a.childLanes)!==0),m){if(u)return rI(r,a,l);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ne($t,$t.current),u)break;return null;case 22:return a.lanes=0,Yb(r,a,l,a.pendingProps);case 24:ha(a,Jt,r.memoizedState.cache)}return ds(r,a,l)}function sI(r,a,l){if(r!==null)if(r.memoizedProps!==a.pendingProps)en=!0;else{if(!Iy(r,l)&&(a.flags&128)===0)return en=!1,MP(r,a,l);en=(r.flags&131072)!==0}else en=!1,Ze&&(a.flags&1048576)!==0&&LT(a,nh,a.index);switch(a.lanes=0,a.tag){case 16:e:{var u=a.pendingProps;if(r=Bo(a.elementType),a.type=r,typeof r=="function")x_(r)?(u=qo(r,u),a.tag=1,a=eI(null,a,r,u,l)):(a.tag=0,a=_y(null,a,r,u,l));else{if(r!=null){var m=r.$$typeof;if(m===de){a.tag=11,a=Kb(null,a,r,u,l);break e}else if(m===k){a.tag=14,a=Qb(null,a,r,u,l);break e}}throw a=se(r)||r,Error(i(306,a,""))}}return a;case 0:return _y(r,a,a.type,a.pendingProps,l);case 1:return u=a.type,m=qo(u,a.pendingProps),eI(r,a,u,m,l);case 3:e:{if(_t(a,a.stateNode.containerInfo),r===null)throw Error(i(387));u=a.pendingProps;var g=a.memoizedState;m=g.element,G_(r,a),uh(a,u,null,l);var E=a.memoizedState;if(u=E.cache,ha(a,Jt,u),u!==g.cache&&U_(a,[Jt],l,!0),ch(),u=E.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:E.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=tI(r,a,u,l);break e}else if(u!==m){m=Fi(Error(i(424)),a),ih(m),a=tI(r,a,u,l);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(bt=Hi(r.firstChild),Rn=a,Ze=!0,ca=null,qi=!0,l=YT(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Mo(),u===m){a=ds(r,a,l);break e}Nn(r,a,u,l)}a=a.child}return a;case 26:return Rm(r,a),r===null?(l=gS(a.type,null,a.pendingProps,null))?a.memoizedState=l:Ze||(l=a.type,r=a.pendingProps,u=Hm(_e.current).createElement(l),u[Vt]=a,u[Cn]=r,Dn(u,l,r),Ht(u),a.stateNode=u):a.memoizedState=gS(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return hn(a),r===null&&Ze&&(u=a.stateNode=fS(a.type,a.pendingProps,_e.current),Rn=a,qi=!0,m=bt,Ia(a.type)?(iv=m,bt=Hi(u.firstChild)):bt=m),Nn(r,a,a.pendingProps.children,l),Rm(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&Ze&&((m=u=bt)&&(u=hO(u,a.type,a.pendingProps,qi),u!==null?(a.stateNode=u,Rn=a,bt=Hi(u.firstChild),qi=!1,m=!0):m=!1),m||ua(a)),hn(a),m=a.type,g=a.pendingProps,E=r!==null?r.memoizedProps:null,u=g.children,Jy(m,g)?u=null:E!==null&&Jy(m,E)&&(a.flags|=32),a.memoizedState!==null&&(m=X_(r,a,AP,null,null,l),Nh._currentValue=m),Rm(r,a),Nn(r,a,u,l),a.child;case 6:return r===null&&Ze&&((r=l=bt)&&(l=dO(l,a.pendingProps,qi),l!==null?(a.stateNode=l,Rn=a,bt=null,r=!0):r=!1),r||ua(a)),null;case 13:return nI(r,a,l);case 4:return _t(a,a.stateNode.containerInfo),u=a.pendingProps,r===null?a.child=jo(a,null,u,l):Nn(r,a,u,l),a.child;case 11:return Kb(r,a,a.type,a.pendingProps,l);case 7:return Nn(r,a,a.pendingProps,l),a.child;case 8:return Nn(r,a,a.pendingProps.children,l),a.child;case 12:return Nn(r,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,ha(a,a.type,u.value),Nn(r,a,u.children,l),a.child;case 9:return m=a.type._context,u=a.pendingProps.children,Lo(a),m=xn(m),u=u(m),a.flags|=1,Nn(r,a,u,l),a.child;case 14:return Qb(r,a,a.type,a.pendingProps,l);case 15:return Wb(r,a,a.type,a.pendingProps,l);case 19:return rI(r,a,l);case 31:return OP(r,a,l);case 22:return Yb(r,a,l,a.pendingProps);case 24:return Lo(a),u=xn(Jt),r===null?(m=j_(),m===null&&(m=yt,g=B_(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=l),m=g),a.memoizedState={parent:u,cache:m},q_(a),ha(a,Jt,m)):((r.lanes&l)!==0&&(G_(r,a),uh(a,null,null,l),ch()),m=r.memoizedState,g=a.memoizedState,m.parent!==u?(m={parent:u,cache:u},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),ha(a,Jt,u)):(u=g.cache,ha(a,Jt,u),u!==m.cache&&U_(a,[Jt],l,!0))),Nn(r,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function fs(r){r.flags|=4}function Sy(r,a,l,u,m){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(kI())r.flags|=8192;else throw Fo=fm,z_}else r.flags&=-16777217}function aI(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!wS(a))if(kI())r.flags|=8192;else throw Fo=fm,z_}function Nm(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?Vu():536870912,r.lanes|=a,_c|=a)}function gh(r,a){if(!Ze)switch(r.tailMode){case"hidden":a=r.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function It(r){var a=r.alternate!==null&&r.alternate.child===r.child,l=0,u=0;if(a)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=u,r.childLanes=l,a}function VP(r,a,l){var u=a.pendingProps;switch(P_(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(a),null;case 1:return It(a),null;case 3:return l=a.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),cs(Jt),tt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(rc(a)?fs(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,M_())),It(a),null;case 26:var m=a.type,g=a.memoizedState;return r===null?(fs(a),g!==null?(It(a),aI(a,g)):(It(a),Sy(a,m,null,u,l))):g?g!==r.memoizedState?(fs(a),It(a),aI(a,g)):(It(a),a.flags&=-16777217):(r=r.memoizedProps,r!==u&&fs(a),It(a),Sy(a,m,r,u,l)),null;case 27:if(tr(a),l=_e.current,m=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==u&&fs(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return It(a),null}r=ae.current,rc(a)?BT(a):(r=fS(m,u,l),a.stateNode=r,fs(a))}return It(a),null;case 5:if(tr(a),m=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==u&&fs(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return It(a),null}if(g=ae.current,rc(a))BT(a);else{var E=Hm(_e.current);switch(g){case 1:g=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=E.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof u.is=="string"?E.createElement("select",{is:u.is}):E.createElement("select"),u.multiple?g.multiple=!0:u.size&&(g.size=u.size);break;default:g=typeof u.is=="string"?E.createElement(m,{is:u.is}):E.createElement(m)}}g[Vt]=a,g[Cn]=u;e:for(E=a.child;E!==null;){if(E.tag===5||E.tag===6)g.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===a)break e;for(;E.sibling===null;){if(E.return===null||E.return===a)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}a.stateNode=g;e:switch(Dn(g,m,u),m){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&fs(a)}}return It(a),Sy(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,l),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==u&&fs(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(i(166));if(r=_e.current,rc(a)){if(r=a.stateNode,l=a.memoizedProps,u=null,m=Rn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}r[Vt]=a,r=!!(r.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||nS(r.nodeValue,l)),r||ua(a,!0)}else r=Hm(r).createTextNode(u),r[Vt]=a,a.stateNode=r}return It(a),null;case 31:if(l=a.memoizedState,r===null||r.memoizedState!==null){if(u=rc(a),l!==null){if(r===null){if(!u)throw Error(i(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Vt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;It(a),r=!1}else l=M_(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return a.flags&256?(Ii(a),a):(Ii(a),null);if((a.flags&128)!==0)throw Error(i(558))}return It(a),null;case 13:if(u=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=rc(a),u!==null&&u.dehydrated!==null){if(r===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Vt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;It(a),m=!1}else m=M_(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Ii(a),a):(Ii(a),null)}return Ii(a),(a.flags&128)!==0?(a.lanes=l,a):(l=u!==null,r=r!==null&&r.memoizedState!==null,l&&(u=a.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool),g=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==m&&(u.flags|=2048)),l!==r&&l&&(a.child.flags|=8192),Nm(a,a.updateQueue),It(a),null);case 4:return tt(),r===null&&Ky(a.stateNode.containerInfo),It(a),null;case 10:return cs(a.type),It(a),null;case 19:if(W($t),u=a.memoizedState,u===null)return It(a),null;if(m=(a.flags&128)!==0,g=u.rendering,g===null)if(m)gh(u,!1);else{if(Bt!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(g=_m(r),g!==null){for(a.flags|=128,gh(u,!1),r=g.updateQueue,a.updateQueue=r,Nm(a,r),a.subtreeFlags=0,r=l,l=a.child;l!==null;)OT(l,r),l=l.sibling;return ne($t,$t.current&1|2),Ze&&os(a,u.treeForkCount),a.child}r=r.sibling}u.tail!==null&&Sn()>Mm&&(a.flags|=128,m=!0,gh(u,!1),a.lanes=4194304)}else{if(!m)if(r=_m(g),r!==null){if(a.flags|=128,m=!0,r=r.updateQueue,a.updateQueue=r,Nm(a,r),gh(u,!0),u.tail===null&&u.tailMode==="hidden"&&!g.alternate&&!Ze)return It(a),null}else 2*Sn()-u.renderingStartTime>Mm&&l!==536870912&&(a.flags|=128,m=!0,gh(u,!1),a.lanes=4194304);u.isBackwards?(g.sibling=a.child,a.child=g):(r=u.last,r!==null?r.sibling=g:a.child=g,u.last=g)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=Sn(),r.sibling=null,l=$t.current,ne($t,m?l&1|2:l&1),Ze&&os(a,u.treeForkCount),r):(It(a),null);case 22:case 23:return Ii(a),Q_(),u=a.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(It(a),a.subtreeFlags&6&&(a.flags|=8192)):It(a),l=a.updateQueue,l!==null&&Nm(a,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),r!==null&&W(Uo),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),cs(Jt),It(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function LP(r,a){switch(P_(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return cs(Jt),tt(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return tr(a),null;case 31:if(a.memoizedState!==null){if(Ii(a),a.alternate===null)throw Error(i(340));Mo()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(Ii(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Mo()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return W($t),null;case 4:return tt(),null;case 10:return cs(a.type),null;case 22:case 23:return Ii(a),Q_(),r!==null&&W(Uo),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return cs(Jt),null;case 25:return null;default:return null}}function oI(r,a){switch(P_(a),a.tag){case 3:cs(Jt),tt();break;case 26:case 27:case 5:tr(a);break;case 4:tt();break;case 31:a.memoizedState!==null&&Ii(a);break;case 13:Ii(a);break;case 19:W($t);break;case 10:cs(a.type);break;case 22:case 23:Ii(a),Q_(),r!==null&&W(Uo);break;case 24:cs(Jt)}}function _h(r,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&r)===r){u=void 0;var g=l.create,E=l.inst;u=g(),E.destroy=u}l=l.next}while(l!==m)}}catch(b){ht(a,a.return,b)}}function _a(r,a,l){try{var u=a.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var g=m.next;u=g;do{if((u.tag&r)===r){var E=u.inst,b=E.destroy;if(b!==void 0){E.destroy=void 0,m=a;var D=l,j=b;try{j()}catch(J){ht(m,D,J)}}}u=u.next}while(u!==g)}}catch(J){ht(a,a.return,J)}}function lI(r){var a=r.updateQueue;if(a!==null){var l=r.stateNode;try{JT(a,l)}catch(u){ht(r,r.return,u)}}}function cI(r,a,l){l.props=qo(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(u){ht(r,a,u)}}function yh(r,a){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof l=="function"?r.refCleanup=l(u):l.current=u}}catch(m){ht(r,a,m)}}function Ar(r,a){var l=r.ref,u=r.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){ht(r,a,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){ht(r,a,m)}else l.current=null}function uI(r){var a=r.type,l=r.memoizedProps,u=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){ht(r,r.return,m)}}function Ay(r,a,l){try{var u=r.stateNode;sO(u,r.type,l,a),u[Cn]=a}catch(m){ht(r,r.return,m)}}function hI(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ia(r.type)||r.tag===4}function Cy(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||hI(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ia(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ry(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(r),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=fn));else if(u!==4&&(u===27&&Ia(r.type)&&(l=r.stateNode,a=null),r=r.child,r!==null))for(Ry(r,a,l),r=r.sibling;r!==null;)Ry(r,a,l),r=r.sibling}function Dm(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?l.insertBefore(r,a):l.appendChild(r);else if(u!==4&&(u===27&&Ia(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(Dm(r,a,l),r=r.sibling;r!==null;)Dm(r,a,l),r=r.sibling}function dI(r){var a=r.stateNode,l=r.memoizedProps;try{for(var u=r.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Dn(a,u,l),a[Vt]=r,a[Cn]=l}catch(g){ht(r,r.return,g)}}var ms=!1,tn=!1,xy=!1,fI=typeof WeakSet=="function"?WeakSet:Set,gn=null;function UP(r,a){if(r=r.containerInfo,Yy=Jm,r=ST(r),T_(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var E=0,b=-1,D=-1,j=0,J=0,te=r,G=null;t:for(;;){for(var $;te!==l||m!==0&&te.nodeType!==3||(b=E+m),te!==g||u!==0&&te.nodeType!==3||(D=E+u),te.nodeType===3&&(E+=te.nodeValue.length),($=te.firstChild)!==null;)G=te,te=$;for(;;){if(te===r)break t;if(G===l&&++j===m&&(b=E),G===g&&++J===u&&(D=E),($=te.nextSibling)!==null)break;te=G,G=te.parentNode}te=$}l=b===-1||D===-1?null:{start:b,end:D}}else l=null}l=l||{start:0,end:0}}else l=null;for(Xy={focusedElem:r,selectionRange:l},Jm=!1,gn=a;gn!==null;)if(a=gn,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,gn=r;else for(;gn!==null;){switch(a=gn,g=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)m=r[l],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&g!==null){r=void 0,l=a,m=g.memoizedProps,g=g.memoizedState,u=l.stateNode;try{var Te=qo(l.type,m);r=u.getSnapshotBeforeUpdate(Te,g),u.__reactInternalSnapshotBeforeUpdate=r}catch(Ne){ht(l,l.return,Ne)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,l=r.nodeType,l===9)ev(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ev(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,gn=r;break}gn=a.return}}function mI(r,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:gs(r,l),u&4&&_h(5,l);break;case 1:if(gs(r,l),u&4)if(r=l.stateNode,a===null)try{r.componentDidMount()}catch(E){ht(l,l.return,E)}else{var m=qo(l.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(m,a,r.__reactInternalSnapshotBeforeUpdate)}catch(E){ht(l,l.return,E)}}u&64&&lI(l),u&512&&yh(l,l.return);break;case 3:if(gs(r,l),u&64&&(r=l.updateQueue,r!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{JT(r,a)}catch(E){ht(l,l.return,E)}}break;case 27:a===null&&u&4&&dI(l);case 26:case 5:gs(r,l),a===null&&u&4&&uI(l),u&512&&yh(l,l.return);break;case 12:gs(r,l);break;case 31:gs(r,l),u&4&&_I(r,l);break;case 13:gs(r,l),u&4&&yI(r,l),u&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=KP.bind(null,l),fO(r,l))));break;case 22:if(u=l.memoizedState!==null||ms,!u){a=a!==null&&a.memoizedState!==null||tn,m=ms;var g=tn;ms=u,(tn=a)&&!g?_s(r,l,(l.subtreeFlags&8772)!==0):gs(r,l),ms=m,tn=g}break;case 30:break;default:gs(r,l)}}function pI(r){var a=r.alternate;a!==null&&(r.alternate=null,pI(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&wo(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var At=null,ri=!1;function ps(r,a,l){for(l=l.child;l!==null;)gI(r,a,l),l=l.sibling}function gI(r,a,l){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(zs,l)}catch{}switch(l.tag){case 26:tn||Ar(l,a),ps(r,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:tn||Ar(l,a);var u=At,m=ri;Ia(l.type)&&(At=l.stateNode,ri=!1),ps(r,a,l),Ch(l.stateNode),At=u,ri=m;break;case 5:tn||Ar(l,a);case 6:if(u=At,m=ri,At=null,ps(r,a,l),At=u,ri=m,At!==null)if(ri)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(l.stateNode)}catch(g){ht(l,a,g)}else try{At.removeChild(l.stateNode)}catch(g){ht(l,a,g)}break;case 18:At!==null&&(ri?(r=At,lS(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Sc(r)):lS(At,l.stateNode));break;case 4:u=At,m=ri,At=l.stateNode.containerInfo,ri=!0,ps(r,a,l),At=u,ri=m;break;case 0:case 11:case 14:case 15:_a(2,l,a),tn||_a(4,l,a),ps(r,a,l);break;case 1:tn||(Ar(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&cI(l,a,u)),ps(r,a,l);break;case 21:ps(r,a,l);break;case 22:tn=(u=tn)||l.memoizedState!==null,ps(r,a,l),tn=u;break;default:ps(r,a,l)}}function _I(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Sc(r)}catch(l){ht(a,a.return,l)}}}function yI(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Sc(r)}catch(l){ht(a,a.return,l)}}function BP(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new fI),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new fI),a;default:throw Error(i(435,r.tag))}}function km(r,a){var l=BP(r);a.forEach(function(u){if(!l.has(u)){l.add(u);var m=QP.bind(null,r,u);u.then(m,m)}})}function si(r,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],g=r,E=a,b=E;e:for(;b!==null;){switch(b.tag){case 27:if(Ia(b.type)){At=b.stateNode,ri=!1;break e}break;case 5:At=b.stateNode,ri=!1;break e;case 3:case 4:At=b.stateNode.containerInfo,ri=!0;break e}b=b.return}if(At===null)throw Error(i(160));gI(g,E,m),At=null,ri=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)vI(a,r),a=a.sibling}var or=null;function vI(r,a){var l=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:si(a,r),ai(r),u&4&&(_a(3,r,r.return),_h(3,r),_a(5,r,r.return));break;case 1:si(a,r),ai(r),u&512&&(tn||l===null||Ar(l,l.return)),u&64&&ms&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=or;if(si(a,r),ai(r),u&512&&(tn||l===null||Ar(l,l.return)),u&4){var g=l!==null?l.memoizedState:null;if(u=r.memoizedState,l===null)if(u===null)if(r.stateNode===null){e:{u=r.type,l=r.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Jr]||g[Vt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(u),m.head.insertBefore(g,m.querySelector("head > title"))),Dn(g,u,l),g[Vt]=r,Ht(g),u=g;break e;case"link":var E=vS("link","href",m).get(u+(l.href||""));if(E){for(var b=0;b<E.length;b++)if(g=E[b],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(b,1);break t}}g=m.createElement(u),Dn(g,u,l),m.head.appendChild(g);break;case"meta":if(E=vS("meta","content",m).get(u+(l.content||""))){for(b=0;b<E.length;b++)if(g=E[b],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(b,1);break t}}g=m.createElement(u),Dn(g,u,l),m.head.appendChild(g);break;default:throw Error(i(468,u))}g[Vt]=r,Ht(g),u=g}r.stateNode=u}else ES(m,r.type,r.stateNode);else r.stateNode=yS(m,u,r.memoizedProps);else g!==u?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,u===null?ES(m,r.type,r.stateNode):yS(m,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Ay(r,r.memoizedProps,l.memoizedProps)}break;case 27:si(a,r),ai(r),u&512&&(tn||l===null||Ar(l,l.return)),l!==null&&u&4&&Ay(r,r.memoizedProps,l.memoizedProps);break;case 5:if(si(a,r),ai(r),u&512&&(tn||l===null||Ar(l,l.return)),r.flags&32){m=r.stateNode;try{Ui(m,"")}catch(Te){ht(r,r.return,Te)}}u&4&&r.stateNode!=null&&(m=r.memoizedProps,Ay(r,m,l!==null?l.memoizedProps:m)),u&1024&&(xy=!0);break;case 6:if(si(a,r),ai(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,l=r.stateNode;try{l.nodeValue=u}catch(Te){ht(r,r.return,Te)}}break;case 3:if(Qm=null,m=or,or=$m(a.containerInfo),si(a,r),or=m,ai(r),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Sc(a.containerInfo)}catch(Te){ht(r,r.return,Te)}xy&&(xy=!1,EI(r));break;case 4:u=or,or=$m(r.stateNode.containerInfo),si(a,r),ai(r),or=u;break;case 12:si(a,r),ai(r);break;case 31:si(a,r),ai(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,km(r,u)));break;case 13:si(a,r),ai(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Om=Sn()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,km(r,u)));break;case 22:m=r.memoizedState!==null;var D=l!==null&&l.memoizedState!==null,j=ms,J=tn;if(ms=j||m,tn=J||D,si(a,r),tn=J,ms=j,ai(r),u&8192)e:for(a=r.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(l===null||D||ms||tn||Go(r)),l=null,a=r;;){if(a.tag===5||a.tag===26){if(l===null){D=l=a;try{if(g=D.stateNode,m)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{b=D.stateNode;var te=D.memoizedProps.style,G=te!=null&&te.hasOwnProperty("display")?te.display:null;b.style.display=G==null||typeof G=="boolean"?"":(""+G).trim()}}catch(Te){ht(D,D.return,Te)}}}else if(a.tag===6){if(l===null){D=a;try{D.stateNode.nodeValue=m?"":D.memoizedProps}catch(Te){ht(D,D.return,Te)}}}else if(a.tag===18){if(l===null){D=a;try{var $=D.stateNode;m?cS($,!0):cS(D.stateNode,!1)}catch(Te){ht(D,D.return,Te)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=r.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,km(r,l))));break;case 19:si(a,r),ai(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,km(r,u)));break;case 30:break;case 21:break;default:si(a,r),ai(r)}}function ai(r){var a=r.flags;if(a&2){try{for(var l,u=r.return;u!==null;){if(hI(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,g=Cy(r);Dm(r,g,m);break;case 5:var E=l.stateNode;l.flags&32&&(Ui(E,""),l.flags&=-33);var b=Cy(r);Dm(r,b,E);break;case 3:case 4:var D=l.stateNode.containerInfo,j=Cy(r);Ry(r,j,D);break;default:throw Error(i(161))}}catch(J){ht(r,r.return,J)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function EI(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;EI(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function gs(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)mI(r,a.alternate,a),a=a.sibling}function Go(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:_a(4,a,a.return),Go(a);break;case 1:Ar(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&cI(a,a.return,l),Go(a);break;case 27:Ch(a.stateNode);case 26:case 5:Ar(a,a.return),Go(a);break;case 22:a.memoizedState===null&&Go(a);break;case 30:Go(a);break;default:Go(a)}r=r.sibling}}function _s(r,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,m=r,g=a,E=g.flags;switch(g.tag){case 0:case 11:case 15:_s(m,g,l),_h(4,g);break;case 1:if(_s(m,g,l),u=g,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(j){ht(u,u.return,j)}if(u=g,m=u.updateQueue,m!==null){var b=u.stateNode;try{var D=m.shared.hiddenCallbacks;if(D!==null)for(m.shared.hiddenCallbacks=null,m=0;m<D.length;m++)XT(D[m],b)}catch(j){ht(u,u.return,j)}}l&&E&64&&lI(g),yh(g,g.return);break;case 27:dI(g);case 26:case 5:_s(m,g,l),l&&u===null&&E&4&&uI(g),yh(g,g.return);break;case 12:_s(m,g,l);break;case 31:_s(m,g,l),l&&E&4&&_I(m,g);break;case 13:_s(m,g,l),l&&E&4&&yI(m,g);break;case 22:g.memoizedState===null&&_s(m,g,l),yh(g,g.return);break;case 30:break;default:_s(m,g,l)}a=a.sibling}}function Ny(r,a){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&rh(l))}function Dy(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&rh(r))}function lr(r,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)wI(r,a,l,u),a=a.sibling}function wI(r,a,l,u){var m=a.flags;switch(a.tag){case 0:case 11:case 15:lr(r,a,l,u),m&2048&&_h(9,a);break;case 1:lr(r,a,l,u);break;case 3:lr(r,a,l,u),m&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&rh(r)));break;case 12:if(m&2048){lr(r,a,l,u),r=a.stateNode;try{var g=a.memoizedProps,E=g.id,b=g.onPostCommit;typeof b=="function"&&b(E,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(D){ht(a,a.return,D)}}else lr(r,a,l,u);break;case 31:lr(r,a,l,u);break;case 13:lr(r,a,l,u);break;case 23:break;case 22:g=a.stateNode,E=a.alternate,a.memoizedState!==null?g._visibility&2?lr(r,a,l,u):vh(r,a):g._visibility&2?lr(r,a,l,u):(g._visibility|=2,mc(r,a,l,u,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Ny(E,a);break;case 24:lr(r,a,l,u),m&2048&&Dy(a.alternate,a);break;default:lr(r,a,l,u)}}function mc(r,a,l,u,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var g=r,E=a,b=l,D=u,j=E.flags;switch(E.tag){case 0:case 11:case 15:mc(g,E,b,D,m),_h(8,E);break;case 23:break;case 22:var J=E.stateNode;E.memoizedState!==null?J._visibility&2?mc(g,E,b,D,m):vh(g,E):(J._visibility|=2,mc(g,E,b,D,m)),m&&j&2048&&Ny(E.alternate,E);break;case 24:mc(g,E,b,D,m),m&&j&2048&&Dy(E.alternate,E);break;default:mc(g,E,b,D,m)}a=a.sibling}}function vh(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=r,u=a,m=u.flags;switch(u.tag){case 22:vh(l,u),m&2048&&Ny(u.alternate,u);break;case 24:vh(l,u),m&2048&&Dy(u.alternate,u);break;default:vh(l,u)}a=a.sibling}}var Eh=8192;function pc(r,a,l){if(r.subtreeFlags&Eh)for(r=r.child;r!==null;)TI(r,a,l),r=r.sibling}function TI(r,a,l){switch(r.tag){case 26:pc(r,a,l),r.flags&Eh&&r.memoizedState!==null&&SO(l,or,r.memoizedState,r.memoizedProps);break;case 5:pc(r,a,l);break;case 3:case 4:var u=or;or=$m(r.stateNode.containerInfo),pc(r,a,l),or=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=Eh,Eh=16777216,pc(r,a,l),Eh=u):pc(r,a,l));break;default:pc(r,a,l)}}function bI(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function wh(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];gn=u,SI(u,r)}bI(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)II(r),r=r.sibling}function II(r){switch(r.tag){case 0:case 11:case 15:wh(r),r.flags&2048&&_a(9,r,r.return);break;case 3:wh(r);break;case 12:wh(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,Pm(r)):wh(r);break;default:wh(r)}}function Pm(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];gn=u,SI(u,r)}bI(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:_a(8,a,a.return),Pm(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Pm(a));break;default:Pm(a)}r=r.sibling}}function SI(r,a){for(;gn!==null;){var l=gn;switch(l.tag){case 0:case 11:case 15:_a(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:rh(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,gn=u;else e:for(l=r;gn!==null;){u=gn;var m=u.sibling,g=u.return;if(pI(u),u===l){gn=null;break e}if(m!==null){m.return=g,gn=m;break e}gn=g}}}var FP={getCacheForType:function(r){var a=xn(Jt),l=a.data.get(r);return l===void 0&&(l=r(),a.data.set(r,l)),l},cacheSignal:function(){return xn(Jt).controller.signal}},jP=typeof WeakMap=="function"?WeakMap:Map,ot=0,yt=null,$e=null,Qe=0,ut=0,Si=null,ya=!1,gc=!1,ky=!1,ys=0,Bt=0,va=0,Ho=0,Py=0,Ai=0,_c=0,Th=null,oi=null,Oy=!1,Om=0,AI=0,Mm=1/0,Vm=null,Ea=null,an=0,wa=null,yc=null,vs=0,My=0,Vy=null,CI=null,bh=0,Ly=null;function Ci(){return(ot&2)!==0&&Qe!==0?Qe&-Qe:H.T!==null?qy():Xr()}function RI(){if(Ai===0)if((Qe&536870912)===0||Ze){var r=gr;gr<<=1,(gr&3932160)===0&&(gr=262144),Ai=r}else Ai=536870912;return r=bi.current,r!==null&&(r.flags|=32),Ai}function li(r,a,l){(r===yt&&(ut===2||ut===9)||r.cancelPendingCommit!==null)&&(vc(r,0),Ta(r,Qe,Ai,!1)),Hs(r,l),((ot&2)===0||r!==yt)&&(r===yt&&((ot&2)===0&&(Ho|=l),Bt===4&&Ta(r,Qe,Ai,!1)),Cr(r))}function xI(r,a,l){if((ot&6)!==0)throw Error(i(327));var u=!l&&(a&127)===0&&(a&r.expiredLanes)===0||Gs(r,a),m=u?GP(r,a):By(r,a,!0),g=u;do{if(m===0){gc&&!u&&Ta(r,a,0,!1);break}else{if(l=r.current.alternate,g&&!zP(l)){m=By(r,a,!1),g=!1;continue}if(m===2){if(g=a,r.errorRecoveryDisabledLanes&g)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){a=E;e:{var b=r;m=Th;var D=b.current.memoizedState.isDehydrated;if(D&&(vc(b,E).flags|=256),E=By(b,E,!1),E!==2){if(ky&&!D){b.errorRecoveryDisabledLanes|=g,Ho|=g,m=4;break e}g=oi,oi=m,g!==null&&(oi===null?oi=g:oi.push.apply(oi,g))}m=E}if(g=!1,m!==2)continue}}if(m===1){vc(r,0),Ta(r,a,0,!0);break}e:{switch(u=r,g=m,g){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ta(u,a,Ai,!ya);break e;case 2:oi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Om+300-Sn(),10<m)){if(Ta(u,a,Ai,!ya),Vi(u,0,!0)!==0)break e;vs=a,u.timeoutHandle=aS(NI.bind(null,u,l,oi,Vm,Oy,a,Ai,Ho,_c,ya,g,"Throttled",-0,0),m);break e}NI(u,l,oi,Vm,Oy,a,Ai,Ho,_c,ya,g,null,-0,0)}}break}while(!0);Cr(r)}function NI(r,a,l,u,m,g,E,b,D,j,J,te,G,$){if(r.timeoutHandle=-1,te=a.subtreeFlags,te&8192||(te&16785408)===16785408){te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fn},TI(a,g,te);var Te=(g&62914560)===g?Om-Sn():(g&4194048)===g?AI-Sn():0;if(Te=AO(te,Te),Te!==null){vs=g,r.cancelPendingCommit=Te(UI.bind(null,r,a,g,l,u,m,E,b,D,J,te,null,G,$)),Ta(r,g,E,!j);return}}UI(r,a,g,l,u,m,E,b,D)}function zP(r){for(var a=r;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],g=m.getSnapshot;m=m.value;try{if(!wi(g(),m))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ta(r,a,l,u){a&=~Py,a&=~Ho,r.suspendedLanes|=a,r.pingedLanes&=~a,u&&(r.warmLanes|=a),u=r.expirationTimes;for(var m=a;0<m;){var g=31-zn(m),E=1<<g;u[g]=-1,m&=~E}l!==0&&Lu(r,l,a)}function Lm(){return(ot&6)===0?(Ih(0),!1):!0}function Uy(){if($e!==null){if(ut===0)var r=$e.return;else r=$e,ls=Vo=null,ey(r),cc=null,ah=0,r=$e;for(;r!==null;)oI(r.alternate,r),r=r.return;$e=null}}function vc(r,a){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,lO(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),vs=0,Uy(),yt=r,$e=l=as(r.current,null),Qe=a,ut=0,Si=null,ya=!1,gc=Gs(r,a),ky=!1,_c=Ai=Py=Ho=va=Bt=0,oi=Th=null,Oy=!1,(a&8)!==0&&(a|=a&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=a;0<u;){var m=31-zn(u),g=1<<m;a|=r[m],u&=~g}return ys=a,rm(),l}function DI(r,a){Le=null,H.H=mh,a===lc||a===dm?(a=KT(),ut=3):a===z_?(a=KT(),ut=4):ut=a===gy?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Si=a,$e===null&&(Bt=1,Am(r,Fi(a,r.current)))}function kI(){var r=bi.current;return r===null?!0:(Qe&4194048)===Qe?Gi===null:(Qe&62914560)===Qe||(Qe&536870912)!==0?r===Gi:!1}function PI(){var r=H.H;return H.H=mh,r===null?mh:r}function OI(){var r=H.A;return H.A=FP,r}function Um(){Bt=4,ya||(Qe&4194048)!==Qe&&bi.current!==null||(gc=!0),(va&134217727)===0&&(Ho&134217727)===0||yt===null||Ta(yt,Qe,Ai,!1)}function By(r,a,l){var u=ot;ot|=2;var m=PI(),g=OI();(yt!==r||Qe!==a)&&(Vm=null,vc(r,a)),a=!1;var E=Bt;e:do try{if(ut!==0&&$e!==null){var b=$e,D=Si;switch(ut){case 8:Uy(),E=6;break e;case 3:case 2:case 9:case 6:bi.current===null&&(a=!0);var j=ut;if(ut=0,Si=null,Ec(r,b,D,j),l&&gc){E=0;break e}break;default:j=ut,ut=0,Si=null,Ec(r,b,D,j)}}qP(),E=Bt;break}catch(J){DI(r,J)}while(!0);return a&&r.shellSuspendCounter++,ls=Vo=null,ot=u,H.H=m,H.A=g,$e===null&&(yt=null,Qe=0,rm()),E}function qP(){for(;$e!==null;)MI($e)}function GP(r,a){var l=ot;ot|=2;var u=PI(),m=OI();yt!==r||Qe!==a?(Vm=null,Mm=Sn()+500,vc(r,a)):gc=Gs(r,a);e:do try{if(ut!==0&&$e!==null){a=$e;var g=Si;t:switch(ut){case 1:ut=0,Si=null,Ec(r,a,g,1);break;case 2:case 9:if(HT(g)){ut=0,Si=null,VI(a);break}a=function(){ut!==2&&ut!==9||yt!==r||(ut=7),Cr(r)},g.then(a,a);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:HT(g)?(ut=0,Si=null,VI(a)):(ut=0,Si=null,Ec(r,a,g,7));break;case 5:var E=null;switch($e.tag){case 26:E=$e.memoizedState;case 5:case 27:var b=$e;if(E?wS(E):b.stateNode.complete){ut=0,Si=null;var D=b.sibling;if(D!==null)$e=D;else{var j=b.return;j!==null?($e=j,Bm(j)):$e=null}break t}}ut=0,Si=null,Ec(r,a,g,5);break;case 6:ut=0,Si=null,Ec(r,a,g,6);break;case 8:Uy(),Bt=6;break e;default:throw Error(i(462))}}HP();break}catch(J){DI(r,J)}while(!0);return ls=Vo=null,H.H=u,H.A=m,ot=l,$e!==null?0:(yt=null,Qe=0,rm(),Bt)}function HP(){for(;$e!==null&&!h_();)MI($e)}function MI(r){var a=sI(r.alternate,r,ys);r.memoizedProps=r.pendingProps,a===null?Bm(r):$e=a}function VI(r){var a=r,l=a.alternate;switch(a.tag){case 15:case 0:a=Zb(l,a,a.pendingProps,a.type,void 0,Qe);break;case 11:a=Zb(l,a,a.pendingProps,a.type.render,a.ref,Qe);break;case 5:ey(a);default:oI(l,a),a=$e=OT(a,ys),a=sI(l,a,ys)}r.memoizedProps=r.pendingProps,a===null?Bm(r):$e=a}function Ec(r,a,l,u){ls=Vo=null,ey(a),cc=null,ah=0;var m=a.return;try{if(PP(r,m,a,l,Qe)){Bt=1,Am(r,Fi(l,r.current)),$e=null;return}}catch(g){if(m!==null)throw $e=m,g;Bt=1,Am(r,Fi(l,r.current)),$e=null;return}a.flags&32768?(Ze||u===1?r=!0:gc||(Qe&536870912)!==0?r=!1:(ya=r=!0,(u===2||u===9||u===3||u===6)&&(u=bi.current,u!==null&&u.tag===13&&(u.flags|=16384))),LI(a,r)):Bm(a)}function Bm(r){var a=r;do{if((a.flags&32768)!==0){LI(a,ya);return}r=a.return;var l=VP(a.alternate,a,ys);if(l!==null){$e=l;return}if(a=a.sibling,a!==null){$e=a;return}$e=a=r}while(a!==null);Bt===0&&(Bt=5)}function LI(r,a){do{var l=LP(r.alternate,r);if(l!==null){l.flags&=32767,$e=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(r=r.sibling,r!==null)){$e=r;return}$e=r=l}while(r!==null);Bt=6,$e=null}function UI(r,a,l,u,m,g,E,b,D){r.cancelPendingCommit=null;do Fm();while(an!==0);if((ot&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(g=a.lanes|a.childLanes,g|=C_,An(r,l,g,E,b,D),r===yt&&($e=yt=null,Qe=0),yc=a,wa=r,vs=l,My=g,Vy=m,CI=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,WP(Wr,function(){return qI(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=H.T,H.T=null,m=ee.p,ee.p=2,E=ot,ot|=4;try{UP(r,a,l)}finally{ot=E,ee.p=m,H.T=u}}an=1,BI(),FI(),jI()}}function BI(){if(an===1){an=0;var r=wa,a=yc,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=H.T,H.T=null;var u=ee.p;ee.p=2;var m=ot;ot|=4;try{vI(a,r);var g=Xy,E=ST(r.containerInfo),b=g.focusedElem,D=g.selectionRange;if(E!==b&&b&&b.ownerDocument&&IT(b.ownerDocument.documentElement,b)){if(D!==null&&T_(b)){var j=D.start,J=D.end;if(J===void 0&&(J=j),"selectionStart"in b)b.selectionStart=j,b.selectionEnd=Math.min(J,b.value.length);else{var te=b.ownerDocument||document,G=te&&te.defaultView||window;if(G.getSelection){var $=G.getSelection(),Te=b.textContent.length,Ne=Math.min(D.start,Te),pt=D.end===void 0?Ne:Math.min(D.end,Te);!$.extend&&Ne>pt&&(E=pt,pt=Ne,Ne=E);var U=bT(b,Ne),M=bT(b,pt);if(U&&M&&($.rangeCount!==1||$.anchorNode!==U.node||$.anchorOffset!==U.offset||$.focusNode!==M.node||$.focusOffset!==M.offset)){var F=te.createRange();F.setStart(U.node,U.offset),$.removeAllRanges(),Ne>pt?($.addRange(F),$.extend(M.node,M.offset)):(F.setEnd(M.node,M.offset),$.addRange(F))}}}}for(te=[],$=b;$=$.parentNode;)$.nodeType===1&&te.push({element:$,left:$.scrollLeft,top:$.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<te.length;b++){var Z=te[b];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}Jm=!!Yy,Xy=Yy=null}finally{ot=m,ee.p=u,H.T=l}}r.current=a,an=2}}function FI(){if(an===2){an=0;var r=wa,a=yc,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=H.T,H.T=null;var u=ee.p;ee.p=2;var m=ot;ot|=4;try{mI(r,a.alternate,a)}finally{ot=m,ee.p=u,H.T=l}}an=3}}function jI(){if(an===4||an===3){an=0,Pu();var r=wa,a=yc,l=vs,u=CI;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?an=5:(an=0,yc=wa=null,zI(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(Ea=null),Bu(l),a=a.stateNode,Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(zs,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=H.T,m=ee.p,ee.p=2,H.T=null;try{for(var g=r.onRecoverableError,E=0;E<u.length;E++){var b=u[E];g(b.value,{componentStack:b.stack})}}finally{H.T=a,ee.p=m}}(vs&3)!==0&&Fm(),Cr(r),m=r.pendingLanes,(l&261930)!==0&&(m&42)!==0?r===Ly?bh++:(bh=0,Ly=r):bh=0,Ih(0)}}function zI(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,rh(a)))}function Fm(){return BI(),FI(),jI(),qI()}function qI(){if(an!==5)return!1;var r=wa,a=My;My=0;var l=Bu(vs),u=H.T,m=ee.p;try{ee.p=32>l?32:l,H.T=null,l=Vy,Vy=null;var g=wa,E=vs;if(an=0,yc=wa=null,vs=0,(ot&6)!==0)throw Error(i(331));var b=ot;if(ot|=4,II(g.current),wI(g,g.current,E,l),ot=b,Ih(0,!1),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(zs,g)}catch{}return!0}finally{ee.p=m,H.T=u,zI(r,a)}}function GI(r,a,l){a=Fi(l,a),a=py(r.stateNode,a,2),r=ma(r,a,2),r!==null&&(Hs(r,2),Cr(r))}function ht(r,a,l){if(r.tag===3)GI(r,r,l);else for(;a!==null;){if(a.tag===3){GI(a,r,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ea===null||!Ea.has(u))){r=Fi(l,r),l=Hb(2),u=ma(a,l,2),u!==null&&($b(l,u,a,r),Hs(u,2),Cr(u));break}}a=a.return}}function Fy(r,a,l){var u=r.pingCache;if(u===null){u=r.pingCache=new jP;var m=new Set;u.set(a,m)}else m=u.get(a),m===void 0&&(m=new Set,u.set(a,m));m.has(l)||(ky=!0,m.add(l),r=$P.bind(null,r,a,l),a.then(r,r))}function $P(r,a,l){var u=r.pingCache;u!==null&&u.delete(a),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,yt===r&&(Qe&l)===l&&(Bt===4||Bt===3&&(Qe&62914560)===Qe&&300>Sn()-Om?(ot&2)===0&&vc(r,0):Py|=l,_c===Qe&&(_c=0)),Cr(r)}function HI(r,a){a===0&&(a=Vu()),r=Po(r,a),r!==null&&(Hs(r,a),Cr(r))}function KP(r){var a=r.memoizedState,l=0;a!==null&&(l=a.retryLane),HI(r,l)}function QP(r,a){var l=0;switch(r.tag){case 31:case 13:var u=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(a),HI(r,l)}function WP(r,a){return yo(r,a)}var jm=null,wc=null,jy=!1,zm=!1,zy=!1,ba=0;function Cr(r){r!==wc&&r.next===null&&(wc===null?jm=wc=r:wc=wc.next=r),zm=!0,jy||(jy=!0,XP())}function Ih(r,a){if(!zy&&zm){zy=!0;do for(var l=!1,u=jm;u!==null;){if(r!==0){var m=u.pendingLanes;if(m===0)var g=0;else{var E=u.suspendedLanes,b=u.pingedLanes;g=(1<<31-zn(42|r)+1)-1,g&=m&~(E&~b),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,WI(u,g))}else g=Qe,g=Vi(u,u===yt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Gs(u,g)||(l=!0,WI(u,g));u=u.next}while(l);zy=!1}}function YP(){$I()}function $I(){zm=jy=!1;var r=0;ba!==0&&oO()&&(r=ba);for(var a=Sn(),l=null,u=jm;u!==null;){var m=u.next,g=KI(u,a);g===0?(u.next=null,l===null?jm=m:l.next=m,m===null&&(wc=l)):(l=u,(r!==0||(g&3)!==0)&&(zm=!0)),u=m}an!==0&&an!==5||Ih(r),ba!==0&&(ba=0)}function KI(r,a){for(var l=r.suspendedLanes,u=r.pingedLanes,m=r.expirationTimes,g=r.pendingLanes&-62914561;0<g;){var E=31-zn(g),b=1<<E,D=m[E];D===-1?((b&l)===0||(b&u)!==0)&&(m[E]=jl(b,a)):D<=a&&(r.expiredLanes|=b),g&=~b}if(a=yt,l=Qe,l=Vi(r,r===a?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,l===0||r===a&&(ut===2||ut===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Fl(u),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Gs(r,l)){if(a=l&-l,a===r.callbackPriority)return a;switch(u!==null&&Fl(u),Bu(l)){case 2:case 8:l=dn;break;case 32:l=Wr;break;case 268435456:l=Ou;break;default:l=Wr}return u=QI.bind(null,r),l=yo(l,u),r.callbackPriority=a,r.callbackNode=l,a}return u!==null&&u!==null&&Fl(u),r.callbackPriority=2,r.callbackNode=null,2}function QI(r,a){if(an!==0&&an!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Fm()&&r.callbackNode!==l)return null;var u=Qe;return u=Vi(r,r===yt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(xI(r,u,a),KI(r,Sn()),r.callbackNode!=null&&r.callbackNode===l?QI.bind(null,r):null)}function WI(r,a){if(Fm())return null;xI(r,a,!0)}function XP(){cO(function(){(ot&6)!==0?yo(sn,YP):$I()})}function qy(){if(ba===0){var r=ac;r===0&&(r=Eo,Eo<<=1,(Eo&261888)===0&&(Eo=256)),ba=r}return ba}function YI(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:wr(""+r)}function XI(r,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,r.id&&l.setAttribute("form",r.id),a.parentNode.insertBefore(l,a),r=new FormData(r),l.parentNode.removeChild(l),r}function JP(r,a,l,u,m){if(a==="submit"&&l&&l.stateNode===m){var g=YI((m[Cn]||null).action),E=u.submitter;E&&(a=(a=E[Cn]||null)?YI(a.formAction):E.getAttribute("formAction"),a!==null&&(g=a,E=null));var b=new Ao("action","action",null,u,m);r.push({event:b,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ba!==0){var D=E?XI(m,E):new FormData(m);cy(l,{pending:!0,data:D,method:m.method,action:g},null,D)}}else typeof g=="function"&&(b.preventDefault(),D=E?XI(m,E):new FormData(m),cy(l,{pending:!0,data:D,method:m.method,action:g},g,D))},currentTarget:m}]})}}for(var Gy=0;Gy<A_.length;Gy++){var Hy=A_[Gy],ZP=Hy.toLowerCase(),eO=Hy[0].toUpperCase()+Hy.slice(1);ar(ZP,"on"+eO)}ar(RT,"onAnimationEnd"),ar(xT,"onAnimationIteration"),ar(NT,"onAnimationStart"),ar("dblclick","onDoubleClick"),ar("focusin","onFocus"),ar("focusout","onBlur"),ar(gP,"onTransitionRun"),ar(_P,"onTransitionStart"),ar(yP,"onTransitionCancel"),ar(DT,"onTransitionEnd"),Er("onMouseEnter",["mouseout","mouseover"]),Er("onMouseLeave",["mouseout","mouseover"]),Er("onPointerEnter",["pointerout","pointerover"]),Er("onPointerLeave",["pointerout","pointerover"]),qn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qn("onBeforeInput",["compositionend","keypress","textInput","paste"]),qn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sh));function JI(r,a){a=(a&4)!==0;for(var l=0;l<r.length;l++){var u=r[l],m=u.event;u=u.listeners;e:{var g=void 0;if(a)for(var E=u.length-1;0<=E;E--){var b=u[E],D=b.instance,j=b.currentTarget;if(b=b.listener,D!==g&&m.isPropagationStopped())break e;g=b,m.currentTarget=j;try{g(m)}catch(J){im(J)}m.currentTarget=null,g=D}else for(E=0;E<u.length;E++){if(b=u[E],D=b.instance,j=b.currentTarget,b=b.listener,D!==g&&m.isPropagationStopped())break e;g=b,m.currentTarget=j;try{g(m)}catch(J){im(J)}m.currentTarget=null,g=D}}}}function Ke(r,a){var l=a[Qs];l===void 0&&(l=a[Qs]=new Set);var u=r+"__bubble";l.has(u)||(ZI(a,r,2,!1),l.add(u))}function $y(r,a,l){var u=0;a&&(u|=4),ZI(l,r,u,a)}var qm="_reactListening"+Math.random().toString(36).slice(2);function Ky(r){if(!r[qm]){r[qm]=!0,zl.forEach(function(l){l!=="selectionchange"&&(tO.has(l)||$y(l,!1,r),$y(l,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[qm]||(a[qm]=!0,$y("selectionchange",!1,a))}}function ZI(r,a,l,u){switch(RS(a)){case 2:var m=xO;break;case 8:m=NO;break;default:m=lv}l=m.bind(null,a,l,r),m=void 0,!Ku||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),u?m!==void 0?r.addEventListener(a,l,{capture:!0,passive:m}):r.addEventListener(a,l,!0):m!==void 0?r.addEventListener(a,l,{passive:m}):r.addEventListener(a,l,!1)}function Qy(r,a,l,u,m){var g=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var b=u.stateNode.containerInfo;if(b===m)break;if(E===4)for(E=u.return;E!==null;){var D=E.tag;if((D===3||D===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;b!==null;){if(E=Zr(b),E===null)return;if(D=E.tag,D===5||D===6||D===26||D===27){u=g=E;continue e}b=b.parentNode}}u=u.return}jf(function(){var j=g,J=Kl(l),te=[];e:{var G=kT.get(r);if(G!==void 0){var $=Ao,Te=r;switch(r){case"keypress":if(So(l)===0)break e;case"keydown":case"keyup":$=Yf;break;case"focusin":Te="focus",$=ra;break;case"focusout":Te="blur",$=ra;break;case"beforeblur":case"afterblur":$=ra;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$=qf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$=Gf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$=Jf;break;case RT:case xT:case NT:$=Yl;break;case DT:$=Xl;break;case"scroll":case"scrollend":$=zf;break;case"wheel":$=em;break;case"copy":case"cut":case"paste":$=$f;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$=Ju;break;case"toggle":case"beforetoggle":$=aa}var Ne=(a&4)!==0,pt=!Ne&&(r==="scroll"||r==="scrollend"),U=Ne?G!==null?G+"Capture":null:G;Ne=[];for(var M=j,F;M!==null;){var Z=M;if(F=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||F===null||U===null||(Z=ni(M,U),Z!=null&&Ne.push(Ah(M,Z,F))),pt)break;M=M.return}0<Ne.length&&(G=new $(G,Te,null,l,J),te.push({event:G,listeners:Ne}))}}if((a&7)===0){e:{if(G=r==="mouseover"||r==="pointerover",$=r==="mouseout"||r==="pointerout",G&&l!==$l&&(Te=l.relatedTarget||l.fromElement)&&(Zr(Te)||Te[yr]))break e;if(($||G)&&(G=J.window===J?J:(G=J.ownerDocument)?G.defaultView||G.parentWindow:window,$?(Te=l.relatedTarget||l.toElement,$=j,Te=Te?Zr(Te):null,Te!==null&&(pt=o(Te),Ne=Te.tag,Te!==pt||Ne!==5&&Ne!==27&&Ne!==6)&&(Te=null)):($=null,Te=j),$!==Te)){if(Ne=qf,Z="onMouseLeave",U="onMouseEnter",M="mouse",(r==="pointerout"||r==="pointerover")&&(Ne=Ju,Z="onPointerLeave",U="onPointerEnter",M="pointer"),pt=$==null?G:To($),F=Te==null?G:To(Te),G=new Ne(Z,M+"leave",$,l,J),G.target=pt,G.relatedTarget=F,Z=null,Zr(J)===j&&(Ne=new Ne(U,M+"enter",Te,l,J),Ne.target=F,Ne.relatedTarget=pt,Z=Ne),pt=Z,$&&Te)t:{for(Ne=nO,U=$,M=Te,F=0,Z=U;Z;Z=Ne(Z))F++;Z=0;for(var xe=M;xe;xe=Ne(xe))Z++;for(;0<F-Z;)U=Ne(U),F--;for(;0<Z-F;)M=Ne(M),Z--;for(;F--;){if(U===M||M!==null&&U===M.alternate){Ne=U;break t}U=Ne(U),M=Ne(M)}Ne=null}else Ne=null;$!==null&&eS(te,G,$,Ne,!1),Te!==null&&pt!==null&&eS(te,pt,Te,Ne,!0)}}e:{if(G=j?To(j):window,$=G.nodeName&&G.nodeName.toLowerCase(),$==="select"||$==="input"&&G.type==="file")var it=_T;else if(ii(G))if(yT)it=fP;else{it=hP;var Ie=uP}else $=G.nodeName,!$||$.toLowerCase()!=="input"||G.type!=="checkbox"&&G.type!=="radio"?j&&Hu(j.elementType)&&(it=_T):it=dP;if(it&&(it=it(r,j))){No(te,it,l,J);break e}Ie&&Ie(r,G,j),r==="focusout"&&j&&G.type==="number"&&j.memoizedProps.value!=null&&Hl(G,"number",G.value)}switch(Ie=j?To(j):window,r){case"focusin":(ii(Ie)||Ie.contentEditable==="true")&&(Jl=Ie,b_=j,th=null);break;case"focusout":th=b_=Jl=null;break;case"mousedown":I_=!0;break;case"contextmenu":case"mouseup":case"dragend":I_=!1,AT(te,l,J);break;case"selectionchange":if(pP)break;case"keydown":case"keyup":AT(te,l,J)}var Fe;if(y)e:{switch(r){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else je?lt(r,l)&&(We="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(B&&l.locale!=="ko"&&(je||We!=="onCompositionStart"?We==="onCompositionEnd"&&je&&(Fe=ea()):(Ei=J,Ql="value"in Ei?Ei.value:Ei.textContent,je=!0)),Ie=Gm(j,We),0<Ie.length&&(We=new Wu(We,r,null,l,J),te.push({event:We,listeners:Ie}),Fe?We.data=Fe:(Fe=Xt(l),Fe!==null&&(We.data=Fe)))),(Fe=S?mn(r,l):pn(r,l))&&(We=Gm(j,"onBeforeInput"),0<We.length&&(Ie=new Wu("onBeforeInput","beforeinput",null,l,J),te.push({event:Ie,listeners:We}),Ie.data=Fe)),JP(te,r,j,l,J)}JI(te,a)})}function Ah(r,a,l){return{instance:r,listener:a,currentTarget:l}}function Gm(r,a){for(var l=a+"Capture",u=[];r!==null;){var m=r,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=ni(r,l),m!=null&&u.unshift(Ah(r,m,g)),m=ni(r,a),m!=null&&u.push(Ah(r,m,g))),r.tag===3)return u;r=r.return}return[]}function nO(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function eS(r,a,l,u,m){for(var g=a._reactName,E=[];l!==null&&l!==u;){var b=l,D=b.alternate,j=b.stateNode;if(b=b.tag,D!==null&&D===u)break;b!==5&&b!==26&&b!==27||j===null||(D=j,m?(j=ni(l,g),j!=null&&E.unshift(Ah(l,j,D))):m||(j=ni(l,g),j!=null&&E.push(Ah(l,j,D)))),l=l.return}E.length!==0&&r.push({event:a,listeners:E})}var iO=/\r\n?/g,rO=/\u0000|\uFFFD/g;function tS(r){return(typeof r=="string"?r:""+r).replace(iO,`
`).replace(rO,"")}function nS(r,a){return a=tS(a),tS(r)===a}function mt(r,a,l,u,m,g){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||Ui(r,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&Ui(r,""+u);break;case"className":Xs(r,"class",u);break;case"tabIndex":Xs(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Xs(r,l,u);break;case"style":Bf(r,u,g);break;case"data":if(a!=="object"){Xs(r,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){r.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=wr(""+u),r.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(a!=="input"&&mt(r,a,"name",m.name,m,null),mt(r,a,"formEncType",m.formEncType,m,null),mt(r,a,"formMethod",m.formMethod,m,null),mt(r,a,"formTarget",m.formTarget,m,null)):(mt(r,a,"encType",m.encType,m,null),mt(r,a,"method",m.method,m,null),mt(r,a,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=wr(""+u),r.setAttribute(l,u);break;case"onClick":u!=null&&(r.onclick=fn);break;case"onScroll":u!=null&&Ke("scroll",r);break;case"onScrollEnd":u!=null&&Ke("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}l=wr(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""+u):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":u===!0?r.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,u):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(l,u):r.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(l):r.setAttribute(l,u);break;case"popover":Ke("beforetoggle",r),Ke("toggle",r),Ys(r,"popover",u);break;case"xlinkActuate":Li(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Li(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Li(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Li(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Li(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Li(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Li(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Li(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Li(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ys(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=__.get(l)||l,Ys(r,l,u))}}function Wy(r,a,l,u,m,g){switch(l){case"style":Bf(r,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof u=="string"?Ui(r,u):(typeof u=="number"||typeof u=="bigint")&&Ui(r,""+u);break;case"onScroll":u!=null&&Ke("scroll",r);break;case"onScrollEnd":u!=null&&Ke("scrollend",r);break;case"onClick":u!=null&&(r.onclick=fn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ws.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),a=l.slice(2,m?l.length-7:void 0),g=r[Cn]||null,g=g!=null?g[l]:null,typeof g=="function"&&r.removeEventListener(a,g,m),typeof u=="function")){typeof g!="function"&&g!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(a,u,m);break e}l in r?r[l]=u:u===!0?r.setAttribute(l,""):Ys(r,l,u)}}}function Dn(r,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",r),Ke("load",r);var u=!1,m=!1,g;for(g in l)if(l.hasOwnProperty(g)){var E=l[g];if(E!=null)switch(g){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:mt(r,a,g,E,l,null)}}m&&mt(r,a,"srcSet",l.srcSet,l,null),u&&mt(r,a,"src",l.src,l,null);return;case"input":Ke("invalid",r);var b=g=E=m=null,D=null,j=null;for(u in l)if(l.hasOwnProperty(u)){var J=l[u];if(J!=null)switch(u){case"name":m=J;break;case"type":E=J;break;case"checked":D=J;break;case"defaultChecked":j=J;break;case"value":g=J;break;case"defaultValue":b=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,a));break;default:mt(r,a,u,J,l,null)}}bo(r,g,b,D,j,E,m,!1);return;case"select":Ke("invalid",r),u=E=g=null;for(m in l)if(l.hasOwnProperty(m)&&(b=l[m],b!=null))switch(m){case"value":g=b;break;case"defaultValue":E=b;break;case"multiple":u=b;default:mt(r,a,m,b,l,null)}a=g,l=E,r.multiple=!!u,a!=null?nt(r,!!u,a,!1):l!=null&&nt(r,!!u,l,!0);return;case"textarea":Ke("invalid",r),g=m=u=null;for(E in l)if(l.hasOwnProperty(E)&&(b=l[E],b!=null))switch(E){case"value":u=b;break;case"defaultValue":m=b;break;case"children":g=b;break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(i(91));break;default:mt(r,a,E,b,l,null)}Zs(r,u,m,g);return;case"option":for(D in l)if(l.hasOwnProperty(D)&&(u=l[D],u!=null))switch(D){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:mt(r,a,D,u,l,null)}return;case"dialog":Ke("beforetoggle",r),Ke("toggle",r),Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":Ke("load",r);break;case"video":case"audio":for(u=0;u<Sh.length;u++)Ke(Sh[u],r);break;case"image":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"embed":case"source":case"link":Ke("error",r),Ke("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(j in l)if(l.hasOwnProperty(j)&&(u=l[j],u!=null))switch(j){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:mt(r,a,j,u,l,null)}return;default:if(Hu(a)){for(J in l)l.hasOwnProperty(J)&&(u=l[J],u!==void 0&&Wy(r,a,J,u,l,void 0));return}}for(b in l)l.hasOwnProperty(b)&&(u=l[b],u!=null&&mt(r,a,b,u,l,null))}function sO(r,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,E=null,b=null,D=null,j=null,J=null;for($ in l){var te=l[$];if(l.hasOwnProperty($)&&te!=null)switch($){case"checked":break;case"value":break;case"defaultValue":D=te;default:u.hasOwnProperty($)||mt(r,a,$,null,u,te)}}for(var G in u){var $=u[G];if(te=l[G],u.hasOwnProperty(G)&&($!=null||te!=null))switch(G){case"type":g=$;break;case"name":m=$;break;case"checked":j=$;break;case"defaultChecked":J=$;break;case"value":E=$;break;case"defaultValue":b=$;break;case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,a));break;default:$!==te&&mt(r,a,G,$,u,te)}}Js(r,E,b,D,j,J,g,m);return;case"select":$=E=b=G=null;for(g in l)if(D=l[g],l.hasOwnProperty(g)&&D!=null)switch(g){case"value":break;case"multiple":$=D;default:u.hasOwnProperty(g)||mt(r,a,g,null,u,D)}for(m in u)if(g=u[m],D=l[m],u.hasOwnProperty(m)&&(g!=null||D!=null))switch(m){case"value":G=g;break;case"defaultValue":b=g;break;case"multiple":E=g;default:g!==D&&mt(r,a,m,g,u,D)}a=b,l=E,u=$,G!=null?nt(r,!!l,G,!1):!!u!=!!l&&(a!=null?nt(r,!!l,a,!0):nt(r,!!l,l?[]:"",!1));return;case"textarea":$=G=null;for(b in l)if(m=l[b],l.hasOwnProperty(b)&&m!=null&&!u.hasOwnProperty(b))switch(b){case"value":break;case"children":break;default:mt(r,a,b,null,u,m)}for(E in u)if(m=u[E],g=l[E],u.hasOwnProperty(E)&&(m!=null||g!=null))switch(E){case"value":G=m;break;case"defaultValue":$=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==g&&mt(r,a,E,m,u,g)}Io(r,G,$);return;case"option":for(var Te in l)if(G=l[Te],l.hasOwnProperty(Te)&&G!=null&&!u.hasOwnProperty(Te))switch(Te){case"selected":r.selected=!1;break;default:mt(r,a,Te,null,u,G)}for(D in u)if(G=u[D],$=l[D],u.hasOwnProperty(D)&&G!==$&&(G!=null||$!=null))switch(D){case"selected":r.selected=G&&typeof G!="function"&&typeof G!="symbol";break;default:mt(r,a,D,G,u,$)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ne in l)G=l[Ne],l.hasOwnProperty(Ne)&&G!=null&&!u.hasOwnProperty(Ne)&&mt(r,a,Ne,null,u,G);for(j in u)if(G=u[j],$=l[j],u.hasOwnProperty(j)&&G!==$&&(G!=null||$!=null))switch(j){case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(i(137,a));break;default:mt(r,a,j,G,u,$)}return;default:if(Hu(a)){for(var pt in l)G=l[pt],l.hasOwnProperty(pt)&&G!==void 0&&!u.hasOwnProperty(pt)&&Wy(r,a,pt,void 0,u,G);for(J in u)G=u[J],$=l[J],!u.hasOwnProperty(J)||G===$||G===void 0&&$===void 0||Wy(r,a,J,G,u,$);return}}for(var U in l)G=l[U],l.hasOwnProperty(U)&&G!=null&&!u.hasOwnProperty(U)&&mt(r,a,U,null,u,G);for(te in u)G=u[te],$=l[te],!u.hasOwnProperty(te)||G===$||G==null&&$==null||mt(r,a,te,G,u,$)}function iS(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function aO(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var m=l[u],g=m.transferSize,E=m.initiatorType,b=m.duration;if(g&&b&&iS(E)){for(E=0,b=m.responseEnd,u+=1;u<l.length;u++){var D=l[u],j=D.startTime;if(j>b)break;var J=D.transferSize,te=D.initiatorType;J&&iS(te)&&(D=D.responseEnd,E+=J*(D<b?1:(b-j)/(D-j)))}if(--u,a+=8*(g+E)/(m.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Yy=null,Xy=null;function Hm(r){return r.nodeType===9?r:r.ownerDocument}function rS(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sS(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Jy(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Zy=null;function oO(){var r=window.event;return r&&r.type==="popstate"?r===Zy?!1:(Zy=r,!0):(Zy=null,!1)}var aS=typeof setTimeout=="function"?setTimeout:void 0,lO=typeof clearTimeout=="function"?clearTimeout:void 0,oS=typeof Promise=="function"?Promise:void 0,cO=typeof queueMicrotask=="function"?queueMicrotask:typeof oS<"u"?function(r){return oS.resolve(null).then(r).catch(uO)}:aS;function uO(r){setTimeout(function(){throw r})}function Ia(r){return r==="head"}function lS(r,a){var l=a,u=0;do{var m=l.nextSibling;if(r.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"||l==="/&"){if(u===0){r.removeChild(m),Sc(a);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")Ch(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,Ch(l);for(var g=l.firstChild;g;){var E=g.nextSibling,b=g.nodeName;g[Jr]||b==="SCRIPT"||b==="STYLE"||b==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=E}}else l==="body"&&Ch(r.ownerDocument.body);l=m}while(l);Sc(a)}function cS(r,a){var l=r;r=0;do{var u=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=u}while(l)}function ev(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":ev(l),wo(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function hO(r,a,l,u){for(;r.nodeType===1;){var m=l;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Jr])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(g=r.getAttribute("rel"),g==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(g!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(g=r.getAttribute("src"),(g!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===g)return r}else return r;if(r=Hi(r.nextSibling),r===null)break}return null}function dO(r,a,l){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Hi(r.nextSibling),r===null))return null;return r}function uS(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=Hi(r.nextSibling),r===null))return null;return r}function tv(r){return r.data==="$?"||r.data==="$~"}function nv(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function fO(r,a){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||l.readyState!=="loading")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function Hi(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var iv=null;function hS(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(a===0)return Hi(r.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}r=r.nextSibling}return null}function dS(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return r;a--}else l!=="/$"&&l!=="/&"||a++}r=r.previousSibling}return null}function fS(r,a,l){switch(a=Hm(l),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Ch(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);wo(r)}var $i=new Map,mS=new Set;function $m(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Es=ee.d;ee.d={f:mO,r:pO,D:gO,C:_O,L:yO,m:vO,X:wO,S:EO,M:TO};function mO(){var r=Es.f(),a=Lm();return r||a}function pO(r){var a=es(r);a!==null&&a.tag===5&&a.type==="form"?Db(a):Es.r(r)}var Tc=typeof document>"u"?null:document;function pS(r,a,l){var u=Tc;if(u&&typeof a=="string"&&a){var m=Lt(a);m='link[rel="'+r+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),mS.has(m)||(mS.add(m),r={rel:r,crossOrigin:l,href:a},u.querySelector(m)===null&&(a=u.createElement("link"),Dn(a,"link",r),Ht(a),u.head.appendChild(a)))}}function gO(r){Es.D(r),pS("dns-prefetch",r,null)}function _O(r,a){Es.C(r,a),pS("preconnect",r,a)}function yO(r,a,l){Es.L(r,a,l);var u=Tc;if(u&&r&&a){var m='link[rel="preload"][as="'+Lt(a)+'"]';a==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Lt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Lt(l.imageSizes)+'"]')):m+='[href="'+Lt(r)+'"]';var g=m;switch(a){case"style":g=bc(r);break;case"script":g=Ic(r)}$i.has(g)||(r=v({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:r,as:a},l),$i.set(g,r),u.querySelector(m)!==null||a==="style"&&u.querySelector(Rh(g))||a==="script"&&u.querySelector(xh(g))||(a=u.createElement("link"),Dn(a,"link",r),Ht(a),u.head.appendChild(a)))}}function vO(r,a){Es.m(r,a);var l=Tc;if(l&&r){var u=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+Lt(u)+'"][href="'+Lt(r)+'"]',g=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Ic(r)}if(!$i.has(g)&&(r=v({rel:"modulepreload",href:r},a),$i.set(g,r),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(xh(g)))return}u=l.createElement("link"),Dn(u,"link",r),Ht(u),l.head.appendChild(u)}}}function EO(r,a,l){Es.S(r,a,l);var u=Tc;if(u&&r){var m=rr(u).hoistableStyles,g=bc(r);a=a||"default";var E=m.get(g);if(!E){var b={loading:0,preload:null};if(E=u.querySelector(Rh(g)))b.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":a},l),(l=$i.get(g))&&rv(r,l);var D=E=u.createElement("link");Ht(D),Dn(D,"link",r),D._p=new Promise(function(j,J){D.onload=j,D.onerror=J}),D.addEventListener("load",function(){b.loading|=1}),D.addEventListener("error",function(){b.loading|=2}),b.loading|=4,Km(E,a,u)}E={type:"stylesheet",instance:E,count:1,state:b},m.set(g,E)}}}function wO(r,a){Es.X(r,a);var l=Tc;if(l&&r){var u=rr(l).hoistableScripts,m=Ic(r),g=u.get(m);g||(g=l.querySelector(xh(m)),g||(r=v({src:r,async:!0},a),(a=$i.get(m))&&sv(r,a),g=l.createElement("script"),Ht(g),Dn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function TO(r,a){Es.M(r,a);var l=Tc;if(l&&r){var u=rr(l).hoistableScripts,m=Ic(r),g=u.get(m);g||(g=l.querySelector(xh(m)),g||(r=v({src:r,async:!0,type:"module"},a),(a=$i.get(m))&&sv(r,a),g=l.createElement("script"),Ht(g),Dn(g,"link",r),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function gS(r,a,l,u){var m=(m=_e.current)?$m(m):null;if(!m)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=bc(l.href),l=rr(m).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=bc(l.href);var g=rr(m).hoistableStyles,E=g.get(r);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(r,E),(g=m.querySelector(Rh(r)))&&!g._p&&(E.instance=g,E.state.loading=5),$i.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},$i.set(r,l),g||bO(m,r,l,E.state))),a&&u===null)throw Error(i(528,""));return E}if(a&&u!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ic(l),l=rr(m).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function bc(r){return'href="'+Lt(r)+'"'}function Rh(r){return'link[rel="stylesheet"]['+r+"]"}function _S(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function bO(r,a,l,u){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=r.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),Dn(a,"link",l),Ht(a),r.head.appendChild(a))}function Ic(r){return'[src="'+Lt(r)+'"]'}function xh(r){return"script[async]"+r}function yS(r,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=r.querySelector('style[data-href~="'+Lt(l.href)+'"]');if(u)return a.instance=u,Ht(u),u;var m=v({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Ht(u),Dn(u,"style",m),Km(u,l.precedence,r),a.instance=u;case"stylesheet":m=bc(l.href);var g=r.querySelector(Rh(m));if(g)return a.state.loading|=4,a.instance=g,Ht(g),g;u=_S(l),(m=$i.get(m))&&rv(u,m),g=(r.ownerDocument||r).createElement("link"),Ht(g);var E=g;return E._p=new Promise(function(b,D){E.onload=b,E.onerror=D}),Dn(g,"link",u),a.state.loading|=4,Km(g,l.precedence,r),a.instance=g;case"script":return g=Ic(l.src),(m=r.querySelector(xh(g)))?(a.instance=m,Ht(m),m):(u=l,(m=$i.get(g))&&(u=v({},l),sv(u,m)),r=r.ownerDocument||r,m=r.createElement("script"),Ht(m),Dn(m,"link",u),r.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,Km(u,l.precedence,r));return a.instance}function Km(r,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,g=m,E=0;E<u.length;E++){var b=u[E];if(b.dataset.precedence===a)g=b;else if(g!==m)break}g?g.parentNode.insertBefore(r,g.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(r,a.firstChild))}function rv(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function sv(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var Qm=null;function vS(r,a,l){if(Qm===null){var u=new Map,m=Qm=new Map;m.set(l,u)}else m=Qm,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(r))return u;for(u.set(r,null),l=l.getElementsByTagName(r),m=0;m<l.length;m++){var g=l[m];if(!(g[Jr]||g[Vt]||r==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(a)||"";E=r+E;var b=u.get(E);b?b.push(g):u.set(E,[g])}}return u}function ES(r,a,l){r=r.ownerDocument||r,r.head.insertBefore(l,a==="title"?r.querySelector("head > title"):null)}function IO(r,a,l){if(l===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function wS(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function SO(r,a,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=bc(u.href),g=a.querySelector(Rh(m));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=Wm.bind(r),a.then(r,r)),l.state.loading|=4,l.instance=g,Ht(g);return}g=a.ownerDocument||a,u=_S(u),(m=$i.get(m))&&rv(u,m),g=g.createElement("link"),Ht(g);var E=g;E._p=new Promise(function(b,D){E.onload=b,E.onerror=D}),Dn(g,"link",u),l.instance=g}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=Wm.bind(r),a.addEventListener("load",l),a.addEventListener("error",l))}}var av=0;function AO(r,a){return r.stylesheets&&r.count===0&&Xm(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var u=setTimeout(function(){if(r.stylesheets&&Xm(r,r.stylesheets),r.unsuspend){var g=r.unsuspend;r.unsuspend=null,g()}},6e4+a);0<r.imgBytes&&av===0&&(av=62500*aO());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Xm(r,r.stylesheets),r.unsuspend)){var g=r.unsuspend;r.unsuspend=null,g()}},(r.imgBytes>av?50:800)+a);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(m)}}:null}function Wm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xm(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Ym=null;function Xm(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Ym=new Map,a.forEach(CO,r),Ym=null,Wm.call(r))}function CO(r,a){if(!(a.state.loading&4)){var l=Ym.get(r);if(l)var u=l.get(null);else{l=new Map,Ym.set(r,l);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var E=m[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),u=E)}u&&l.set(null,u)}m=a.instance,E=m.getAttribute("data-precedence"),g=l.get(E)||u,g===u&&l.set(null,m),l.set(E,m),this.count++,u=Wm.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),g?g.parentNode.insertBefore(m,g.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),a.state.loading|=4}}var Nh={$$typeof:oe,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function RO(r,a,l,u,m,g,E,b,D){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yr(0),this.hiddenUpdates=Yr(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function TS(r,a,l,u,m,g,E,b,D,j,J,te){return r=new RO(r,a,l,E,D,j,J,te,b),a=1,g===!0&&(a|=24),g=Ti(3,null,null,a),r.current=g,g.stateNode=r,a=B_(),a.refCount++,r.pooledCache=a,a.refCount++,g.memoizedState={element:u,isDehydrated:l,cache:a},q_(g),r}function bS(r){return r?(r=tc,r):tc}function IS(r,a,l,u,m,g){m=bS(m),u.context===null?u.context=m:u.pendingContext=m,u=fa(a),u.payload={element:l},g=g===void 0?null:g,g!==null&&(u.callback=g),l=ma(r,u,a),l!==null&&(li(l,r,a),lh(l,r,a))}function SS(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<a?l:a}}function ov(r,a){SS(r,a),(r=r.alternate)&&SS(r,a)}function AS(r){if(r.tag===13||r.tag===31){var a=Po(r,67108864);a!==null&&li(a,r,67108864),ov(r,67108864)}}function CS(r){if(r.tag===13||r.tag===31){var a=Ci();a=Uu(a);var l=Po(r,a);l!==null&&li(l,r,a),ov(r,a)}}var Jm=!0;function xO(r,a,l,u){var m=H.T;H.T=null;var g=ee.p;try{ee.p=2,lv(r,a,l,u)}finally{ee.p=g,H.T=m}}function NO(r,a,l,u){var m=H.T;H.T=null;var g=ee.p;try{ee.p=8,lv(r,a,l,u)}finally{ee.p=g,H.T=m}}function lv(r,a,l,u){if(Jm){var m=cv(u);if(m===null)Qy(r,a,u,Zm,l),xS(r,u);else if(kO(m,r,a,l,u))u.stopPropagation();else if(xS(r,u),a&4&&-1<DO.indexOf(r)){for(;m!==null;){var g=es(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=ir(g.pendingLanes);if(E!==0){var b=g;for(b.pendingLanes|=2,b.entangledLanes|=2;E;){var D=1<<31-zn(E);b.entanglements[1]|=D,E&=~D}Cr(g),(ot&6)===0&&(Mm=Sn()+500,Ih(0))}}break;case 31:case 13:b=Po(g,2),b!==null&&li(b,g,2),Lm(),ov(g,2)}if(g=cv(u),g===null&&Qy(r,a,u,Zm,l),g===m)break;m=g}m!==null&&u.stopPropagation()}else Qy(r,a,u,null,l)}}function cv(r){return r=Kl(r),uv(r)}var Zm=null;function uv(r){if(Zm=null,r=Zr(r),r!==null){var a=o(r);if(a===null)r=null;else{var l=a.tag;if(l===13){if(r=c(a),r!==null)return r;r=null}else if(l===31){if(r=h(a),r!==null)return r;r=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Zm=r,null}function RS(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kf()){case sn:return 2;case dn:return 8;case Wr:case Pf:return 32;case Ou:return 268435456;default:return 32}default:return 32}}var hv=!1,Sa=null,Aa=null,Ca=null,Dh=new Map,kh=new Map,Ra=[],DO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xS(r,a){switch(r){case"focusin":case"focusout":Sa=null;break;case"dragenter":case"dragleave":Aa=null;break;case"mouseover":case"mouseout":Ca=null;break;case"pointerover":case"pointerout":Dh.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":kh.delete(a.pointerId)}}function Ph(r,a,l,u,m,g){return r===null||r.nativeEvent!==g?(r={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:g,targetContainers:[m]},a!==null&&(a=es(a),a!==null&&AS(a)),r):(r.eventSystemFlags|=u,a=r.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),r)}function kO(r,a,l,u,m){switch(a){case"focusin":return Sa=Ph(Sa,r,a,l,u,m),!0;case"dragenter":return Aa=Ph(Aa,r,a,l,u,m),!0;case"mouseover":return Ca=Ph(Ca,r,a,l,u,m),!0;case"pointerover":var g=m.pointerId;return Dh.set(g,Ph(Dh.get(g)||null,r,a,l,u,m)),!0;case"gotpointercapture":return g=m.pointerId,kh.set(g,Ph(kh.get(g)||null,r,a,l,u,m)),!0}return!1}function NS(r){var a=Zr(r.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){r.blockedOn=a,Mf(r.priority,function(){CS(l)});return}}else if(a===31){if(a=h(l),a!==null){r.blockedOn=a,Mf(r.priority,function(){CS(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ep(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var l=cv(r.nativeEvent);if(l===null){l=r.nativeEvent;var u=new l.constructor(l.type,l);$l=u,l.target.dispatchEvent(u),$l=null}else return a=es(l),a!==null&&AS(a),r.blockedOn=l,!1;a.shift()}return!0}function DS(r,a,l){ep(r)&&l.delete(a)}function PO(){hv=!1,Sa!==null&&ep(Sa)&&(Sa=null),Aa!==null&&ep(Aa)&&(Aa=null),Ca!==null&&ep(Ca)&&(Ca=null),Dh.forEach(DS),kh.forEach(DS)}function tp(r,a){r.blockedOn===a&&(r.blockedOn=null,hv||(hv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,PO)))}var np=null;function kS(r){np!==r&&(np=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){np===r&&(np=null);for(var a=0;a<r.length;a+=3){var l=r[a],u=r[a+1],m=r[a+2];if(typeof u!="function"){if(uv(u||l)===null)continue;break}var g=es(l);g!==null&&(r.splice(a,3),a-=3,cy(g,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function Sc(r){function a(D){return tp(D,r)}Sa!==null&&tp(Sa,r),Aa!==null&&tp(Aa,r),Ca!==null&&tp(Ca,r),Dh.forEach(a),kh.forEach(a);for(var l=0;l<Ra.length;l++){var u=Ra[l];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Ra.length&&(l=Ra[0],l.blockedOn===null);)NS(l),l.blockedOn===null&&Ra.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],g=l[u+1],E=m[Cn]||null;if(typeof g=="function")E||kS(l);else if(E){var b=null;if(g&&g.hasAttribute("formAction")){if(m=g,E=g[Cn]||null)b=E.formAction;else if(uv(m)!==null)continue}else b=E.action;typeof b=="function"?l[u+1]=b:(l.splice(u,3),u-=3),kS(l)}}}function PS(){function r(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function dv(r){this._internalRoot=r}ip.prototype.render=dv.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,u=Ci();IS(l,u,r,a,null,null)},ip.prototype.unmount=dv.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;IS(r.current,2,null,r,null,null),Lm(),a[yr]=null}};function ip(r){this._internalRoot=r}ip.prototype.unstable_scheduleHydration=function(r){if(r){var a=Xr();r={blockedOn:null,target:r,priority:a};for(var l=0;l<Ra.length&&a!==0&&a<Ra[l].priority;l++);Ra.splice(l,0,r),l===0&&NS(r)}};var OS=e.version;if(OS!=="19.2.0")throw Error(i(527,OS,"19.2.0"));ee.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(a),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var OO={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var rp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rp.isDisabled&&rp.supportsFiber)try{zs=rp.inject(OO),Vn=rp}catch{}}return Mh.createRoot=function(r,a){if(!s(r))throw Error(i(299));var l=!1,u="",m=jb,g=zb,E=qb;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),a=TS(r,1,!1,null,null,l,u,null,m,g,E,PS),r[yr]=a.current,Ky(r),new dv(a)},Mh.hydrateRoot=function(r,a,l){if(!s(r))throw Error(i(299));var u=!1,m="",g=jb,E=zb,b=qb,D=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(b=l.onRecoverableError),l.formState!==void 0&&(D=l.formState)),a=TS(r,1,!0,a,l??null,u,m,D,g,E,b,PS),a.context=bS(null),l=a.current,u=Ci(),u=Uu(u),m=fa(u),m.callback=null,ma(l,m,u),l=u,a.current.lanes=l,Hs(a,l),Cr(a),r[yr]=a.current,Ky(r),new ip(a)},Mh.version="19.2.0",Mh}var GS;function GO(){if(GS)return pv.exports;GS=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),pv.exports=qO(),pv.exports}var HO=GO();const $O=FR(HO),KO="modulepreload",QO=function(n){return"/Caro-AI-Arena-v1.1a/"+n},HS={},Sl=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(_=>Promise.resolve(_).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),d=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));s=c(t.map(p=>{if(p=QO(p),p in HS)return;HS[p]=!0;const _=p.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const T=document.createElement("link");if(T.rel=_?"stylesheet":KO,_||(T.as="script"),T.crossOrigin="",T.href=p,d&&T.setAttribute("nonce",d),document.head.appendChild(T),_)return new Promise((R,P)=>{T.addEventListener("load",R),T.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return s.then(c=>{for(const h of c||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})},La=15,$S=5,KS=900,X8=60,WO={win:50,draw:20,loss:10},YO={win:30,draw:10,loss:5},QS=n=>100+(n-1)*50,J8=["Available for a match!","Happy 😊","In love 🥰","Feeling lucky 🍀","Busy","Just chilling...","Up for a challenge!"],sp=[{name:"Sắt",tiers:3,baseCp:0,icon:"🛡️"},{name:"Đồng",tiers:3,baseCp:300,icon:"🥉"},{name:"Bạc",tiers:3,baseCp:600,icon:"🥈"},{name:"Vàng",tiers:3,baseCp:900,icon:"🥇"},{name:"Kim Cương",tiers:3,baseCp:1200,icon:"💎"},{name:"Cao Thủ",tiers:3,baseCp:1500,icon:"👑"},{name:"Thách Đấu",tiers:0,baseCp:1800,icon:"🔥"}],WS=n=>{const e=Number.isFinite(n)?Math.max(0,n):0;let t=sp[0];for(let d=sp.length-1;d>=0;d--)if(e>=sp[d].baseCp){t=sp[d];break}if(t.name==="Thách Đấu")return{name:"Thách Đấu",cpInTier:e,icon:t.icon};const i=e-t.baseCp,s=100,o=t.tiers-Math.floor(i/s),c=i%s,h={3:"III",2:"II",1:"I"}[o]||"I";return{name:`${t.name} ${h}`,cpInTier:c,icon:t.icon}},Z8=(n,e,t)=>{const s=t==="win"?1:t==="draw"?.5:0,o=1/(1+Math.pow(10,(e-n)/400)),c=40*(s-o);return t==="win"?Math.max(1,Math.round(c)):t==="loss"?Math.min(-1,Math.round(c)):Math.round(c)},XO=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M17.2,3H6.8l-5.2,9l5.2,9h10.4l5.2-9L17.2,3z"})}),JO=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12,2L1,21h22L12,2z"})}),ZO=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),e2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.03-3.58 2.37-6.53 5.5-7.65L8.5 3.5C4.73 4.83 2 8.57 2 13zm18 0c0-4.43-3.27-8.17-7.5-9.5L11.5 5.35c3.13 1.12 5.47 4.07 5.5 7.65h2zM12 5V3c4.42 0 8 3.58 8 8h-2c0-3.31-2.69-6-6-6zm0 14v2c-4.42 0-8-3.58-8-8h2c0 3.31 2.69 6 6 6z"})}),t2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 2C8.69 2 6 4.69 6 8v6c0 1.1.9 2 2 2h2v4h4v-4h2c1.1 0 2-.9 2-2V8c0-3.31-2.69-6-6-6zm-2 10c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm4 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"})}),n2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v5.5l3.5 3.5-1.42 1.42L11 13.41V7z"})}),i2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:I.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"currentColor",strokeWidth:"12"})}),r2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:I.jsx("path",{d:"M10 10 L90 90 M90 10 L10 90",stroke:"currentColor",strokeWidth:"12",strokeLinecap:"round"})}),s2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 2 L2 12 L12 22 L22 12 Z"})}),a2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),o2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),l2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"})}),c2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"})}),u2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.53c-.25.58-.56 1.12-.9 1.6l-2.8-2.81c.81-.43 1.51-1.03 2-1.79.49-.76.79-1.68.8-2.65.01-.98-.24-1.92-.7-2.75l1.45-1.45C18.53 7.8 19 9.83 19 12c0 2.21-.81 4.24-2.1 5.86v.01z"})}),h2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"})}),d2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M3 3v18h18V3H3zm16 16H5V5h14v14z"})}),f2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-14h2v4h3v2h-3v4h-2v-4H8v-2h3V6z"})}),m2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M19 8h-1.81c-.45-1.73-1.98-3-3.88-3s-3.43 1.27-3.88 3H7.69l-1.63 4.9A2 2 0 0 0 8 15h8a2 2 0 0 0 1.94-2.1L16.31 8h1.88c.55 0 1-.45 1-1s-.45-1-1-1zm-7 8c-1.66 0-3-1.34-3-3h6c0 1.66-1.34 3-3 3z"})}),p2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5z"})}),g2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zm0 13c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"})}),_2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6z"})}),y2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:I.jsx("path",{d:"M1,9 L5,5 L9,9 L13,5 L17,9 L21,5 L23,7 L19,11 L23,15 L21,17 L17,13 L13,17 L9,13 L5,17 L1,13 L5,9 M9,11 A2,2 0 1,1 9,10.99"})}),v2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8v16zM12 5.5A1.5 1.5 0 1 1 12 8.5 1.5 1.5 0 0 1 12 5.5zm0 10a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"})}),E2=({className:n})=>I.jsxs("svg",{className:n,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[I.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor",stroke:"none"}),I.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"4",transform:"rotate(45 12 12)"}),I.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"4",transform:"rotate(-45 12 12)"}),I.jsx("ellipse",{cx:"12",cy:"12",rx:"10",ry:"4",transform:"rotate(90 12 12)"})]}),w2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M15.42 16.62c.69.41 1.25.98 1.66 1.67.4-.7.95-1.25 1.64-1.65-.69-.4-1.25-.96-1.65-1.65a4.34 4.34 0 0 1-1.65 1.63M8.58 16.62a4.34 4.34 0 0 1-1.65-1.63c-.4.7-.96 1.25-1.65 1.65.69.4 1.25.95 1.65 1.65.41-.7.97-1.26 1.65-1.67M12 8.3c.7 0 1.25.56 1.25 1.25S12.7 10.8 12 10.8s-1.25-.56-1.25-1.25S11.3 8.3 12 8.3m0-2.5c-2.07 0-3.75 1.68-3.75 3.75S9.93 13.3 12 13.3s3.75-1.68 3.75-3.75S14.07 5.8 12 5.8m0-3.8C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-3.42-3.05c.41-.7.97-1.26 1.65-1.67-.69-.41-1.25-.98-1.66-1.67-.4.7-.95 1.25-1.64 1.65.7.41 1.25.96 1.65 1.69z"})}),T2=({className:n})=>I.jsxs("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:[I.jsx("path",{d:"M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66C7.32 17.33 10 12 17 10V8m-2-6h2v2h-2V2z"}),I.jsx("path",{d:"M15 4c-3.9 2-6.2 8-8.18 13.34l1.89.66C10.32 12.33 13 6 15 4z"})]}),b2=({className:n})=>I.jsx("svg",{className:n,viewBox:"0 0 24 24",fill:"currentColor",children:I.jsx("path",{d:"M12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6.5 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-13 0C4.4 10 3.5 10.9 3.5 12s.9 2 2 2 2-.9 2-2-.9-2-2-2m2 13c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m9-13c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-9 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m2-2.5c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m9 9c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})}),I2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(25)].map((n,e)=>I.jsx("div",{className:"absolute text-cyan-200/50",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.8+Math.random()*1.2}rem`,animationName:"snowfall, sway",animationDuration:`${10+Math.random()*10}s, ${4+Math.random()*4}s`,animationDelay:`${Math.random()*15}s, ${Math.random()*4}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*80}px`},children:"❄"},e))}),I.jsx("style",{children:`
            @keyframes snowfall {
                from {
                    transform: translateY(0vh) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(105vh) rotate(720deg);
                    opacity: 0;
                }
            }
             @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),S2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0 opacity-20 animate-scanlines"}),I.jsx("style",{children:`
            @keyframes scanlines {
                0% { background-position: 0 0; }
                100% { background-position: 0 50px; }
            }
            .animate-scanlines {
                background: linear-gradient(to bottom, transparent 0%, transparent 50%, rgba(24, 24, 27, 0.5) 50%, rgba(24, 24, 27, 0.5) 100%);
                background-size: 100% 4px;
                animation: scanlines 0.5s linear infinite;
            }
        `})]})),A2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(15)].map((n,e)=>I.jsx("div",{className:"absolute text-pink-400/50",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,fontSize:`${.5+Math.random()*1}rem`,animationName:"glint, drift",animationDelay:`${Math.random()*8}s`,animationDuration:`${4+Math.random()*4}s, ${4+Math.random()*4}s`,animationTimingFunction:"ease-in-out, linear",animationIterationCount:"infinite, infinite"},children:"✦"},e))}),I.jsx("style",{children:`
            @keyframes glint {
                0%, 100% { transform: scale(0.8); opacity: 0; }
                50% { transform: scale(1.5); opacity: 1; }
                75% { transform: scale(1.2); opacity: 0.8; }
            }
            @keyframes drift {
                from { transform: translateY(0); }
                to { transform: translateY(-80px); opacity: 0; }
            }
        `})]})),C2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(12)].map((n,e)=>I.jsx("div",{className:"absolute text-orange-400/50",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${1+Math.random()*1.5}rem`,animationName:"fall, sway",animationDuration:`${7+Math.random()*8}s, ${4+Math.random()*5}s`,animationDelay:`${Math.random()*10}s, ${Math.random()*5}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*150}px`},children:Math.random()>.5?"🍁":"🍂"},e))}),I.jsx("style",{children:`
            @keyframes fall {
                to {
                    transform: translateY(105vh) rotate(720deg);
                    opacity: 0;
                }
            }
            @keyframes sway {
                0%, 100% { margin-left: 0px; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),R2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(15)].map((n,e)=>I.jsx("div",{className:"absolute text-pink-200/60",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.8+Math.random()*1.2}rem`,animationName:"fall, sway",animationDuration:`${8+Math.random()*7}s, ${5+Math.random()*5}s`,animationDelay:`${Math.random()*12}s, ${Math.random()*5}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*120}px`},children:"🌸"},e))}),I.jsx("style",{children:`
            @keyframes fall {
                to { transform: translateY(105vh) rotate(720deg); opacity: 0; }
            }
            @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),x2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"absolute -top-24 -right-24 w-96 h-96 pointer-events-none z-0",children:[I.jsx("div",{className:"absolute inset-0 bg-yellow-300 rounded-full blur-3xl animate-pulse-slow opacity-10"}),I.jsx("div",{className:"absolute inset-10 bg-yellow-200 rounded-full blur-2xl animate-pulse-slow opacity-20"})]}),I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[[...Array(3)].map((n,e)=>I.jsx("div",{className:"absolute h-[150%] w-[150%]",style:{top:"-25%",right:"-25%",background:"linear-gradient(225deg, rgba(253, 224, 71, 0.08), rgba(253, 224, 71, 0))",transformOrigin:"top right",animation:`god-ray-pulse 8s ease-in-out infinite ${e*2.5}s`}},e)),[...Array(30)].map((n,e)=>I.jsx("div",{className:"absolute w-0.5 h-12 bg-gradient-to-b from-cyan-200/0 to-cyan-200/30",style:{top:"-20%",left:`${Math.random()*100}%`,animation:`rain-fall ${.5+Math.random()*.5}s linear infinite`,animationDelay:`${Math.random()*5}s`}},e))]}),I.jsx("style",{children:`
            @keyframes pulse-slow { 50% { opacity: 0.4; transform: scale(1.05); } }
            .animate-pulse-slow { animation: pulse-slow 10s ease-in-out infinite; }
            @keyframes god-ray-pulse {
                0%, 100% { opacity: 0; transform: rotate(15deg); }
                50% { opacity: 0.6; transform: rotate(20deg); }
            }
            @keyframes rain-fall {
                from { transform: translateY(0vh); }
                to { transform: translateY(120vh); }
            }
        `})]})),N2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(40)].map((n,e)=>I.jsx("div",{className:"absolute text-blue-200/60",style:{top:"-10%",left:`${-10+Math.random()*120}%`,fontSize:`${.6+Math.random()*1}rem`,animationName:"snowfall, sway",animationDuration:`${8+Math.random()*8}s, ${3+Math.random()*4}s`,animationDelay:`${Math.random()*12}s, ${Math.random()*4}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--sway-amount":`${(Math.random()-.5)*120}px`},children:Math.random()>.3?"❄":"•"},e))}),I.jsx("style",{children:`
            @keyframes snowfall {
                from {
                    transform: translateY(0vh) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(105vh) rotate(360deg);
                    opacity: 0;
                }
            }
             @keyframes sway {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--sway-amount); }
            }
        `})]})),D2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[[...Array(60)].map((n,e)=>I.jsx("div",{className:"absolute w-0.5 h-0.5 bg-white rounded-full animate-twinkle",style:{top:`${Math.random()*100}%`,left:`${Math.random()*100}%`,animationDelay:`${Math.random()*10}s`,animationDuration:`${2+Math.random()*3}s`,opacity:Math.random()*.5+.2}},`star-${e}`)),[...Array(3)].map((n,e)=>I.jsx("div",{className:"absolute h-0.5 w-24 bg-gradient-to-l from-white/50 to-transparent animate-shooting-star",style:{top:`${Math.random()*60-10}%`,left:`${Math.random()*60+50}%`,animationDelay:`${3+Math.random()*12}s`,animationDuration:`${1.5+Math.random()*1}s`}},`shooting-star-${e}`))]}),I.jsx("style",{children:`
            @keyframes twinkle {
                0%, 100% { opacity: 0.2; transform: scale(0.8); }
                50% { opacity: 1; transform: scale(1.2); filter: drop-shadow(0 0 3px white); }
            }
            .animate-twinkle { animation: twinkle ease-in-out infinite; }

            @keyframes shooting-star {
                from {
                    transform: rotate(135deg) translateX(0);
                    opacity: 1;
                }
                to {
                    transform: rotate(135deg) translateX(150vmin);
                    opacity: 0;
                }
            }
            .animate-shooting-star { animation: shooting-star linear infinite; }
        `})]})),k2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1/3 bg-gradient-to-t from-orange-900/40 to-transparent pointer-events-none z-0 animate-pulse-slow"}),I.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[...Array(25)].map((n,e)=>I.jsx("div",{className:"absolute rounded-full",style:{bottom:"-5%",left:`${Math.random()*100}%`,width:`${2+Math.random()*3}px`,height:`${2+Math.random()*3}px`,backgroundColor:`rgba(251, 146, 60, ${.5+Math.random()*.5})`,boxShadow:"0 0 6px 3px #f97316, 0 0 12px 6px #ef4444",animationName:"emberRise, emberWobble",animationDuration:`${4+Math.random()*6}s, ${3+Math.random()*3}s`,animationDelay:`${Math.random()*8}s, ${Math.random()*3}s`,animationTimingFunction:"linear, ease-in-out",animationIterationCount:"infinite, infinite","--wobble-amount":`${(Math.random()-.5)*80}px`}},e))}),I.jsx("style",{children:`
            @keyframes emberRise {
                from {
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                to {
                    transform: translateY(-105vh) scale(0.5);
                    opacity: 0;
                }
            }
             @keyframes emberWobble {
                0%, 100% { margin-left: 0; }
                50% { margin-left: var(--wobble-amount); }
            }
            @keyframes pulse-slow { 
                50% { opacity: 0.6; } 
            }
            .animate-pulse-slow { animation: pulse-slow 6s ease-in-out infinite; }
        `})]})),P2=cn.memo(()=>I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none z-0",children:[I.jsxs("div",{className:"absolute bottom-0 left-0 w-48 h-32",children:[I.jsx("div",{className:"absolute bottom-0 left-4 w-1 h-12 bg-green-400/30 rounded-t-full transform -rotate-12"}),I.jsx("div",{className:"absolute bottom-0 left-8 w-1 h-16 bg-green-400/40 rounded-t-full transform rotate-6"}),I.jsx("div",{className:"absolute bottom-0 left-12 w-1.5 h-20 bg-green-300/50 rounded-t-full transform -rotate-6"}),I.jsx("div",{className:"absolute bottom-16 left-10 text-3xl animate-butterfly-flap",style:{animationDelay:"0.5s"},children:"🦋"})]}),I.jsxs("div",{className:"absolute bottom-0 right-0 w-48 h-40",children:[I.jsx("div",{className:"absolute bottom-0 right-4 w-1 h-16 bg-green-400/30 rounded-t-full transform rotate-12"}),I.jsx("div",{className:"absolute bottom-0 right-8 w-1 h-20 bg-green-400/40 rounded-t-full transform -rotate-6"}),I.jsx("div",{className:"absolute bottom-0 right-12 w-1.5 h-24 bg-green-300/50 rounded-t-full transform rotate-6"}),I.jsx("div",{className:"absolute bottom-20 right-14 text-2xl animate-butterfly-flap",style:{animationDelay:"1.2s"},children:"🦋"})]})]}),I.jsx("style",{children:`
            @keyframes butterfly-flap {
                0%, 100% { transform: scaleY(1) translateY(0) rotate(-15deg); }
                25% { transform: scaleY(0.2) translateY(5px) rotate(-15deg); }
                50% { transform: scaleY(1) translateY(0) rotate(-15deg); }
                75% { transform: scaleY(0.2) translateY(5px) rotate(-15deg); }
            }
            .animate-butterfly-flap {
                animation: butterfly-flap 2.5s ease-in-out infinite;
            }
        `})]})),Cs={id:"theme_default",name:"Default",boardBg:"bg-slate-900",cellBg:"bg-transparent",gridColor:"border-slate-500",nameColor:"text-white"},Z0=[{id:"theme_ice",name:"Ice",boardBg:"bg-[#0c1a3e]",boardBgImage:"assets/themes/ice.png",cellBg:"bg-transparent",gridColor:"border-cyan-400/50",nameColor:"text-cyan-100",decoratorComponent:I2},{id:"theme_retro",name:"Retro",boardBg:"bg-[#281e36]",boardBgImage:"assets/themes/retro.png",cellBg:"bg-transparent",gridColor:"border-yellow-400/50",nameColor:"text-yellow-100",decoratorComponent:S2},{id:"theme_ruby",name:"Ruby",boardBg:"bg-[#3b0f2d]",boardBgImage:"assets/themes/ruby.png",cellBg:"bg-transparent",gridColor:"border-pink-400/50",nameColor:"text-pink-100",decoratorComponent:A2},{id:"theme_autumn",name:"Autumn",boardBg:"bg-[#4a2525]",boardBgImage:"assets/themes/autumn.png",cellBg:"bg-transparent",gridColor:"border-orange-400/50",nameColor:"text-orange-100",decoratorComponent:C2},{id:"theme_spring",name:"Spring",boardBg:"bg-[#4d7c5a]",boardBgImage:"assets/themes/spring.png",cellBg:"bg-transparent",gridColor:"border-pink-200/60",nameColor:"text-pink-50",decoratorComponent:R2},{id:"theme_summer",name:"Summer",boardBg:"bg-[#005f73]",boardBgImage:"assets/themes/summer.png",cellBg:"bg-transparent",gridColor:"border-yellow-200/50",nameColor:"text-yellow-50",decoratorComponent:x2},{id:"theme_winter",name:"Winter",boardBg:"bg-[#1a2b4a]",boardBgImage:"assets/themes/winter.png",cellBg:"bg-transparent",gridColor:"border-blue-200/50",nameColor:"text-blue-100",decoratorComponent:N2},{id:"theme_space",name:"Space",boardBg:"bg-[#0c0a1f]",boardBgImage:"assets/themes/space.png",cellBg:"bg-transparent",gridColor:"border-purple-400/50",nameColor:"text-purple-200",decoratorComponent:D2},{id:"theme_fire",name:"Fire",boardBg:"bg-[#2d0d0d]",boardBgImage:"assets/themes/fire.png",cellBg:"bg-transparent",gridColor:"border-orange-500/50",nameColor:"text-yellow-200",decoratorComponent:k2},{id:"theme_forest",name:"Forest",boardBg:"bg-[#1c3d1c]",boardBgImage:"assets/themes/forest.png",cellBg:"bg-transparent",gridColor:"border-green-400/50",nameColor:"text-green-100",decoratorComponent:P2}],hr={id:"board_default",name:"Default",style:{backgroundColor:"rgba(0, 0, 0, 0.4)",borderColor:"rgba(255, 255, 255, 0.1)",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)",borderWidth:"2px",borderStyle:"solid"}},eE=[{id:"board_ice",name:"Băng giá",style:{backgroundColor:"rgba(2, 6, 23, 0.5)",borderColor:"#22d3ee",boxShadow:"0 0 20px #22d3ee",borderWidth:"2px",borderStyle:"solid"}},{id:"board_fire",name:"Lửa",style:{backgroundColor:"rgba(30, 7, 0, 0.5)",borderColor:"#f87171",boxShadow:"0 0 20px #f87171",borderWidth:"2px",borderStyle:"solid"}},{id:"board_forest",name:"Rừng",style:{backgroundColor:"rgba(4, 20, 10, 0.5)",borderColor:"#34d399",boxShadow:"0 0 20px #34d399",borderWidth:"2px",borderStyle:"solid"}},{id:"board_autumn",name:"Mùa thu",style:{backgroundColor:"rgba(40, 15, 0, 0.5)",borderColor:"#fb923c",boxShadow:"0 0 20px #fb923c",borderWidth:"2px",borderStyle:"solid"}},{id:"board_celestial",name:"Celestial",style:{backgroundColor:"rgba(19, 15, 46, 0.6)",borderColor:"#a78bfa",borderWidth:"2px",borderStyle:"solid",boxShadow:"0 0 25px #a78bfa, inset 0 0 10px rgba(167, 139, 250, 0.5)"}}],Wn={id:"piece_default_x",name:"Cross",component:r2},Vr={id:"piece_default_o",name:"Circle",component:i2},Ts=[{id:"piece_hexagon",name:"Hexagon",component:XO},{id:"piece_triangle",name:"Triangle",component:JO},{id:"piece_plus",name:"Plus",component:ZO},{id:"piece_sun",name:"Sun",component:e2},{id:"piece_ghost",name:"Ghost",component:t2},{id:"piece_peace",name:"Peace Sign",component:n2},{id:"piece_diamond",name:"Diamond",component:s2},{id:"piece_star",name:"Star",component:a2},{id:"piece_heart",name:"Heart",component:o2},{id:"piece_music",name:"Music Note",component:l2},{id:"piece_bolt",name:"Bolt",component:c2},{id:"piece_planet",name:"Planet",component:u2},{id:"piece_shield",name:"Shield",component:h2},{id:"piece_square",name:"Square",component:d2},{id:"piece_anchor",name:"Anchor",component:f2},{id:"piece_bug",name:"Bug",component:m2},{id:"piece_crown",name:"Crown",component:p2},{id:"piece_eye",name:"Eye",component:g2},{id:"piece_flag",name:"Flag",component:_2},{id:"piece_dragon",name:"Dragon",component:y2},{id:"piece_yin_yang",name:"Yin Yang",component:v2},{id:"piece_atom",name:"Atom",component:E2},{id:"piece_biohazard",name:"Biohazard",component:w2},{id:"piece_leaf",name:"Leaf",component:T2},{id:"piece_flower",name:"Flower",component:b2}],Xn={id:"avatar_default",name:"Guest",url:"assets/avatars/avatar_1.png"},Cp=[{id:"avatar_2",name:"Rebel",url:"assets/avatars/avatar_2.png"},{id:"avatar_3",name:"Scholar",url:"assets/avatars/avatar_3.png"},{id:"avatar_4",name:"Ninja",url:"assets/avatars/avatar_4.png"},{id:"avatar_5",name:"Knight",url:"assets/avatars/avatar_5.png"},{id:"avatar_6",name:"Shadow",url:"assets/avatars/avatar_6.png"}],jR=[{id:"emoji_wave",name:"Wave",emoji:"👋"},{id:"emoji_cool",name:"Cool",emoji:"😎"},{id:"emoji_laugh",name:"Laugh",emoji:"😂"},{id:"emoji_wow",name:"Wow",emoji:"😮"},{id:"emoji_think",name:"Thinking",emoji:"🤔"},{id:"emoji_gg",name:"Good Game",emoji:"🤝"},{id:"emoji_thumbs_up",name:"Thumbs Up",emoji:"👍"},{id:"emoji_clap",name:"Clapping",emoji:"👏"},{id:"emoji_fire",name:"Fire",emoji:"🔥"},{id:"emoji_mind_blown",name:"Mind Blown",emoji:"🤯"},{id:"emoji_cry",name:"Crying",emoji:"😭"},{id:"emoji_angry",name:"Angry",emoji:"😠"},{id:"emoji_sleep",name:"Sleeping",emoji:"😴"},{id:"emoji_facepalm",name:"Facepalm",emoji:"🤦"},{id:"emoji_shrug",name:"Shrug",emoji:"🤷"},{id:"emoji_heart",name:"Heart",emoji:"❤️"},{id:"emoji_rocket",name:"Rocket",emoji:"🚀"},{id:"emoji_star_struck",name:"Star-Struck",emoji:"🤩"},{id:"emoji_wink",name:"Wink",emoji:"😉"},{id:"emoji_eyes",name:"Eyes",emoji:"👀"},{id:"emoji_pray",name:"Pray",emoji:"🙏"},{id:"emoji_celebrate",name:"Celebrate",emoji:"🎉"},{id:"emoji_sad",name:"Sad",emoji:"😢"},{id:"emoji_zany",name:"Zany",emoji:"🤪"},{id:"emoji_skull",name:"Skull",emoji:"💀"},{id:"emoji_clown",name:"Clown",emoji:"🤡"},{id:"emoji_fleur",name:"Fleur-de-lis",emoji:"⚜️"},{id:"emoji_dragon",name:"Dragon",emoji:"🐉"},{id:"emoji_robot",name:"Robot",emoji:"🤖"},{id:"emoji_tophat",name:"Top Hat",emoji:"🎩"}],O2=[{id:"anim_emoji_laugh",name:"Laughing GIF",url:"assets/emojis/laughing.gif"},{id:"anim_emoji_smile",name:"Smile",url:"assets/emojis/smile.gif"}],kc=({className:n})=>I.jsx("div",{className:n,children:I.jsx("div",{})}),M2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",children:[I.jsx("path",{d:"M50 10 L50 70 M30 50 L50 70 L70 50",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),I.jsx("circle",{cx:"50",cy:"80",r:"10",fill:"currentColor"})]}),V2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",children:[I.jsx("path",{d:"M 50,50 m -35,0 a 35,35 0 1,0 70,0 a 35,35 0 1,0 -70,0",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeDasharray:"150 220",strokeDashoffset:"0"}),I.jsx("path",{d:"M80 50 L65 40 M80 50 L65 60",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round"})]}),L2=()=>I.jsx("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:I.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"currentColor"})}),U2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-400",children:[I.jsx("circle",{cx:"50",cy:"50",r:"15",stroke:"currentColor",strokeWidth:"4",fill:"none"}),I.jsx("circle",{cx:"50",cy:"50",r:"30",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"4 8"})]}),B2=()=>I.jsx("svg",{viewBox:"0 0 100 100",className:"text-cyan-400",children:I.jsxs("circle",{cx:"50",cy:"50",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none",children:[I.jsx("animate",{attributeName:"r",from:"10",to:"40",dur:"1s",repeatCount:"indefinite",begin:"0s"}),I.jsx("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",repeatCount:"indefinite",begin:"0s"})]})}),F2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-blue-400",children:[I.jsx("path",{d:"M50 10 L50 90 M10 50 L90 50",stroke:"currentColor",strokeWidth:"6",strokeDasharray:"10 15",strokeLinecap:"round"}),I.jsx("circle",{cx:"50",cy:"50",r:"10",fill:"currentColor"})]}),j2=()=>`
  /* Universal Glow for all effects */
  @keyframes piece-glow {
    0%, 100% { filter: drop-shadow(0 0 2px transparent); }
    50% { filter: drop-shadow(0 0 12px currentColor) drop-shadow(0 0 5px currentColor) brightness(1.2); }
  }

  /* Drop: Piece falls from above and lands with a bounce. */
  @keyframes piece-drop-fall {
    0% { transform: translateY(-200%); opacity: 0; }
    80% { transform: translateY(0); opacity: 1; }
    90% { transform: translateY(-10%); }
    100% { transform: translateY(0); }
  }
  .animate-effect_drop { animation: piece-drop-fall 0.4s cubic-bezier(0.5, 0, 0.25, 1.5) forwards; }

  /* Rotate: Spins 360 degrees. */
  @keyframes piece-rotate-spin {
    from { transform: rotate(-360deg) scale(0.5); opacity: 0; }
    to { transform: rotate(0deg) scale(1); opacity: 1; }
  }
  .animate-effect_rotate { animation: piece-rotate-spin 0.35s ease-out forwards; }

  /* Flash: An elegant, bright golden flash that bursts outwards */
  @keyframes piece-flash-burst {
    0% { transform: scale(0); opacity: 0.8; }
    100% { transform: scale(1.8); opacity: 0; }
  }
   @keyframes piece-flash-self {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); filter: brightness(3); }
  }
  .animate-effect_flash { animation: piece-flash-self 0.3s ease-in-out forwards; }
  .animate-effect_flash::after {
    content: '';
    position: absolute;
    inset: -20%;
    border-radius: 99px;
    background: radial-gradient(circle, currentColor 0%, transparent 70%);
    opacity: 0;
    transform: scale(0);
    animation: piece-flash-burst 0.35s ease-out forwards;
  }

  /* Phase: Holographic activation rings, no longer obscures piece */
  @keyframes piece-phase-fade-in {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
  }
  @keyframes piece-phase-rings {
    from { transform: scale(0.5); opacity: 1; }
    to { transform: scale(1.5); opacity: 0; }
  }
  .animate-effect_phase { animation: piece-phase-fade-in 0.4s ease-out forwards; }
  .animate-effect_phase::before, .animate-effect_phase::after {
    content: '';
    position: absolute;
    inset: 0;
    border: 2px solid currentColor;
    border-radius: 99px;
    opacity: 0;
    transform: scale(0.5);
    animation: piece-phase-rings 0.45s ease-out forwards;
  }
  .animate-effect_phase::after { animation-delay: 0.1s; }

  /* Ripple: Expanding shockwave */
  @keyframes piece-ripple {
    from { transform: scale(0); opacity: 0.7; }
    to { transform: scale(3); opacity: 0; }
  }
  .animate-effect_ripple { animation: piece-glow 0.5s ease-out forwards; }
  .animate-effect_ripple::before {
    content: ''; position: absolute; inset: 0; border-radius: 99px;
    border: 3px solid currentColor;
    animation: piece-ripple 0.4s ease-out forwards;
  }

  /* Warp: Scales up from the center. */
  @keyframes piece-warp-in {
    from { transform: scale(0); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }
  .animate-effect_warp { animation: piece-warp-in 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
`,eG=()=>I.jsx("style",{children:j2()}),Lr={id:"effect_flash",name:"Flash",component:kc,previewComponent:L2},tE=[{id:"effect_rotate",name:"Rotate",component:kc,previewComponent:V2},{id:"effect_drop",name:"Drop",component:kc,previewComponent:M2},{id:"effect_phase",name:"Phase",component:kc,previewComponent:U2},{id:"effect_ripple",name:"Ripple",component:kc,previewComponent:B2},{id:"effect_warp",name:"Warp",component:kc,previewComponent:F2}],z2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[I.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"currentColor"}),I.jsx("path",{d:"M20 20 L30 30 M70 30 L80 20 M70 70 L80 80 M20 80 L30 70",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),q2=()=>I.jsx("svg",{viewBox:"0 0 100 100",children:I.jsxs("g",{transform:"translate(15 15) scale(0.7)",children:[I.jsx("rect",{x:"10",y:"20",width:"15",height:"8",fill:"#34D399",transform:"rotate(-30 17.5 24)"}),I.jsx("rect",{x:"50",y:"15",width:"15",height:"8",fill:"#F472B6",transform:"rotate(20 57.5 19)"}),I.jsx("rect",{x:"70",y:"60",width:"15",height:"8",fill:"#60A5FA",transform:"rotate(-10 77.5 64)"}),I.jsx("rect",{x:"25",y:"70",width:"15",height:"8",fill:"#FBBF24",transform:"rotate(40 32.5 74)"})]})}),G2=()=>I.jsx("svg",{viewBox:"0 0 100 100",children:I.jsxs("g",{strokeWidth:"4",strokeLinecap:"round",children:[I.jsx("path",{d:"M50 50 L50 30",stroke:"#F472B6"}),I.jsx("path",{d:"M50 50 L70 50",stroke:"#60A5FA"}),I.jsx("path",{d:"M50 50 L30 50",stroke:"#34D399"}),I.jsx("path",{d:"M50 50 L50 70",stroke:"#FBBF24"})]})}),H2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[I.jsx("path",{d:"M50 10 L55 45 L90 50 L55 55 L50 90 L45 55 L10 50 L45 45 Z",fill:"none",stroke:"currentColor",strokeWidth:"4"}),I.jsx("text",{x:"25",y:"30",fontSize:"30",children:"✨"}),I.jsx("text",{x:"75",y:"75",fontSize:"30",children:"✨"})]}),$2=()=>I.jsx("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:I.jsxs("g",{stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round",children:[I.jsx("path",{d:"M30 70 L30 30 M20 40 L30 30 L40 40"}),I.jsx("path",{d:"M70 70 L70 30 M60 40 L70 30 L80 40"})]})}),K2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-300",children:[I.jsx("path",{d:"M20 80 Q 50 20, 80 80",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round"}),I.jsx("path",{d:"M30 80 Q 50 40, 70 80",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",opacity:"0.6"})]}),Q2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-pink-500",children:[I.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),I.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:"❤️"})]}),W2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-orange-500",children:[I.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),I.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:"🚀"})]}),Y2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-500",children:[I.jsx("path",{d:"M20 50 C 40 30, 60 70, 80 50",stroke:"currentColor",strokeWidth:"6",fill:"none"}),I.jsx("circle",{cx:"15",cy:"50",r:"8",fill:"currentColor"})]}),X2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-slate-300",children:[I.jsx("path",{d:"M10 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"}),I.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"30",children:"👻"})]}),J2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-purple-400",children:[I.jsx("circle",{cx:"50",cy:"50",r:"25",fill:"black"}),I.jsx("path",{d:"M 50,50 m -15,0 a 15,15 0 1,0 30,0 a 15,15 0 1,0 -30,0",stroke:"currentColor",strokeWidth:"4",fill:"none",transform:"rotate(45 50 50)",strokeDasharray:"10 10"})]}),Z2=()=>I.jsxs("svg",{viewBox:"0 0 100 100",className:"text-yellow-400",children:[I.jsx("path",{d:"M10 50 L 30 50 L 25 30 L 45 70 L 40 50 L 60 50",stroke:"currentColor",strokeWidth:"6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),I.jsx("path",{d:"M60 50 L 90 50 M80 40 L90 50 L80 60",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round"})]}),eM=()=>I.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:Array(30).fill(0).map((n,e)=>I.jsx("div",{className:"absolute w-2 h-2 bg-yellow-300 rounded-full animate-particle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`}},e))}),tM=()=>I.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:[...Array(50)].map((n,e)=>I.jsx("div",{className:"absolute h-4 animate-confetti",style:{width:"8px",left:`${Math.random()*100}%`,animationDelay:`${Math.random()*.2}s`,animationDuration:`${2+Math.random()*2}s`,backgroundColor:["#34D399","#F472B6","#60A5FA","#FBBF24"][e%4]}},e))}),nM=()=>{const n=["#F472B6","#60A5FA","#34D399","#FBBF24","#A78BFA","#FDE047"],e=[{delay:.2,scale:1,left:"45%",top:"40%"},{delay:.7,scale:.8,left:"65%",top:"50%"},{delay:1.2,scale:1.2,left:"35%",top:"30%"},{delay:1.6,scale:.9,left:"55%",top:"60%"},{delay:2,scale:1.1,left:"40%",top:"55%"}];return I.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:e.map((t,i)=>I.jsx("div",{className:"absolute animate-firework-container",style:{left:t.left,top:t.top,transform:`scale(${t.scale})`,animationDelay:`${t.delay}s`},children:[...Array(35)].map((s,o)=>{const c=Math.random()*360,h=60+Math.random()*70;return I.jsx("div",{className:"absolute w-2 h-2 rounded-full animate-firework-particle",style:{backgroundColor:n[o%n.length],"--angle":`${c}deg`,"--distance":`${h}px`,"--duration":`${.9+Math.random()*.5}s`}},o)})},i))})},iM=()=>I.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:Array(25).fill(0).map((n,e)=>I.jsx("div",{className:"animate-starlight",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,transform:`scale(${.5+Math.random()*.5})`},children:"✨"},e))}),rM=()=>I.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 overflow-hidden",children:[...Array(15)].map((n,e)=>I.jsx("div",{className:"absolute bottom-0 w-2 animate-ascension-beam",style:{left:`${5+Math.random()*90}%`,animationDelay:`${Math.random()*2.5}s`,animationDuration:`${2.5+Math.random()*2}s`}},e))}),sM=()=>I.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 flex items-center justify-center",children:I.jsxs("div",{className:"relative w-[40vmin] h-[40vmin]",children:[I.jsx("div",{className:"absolute inset-0 rounded-full animate-aura-rise-1"}),I.jsx("div",{className:"absolute inset-0 rounded-full animate-aura-rise-2"}),I.jsx("div",{className:"absolute inset-0 rounded-full animate-aura-rise-3"})]})}),Ji=n=>n?{x:n.left+n.width/2,y:n.top+n.height/2}:{x:0,y:0},aM=({winnerCoords:n,loserCoords:e})=>{const t=Ji(n),i=Ji(e);return!n||!e?null:I.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[I.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:"❤️"}),I.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},oM=({winnerCoords:n,loserCoords:e})=>{const t=Ji(n),i=Ji(e);return!n||!e?null:I.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[I.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:"🚀"}),I.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},lM=({winnerCoords:n,loserCoords:e})=>{const t=Ji(n),i=Ji(e);return!n||!e?null:I.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[I.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-purple-500 animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}}),I.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},cM=({winnerCoords:n,loserCoords:e})=>{const t=Ji(n),i=Ji(e);return!n||!e?null:I.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[I.jsx("div",{className:"absolute text-5xl animate-boom-travel-vanish",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:"👻"}),I.jsx("div",{className:"animate-boom-ghost-wail",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:[...Array(8)].map((s,o)=>I.jsx("div",{className:"absolute text-2xl top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",style:{transform:`rotate(${o*45}deg) translateY(-50px)`},children:"👻"},o))})]})},uM=({winnerCoords:n,loserCoords:e})=>{const t=Ji(n),i=Ji(e);return!n||!e?null:I.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[I.jsx("div",{className:"absolute w-8 h-8 rounded-full bg-black border-2 border-purple-500 animate-boom-void-travel",style:{"--start-x":`${t.x}px`,"--start-y":`${t.y}px`,"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}}),I.jsxs("div",{className:"w-48 h-48 animate-boom-void-impact-container",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`},children:[I.jsx("div",{className:"absolute inset-0 animate-boom-void-black-hole"}),I.jsx("div",{className:"absolute inset-0 animate-boom-void-particles",children:[...Array(12)].map((s,o)=>I.jsx("div",{className:"absolute w-1 h-8 bg-purple-400 animate-boom-void-particle",style:{"--i":o}},o))})]})]})},hM=({winnerCoords:n,loserCoords:e})=>{const t=Ji(n),i=Ji(e);if(!n||!e)return null;const s=Math.atan2(i.y-t.y,i.x-t.x)*180/Math.PI,o=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2)),c=ye.useMemo(()=>{let h="M0 0";const d=Math.max(8,Math.floor(o/40)),p=20,_=o/d;for(let v=1;v<=d;v++){const T=_*v,R=v===d?0:(Math.random()-.5)*p;h+=` L${T.toFixed(2)} ${R.toFixed(2)}`}return h},[o]);return I.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[I.jsxs("svg",{className:"absolute w-full h-full overflow-visible",children:[I.jsx("defs",{children:I.jsxs("filter",{id:"thunder-glow",children:[I.jsx("feGaussianBlur",{stdDeviation:"3.5",result:"coloredBlur"}),I.jsxs("feMerge",{children:[I.jsx("feMergeNode",{in:"coloredBlur"}),I.jsx("feMergeNode",{in:"SourceGraphic"})]})]})}),I.jsx("path",{d:c,stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",className:"animate-boom-thunderclap-bolt",style:{"--distance":o,filter:"url(#thunder-glow)"},transform:`translate(${t.x}, ${t.y}) rotate(${s})`})]}),I.jsx("div",{className:"animate-boom-impact",style:{"--end-x":`${i.x}px`,"--end-y":`${i.y}px`}})]})},dM=()=>`
  /* Victory: Default Particle Burst */
  @keyframes particle { 0% { transform: scale(1) translateY(0); opacity: 1; } 100% { transform: scale(0) translateY(-100px); opacity: 0; } }
  .animate-particle { animation: particle 2s ease-out forwards; }
  /* Victory: Confetti */
  @keyframes confetti-fall { from { transform: translateY(-20vh) rotate(0deg); } to { transform: translateY(100vh) rotate(1080deg); } }
  .animate-confetti { animation: confetti-fall linear infinite; }
  /* Victory: Starlight */
  @keyframes starlight-twinkle { 0%, 100% { transform: scale(0.5); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 1; filter: drop-shadow(0 0 5px currentColor); } }
  .animate-starlight { position: absolute; color: #fef08a; font-size: 1.5rem; animation: starlight-twinkle 2s ease-in-out infinite; }
  
  /* Victory: Fireworks */
  @keyframes firework-burst {
    0% { transform: rotate(var(--angle)) translateY(0) scale(1.5); opacity: 1; }
    100% { transform: rotate(var(--angle)) translateY(var(--distance)) scale(0); opacity: 0; }
  }
  .animate-firework-particle {
    animation: firework-burst var(--duration) cubic-bezier(0.2, 0.8, 0.7, 1) forwards;
    filter: drop-shadow(0 0 4px currentColor);
  }
  .animate-firework-container { opacity: 0; animation: firework-fade-in 0.1s linear forwards; animation-delay: inherit; }
  @keyframes firework-fade-in { to { opacity: 1; } }

  /* Victory: Ascension */
  @keyframes light-beam-rise {
    from { transform: translateY(0) scaleY(1); opacity: 0; }
    20% { opacity: 0.7; }
    80% { opacity: 0.7; }
    to { transform: translateY(-100vh) scaleY(3); opacity: 0; }
  }
  .animate-ascension-beam {
    height: 30vh;
    background: linear-gradient(to top, rgba(253, 224, 71, 0), rgba(253, 224, 71, 0.6), rgba(253, 224, 71, 0));
    filter: drop-shadow(0 0 6px #fde047);
    animation: light-beam-rise ease-in forwards;
  }
  
  /* Victory: Aura Rise */
      @keyframes aura-rise-anim {
          from {
              transform: scale(0.2);
              opacity: 1;
          }
          to {
              transform: scale(2);
              opacity: 0;
          }
      }
      .animate-aura-rise-1, .animate-aura-rise-2, .animate-aura-rise-3 {
          border: 3px solid;
          animation: aura-rise-anim 2s cubic-bezier(0.25, 1, 0.5, 1) forwards;
      }
      .animate-aura-rise-1 {
          border-color: #fef08a; /* yellow-200 */
          filter: drop-shadow(0 0 10px #fef08a);
      }
      .animate-aura-rise-2 {
          border-color: #fde047; /* yellow-300 */
          filter: drop-shadow(0 0 15px #fde047);
          animation-delay: 0.15s;
      }
      .animate-aura-rise-3 {
          border-color: #facc15; /* yellow-400 */
          filter: drop-shadow(0 0 20px #facc15);
          animation-delay: 0.3s;
      }

  /* Boom: Projectile Travel & Vanish (FIXED: Centered and vanishes on impact) */
  @keyframes boom-travel-vanish {
    0% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
    10% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(1); opacity: 1; }
    89% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1); opacity: 1; }
    100% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1.5); opacity: 0; }
  }
  .animate-boom-travel-vanish {
    position: fixed; top: 0; left: 0;
    animation: boom-travel-vanish 1s ease-in-out forwards;
  }
  
  /* Boom: Impact flash at destination */
  @keyframes boom-impact-flash { 
      0% { transform: translate(-50%,-50%) scale(0); opacity: 1; filter: brightness(1.5); } 
      50% { filter: brightness(2.5); }
      100% { transform: translate(-50%,-50%) scale(3); opacity: 0; filter: brightness(1); } 
  }
  .animate-boom-impact {
    position: fixed;
    left: var(--end-x); top: var(--end-y);
    width: 100px; height: 100px; border-radius: 99px;
    background: radial-gradient(circle, white 0%, #FFD700 40%, #FF8C00 70%, transparent 85%);
    transform: translate(-50%, -50%);
    opacity: 0;
    animation: boom-impact-flash 0.4s ease-out forwards;
    animation-delay: 0.85s; /* Delay until travel is almost complete */
  }

  /* Boom: Ghostly Wail Impact */
  @keyframes boom-ghost-wail-anim {
      from { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 1; }
      to { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 0; }
  }
  .animate-boom-ghost-wail {
      position: fixed;
      left: var(--end-x); top: var(--end-y);
      width: 150px; height: 150px;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      animation: boom-ghost-wail-anim 0.8s ease-out forwards;
      animation-delay: 0.85s;
  }

  /* Boom: Void Collapse */
  @keyframes boom-void-travel-anim {
      0% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
      10% { transform: translate(var(--start-x), var(--start-y)) translate(-50%, -50%) scale(1); opacity: 1; }
      89% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(var(--end-x), var(--end-y)) translate(-50%, -50%) scale(0.5); opacity: 0; }
  }
  .animate-boom-void-travel {
      position: fixed; top: 0; left: 0;
      filter: drop-shadow(0 0 8px #a855f7);
      animation: boom-void-travel-anim 1s ease-in-out forwards;
  }
  .animate-boom-void-impact-container {
      position: fixed;
      top: var(--end-y);
      left: var(--end-x);
      transform: translate(-50%, -50%);
      opacity: 0;
      animation: firework-fade-in 0.1s linear forwards;
      animation-delay: 0.85s;
  }
  @keyframes boom-void-black-hole-anim {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 0.5; }
    30% { transform: translate(-50%, -50%) scale(0.6); opacity: 1; }
    100% { transform: translate(-50%, -50%) scale(0.5) rotate(90deg); opacity: 1; }
  }
  .animate-boom-void-black-hole {
    position: absolute; top: 50%; left: 50%;
    width: 100%; height: 100%;
    transform-origin: center;
    transform: translate(-50%, -50%) scale(0);
    background: radial-gradient(circle, #2d0b45 10%, black 60%);
    border-radius: 50%;
    filter: blur(8px);
    animation: boom-void-black-hole-anim 0.8s ease-out forwards;
  }
  @keyframes boom-void-particles-rotate {
      from { transform: scale(1.5) rotate(0deg); }
      to { transform: scale(1.5) rotate(-360deg); }
  }
  .animate-boom-void-particles {
      transform-origin: center;
      animation: boom-void-particles-rotate 0.8s ease-in forwards;
  }
  @keyframes boom-void-particle-suck {
      from { transform: rotate(calc(var(--i) * 30deg)) translateY(0) scaleY(1); opacity: 1; }
      to { transform: rotate(calc(var(--i) * 30deg)) translateY(-70px) scaleY(0.2); opacity: 0; }
  }
  .animate-boom-void-particle {
      top: 50%; left: 50%;
      transform-origin: center bottom;
      animation: boom-void-particle-suck 0.5s ease-in forwards;
  }

  /* Boom: Thunderclap */
  @keyframes boom-thunderclap-bolt-anim {
      0% { stroke-dasharray: 0, var(--distance); }
      30% { stroke-dasharray: var(--distance), var(--distance); }
      100% { stroke-dasharray: var(--distance), var(--distance); opacity: 0; }
  }
  .animate-boom-thunderclap-bolt {
      animation: boom-thunderclap-bolt-anim 1s ease-out forwards;
  }
`,tG=()=>I.jsx("style",{children:dM()}),Ur={id:"victory_default",name:"Glimmer",component:eM,previewComponent:z2},td=[{id:"victory_confetti",name:"Confetti",component:tM,previewComponent:q2},{id:"victory_fireworks",name:"Fireworks",component:nM,previewComponent:G2},{id:"victory_starlight",name:"Starlight",component:iM,previewComponent:H2},{id:"victory_ascension",name:"Ascension",component:rM,previewComponent:$2},{id:"victory_aurarise",name:"Aura Rise",component:sM,previewComponent:K2}],Br={id:"boom_heart",name:"Heart",component:aM,previewComponent:Q2},nd=[{id:"boom_rocket",name:"Rocket Barrage",component:oM,previewComponent:W2},{id:"boom_missile",name:"Magic Missile",component:lM,previewComponent:Y2},{id:"boom_ghost",name:"Ghostly Wail",component:cM,previewComponent:X2},{id:"boom_void_collapse",name:"Void Collapse",component:uM,previewComponent:J2},{id:"boom_thunderclap",name:"Thunderclap",component:hM,previewComponent:Z2}],YS=[{id:"bot_easy",name:"Meow",avatar:"assets/avatars/bot_1.png",level:2,skillLevel:"easy",description:"Một chú mèo nhỏ mới tập chơi! Tuyệt vời cho những màn đấu không căng não.",cp:550},{id:"bot_medium",name:"Nova",avatar:"assets/avatars/bot_2.png",level:10,skillLevel:"medium",description:"Một cô gái xinh đẹp đã thành thạo chiến lược. Hứa hẹn một ván đấu mãn nhãn.",cp:1150},{id:"bot_hard",name:"Kael",avatar:"assets/avatars/bot_3.png",level:15,skillLevel:"hard",description:"Một hacker trẻ, suy nghĩ rất kỹ trước khi hành động, thất bại là điều hiển nhiên.",cp:1750}],fM=[{id:"music_default",name:"Celestial",url:"assets/sounds/music.mp3"},{id:"music_chill",name:"Chillhop",url:"assets/sounds/music_1.mp3"},{id:"music_action",name:"Action",url:"assets/sounds/music_2.mp3"},{id:"music_synth",name:"Synthwave",url:"assets/sounds/music_3.mp3"}],fr=[{id:Cs.id,name:Cs.name,type:"theme",price:0,item:Cs},...Z0.map(n=>({id:n.id,name:n.name,type:"theme",price:500,item:n})),{id:hr.id,name:hr.name,type:"board",price:0,item:hr},...eE.map(n=>({id:n.id,name:n.name,type:"board",price:n.id==="board_celestial"?900:800,item:n})),{id:Xn.id,name:Xn.name,type:"avatar",price:0,item:Xn},...Cp.filter(n=>n.id!=="avatar_6").map(n=>({id:n.id,name:n.name,type:"avatar",price:300,item:n})),{id:"avatar_6",name:"Shadow",type:"avatar",price:500,item:Cp.find(n=>n.id==="avatar_6")},{id:Wn.id,name:Wn.name,type:"piece",price:0,item:Wn},{id:Vr.id,name:Vr.name,type:"piece",price:0,item:Vr},...Ts.filter(n=>!["piece_dragon","piece_yin_yang","piece_atom","piece_biohazard","piece_leaf","piece_flower"].includes(n.id)).map(n=>({id:n.id,name:n.name,type:"piece",price:250,item:n})),{id:"piece_dragon",name:"Dragon",type:"piece",price:750,item:Ts.find(n=>n.id==="piece_dragon")},{id:"piece_yin_yang",name:"Yin Yang",type:"piece",price:600,item:Ts.find(n=>n.id==="piece_yin_yang")},{id:"piece_atom",name:"Atom",type:"piece",price:600,item:Ts.find(n=>n.id==="piece_atom")},{id:"piece_biohazard",name:"Biohazard",type:"piece",price:600,item:Ts.find(n=>n.id==="piece_biohazard")},{id:"piece_leaf",name:"Leaf",type:"piece",price:650,item:Ts.find(n=>n.id==="piece_leaf")},{id:"piece_flower",name:"Flower",type:"piece",price:650,item:Ts.find(n=>n.id==="piece_flower")},{id:Lr.id,name:Lr.name,type:"effect",price:0,item:Lr},...tE.map(n=>({id:n.id,name:n.name,type:"effect",price:400,item:n})),{id:Ur.id,name:Ur.name,type:"victory",price:0,item:Ur},...td.filter(n=>!["victory_ascension","victory_aurarise"].includes(n.id)).map(n=>({id:n.id,name:n.name,type:"victory",price:750,item:n})),{id:"victory_ascension",name:"Ascension",type:"victory",price:900,item:td.find(n=>n.id==="victory_ascension")},{id:"victory_aurarise",name:"Aura Rise",type:"victory",price:950,item:td.find(n=>n.id==="victory_aurarise")},{id:Br.id,name:Br.name,type:"boom",price:0,item:Br},...nd.filter(n=>!["boom_void_collapse","boom_thunderclap"].includes(n.id)).map(n=>({id:n.id,name:n.name,type:"boom",price:1e3,item:n})),{id:"boom_void_collapse",name:"Void Collapse",type:"boom",price:1200,item:nd.find(n=>n.id==="boom_void_collapse")},{id:"boom_thunderclap",name:"Thunderclap",type:"boom",price:1100,item:nd.find(n=>n.id==="boom_thunderclap")},...jR.map(n=>({id:n.id,name:n.name,type:"emoji",price:10,item:n})),...O2.map(n=>({id:n.id,name:n.name,type:"animated_emoji",price:20,item:n}))];var XS={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue=function(n,e){if(!n)throw gu(e)},gu=function(n){return new Error("Firebase Database ("+zR.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},mM=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],c=n[t++],h=n[t++],d=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],c=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return e.join("")},nE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],c=s+1<n.length,h=c?n[s+1]:0,d=s+2<n.length,p=d?n[s+2]:0,_=o>>2,v=(o&3)<<4|h>>4;let T=(h&15)<<2|p>>6,R=p&63;d||(R=64,c||(T=64)),i.push(t[_],t[v],t[T],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],h=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||h==null||p==null||v==null)throw new pM;const T=o<<2|h>>4;if(i.push(T),p!==64){const R=h<<4&240|p>>2;if(i.push(R),v!==64){const P=p<<6&192|v;i.push(P)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class pM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GR=function(n){const e=qR(n);return nE.encodeByteArray(e,!0)},Rp=function(n){return GR(n).replace(/\./g,"")},xp=function(n){try{return nE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(n){return _d(void 0,n)}function _d(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!_M(t)||(n[t]=_d(n[t],e[t]));return n}function _M(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM=()=>HR().__FIREBASE_DEFAULTS__,vM=()=>{if(typeof process>"u"||typeof XS>"u")return;const n=XS.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},EM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&xp(n[1]);return e&&JSON.parse(e)},iE=()=>{try{return yM()||vM()||EM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$R=()=>{var n;return(n=iE())===null||n===void 0?void 0:n.config},wM=n=>{var e;return(e=iE())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Rp(JSON.stringify(t)),Rp(JSON.stringify(c)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function sE(){var n;const e=(n=iE())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TM(){return typeof window<"u"||QR()}function QR(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function bM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WR(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ug(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function YR(){const n=Ot();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function IM(){return zR.NODE_ADMIN===!0}function XR(){return!sE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function yd(){try{return typeof indexedDB=="object"}catch{return!1}}function SM(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM="FirebaseError";class Jn extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=AM,Object.setPrototypeOf(this,Jn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Al.prototype.create)}}class Al{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],c=o?CM(o,i):"Error",h=`${this.serviceName}: ${c} (${s}).`;return new Jn(s,h,i)}}function CM(n,e){return n.replace(RM,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const RM=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(n){return JSON.parse(n)}function on(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=vd(xp(o[0])||""),t=vd(xp(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},xM=function(n){const e=JR(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},NM=function(n){const e=JR(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function cl(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Np(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Dp(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ed(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],c=e[s];if(JS(o)&&JS(c)){if(!Ed(o,c))return!1}else if(o!==c)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function JS(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cl(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Uc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Qh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let v=0;v<16;v++)i[v]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let v=0;v<16;v++)i[v]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let v=16;v<80;v++){const T=i[v-3]^i[v-8]^i[v-14]^i[v-16];i[v]=(T<<1|T>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],c=this.chain_[2],h=this.chain_[3],d=this.chain_[4],p,_;for(let v=0;v<80;v++){v<40?v<20?(p=h^o&(c^h),_=1518500249):(p=o^c^h,_=1859775393):v<60?(p=o&c|h&(o|c),_=2400959708):(p=o^c^h,_=3395469782);const T=(s<<5|s>>>27)+p+d+_+i[v]&4294967295;d=h,h=c,c=(o<<30|o>>>2)&4294967295,o=s,s=T}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let c=this.inbuf_;for(;s<t;){if(c===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[c]=e.charCodeAt(s),++c,++s,c===this.blockSize){this.compress_(o),c=0;break}}else for(;s<t;)if(o[c]=e[s],++c,++s,c===this.blockSize){this.compress_(o),c=0;break}}this.inbuf_=c,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function ZR(n,e){const t=new kM(n,e);return t.subscribe.bind(t)}class kM{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");PM(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=vv),s.error===void 0&&(s.error=vv),s.complete===void 0&&(s.complete=vv);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function PM(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function vv(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke=function(n,e,t,i){let s;if(i<e?s="at least "+e:i>t&&(s=t===0?"none":"no more than "+t),s){const o=n+" failed: Was called with "+i+(i===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(o)}};function gi(n,e){return`${n} failed: ${e} argument `}function vn(n,e,t,i){if(!(i&&!t)&&typeof t!="function")throw new Error(gi(n,e)+"must be a valid function.")}function ZS(n,e,t,i){if(t&&(typeof t!="object"||t===null))throw new Error(gi(n,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,ue(i<n.length,"Surrogate pair missing trail surrogate.");const c=n.charCodeAt(i)-56320;s=65536+(o<<10)+c}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},hg=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(n){return n&&n._delegate?n._delegate:n}class _i{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new hi;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VM(e))try{this.getOrInitializeService({instanceIdentifier:Ko})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=Ko){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ko){return this.instances.has(e)}getOptions(e=Ko){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&c.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:MM(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ko){return this.component?this.component.multipleInstances?e:Ko:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MM(n){return n===Ko?void 0:n}function VM(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Hv(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=[];var Ge;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ge||(Ge={}));const e1={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},LM=Ge.INFO,UM={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},BM=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=UM[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _u{constructor(e){this.name=e,this._logLevel=LM,this._logHandler=BM,this._userLogHandler=null,oE.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}function FM(n){oE.forEach(e=>{e.setLogLevel(n)})}function jM(n,e){for(const t of oE){let i=null;e&&e.level&&(i=e1[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(s,o,...c)=>{const h=c.map(d=>{if(d==null)return null;if(typeof d=="string")return d;if(typeof d=="number"||typeof d=="boolean")return d.toString();if(d instanceof Error)return d.message;try{return JSON.stringify(d)}catch{return null}}).filter(d=>d).join(" ");o>=(i??s.logLevel)&&n({level:Ge[o].toLowerCase(),message:h,args:c,type:s.name})}}}const zM=(n,e)=>e.some(t=>n instanceof t);let eA,tA;function qM(){return eA||(eA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GM(){return tA||(tA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const t1=new WeakMap,$v=new WeakMap,n1=new WeakMap,Ev=new WeakMap,lE=new WeakMap;function HM(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(za(n.result)),s()},c=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&t1.set(t,n)}).catch(()=>{}),lE.set(e,n),e}function $M(n){if($v.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),s()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});$v.set(n,e)}let Kv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return $v.get(n);if(e==="objectStoreNames")return n.objectStoreNames||n1.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return za(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KM(n){Kv=n(Kv)}function QM(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(wv(this),e,...t);return n1.set(i,e.sort?e.sort():[e]),za(i)}:GM().includes(n)?function(...e){return n.apply(wv(this),e),za(t1.get(this))}:function(...e){return za(n.apply(wv(this),e))}}function WM(n){return typeof n=="function"?QM(n):(n instanceof IDBTransaction&&$M(n),zM(n,qM())?new Proxy(n,Kv):n)}function za(n){if(n instanceof IDBRequest)return HM(n);if(Ev.has(n))return Ev.get(n);const e=WM(n);return e!==n&&(Ev.set(n,e),lE.set(e,n)),e}const wv=n=>lE.get(n);function YM(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const c=indexedDB.open(n,e),h=za(c);return i&&c.addEventListener("upgradeneeded",d=>{i(za(c.result),d.oldVersion,d.newVersion,za(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const XM=["get","getKey","getAll","getAllKeys","count"],JM=["put","add","delete","clear"],Tv=new Map;function nA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Tv.get(e))return Tv.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=JM.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||XM.includes(t)))return;const o=async function(c,...h){const d=this.transaction(c,s?"readwrite":"readonly");let p=d.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),s&&d.done]))[0]};return Tv.set(e,o),o}KM(n=>({...n,get:(e,t,i)=>nA(e,t)||n.get(e,t,i),has:(e,t)=>!!nA(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(eV(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function eV(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const kp="@firebase/app",Qv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=new _u("@firebase/app"),tV="@firebase/app-compat",nV="@firebase/analytics-compat",iV="@firebase/analytics",rV="@firebase/app-check-compat",sV="@firebase/app-check",aV="@firebase/auth",oV="@firebase/auth-compat",lV="@firebase/database",cV="@firebase/data-connect",uV="@firebase/database-compat",hV="@firebase/functions",dV="@firebase/functions-compat",fV="@firebase/installations",mV="@firebase/installations-compat",pV="@firebase/messaging",gV="@firebase/messaging-compat",_V="@firebase/performance",yV="@firebase/performance-compat",vV="@firebase/remote-config",EV="@firebase/remote-config-compat",wV="@firebase/storage",TV="@firebase/storage-compat",bV="@firebase/firestore",IV="@firebase/vertexai-preview",SV="@firebase/firestore-compat",AV="firebase",CV="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa="[DEFAULT]",RV={[kp]:"fire-core",[tV]:"fire-core-compat",[iV]:"fire-analytics",[nV]:"fire-analytics-compat",[sV]:"fire-app-check",[rV]:"fire-app-check-compat",[aV]:"fire-auth",[oV]:"fire-auth-compat",[lV]:"fire-rtdb",[cV]:"fire-data-connect",[uV]:"fire-rtdb-compat",[hV]:"fire-fn",[dV]:"fire-fn-compat",[fV]:"fire-iid",[mV]:"fire-iid-compat",[pV]:"fire-fcm",[gV]:"fire-fcm-compat",[_V]:"fire-perf",[yV]:"fire-perf-compat",[vV]:"fire-rc",[EV]:"fire-rc-compat",[wV]:"fire-gcs",[TV]:"fire-gcs-compat",[bV]:"fire-fst",[SV]:"fire-fst-compat",[IV]:"fire-vertex","fire-js":"fire-js",[AV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=new Map,Qc=new Map,Wc=new Map;function wd(n,e){try{n.container.addComponent(e)}catch(t){Ns.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function i1(n,e){n.container.addOrOverwriteComponent(e)}function Ds(n){const e=n.name;if(Wc.has(e))return Ns.debug(`There were multiple attempts to register component ${e}.`),!1;Wc.set(e,n);for(const t of Wa.values())wd(t,n);for(const t of Qc.values())wd(t,n);return!0}function r1(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function xV(n,e,t=Qa){r1(n,e).clearInstance(t)}function s1(n){return n.options!==void 0}function Ft(n){return n.settings!==void 0}function NV(){Wc.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new Al("app","Firebase",DV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a1=class{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV extends a1{constructor(e,t,i,s){const o=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,c={name:i,automaticDataCollectionEnabled:o};if(e.apiKey!==void 0)super(e,c,s);else{const h=e;super(h.options,c,s)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:o},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Di(kp,Qv,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){uE(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Xi.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=CV;function cE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Qa,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Xi.create("bad-app-name",{appName:String(s)});if(t||(t=$R()),!t)throw Xi.create("no-options");const o=Wa.get(s);if(o){if(Ed(t,o.options)&&Ed(i,o.config))return o;throw Xi.create("duplicate-app",{appName:s})}const c=new aE(s);for(const d of Wc.values())c.addComponent(d);const h=new a1(t,i,c);return Wa.set(s,h),h}function PV(n,e){if(TM()&&!QR())throw Xi.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;s1(n)?t=n.options:t=n;const i=Object.assign(Object.assign({},e),t);i.releaseOnDeref!==void 0&&delete i.releaseOnDeref;const s=p=>[...p].reduce((_,v)=>Math.imul(31,_)+v.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Xi.create("finalization-registry-not-supported",{});const o=""+s(JSON.stringify(i)),c=Qc.get(o);if(c)return c.incRefCount(e.releaseOnDeref),c;const h=new aE(o);for(const p of Wc.values())h.addComponent(p);const d=new kV(t,e,o,h);return Qc.set(o,d),d}function OV(n=Qa){const e=Wa.get(n);if(!e&&n===Qa&&$R())return cE();if(!e)throw Xi.create("no-app",{appName:n});return e}function MV(){return Array.from(Wa.values())}async function uE(n){let e=!1;const t=n.name;Wa.has(t)?(e=!0,Wa.delete(t)):Qc.has(t)&&n.decRefCount()<=0&&(Qc.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(i=>i.delete())),n.isDeleted=!0)}function Di(n,e,t){var i;let s=(i=RV[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const h=[`Unable to register library "${s}" with version "${e}":`];o&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&h.push("and"),c&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ns.warn(h.join(" "));return}Ds(new _i(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function o1(n,e){if(n!==null&&typeof n!="function")throw Xi.create("invalid-log-argument");jM(n,e)}function l1(n){FM(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV="firebase-heartbeat-database",LV=1,Td="firebase-heartbeat-store";let bv=null;function c1(){return bv||(bv=YM(VV,LV,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Td)}catch(t){console.warn(t)}}}}).catch(n=>{throw Xi.create("idb-open",{originalErrorMessage:n.message})})),bv}async function UV(n){try{const t=(await c1()).transaction(Td),i=await t.objectStore(Td).get(u1(n));return await t.done,i}catch(e){if(e instanceof Jn)Ns.warn(e.message);else{const t=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ns.warn(t.message)}}}async function iA(n,e){try{const i=(await c1()).transaction(Td,"readwrite");await i.objectStore(Td).put(e,u1(n)),await i.done}catch(t){if(t instanceof Jn)Ns.warn(t.message);else{const i=Xi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ns.warn(i.message)}}}function u1(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=1024,FV=720*60*60*1e3;class jV{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new qV(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=rA();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const h=new Date(c.date).valueOf();return Date.now()-h<=FV}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Ns.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=rA(),{heartbeatsToSend:i,unsentEntries:s}=zV(this._heartbeatsCache.heartbeats),o=Rp(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Ns.warn(t),""}}}function rA(){return new Date().toISOString().substring(0,10)}function zV(n,e=BV){const t=[];let i=n.slice();for(const s of n){const o=t.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),sA(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),sA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class qV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return yd()?SM().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await UV(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return iA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return iA(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function sA(n){return Rp(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(n){Ds(new _i("platform-logger",e=>new ZM(e),"PRIVATE")),Ds(new _i("heartbeat",e=>new jV(e),"PRIVATE")),Di(kp,Qv,n),Di(kp,Qv,"esm2017"),Di("fire-js","")}GV("");const HV=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Jn,SDK_VERSION:Vs,_DEFAULT_ENTRY_NAME:Qa,_addComponent:wd,_addOrOverwriteComponent:i1,_apps:Wa,_clearComponents:NV,_components:Wc,_getProvider:r1,_isFirebaseApp:s1,_isFirebaseServerApp:Ft,_registerComponent:Ds,_removeServiceInstance:xV,_serverApps:Qc,deleteApp:uE,getApp:OV,getApps:MV,initializeApp:cE,initializeServerApp:PV,onLog:o1,registerVersion:Di,setLogLevel:l1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e,t){this._delegate=e,this.firebase=t,wd(e,new _i("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),uE(this._delegate)))}_getService(e,t=Qa){var i;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((i=s.getComponent())===null||i===void 0?void 0:i.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:t})}_removeServiceInstance(e,t=Qa){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){wd(this._delegate,e)}_addOrOverwriteComponent(e){i1(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},aA=new Al("app-compat","Firebase",KV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QV(n){const e={},t={__esModule:!0,initializeApp:o,app:s,registerVersion:Di,setLogLevel:l1,onLog:o1,apps:null,SDK_VERSION:Vs,INTERNAL:{registerComponent:h,removeApp:i,useAsService:d,modularAPIs:HV}};t.default=t,Object.defineProperty(t,"apps",{get:c});function i(p){delete e[p]}function s(p){if(p=p||Qa,!ki(e,p))throw aA.create("no-app",{appName:p});return e[p]}s.App=n;function o(p,_={}){const v=cE(p,_);if(ki(e,v.name))return e[v.name];const T=new n(v,t);return e[v.name]=T,T}function c(){return Object.keys(e).map(p=>e[p])}function h(p){const _=p.name,v=_.replace("-compat","");if(Ds(p)&&p.type==="PUBLIC"){const T=(R=s())=>{if(typeof R[v]!="function")throw aA.create("invalid-app-argument",{appName:_});return R[v]()};p.serviceProps!==void 0&&_d(T,p.serviceProps),t[v]=T,n.prototype[v]=function(...R){return this._getService.bind(this,_).apply(this,p.multipleInstances?R:[])}}return p.type==="PUBLIC"?t[v]:null}function d(p,_){return _==="serverAuth"?null:_}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(){const n=QV($V);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:h1,extendNamespace:e,createSubscribe:ZR,ErrorFactory:Al,deepExtend:_d});function e(t){_d(n,t)}return n}const WV=h1();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=new _u("@firebase/app-compat"),YV="@firebase/app-compat",XV="0.2.43";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JV(n){Di(YV,XV,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=HR();if(n.firebase!==void 0){oA.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&oA.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Ye=WV;JV();var ZV="firebase",eL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ye.registerVersion(ZV,eL,"app-compat");function hE(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}const Vh={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Ac={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function d1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nL=tL,iL=d1,f1=new Al("auth","Firebase",d1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp=new _u("@firebase/auth");function rL(n,...e){Pp.logLevel<=Ge.WARN&&Pp.warn(`Auth (${Vs}): ${n}`,...e)}function pp(n,...e){Pp.logLevel<=Ge.ERROR&&Pp.error(`Auth (${Vs}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(n,...e){throw fE(n,...e)}function ln(n,...e){return fE(n,...e)}function dE(n,e,t){const i=Object.assign(Object.assign({},iL()),{[e]:t});return new Al("auth","Firebase",i).create(e,{appName:n.name})}function bn(n){return dE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function yu(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Mn(n,"argument-error"),dE(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function fE(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return f1.create(n,...e)}function ce(n,e,...t){if(!n)throw fE(e,...t)}function Pr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw pp(e),new Error(e)}function mr(n,e){n||Pr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function mE(){return lA()==="http:"||lA()==="https:"}function lA(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mE()||WR()||"connection"in navigator)?navigator.onLine:!0}function aL(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t){this.shortDelay=e,this.longDelay=t,mr(t>e,"Short delay should be less than long delay!"),this.isMobile=rE()||ug()}get(){return sL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(n,e){mr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL=new ef(3e4,6e4);function qt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Gt(n,e,t,i,s={}){return p1(n,s,async()=>{let o={},c={};i&&(e==="GET"?c=i:o={body:JSON.stringify(i)});const h=Cl(Object.assign({key:n.config.apiKey},c)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:d},o);return bM()||(p.referrerPolicy="no-referrer"),m1.fetch()(g1(n,n.config.apiHost,t,h),p)})}async function p1(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},oL),e);try{const s=new uL(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Wh(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const h=o.ok?c.errorMessage:c.error.message,[d,p]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Wh(n,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw Wh(n,"email-already-in-use",c);if(d==="USER_DISABLED")throw Wh(n,"user-disabled",c);const _=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw dE(n,_,p);Mn(n,_)}}catch(s){if(s instanceof Jn)throw s;Mn(n,"network-request-failed",{message:String(s)})}}async function Ls(n,e,t,i,s={}){const o=await Gt(n,e,t,i,s);return"mfaPendingCredential"in o&&Mn(n,"multi-factor-auth-required",{_serverResponse:o}),o}function g1(n,e,t,i){const s=`${e}${t}?${i}`;return n.config.emulator?pE(n.config,s):`${n.config.apiScheme}://${s}`}function cL(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class uL{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ln(this.auth,"network-request-failed")),lL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Wh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=ln(n,e,i);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(n){return n!==void 0&&n.getResponse!==void 0}function uA(n){return n!==void 0&&n.enterprise!==void 0}class hL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return cL(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dL(n){return(await Gt(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function fL(n,e){return Gt(n,"GET","/v2/recaptchaConfig",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mL(n,e){return Gt(n,"POST","/v1/accounts:delete",e)}async function pL(n,e){return Gt(n,"POST","/v1/accounts:update",e)}async function _1(n,e){return Gt(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function id(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gL(n,e=!1){const t=we(n),i=await t.getIdToken(e),s=dg(i);ce(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,c=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:id(Iv(s.auth_time)),issuedAtTime:id(Iv(s.iat)),expirationTime:id(Iv(s.exp)),signInProvider:c||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Iv(n){return Number(n)*1e3}function dg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return pp("JWT malformed, contained fewer than 3 sections"),null;try{const s=xp(t);return s?JSON.parse(s):(pp("Failed to decode base64 JWT payload"),null)}catch(s){return pp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function hA(n){const e=dg(n);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ks(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Jn&&_L(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function _L({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=id(this.lastLoginAt),this.creationTime=id(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Id(n){var e;const t=n.auth,i=await n.getIdToken(),s=await ks(n,_1(t,{idToken:i}));ce(s==null?void 0:s.users.length,t,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?y1(o.providerUserInfo):[],h=EL(n.providerData,c),d=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!(h!=null&&h.length),_=d?p:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new Wv(o.createdAt,o.lastLoginAt),isAnonymous:_};Object.assign(n,v)}async function vL(n){const e=we(n);await Id(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function EL(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function y1(n){return n.map(e=>{var{providerId:t}=e,i=hE(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wL(n,e){const t=await p1(n,{},async()=>{const i=Cl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,c=g1(n,s,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",m1.fetch()(c,{method:"POST",headers:h,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function TL(n,e){return Gt(n,"POST","/v2/accounts:revokeToken",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const t=hA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await wL(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,c=new Fc;return i&&(ce(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),s&&(ce(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),o&&(ce(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fc,this.toJSON())}_performRefresh(){return Pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(n,e){ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,o=hE(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new yL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Wv(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await ks(this,this.stsTokenManager.getToken(this.auth,e));return ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return gL(this,e)}reload(){return vL(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Id(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ft(this.auth.app))return Promise.reject(bn(this.auth));const e=await this.getIdToken();return await ks(this,mL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,o,c,h,d,p,_;const v=(i=t.displayName)!==null&&i!==void 0?i:void 0,T=(s=t.email)!==null&&s!==void 0?s:void 0,R=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,P=(c=t.photoURL)!==null&&c!==void 0?c:void 0,q=(h=t.tenantId)!==null&&h!==void 0?h:void 0,Y=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,le=(p=t.createdAt)!==null&&p!==void 0?p:void 0,Ee=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:oe,emailVerified:de,isAnonymous:Pe,providerData:Re,stsTokenManager:k}=t;ce(oe&&k,e,"internal-error");const x=Fc.fromJSON(this.name,k);ce(typeof oe=="string",e,"internal-error"),Na(v,e.name),Na(T,e.name),ce(typeof de=="boolean",e,"internal-error"),ce(typeof Pe=="boolean",e,"internal-error"),Na(R,e.name),Na(P,e.name),Na(q,e.name),Na(Y,e.name),Na(le,e.name),Na(Ee,e.name);const N=new bs({uid:oe,auth:e,email:T,emailVerified:de,displayName:v,isAnonymous:Pe,photoURL:P,phoneNumber:R,tenantId:q,stsTokenManager:x,createdAt:le,lastLoginAt:Ee});return Re&&Array.isArray(Re)&&(N.providerData=Re.map(V=>Object.assign({},V))),Y&&(N._redirectEventId=Y),N}static async _fromIdTokenResponse(e,t,i=!1){const s=new Fc;s.updateFromServerResponse(t);const o=new bs({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await Id(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];ce(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?y1(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),h=new Fc;h.updateFromIdToken(i);const d=new bs({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:c}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Wv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=new Map;function Ni(n){mr(n instanceof Function,"Expected a class definition");let e=dA.get(n);return e?(mr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}v1.type="NONE";const Yc=v1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(n,e,t){return`firebase:${n}:${e}:${t}`}class jc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=sl(this.userKey,s.apiKey,o),this.fullPersistenceKey=sl("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?bs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new jc(Ni(Yc),e,i);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=s[0]||Ni(Yc);const c=sl(i,e.config.apiKey,e.name);let h=null;for(const p of t)try{const _=await p._get(c);if(_){const v=bs._fromJSON(e,_);p!==o&&(h=v),o=p;break}}catch{}const d=s.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new jc(o,e,i):(o=d[0],h&&await o._set(c,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(c)}catch{}})),new jc(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(b1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(I1(e))return"Blackberry";if(S1(e))return"Webos";if(w1(e))return"Safari";if((e.includes("chrome/")||T1(e))&&!e.includes("edge/"))return"Chrome";if(tf(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function E1(n=Ot()){return/firefox\//i.test(n)}function w1(n=Ot()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function T1(n=Ot()){return/crios\//i.test(n)}function b1(n=Ot()){return/iemobile/i.test(n)}function tf(n=Ot()){return/android/i.test(n)}function I1(n=Ot()){return/blackberry/i.test(n)}function S1(n=Ot()){return/webos/i.test(n)}function nf(n=Ot()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bL(n=Ot()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function IL(n=Ot()){var e;return nf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function SL(){return YR()&&document.documentMode===10}function A1(n=Ot()){return nf(n)||tf(n)||S1(n)||I1(n)||/windows phone/i.test(n)||b1(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(n,e=[]){let t;switch(n){case"Browser":t=fA(Ot());break;case"Worker":t=`${fA(Ot())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vs}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((c,h)=>{try{const d=e(o);c(d)}catch(d){h(d)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CL(n,e={}){return Gt(n,"GET","/v2/passwordPolicy",qt(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL=6;class xL{constructor(e){var t,i,s,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:RL,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,s,o,c,h;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsLowercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(c=d.containsNumericCharacter)!==null&&c!==void 0?c:!0),d.isValid&&(d.isValid=(h=d.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),d}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mA(this),this.idTokenSubscription=new mA(this),this.beforeStateQueue=new AL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ni(t)),this._initializationPromise=this.queue(async()=>{var i,s;if(!this._deleted&&(this.persistenceManager=await jc.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await _1(this,{idToken:e}),i=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ft(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=s==null?void 0:s._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===h)&&(d!=null&&d.user)&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Id(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=aL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ft(this.app))return Promise.reject(bn(this));const t=e?we(e):null;return t&&ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ft(this.app)?Promise.reject(bn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ft(this.app)?Promise.reject(bn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ni(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CL(this),t=new xL(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Al("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await TL(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ni(e)||this._popupRedirectResolver;ce(t,this,"argument-error"),this.redirectPersistenceManager=await jc.create(this,[Ni(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(h,this,"internal-error"),h.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,s);return()=>{c=!0,d()}}else{const d=e.addObserver(t);return()=>{c=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=C1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&rL(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function jt(n){return we(n)}class mA{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZR(t=>this.observer=t)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function DL(n){rf=n}function gE(n){return rf.loadJS(n)}function kL(){return rf.recaptchaV2Script}function PL(){return rf.recaptchaEnterpriseScript}function OL(){return rf.gapiScript}function R1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const ML="recaptcha-enterprise",VL="NO_RECAPTCHA";class LL{constructor(e){this.type=ML,this.auth=jt(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,h)=>{fL(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new hL(d);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,c(p.siteKey)}}).catch(d=>{h(d)})})}function s(o,c,h){const d=window.grecaptcha;uA(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(p=>{c(p)}).catch(()=>{c(VL)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,c)=>{i(this.auth).then(h=>{if(!t&&uA(window.grecaptcha))s(h,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let d=PL();d.length!==0&&(d+=h),gE(d).then(()=>{s(h,o,c)}).catch(p=>{c(p)})}}).catch(h=>{c(h)})})}}async function pA(n,e,t,i=!1){const s=new LL(n);let o;try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const c=Object.assign({},e);return i?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Sd(n,e,t,i){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await pA(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await pA(n,e,t,t==="getOobCode");return i(n,c)}else return Promise.reject(o)})}function UL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ni);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function BL(n,e,t){const i=jt(n);ce(i._canInitEmulator,i,"emulator-config-failed"),ce(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),o=x1(e),{host:c,port:h}=FL(e),d=h===null?"":`:${h}`;i.config.emulator={url:`${o}//${c}${d}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:c,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||jL()}function x1(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function FL(n){const e=x1(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:gA(i.substr(o.length+1))}}else{const[o,c]=i.split(":");return{host:o,port:gA(c)}}}function gA(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function jL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Pr("not implemented")}_getIdTokenResponse(e){return Pr("not implemented")}_linkToIdToken(e,t){return Pr("not implemented")}_getReauthenticationResolver(e){return Pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N1(n,e){return Gt(n,"POST","/v1/accounts:resetPassword",qt(n,e))}async function zL(n,e){return Gt(n,"POST","/v1/accounts:update",e)}async function qL(n,e){return Gt(n,"POST","/v1/accounts:signUp",e)}async function GL(n,e){return Gt(n,"POST","/v1/accounts:update",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HL(n,e){return Ls(n,"POST","/v1/accounts:signInWithPassword",qt(n,e))}async function fg(n,e){return Gt(n,"POST","/v1/accounts:sendOobCode",qt(n,e))}async function $L(n,e){return fg(n,e)}async function KL(n,e){return fg(n,e)}async function QL(n,e){return fg(n,e)}async function WL(n,e){return fg(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YL(n,e){return Ls(n,"POST","/v1/accounts:signInWithEmailLink",qt(n,e))}async function XL(n,e){return Ls(n,"POST","/v1/accounts:signInWithEmailLink",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad extends vu{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Ad(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ad(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sd(e,t,"signInWithPassword",HL);case"emailLink":return YL(e,{email:this._email,oobCode:this._password});default:Mn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sd(e,i,"signUpPassword",qL);case"emailLink":return XL(e,{idToken:t,email:this._email,oobCode:this._password});default:Mn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rs(n,e){return Ls(n,"POST","/v1/accounts:signInWithIdp",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL="http://localhost";class qr extends vu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new qr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,o=hE(t,["providerId","signInMethod"]);if(!i||!s)return null;const c=new qr(i,s);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Rs(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Rs(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Rs(e,t)}buildRequest(){const e={requestUri:JL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZL(n,e){return Gt(n,"POST","/v1/accounts:sendVerificationCode",qt(n,e))}async function e5(n,e){return Ls(n,"POST","/v1/accounts:signInWithPhoneNumber",qt(n,e))}async function t5(n,e){const t=await Ls(n,"POST","/v1/accounts:signInWithPhoneNumber",qt(n,e));if(t.temporaryProof)throw Wh(n,"account-exists-with-different-credential",t);return t}const n5={USER_NOT_FOUND:"user-not-found"};async function i5(n,e){const t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ls(n,"POST","/v1/accounts:signInWithPhoneNumber",qt(n,t),n5)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al extends vu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new al({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new al({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return e5(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return t5(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return i5(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:s}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:o}=e;return!i&&!t&&!s&&!o?null:new al({verificationId:t,verificationCode:i,phoneNumber:s,temporaryProof:o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function s5(n){const e=Uc(Qh(n)).link,t=e?Uc(Qh(e)).deep_link_id:null,i=Uc(Qh(n)).deep_link_id;return(i?Uc(Qh(i)).link:null)||i||t||e||n}class mg{constructor(e){var t,i,s,o,c,h;const d=Uc(Qh(e)),p=(t=d.apiKey)!==null&&t!==void 0?t:null,_=(i=d.oobCode)!==null&&i!==void 0?i:null,v=r5((s=d.mode)!==null&&s!==void 0?s:null);ce(p&&_&&v,"argument-error"),this.apiKey=p,this.operation=v,this.code=_,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=d.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(h=d.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=s5(e);try{return new mg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(){this.providerId=co.PROVIDER_ID}static credential(e,t){return Ad._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=mg.parseLink(t);return ce(i,"argument-error"),Ad._fromEmailAndCode(e,i.code,i.tenantId)}}co.PROVIDER_ID="password";co.EMAIL_PASSWORD_SIGN_IN_METHOD="password";co.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu extends Us{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zc extends Eu{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ce("providerId"in t&&"signInMethod"in t,"argument-error"),qr._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ce(e.idToken||e.accessToken,"argument-error"),qr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return zc.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return zc.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:c,providerId:h}=e;if(!i&&!s&&!t&&!o||!h)return null;try{return new zc(h)._credential({idToken:t,accessToken:i,nonce:c,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends Eu{constructor(){super("facebook.com")}static credential(e){return qr._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xr.credential(e.oauthAccessToken)}catch{return null}}}xr.FACEBOOK_SIGN_IN_METHOD="facebook.com";xr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends Eu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return qr._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Nr.credential(t,i)}catch{return null}}}Nr.GOOGLE_SIGN_IN_METHOD="google.com";Nr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends Eu{constructor(){super("github.com")}static credential(e){return qr._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dr.credential(e.oauthAccessToken)}catch{return null}}}Dr.GITHUB_SIGN_IN_METHOD="github.com";Dr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5="http://localhost";class Xc extends vu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return Rs(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Rs(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Rs(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,pendingToken:o}=t;return!i||!s||!o||i!==s?null:new Xc(i,o)}static _create(e,t){return new Xc(e,t)}buildRequest(){return{requestUri:a5,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5="saml.";class Op extends Us{constructor(e){ce(e.startsWith(o5),"argument-error"),super(e)}static credentialFromResult(e){return Op.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Op.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Xc.fromJSON(e);return ce(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:i}=e;if(!t||!i)return null;try{return Xc._create(i,t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends Eu{constructor(){super("twitter.com")}static credential(e,t){return qr._fromParams({providerId:kr.PROVIDER_ID,signInMethod:kr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kr.credentialFromTaggedObject(e)}static credentialFromError(e){return kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return kr.credential(t,i)}catch{return null}}}kr.TWITTER_SIGN_IN_METHOD="twitter.com";kr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D1(n,e){return Ls(n,"POST","/v1/accounts:signUp",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await bs._fromIdTokenResponse(e,i,s),c=_A(i);return new Zi({user:o,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=_A(i);return new Zi({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function _A(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l5(n){var e;if(Ft(n.app))return Promise.reject(bn(n));const t=jt(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new Zi({user:t.currentUser,providerId:null,operationType:"signIn"});const i=await D1(t,{returnSecureToken:!0}),s=await Zi._fromIdTokenResponse(t,"signIn",i,!0);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp extends Jn{constructor(e,t,i,s){var o;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Mp.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new Mp(e,t,i,s)}}function k1(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Mp._fromErrorAndOperation(n,o,e,i):o})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P1(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c5(n,e){const t=we(n);await pg(!0,t,e);const{providerUserInfo:i}=await pL(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),s=P1(i||[]);return t.providerData=t.providerData.filter(o=>s.has(o.providerId)),s.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function _E(n,e,t=!1){const i=await ks(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Zi._forOperation(n,"link",i)}async function pg(n,e,t){await Id(e);const i=P1(e.providerData),s=n===!1?"provider-already-linked":"no-such-provider";ce(i.has(t)===n,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(n,e,t=!1){const{auth:i}=n;if(Ft(i.app))return Promise.reject(bn(i));const s="reauthenticate";try{const o=await ks(n,k1(i,s,e,n),t);ce(o.idToken,i,"internal-error");const c=dg(o.idToken);ce(c,i,"internal-error");const{sub:h}=c;return ce(n.uid===h,i,"user-mismatch"),Zi._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Mn(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(n,e,t=!1){if(Ft(n.app))return Promise.reject(bn(n));const i="signIn",s=await k1(n,i,e),o=await Zi._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}async function gg(n,e){return M1(jt(n),e)}async function V1(n,e){const t=we(n);return await pg(!1,t,e.providerId),_E(t,e)}async function L1(n,e){return O1(we(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u5(n,e){return Ls(n,"POST","/v1/accounts:signInWithCustomToken",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h5(n,e){if(Ft(n.app))return Promise.reject(bn(n));const t=jt(n),i=await u5(t,{token:e,returnSecureToken:!0}),s=await Zi._fromIdTokenResponse(t,"signIn",i);return await t._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?yE._fromServerResponse(e,t):"totpInfo"in t?vE._fromServerResponse(e,t):Mn(e,"internal-error")}}class yE extends sf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new yE(t)}}class vE extends sf{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new vE(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(n,e,t){var i;ce(((i=t.url)===null||i===void 0?void 0:i.length)>0,n,"invalid-continue-uri"),ce(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ce(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ce(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EE(n){const e=jt(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function d5(n,e,t){const i=jt(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&_g(i,s,t),await Sd(i,s,"getOobCode",KL)}async function f5(n,e,t){await N1(we(n),{oobCode:e,newPassword:t}).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&EE(n),i})}async function m5(n,e){await GL(we(n),{oobCode:e})}async function U1(n,e){const t=we(n),i=await N1(t,{oobCode:e}),s=i.requestType;switch(ce(s,t,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ce(i.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ce(i.mfaInfo,t,"internal-error");default:ce(i.email,t,"internal-error")}let o=null;return i.mfaInfo&&(o=sf._fromServerResponse(jt(t),i.mfaInfo)),{data:{email:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.newEmail:i.email)||null,previousEmail:(i.requestType==="VERIFY_AND_CHANGE_EMAIL"?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function p5(n,e){const{data:t}=await U1(we(n),e);return t.email}async function g5(n,e,t){if(Ft(n.app))return Promise.reject(bn(n));const i=jt(n),c=await Sd(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",D1).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&EE(n),d}),h=await Zi._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(h.user),h}function _5(n,e,t){return Ft(n.app)?Promise.reject(bn(n)):gg(we(n),co.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&EE(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y5(n,e,t){const i=jt(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(c,h){ce(h.handleCodeInApp,i,"argument-error"),h&&_g(i,c,h)}o(s,t),await Sd(i,s,"getOobCode",QL)}function v5(n,e){const t=mg.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function E5(n,e,t){if(Ft(n.app))return Promise.reject(bn(n));const i=we(n),s=co.credentialWithLink(e,t||bd());return ce(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),gg(i,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w5(n,e){return Gt(n,"POST","/v1/accounts:createAuthUri",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T5(n,e){const t=mE()?bd():"http://localhost",i={identifier:e,continueUri:t},{signinMethods:s}=await w5(we(n),i);return s||[]}async function b5(n,e){const t=we(n),s={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&_g(t.auth,s,e);const{email:o}=await $L(t.auth,s);o!==n.email&&await n.reload()}async function I5(n,e,t){const i=we(n),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&_g(i.auth,o,t);const{email:c}=await WL(i.auth,o);c!==n.email&&await n.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S5(n,e){return Gt(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A5(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=we(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await ks(i,S5(i.auth,o));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const h=i.providerData.find(({providerId:d})=>d==="password");h&&(h.displayName=i.displayName,h.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function C5(n,e){const t=we(n);return Ft(t.auth.app)?Promise.reject(bn(t.auth)):B1(t,e,null)}function R5(n,e){return B1(we(n),null,e)}async function B1(n,e,t){const{auth:i}=n,o={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(o.email=e),t&&(o.password=t);const c=await ks(n,zL(i,o));await n._updateTokensIfNecessary(c,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x5(n){var e,t;if(!n)return null;const{providerId:i}=n,s=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},o=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!i&&(n!=null&&n.idToken)){const c=(t=(e=dg(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(c){const h=c!=="anonymous"&&c!=="custom"?c:null;return new qc(o,h)}}if(!i)return null;switch(i){case"facebook.com":return new N5(o,s);case"github.com":return new D5(o,s);case"google.com":return new k5(o,s);case"twitter.com":return new P5(o,s,n.screenName||null);case"custom":case"anonymous":return new qc(o,null);default:return new qc(o,i,s)}}class qc{constructor(e,t,i={}){this.isNewUser=e,this.providerId=t,this.profile=i}}class F1 extends qc{constructor(e,t,i,s){super(e,t,i),this.username=s}}class N5 extends qc{constructor(e,t){super(e,"facebook.com",t)}}class D5 extends F1{constructor(e,t){super(e,"github.com",t,typeof(t==null?void 0:t.login)=="string"?t==null?void 0:t.login:null)}}class k5 extends qc{constructor(e,t){super(e,"google.com",t)}}class P5 extends F1{constructor(e,t,i){super(e,"twitter.com",t,i)}}function O5(n){const{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:x5(t)}function M5(n,e,t,i){return we(n).onAuthStateChanged(e,t,i)}function V5(n){return we(n).signOut()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t,i){this.type=e,this.credential=t,this.user=i}static _fromIdtoken(e,t){return new tl("enroll",e,t)}static _fromMfaPendingCredential(e){return new tl("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,i;if(e!=null&&e.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return tl._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((i=e.multiFactorSession)===null||i===void 0)&&i.idToken)return tl._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e,t,i){this.session=e,this.hints=t,this.signInResolver=i}static _fromError(e,t){const i=jt(e),s=t.customData._serverResponse,o=(s.mfaInfo||[]).map(h=>sf._fromServerResponse(i,h));ce(s.mfaPendingCredential,i,"internal-error");const c=tl._fromMfaPendingCredential(s.mfaPendingCredential);return new wE(c,o,async h=>{const d=await h._process(i,c);delete s.mfaInfo,delete s.mfaPendingCredential;const p=Object.assign(Object.assign({},s),{idToken:d.idToken,refreshToken:d.refreshToken});switch(t.operationType){case"signIn":const _=await Zi._fromIdTokenResponse(i,t.operationType,p);return await i._updateCurrentUser(_.user),_;case"reauthenticate":return ce(t.user,i,"internal-error"),Zi._forOperation(t.user,t.operationType,p);default:Mn(i,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function L5(n,e){var t;const i=we(n),s=e;return ce(e.customData.operationType,i,"argument-error"),ce((t=s.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,i,"argument-error"),wE._fromError(i,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U5(n,e){return Gt(n,"POST","/v2/accounts/mfaEnrollment:start",qt(n,e))}function B5(n,e){return Gt(n,"POST","/v2/accounts/mfaEnrollment:finalize",qt(n,e))}function F5(n,e){return Gt(n,"POST","/v2/accounts/mfaEnrollment:withdraw",qt(n,e))}class TE{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(i=>sf._fromServerResponse(e.auth,i)))})}static _fromUser(e){return new TE(e)}async getSession(){return tl._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const i=e,s=await this.getSession(),o=await ks(this.user,i._process(this.user.auth,s,t));return await this.user._updateTokensIfNecessary(o),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,i=await this.user.getIdToken();try{const s=await ks(this.user,F5(this.user.auth,{idToken:i,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==t),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const Sv=new WeakMap;function j5(n){const e=we(n);return Sv.has(e)||Sv.set(e,TE._fromUser(e)),Sv.get(e)}const Vp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Vp,"1"),this.storage.removeItem(Vp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5=1e3,q5=10;class z1 extends j1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=A1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,h,d)=>{this.notifyListeners(c,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);SL()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,q5):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},z5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}z1.type="LOCAL";const bE=z1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1 extends j1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}q1.type="SESSION";const ul=q1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G5(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new yg(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,c=this.handlersMap[s];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const h=Array.from(c).map(async p=>p(t.origin,o)),d=await G5(h);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,c;return new Promise((h,d)=>{const p=af("",20);s.port1.start();const _=setTimeout(()=>{d(new Error("unsupported_event"))},i);c={messageChannel:s,onMessage(v){const T=v;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(_),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(T.data.response);break;default:clearTimeout(_),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(){return window}function $5(n){rn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(){return typeof rn().WorkerGlobalScope<"u"&&typeof rn().importScripts=="function"}async function K5(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Q5(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function W5(){return IE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="firebaseLocalStorageDb",Y5=1,Lp="firebaseLocalStorage",H1="fbase_key";class of{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function vg(n,e){return n.transaction([Lp],e?"readwrite":"readonly").objectStore(Lp)}function X5(){const n=indexedDB.deleteDatabase(G1);return new of(n).toPromise()}function Yv(){const n=indexedDB.open(G1,Y5);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Lp,{keyPath:H1})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Lp)?e(i):(i.close(),await X5(),e(await Yv()))})})}async function yA(n,e,t){const i=vg(n,!0).put({[H1]:e,value:t});return new of(i).toPromise()}async function J5(n,e){const t=vg(n,!1).get(e),i=await new of(t).toPromise();return i===void 0?null:i.value}function vA(n,e){const t=vg(n,!0).delete(e);return new of(t).toPromise()}const Z5=800,e4=3;class $1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yv(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>e4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return IE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yg._getInstance(W5()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await K5(),!this.activeServiceWorker)return;this.sender=new H5(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Q5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yv();return await yA(e,Vp,"1"),await vA(e,Vp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>yA(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>J5(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=vg(s,!1).getAll();return new of(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Z5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$1.type="LOCAL";const Cd=$1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(n,e){return Gt(n,"POST","/v2/accounts/mfaSignIn:start",qt(n,e))}function n4(n,e){return Gt(n,"POST","/v2/accounts/mfaSignIn:finalize",qt(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=500,r4=6e4,ap=1e12;class s4{constructor(e){this.auth=e,this.counter=ap,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new a4(e,this.auth.name,t||{})),this.counter++,i}reset(e){var t;const i=e||ap;(t=this._widgets.get(i))===null||t===void 0||t.delete(),this._widgets.delete(i)}getResponse(e){var t;const i=e||ap;return((t=this._widgets.get(i))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;const i=e||ap;return(t=this._widgets.get(i))===null||t===void 0||t.execute(),""}}class a4{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;ce(s,"argument-error",{appName:t}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=o4(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},r4)},i4))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function o4(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av=R1("rcb"),l4=new ef(3e4,6e4);class c4{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=rn().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return ce(u4(t),e,"argument-error"),this.shouldResolveImmediately(t)&&cA(rn().grecaptcha)?Promise.resolve(rn().grecaptcha):new Promise((i,s)=>{const o=rn().setTimeout(()=>{s(ln(e,"network-request-failed"))},l4.get());rn()[Av]=()=>{rn().clearTimeout(o),delete rn()[Av];const h=rn().grecaptcha;if(!h||!cA(h)){s(ln(e,"internal-error"));return}const d=h.render;h.render=(p,_)=>{const v=d(p,_);return this.counter++,v},this.hostLanguage=t,i(h)};const c=`${kL()}?${Cl({onload:Av,render:"explicit",hl:t})}`;gE(c).catch(()=>{clearTimeout(o),s(ln(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=rn().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function u4(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}class h4{async load(e){return new s4(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1="recaptcha",d4={theme:"light",type:"image"};let f4=class{constructor(e,t,i=Object.assign({},d4)){this.parameters=i,this.type=K1,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=jt(e),this.isInvisible=this.parameters.size==="invisible",ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof t=="string"?document.getElementById(t):t;ce(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new h4:new c4,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),i=t.getResponse(e);return i||new Promise(s=>{const o=c=>{c&&(this.tokenChangeListeners.delete(o),s(c))};this.tokenChangeListeners.add(o),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){ce(!this.parameters.sitekey,this.auth,"argument-error"),ce(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ce(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),typeof e=="function")e(t);else if(typeof e=="string"){const i=rn()[e];typeof i=="function"&&i(t)}}}assertNotDestroyed(){ce(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){ce(mE()&&!IE(),this.auth,"internal-error"),await m4(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await dL(this.auth);ce(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return ce(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function m4(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=al._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function p4(n,e,t){if(Ft(n.app))return Promise.reject(bn(n));const i=jt(n),s=await Eg(i,e,we(t));return new SE(s,o=>gg(i,o))}async function g4(n,e,t){const i=we(n);await pg(!1,i,"phone");const s=await Eg(i.auth,e,we(t));return new SE(s,o=>V1(i,o))}async function _4(n,e,t){const i=we(n);if(Ft(i.auth.app))return Promise.reject(bn(i.auth));const s=await Eg(i.auth,e,we(t));return new SE(s,o=>L1(i,o))}async function Eg(n,e,t){var i;const s=await t.verify();try{ce(typeof s=="string",n,"argument-error"),ce(t.type===K1,n,"argument-error");let o;if(typeof e=="string"?o={phoneNumber:e}:o=e,"session"in o){const c=o.session;if("phoneNumber"in o)return ce(c.type==="enroll",n,"internal-error"),(await U5(n,{idToken:c.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{ce(c.type==="signin",n,"internal-error");const h=((i=o.multiFactorHint)===null||i===void 0?void 0:i.uid)||o.multiFactorUid;return ce(h,n,"missing-multi-factor-info"),(await t4(n,{mfaPendingCredential:c.credential,mfaEnrollmentId:h,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:c}=await ZL(n,{phoneNumber:o.phoneNumber,recaptchaToken:s});return c}}finally{t._reset()}}async function y4(n,e){const t=we(n);if(Ft(t.auth.app))return Promise.reject(bn(t.auth));await _E(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl=class gp{constructor(e){this.providerId=gp.PROVIDER_ID,this.auth=jt(e)}verifyPhoneNumber(e,t){return Eg(this.auth,e,we(t))}static credential(e,t){return al._fromVerification(e,t)}static credentialFromResult(e){const t=e;return gp.credentialFromTaggedObject(t)}static credentialFromError(e){return gp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:i}=e;return t&&i?al._fromTokenResponse(t,i):null}};hl.PROVIDER_ID="phone";hl.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(n,e){return e?Ni(e):(ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE extends vu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Rs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Rs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Rs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function v4(n){return M1(n.auth,new AE(n),n.bypassAuthState)}function E4(n){const{auth:e,user:t}=n;return ce(t,e,"internal-error"),O1(t,new AE(n),n.bypassAuthState)}async function w4(n){const{auth:e,user:t}=n;return ce(t,e,"internal-error"),_E(t,new AE(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:c,type:h}=e;if(c){this.reject(c);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return v4;case"linkViaPopup":case"linkViaRedirect":return w4;case"reauthViaPopup":case"reauthViaRedirect":return E4;default:Mn(this.auth,"internal-error")}}resolve(e){mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=new ef(2e3,1e4);async function b4(n,e,t){if(Ft(n.app))return Promise.reject(ln(n,"operation-not-supported-in-this-environment"));const i=jt(n);yu(n,e,Us);const s=Rl(i,t);return new Is(i,"signInViaPopup",e,s).executeNotNull()}async function I4(n,e,t){const i=we(n);if(Ft(i.auth.app))return Promise.reject(ln(i.auth,"operation-not-supported-in-this-environment"));yu(i.auth,e,Us);const s=Rl(i.auth,t);return new Is(i.auth,"reauthViaPopup",e,s,i).executeNotNull()}async function S4(n,e,t){const i=we(n);yu(i.auth,e,Us);const s=Rl(i.auth,t);return new Is(i.auth,"linkViaPopup",e,s,i).executeNotNull()}class Is extends Q1{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,Is.currentPopupAction&&Is.currentPopupAction.cancel(),Is.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){mr(this.filter.length===1,"Popup operations only handle one event");const e=af();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ln(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ln(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Is.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ln(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,T4.get())};e()}}Is.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4="pendingRedirect",rd=new Map;class C4 extends Q1{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=rd.get(this.auth._key());if(!e){try{const i=await R4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}rd.set(this.auth._key(),e)}return this.bypassAuthState||rd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function R4(n,e){const t=Y1(e),i=W1(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}async function CE(n,e){return W1(n)._set(Y1(e),"true")}function x4(){rd.clear()}function RE(n,e){rd.set(n._key(),e)}function W1(n){return Ni(n._redirectPersistence)}function Y1(n){return sl(A4,n.config.apiKey,n.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N4(n,e,t){return D4(n,e,t)}async function D4(n,e,t){if(Ft(n.app))return Promise.reject(bn(n));const i=jt(n);yu(n,e,Us),await i._initializationPromise;const s=Rl(i,t);return await CE(s,i),s._openRedirect(i,e,"signInViaRedirect")}function k4(n,e,t){return P4(n,e,t)}async function P4(n,e,t){const i=we(n);if(yu(i.auth,e,Us),Ft(i.auth.app))return Promise.reject(bn(i.auth));await i.auth._initializationPromise;const s=Rl(i.auth,t);await CE(s,i.auth);const o=await X1(i);return s._openRedirect(i.auth,e,"reauthViaRedirect",o)}function O4(n,e,t){return M4(n,e,t)}async function M4(n,e,t){const i=we(n);yu(i.auth,e,Us),await i.auth._initializationPromise;const s=Rl(i.auth,t);await pg(!1,i,e.providerId),await CE(s,i.auth);const o=await X1(i);return s._openRedirect(i.auth,e,"linkViaRedirect",o)}async function V4(n,e){return await jt(n)._initializationPromise,wg(n,e,!1)}async function wg(n,e,t=!1){if(Ft(n.app))return Promise.reject(bn(n));const i=jt(n),s=Rl(i,e),c=await new C4(i,s,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}async function X1(n){const e=af(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4=600*1e3;class J1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!U4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Z1(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(ln(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=L4&&this.cachedEventUids.clear(),this.cachedEventUids.has(EA(e))}saveEventToCache(e){this.cachedEventUids.add(EA(e)),this.lastProcessedEventTime=Date.now()}}function EA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Z1({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function U4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Z1(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ex(n,e={}){return Gt(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,F4=/^https?/;async function j4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await ex(n);for(const t of e)try{if(z4(t))return}catch{}Mn(n,"unauthorized-domain")}function z4(n){const e=bd(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!F4.test(t))return!1;if(B4.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=new ef(3e4,6e4);function wA(){const n=rn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function G4(n){return new Promise((e,t)=>{var i,s,o;function c(){wA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wA(),t(ln(n,"network-request-failed"))},timeout:q4.get()})}if(!((s=(i=rn().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=rn().gapi)===null||o===void 0)&&o.load)c();else{const h=R1("iframefcb");return rn()[h]=()=>{gapi.load?c():t(ln(n,"network-request-failed"))},gE(`${OL()}?onload=${h}`).catch(d=>t(d))}}).catch(e=>{throw _p=null,e})}let _p=null;function H4(n){return _p=_p||G4(n),_p}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4=new ef(5e3,15e3),K4="__/auth/iframe",Q4="emulator/auth/iframe",W4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Y4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X4(n){const e=n.config;ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?pE(e,Q4):`https://${n.config.authDomain}/${K4}`,i={apiKey:e.apiKey,appName:n.name,v:Vs},s=Y4.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Cl(i).slice(1)}`}async function J4(n){const e=await H4(n),t=rn().gapi;return ce(t,n,"internal-error"),e.open({where:document.body,url:X4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W4,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const c=ln(n,"network-request-failed"),h=rn().setTimeout(()=>{o(c)},$4.get());function d(){rn().clearTimeout(h),s(i)}i.ping(d).then(d,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},eU=500,tU=600,nU="_blank",iU="http://localhost";class TA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rU(n,e,t,i=eU,s=tU){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const d=Object.assign(Object.assign({},Z4),{width:i.toString(),height:s.toString(),top:o,left:c}),p=Ot().toLowerCase();t&&(h=T1(p)?nU:t),E1(p)&&(e=e||iU,d.scrollbars="yes");const _=Object.entries(d).reduce((T,[R,P])=>`${T}${R}=${P},`,"");if(IL(p)&&h!=="_self")return sU(e||"",h),new TA(null);const v=window.open(e||"",h,_);ce(v,n,"popup-blocked");try{v.focus()}catch{}return new TA(v)}function sU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aU="__/auth/handler",oU="emulator/auth/handler",lU=encodeURIComponent("fac");async function Xv(n,e,t,i,s,o){ce(n.config.authDomain,n,"auth-domain-config-required"),ce(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Vs,eventId:s};if(e instanceof Us){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",Np(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries(o||{}))c[_]=v}if(e instanceof Eu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}n.tenantId&&(c.tid=n.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const d=await n._getAppCheckToken(),p=d?`#${lU}=${encodeURIComponent(d)}`:"";return`${cU(n)}?${Cl(h).slice(1)}${p}`}function cU({config:n}){return n.emulator?pE(n,oU):`https://${n.authDomain}/${aU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv="webStorageSupport";class uU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ul,this._completeRedirectFn=wg,this._overrideRedirectResult=RE}async _openPopup(e,t,i,s){var o;mr((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await Xv(e,t,i,bd(),s);return rU(e,c,af())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await Xv(e,t,i,bd(),s);return $5(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(mr(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await J4(e),i=new J1(e);return t.register("authEvent",s=>(ce(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cv,{type:Cv},s=>{var o;const c=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[Cv];c!==void 0&&t(!!c),Mn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=j4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return A1()||w1()||nf()}}const hU=uU;class dU{constructor(e){this.factorId=e}_process(e,t,i){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,i);case"signin":return this._finalizeSignIn(e,t.credential);default:return Pr("unexpected MultiFactorSessionType")}}}class xE extends dU{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new xE(e)}_finalizeEnroll(e,t,i){return B5(e,{idToken:t,displayName:i,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return n4(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class tx{constructor(){}static assertion(e){return xE._fromCredential(e)}}tx.FACTOR_ID="phone";var bA="@firebase/auth",IA="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pU(n){Ds(new _i("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;ce(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:c,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:C1(n)},p=new NL(i,s,o,d);return UL(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ds(new _i("auth-internal",e=>{const t=jt(e.getProvider("auth").getImmediate());return(i=>new fU(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Di(bA,IA,mU(n)),Di(bA,IA,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU=300;wM("authIdTokenMaxAge");function _U(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}DL({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=ln("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",_U().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pU("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yU=2e3;async function vU(n,e,t){var i;const{BuildInfo:s}=dl();mr(e.sessionId,"AuthEvent did not contain a session ID");const o=await IU(e.sessionId),c={};return nf()?c.ibi=s.packageName:tf()?c.apn=s.packageName:Mn(n,"operation-not-supported-in-this-environment"),s.displayName&&(c.appDisplayName=s.displayName),c.sessionId=o,Xv(n,t,e.type,void 0,(i=e.eventId)!==null&&i!==void 0?i:void 0,c)}async function EU(n){const{BuildInfo:e}=dl(),t={};nf()?t.iosBundleId=e.packageName:tf()?t.androidPackageName=e.packageName:Mn(n,"operation-not-supported-in-this-environment"),await ex(n,t)}function wU(n){const{cordova:e}=dl();return new Promise(t=>{e.plugins.browsertab.isAvailable(i=>{let s=null;i?e.plugins.browsertab.openUrl(n):s=e.InAppBrowser.open(n,bL()?"_blank":"_system","location=yes"),t(s)})})}async function TU(n,e,t){const{cordova:i}=dl();let s=()=>{};try{await new Promise((o,c)=>{let h=null;function d(){var v;o();const T=(v=i.plugins.browsertab)===null||v===void 0?void 0:v.close;typeof T=="function"&&T(),typeof(t==null?void 0:t.close)=="function"&&t.close()}function p(){h||(h=window.setTimeout(()=>{c(ln(n,"redirect-cancelled-by-user"))},yU))}function _(){(document==null?void 0:document.visibilityState)==="visible"&&p()}e.addPassiveListener(d),document.addEventListener("resume",p,!1),tf()&&document.addEventListener("visibilitychange",_,!1),s=()=>{e.removePassiveListener(d),document.removeEventListener("resume",p,!1),document.removeEventListener("visibilitychange",_,!1),h&&window.clearTimeout(h)}})}finally{s()}}function bU(n){var e,t,i,s,o,c,h,d,p,_;const v=dl();ce(typeof((e=v==null?void 0:v.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ce(typeof((t=v==null?void 0:v.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ce(typeof((o=(s=(i=v==null?void 0:v.cordova)===null||i===void 0?void 0:i.plugins)===null||s===void 0?void 0:s.browsertab)===null||o===void 0?void 0:o.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ce(typeof((d=(h=(c=v==null?void 0:v.cordova)===null||c===void 0?void 0:c.plugins)===null||h===void 0?void 0:h.browsertab)===null||d===void 0?void 0:d.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ce(typeof((_=(p=v==null?void 0:v.cordova)===null||p===void 0?void 0:p.InAppBrowser)===null||_===void 0?void 0:_.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function IU(n){const e=SU(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(s=>s.toString(16).padStart(2,"0")).join("")}function SU(n){if(mr(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);const e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let i=0;i<n.length;i++)t[i]=n.charCodeAt(i);return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU=20;class CU extends J1{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function RU(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:DU(),postBody:null,tenantId:n.tenantId,error:ln(n,"no-auth-event")}}function xU(n,e){return Jv()._set(Zv(n),e)}async function SA(n){const e=await Jv()._get(Zv(n));return e&&await Jv()._remove(Zv(n)),e}function NU(n,e){var t,i;const s=PU(e);if(s.includes("/__/auth/callback")){const o=yp(s),c=o.firebaseError?kU(decodeURIComponent(o.firebaseError)):null,h=(i=(t=c==null?void 0:c.code)===null||t===void 0?void 0:t.split("auth/"))===null||i===void 0?void 0:i[1],d=h?ln(h):null;return d?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:d,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:s,postBody:null}}return null}function DU(){const n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<AU;t++){const i=Math.floor(Math.random()*e.length);n.push(e.charAt(i))}return n.join("")}function Jv(){return Ni(bE)}function Zv(n){return sl("authEvent",n.config.apiKey,n.name)}function kU(n){try{return JSON.parse(n)}catch{return null}}function PU(n){const e=yp(n),t=e.link?decodeURIComponent(e.link):void 0,i=yp(t).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return yp(s).link||s||i||t||n}function yp(n){if(!(n!=null&&n.includes("?")))return{};const[e,...t]=n.split("?");return Uc(t.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OU=500;class MU{constructor(){this._redirectPersistence=ul,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=wg,this._overrideRedirectResult=RE}async _initialize(e){const t=e._key();let i=this.eventManagers.get(t);return i||(i=new CU(e),this.eventManagers.set(t,i),this.attachCallbackListeners(e,i)),i}_openPopup(e){Mn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,i,s){bU(e);const o=await this._initialize(e);await o.initialized(),o.resetRedirect(),x4(),await this._originValidation(e);const c=RU(e,i,s);await xU(e,c);const h=await vU(e,c,t),d=await wU(h);return TU(e,o,d)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=EU(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:i,handleOpenURL:s,BuildInfo:o}=dl(),c=setTimeout(async()=>{await SA(e),t.onEvent(AA())},OU),h=async _=>{clearTimeout(c);const v=await SA(e);let T=null;v&&(_!=null&&_.url)&&(T=NU(v,_.url)),t.onEvent(T||AA())};typeof i<"u"&&typeof i.subscribe=="function"&&i.subscribe(null,h);const d=s,p=`${o.packageName.toLowerCase()}://`;dl().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(p)&&h({url:_}),typeof d=="function")try{d(_)}catch(v){console.error(v)}}}}const VU=MU;function AA(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ln("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(n,e){jt(n)._logFramework(e)}var UU="@firebase/auth-compat",BU="0.5.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU=1e3;function sd(){var n;return((n=self==null?void 0:self.location)===null||n===void 0?void 0:n.protocol)||null}function jU(){return sd()==="http:"||sd()==="https:"}function nx(n=Ot()){return!!((sd()==="file:"||sd()==="ionic:"||sd()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function zU(){return ug()||sE()}function qU(){return YR()&&(document==null?void 0:document.documentMode)===11}function GU(n=Ot()){return/Edge\/\d+/.test(n)}function HU(n=Ot()){return qU()||GU(n)}function ix(){try{const n=self.localStorage,e=af();if(n)return n.setItem(e,"1"),n.removeItem(e),HU()?yd():!0}catch{return NE()&&yd()}return!1}function NE(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Rv(){return(jU()||WR()||nx())&&!zU()&&ix()&&!NE()}function rx(){return nx()&&typeof document<"u"}async function $U(){return rx()?new Promise(n=>{const e=setTimeout(()=>{n(!1)},FU);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function KU(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri={LOCAL:"local",NONE:"none",SESSION:"session"},Lh=ce,sx="persistence";function QU(n,e){if(Lh(Object.values(Ri).includes(e),n,"invalid-persistence-type"),ug()){Lh(e!==Ri.SESSION,n,"unsupported-persistence-type");return}if(sE()){Lh(e===Ri.NONE,n,"unsupported-persistence-type");return}if(NE()){Lh(e===Ri.NONE||e===Ri.LOCAL&&yd(),n,"unsupported-persistence-type");return}Lh(e===Ri.NONE||ix(),n,"unsupported-persistence-type")}async function e0(n){await n._initializationPromise;const e=ax(),t=sl(sx,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function WU(n,e){const t=ax();if(!t)return[];const i=sl(sx,n,e);switch(t.getItem(i)){case Ri.NONE:return[Yc];case Ri.LOCAL:return[Cd,ul];case Ri.SESSION:return[ul];default:return[]}}function ax(){var n;try{return((n=KU())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YU=ce;class Ua{constructor(){this.browserResolver=Ni(hU),this.cordovaResolver=Ni(VU),this.underlyingResolver=null,this._redirectPersistence=ul,this._completeRedirectFn=wg,this._overrideRedirectResult=RE}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,i,s)}async _openRedirect(e,t,i,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,i,s)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return rx()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return YU(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await $U();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(n){return n.unwrap()}function XU(n){return n.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JU(n){return lx(n)}function ZU(n,e){var t;const i=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new e3(n,L5(n,e))}else if(i){const s=lx(e),o=e;s&&(o.credential=s,o.tenantId=i.tenantId||void 0,o.email=i.email||void 0,o.phoneNumber=i.phoneNumber||void 0)}}function lx(n){const{_tokenResponse:e}=n instanceof Jn?n.customData:n;if(!e)return null;if(!(n instanceof Jn)&&"temporaryProof"in e&&"phoneNumber"in e)return hl.credentialFromResult(n);const t=e.providerId;if(!t||t===Vh.PASSWORD)return null;let i;switch(t){case Vh.GOOGLE:i=Nr;break;case Vh.FACEBOOK:i=xr;break;case Vh.GITHUB:i=Dr;break;case Vh.TWITTER:i=kr;break;default:const{oauthIdToken:s,oauthAccessToken:o,oauthTokenSecret:c,pendingToken:h,nonce:d}=e;return!o&&!c&&!s&&!h?null:h?t.startsWith("saml.")?Xc._create(t,h):qr._fromParams({providerId:t,signInMethod:t,pendingToken:h,idToken:s,accessToken:o}):new zc(t).credential({idToken:s,accessToken:o,rawNonce:d})}return n instanceof Jn?i.credentialFromError(n):i.credentialFromResult(n)}function ci(n,e){return e.catch(t=>{throw t instanceof Jn&&ZU(n,t),t}).then(t=>{const i=t.operationType,s=t.user;return{operationType:i,credential:JU(t),additionalUserInfo:O5(t),user:Tg.getOrCreate(s)}})}async function t0(n,e){const t=await e;return{verificationId:t.verificationId,confirm:i=>ci(n,t.confirm(i))}}class e3{constructor(e,t){this.resolver=t,this.auth=XU(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return ci(ox(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tg=class Yh{constructor(e){this._delegate=e,this.multiFactor=j5(e)}static getOrCreate(e){return Yh.USER_MAP.has(e)||Yh.USER_MAP.set(e,new Yh(e)),Yh.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return ci(this.auth,V1(this._delegate,e))}async linkWithPhoneNumber(e,t){return t0(this.auth,g4(this._delegate,e,t))}async linkWithPopup(e){return ci(this.auth,S4(this._delegate,e,Ua))}async linkWithRedirect(e){return await e0(jt(this.auth)),O4(this._delegate,e,Ua)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return ci(this.auth,L1(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return t0(this.auth,_4(this._delegate,e,t))}reauthenticateWithPopup(e){return ci(this.auth,I4(this._delegate,e,Ua))}async reauthenticateWithRedirect(e){return await e0(jt(this.auth)),k4(this._delegate,e,Ua)}sendEmailVerification(e){return b5(this._delegate,e)}async unlink(e){return await c5(this._delegate,e),this}updateEmail(e){return C5(this._delegate,e)}updatePassword(e){return R5(this._delegate,e)}updatePhoneNumber(e){return y4(this._delegate,e)}updateProfile(e){return A5(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return I5(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Tg.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=ce;class n0{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:i}=e.options;Uh(i,"invalid-api-key",{appName:e.name}),Uh(i,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?Ua:void 0;this._delegate=t.initialize({options:{persistence:t3(i,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(nL),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Tg.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){BL(this._delegate,e,t)}applyActionCode(e){return m5(this._delegate,e)}checkActionCode(e){return U1(this._delegate,e)}confirmPasswordReset(e,t){return f5(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return ci(this._delegate,g5(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return T5(this._delegate,e)}isSignInWithEmailLink(e){return v5(this._delegate,e)}async getRedirectResult(){Uh(Rv(),this._delegate,"operation-not-supported-in-this-environment");const e=await V4(this._delegate,Ua);return e?ci(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){LU(this._delegate,e)}onAuthStateChanged(e,t,i){const{next:s,error:o,complete:c}=CA(e,t,i);return this._delegate.onAuthStateChanged(s,o,c)}onIdTokenChanged(e,t,i){const{next:s,error:o,complete:c}=CA(e,t,i);return this._delegate.onIdTokenChanged(s,o,c)}sendSignInLinkToEmail(e,t){return y5(this._delegate,e,t)}sendPasswordResetEmail(e,t){return d5(this._delegate,e,t||void 0)}async setPersistence(e){QU(this._delegate,e);let t;switch(e){case Ri.SESSION:t=ul;break;case Ri.LOCAL:t=await Ni(Cd)._isAvailable()?Cd:bE;break;case Ri.NONE:t=Yc;break;default:return Mn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return ci(this._delegate,l5(this._delegate))}signInWithCredential(e){return ci(this._delegate,gg(this._delegate,e))}signInWithCustomToken(e){return ci(this._delegate,h5(this._delegate,e))}signInWithEmailAndPassword(e,t){return ci(this._delegate,_5(this._delegate,e,t))}signInWithEmailLink(e,t){return ci(this._delegate,E5(this._delegate,e,t))}signInWithPhoneNumber(e,t){return t0(this._delegate,p4(this._delegate,e,t))}async signInWithPopup(e){return Uh(Rv(),this._delegate,"operation-not-supported-in-this-environment"),ci(this._delegate,b4(this._delegate,e,Ua))}async signInWithRedirect(e){return Uh(Rv(),this._delegate,"operation-not-supported-in-this-environment"),await e0(this._delegate),N4(this._delegate,e,Ua)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return p5(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}n0.Persistence=Ri;function CA(n,e,t){let i=n;typeof n!="function"&&({next:i,error:e,complete:t}=n);const s=i;return{next:c=>s(c&&Tg.getOrCreate(c)),error:e,complete:t}}function t3(n,e){const t=WU(n,e);if(typeof self<"u"&&!t.includes(Cd)&&t.push(Cd),typeof window<"u")for(const i of[bE,ul])t.includes(i)||t.push(i);return t.includes(Yc)||t.push(Yc),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.providerId="phone",this._delegate=new hl(ox(Ye.auth()))}static credential(e,t){return hl.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}DE.PHONE_SIGN_IN_METHOD=hl.PHONE_SIGN_IN_METHOD;DE.PROVIDER_ID=hl.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=ce;class i3{constructor(e,t,i=Ye.app()){var s;n3((s=i.options)===null||s===void 0?void 0:s.apiKey,"invalid-api-key",{appName:i.name}),this._delegate=new f4(i.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3="auth-compat";function s3(n){n.INTERNAL.registerComponent(new _i(r3,e=>{const t=e.getProvider("app-compat").getImmediate(),i=e.getProvider("auth");return new n0(t,i)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ac.EMAIL_SIGNIN,PASSWORD_RESET:Ac.PASSWORD_RESET,RECOVER_EMAIL:Ac.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Ac.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Ac.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Ac.VERIFY_EMAIL}},EmailAuthProvider:co,FacebookAuthProvider:xr,GithubAuthProvider:Dr,GoogleAuthProvider:Nr,OAuthProvider:zc,SAMLAuthProvider:Op,PhoneAuthProvider:DE,PhoneMultiFactorGenerator:tx,RecaptchaVerifier:i3,TwitterAuthProvider:kr,Auth:n0,AuthCredential:vu,Error:Jn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(UU,BU)}s3(Ye);var RA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ol,cx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,x){function N(){}N.prototype=x.prototype,k.D=x.prototype,k.prototype=new N,k.prototype.constructor=k,k.C=function(V,L,C){for(var A=Array(arguments.length-2),se=2;se<arguments.length;se++)A[se-2]=arguments[se];return x.prototype[L].apply(V,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,x,N){N||(N=0);var V=Array(16);if(typeof x=="string")for(var L=0;16>L;++L)V[L]=x.charCodeAt(N++)|x.charCodeAt(N++)<<8|x.charCodeAt(N++)<<16|x.charCodeAt(N++)<<24;else for(L=0;16>L;++L)V[L]=x[N++]|x[N++]<<8|x[N++]<<16|x[N++]<<24;x=k.g[0],N=k.g[1],L=k.g[2];var C=k.g[3],A=x+(C^N&(L^C))+V[0]+3614090360&4294967295;x=N+(A<<7&4294967295|A>>>25),A=C+(L^x&(N^L))+V[1]+3905402710&4294967295,C=x+(A<<12&4294967295|A>>>20),A=L+(N^C&(x^N))+V[2]+606105819&4294967295,L=C+(A<<17&4294967295|A>>>15),A=N+(x^L&(C^x))+V[3]+3250441966&4294967295,N=L+(A<<22&4294967295|A>>>10),A=x+(C^N&(L^C))+V[4]+4118548399&4294967295,x=N+(A<<7&4294967295|A>>>25),A=C+(L^x&(N^L))+V[5]+1200080426&4294967295,C=x+(A<<12&4294967295|A>>>20),A=L+(N^C&(x^N))+V[6]+2821735955&4294967295,L=C+(A<<17&4294967295|A>>>15),A=N+(x^L&(C^x))+V[7]+4249261313&4294967295,N=L+(A<<22&4294967295|A>>>10),A=x+(C^N&(L^C))+V[8]+1770035416&4294967295,x=N+(A<<7&4294967295|A>>>25),A=C+(L^x&(N^L))+V[9]+2336552879&4294967295,C=x+(A<<12&4294967295|A>>>20),A=L+(N^C&(x^N))+V[10]+4294925233&4294967295,L=C+(A<<17&4294967295|A>>>15),A=N+(x^L&(C^x))+V[11]+2304563134&4294967295,N=L+(A<<22&4294967295|A>>>10),A=x+(C^N&(L^C))+V[12]+1804603682&4294967295,x=N+(A<<7&4294967295|A>>>25),A=C+(L^x&(N^L))+V[13]+4254626195&4294967295,C=x+(A<<12&4294967295|A>>>20),A=L+(N^C&(x^N))+V[14]+2792965006&4294967295,L=C+(A<<17&4294967295|A>>>15),A=N+(x^L&(C^x))+V[15]+1236535329&4294967295,N=L+(A<<22&4294967295|A>>>10),A=x+(L^C&(N^L))+V[1]+4129170786&4294967295,x=N+(A<<5&4294967295|A>>>27),A=C+(N^L&(x^N))+V[6]+3225465664&4294967295,C=x+(A<<9&4294967295|A>>>23),A=L+(x^N&(C^x))+V[11]+643717713&4294967295,L=C+(A<<14&4294967295|A>>>18),A=N+(C^x&(L^C))+V[0]+3921069994&4294967295,N=L+(A<<20&4294967295|A>>>12),A=x+(L^C&(N^L))+V[5]+3593408605&4294967295,x=N+(A<<5&4294967295|A>>>27),A=C+(N^L&(x^N))+V[10]+38016083&4294967295,C=x+(A<<9&4294967295|A>>>23),A=L+(x^N&(C^x))+V[15]+3634488961&4294967295,L=C+(A<<14&4294967295|A>>>18),A=N+(C^x&(L^C))+V[4]+3889429448&4294967295,N=L+(A<<20&4294967295|A>>>12),A=x+(L^C&(N^L))+V[9]+568446438&4294967295,x=N+(A<<5&4294967295|A>>>27),A=C+(N^L&(x^N))+V[14]+3275163606&4294967295,C=x+(A<<9&4294967295|A>>>23),A=L+(x^N&(C^x))+V[3]+4107603335&4294967295,L=C+(A<<14&4294967295|A>>>18),A=N+(C^x&(L^C))+V[8]+1163531501&4294967295,N=L+(A<<20&4294967295|A>>>12),A=x+(L^C&(N^L))+V[13]+2850285829&4294967295,x=N+(A<<5&4294967295|A>>>27),A=C+(N^L&(x^N))+V[2]+4243563512&4294967295,C=x+(A<<9&4294967295|A>>>23),A=L+(x^N&(C^x))+V[7]+1735328473&4294967295,L=C+(A<<14&4294967295|A>>>18),A=N+(C^x&(L^C))+V[12]+2368359562&4294967295,N=L+(A<<20&4294967295|A>>>12),A=x+(N^L^C)+V[5]+4294588738&4294967295,x=N+(A<<4&4294967295|A>>>28),A=C+(x^N^L)+V[8]+2272392833&4294967295,C=x+(A<<11&4294967295|A>>>21),A=L+(C^x^N)+V[11]+1839030562&4294967295,L=C+(A<<16&4294967295|A>>>16),A=N+(L^C^x)+V[14]+4259657740&4294967295,N=L+(A<<23&4294967295|A>>>9),A=x+(N^L^C)+V[1]+2763975236&4294967295,x=N+(A<<4&4294967295|A>>>28),A=C+(x^N^L)+V[4]+1272893353&4294967295,C=x+(A<<11&4294967295|A>>>21),A=L+(C^x^N)+V[7]+4139469664&4294967295,L=C+(A<<16&4294967295|A>>>16),A=N+(L^C^x)+V[10]+3200236656&4294967295,N=L+(A<<23&4294967295|A>>>9),A=x+(N^L^C)+V[13]+681279174&4294967295,x=N+(A<<4&4294967295|A>>>28),A=C+(x^N^L)+V[0]+3936430074&4294967295,C=x+(A<<11&4294967295|A>>>21),A=L+(C^x^N)+V[3]+3572445317&4294967295,L=C+(A<<16&4294967295|A>>>16),A=N+(L^C^x)+V[6]+76029189&4294967295,N=L+(A<<23&4294967295|A>>>9),A=x+(N^L^C)+V[9]+3654602809&4294967295,x=N+(A<<4&4294967295|A>>>28),A=C+(x^N^L)+V[12]+3873151461&4294967295,C=x+(A<<11&4294967295|A>>>21),A=L+(C^x^N)+V[15]+530742520&4294967295,L=C+(A<<16&4294967295|A>>>16),A=N+(L^C^x)+V[2]+3299628645&4294967295,N=L+(A<<23&4294967295|A>>>9),A=x+(L^(N|~C))+V[0]+4096336452&4294967295,x=N+(A<<6&4294967295|A>>>26),A=C+(N^(x|~L))+V[7]+1126891415&4294967295,C=x+(A<<10&4294967295|A>>>22),A=L+(x^(C|~N))+V[14]+2878612391&4294967295,L=C+(A<<15&4294967295|A>>>17),A=N+(C^(L|~x))+V[5]+4237533241&4294967295,N=L+(A<<21&4294967295|A>>>11),A=x+(L^(N|~C))+V[12]+1700485571&4294967295,x=N+(A<<6&4294967295|A>>>26),A=C+(N^(x|~L))+V[3]+2399980690&4294967295,C=x+(A<<10&4294967295|A>>>22),A=L+(x^(C|~N))+V[10]+4293915773&4294967295,L=C+(A<<15&4294967295|A>>>17),A=N+(C^(L|~x))+V[1]+2240044497&4294967295,N=L+(A<<21&4294967295|A>>>11),A=x+(L^(N|~C))+V[8]+1873313359&4294967295,x=N+(A<<6&4294967295|A>>>26),A=C+(N^(x|~L))+V[15]+4264355552&4294967295,C=x+(A<<10&4294967295|A>>>22),A=L+(x^(C|~N))+V[6]+2734768916&4294967295,L=C+(A<<15&4294967295|A>>>17),A=N+(C^(L|~x))+V[13]+1309151649&4294967295,N=L+(A<<21&4294967295|A>>>11),A=x+(L^(N|~C))+V[4]+4149444226&4294967295,x=N+(A<<6&4294967295|A>>>26),A=C+(N^(x|~L))+V[11]+3174756917&4294967295,C=x+(A<<10&4294967295|A>>>22),A=L+(x^(C|~N))+V[2]+718787259&4294967295,L=C+(A<<15&4294967295|A>>>17),A=N+(C^(L|~x))+V[9]+3951481745&4294967295,k.g[0]=k.g[0]+x&4294967295,k.g[1]=k.g[1]+(L+(A<<21&4294967295|A>>>11))&4294967295,k.g[2]=k.g[2]+L&4294967295,k.g[3]=k.g[3]+C&4294967295}i.prototype.u=function(k,x){x===void 0&&(x=k.length);for(var N=x-this.blockSize,V=this.B,L=this.h,C=0;C<x;){if(L==0)for(;C<=N;)s(this,k,C),C+=this.blockSize;if(typeof k=="string"){for(;C<x;)if(V[L++]=k.charCodeAt(C++),L==this.blockSize){s(this,V),L=0;break}}else for(;C<x;)if(V[L++]=k[C++],L==this.blockSize){s(this,V),L=0;break}}this.h=L,this.o+=x},i.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var x=1;x<k.length-8;++x)k[x]=0;var N=8*this.o;for(x=k.length-8;x<k.length;++x)k[x]=N&255,N/=256;for(this.u(k),k=Array(16),x=N=0;4>x;++x)for(var V=0;32>V;V+=8)k[N++]=this.g[x]>>>V&255;return k};function o(k,x){var N=h;return Object.prototype.hasOwnProperty.call(N,k)?N[k]:N[k]=x(k)}function c(k,x){this.h=x;for(var N=[],V=!0,L=k.length-1;0<=L;L--){var C=k[L]|0;V&&C==x||(N[L]=C,V=!1)}this.g=N}var h={};function d(k){return-128<=k&&128>k?o(k,function(x){return new c([x|0],0>x?-1:0)}):new c([k|0],0>k?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return v;if(0>k)return Y(p(-k));for(var x=[],N=1,V=0;k>=N;V++)x[V]=k/N|0,N*=4294967296;return new c(x,0)}function _(k,x){if(k.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(k.charAt(0)=="-")return Y(_(k.substring(1),x));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=p(Math.pow(x,8)),V=v,L=0;L<k.length;L+=8){var C=Math.min(8,k.length-L),A=parseInt(k.substring(L,L+C),x);8>C?(C=p(Math.pow(x,C)),V=V.j(C).add(p(A))):(V=V.j(N),V=V.add(p(A)))}return V}var v=d(0),T=d(1),R=d(16777216);n=c.prototype,n.m=function(){if(q(this))return-Y(this).m();for(var k=0,x=1,N=0;N<this.g.length;N++){var V=this.i(N);k+=(0<=V?V:4294967296+V)*x,x*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(P(this))return"0";if(q(this))return"-"+Y(this).toString(k);for(var x=p(Math.pow(k,6)),N=this,V="";;){var L=de(N,x).g;N=le(N,L.j(x));var C=((0<N.g.length?N.g[0]:N.h)>>>0).toString(k);if(N=L,P(N))return C+V;for(;6>C.length;)C="0"+C;V=C+V}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function P(k){if(k.h!=0)return!1;for(var x=0;x<k.g.length;x++)if(k.g[x]!=0)return!1;return!0}function q(k){return k.h==-1}n.l=function(k){return k=le(this,k),q(k)?-1:P(k)?0:1};function Y(k){for(var x=k.g.length,N=[],V=0;V<x;V++)N[V]=~k.g[V];return new c(N,~k.h).add(T)}n.abs=function(){return q(this)?Y(this):this},n.add=function(k){for(var x=Math.max(this.g.length,k.g.length),N=[],V=0,L=0;L<=x;L++){var C=V+(this.i(L)&65535)+(k.i(L)&65535),A=(C>>>16)+(this.i(L)>>>16)+(k.i(L)>>>16);V=A>>>16,C&=65535,A&=65535,N[L]=A<<16|C}return new c(N,N[N.length-1]&-2147483648?-1:0)};function le(k,x){return k.add(Y(x))}n.j=function(k){if(P(this)||P(k))return v;if(q(this))return q(k)?Y(this).j(Y(k)):Y(Y(this).j(k));if(q(k))return Y(this.j(Y(k)));if(0>this.l(R)&&0>k.l(R))return p(this.m()*k.m());for(var x=this.g.length+k.g.length,N=[],V=0;V<2*x;V++)N[V]=0;for(V=0;V<this.g.length;V++)for(var L=0;L<k.g.length;L++){var C=this.i(V)>>>16,A=this.i(V)&65535,se=k.i(L)>>>16,Ae=k.i(L)&65535;N[2*V+2*L]+=A*Ae,Ee(N,2*V+2*L),N[2*V+2*L+1]+=C*Ae,Ee(N,2*V+2*L+1),N[2*V+2*L+1]+=A*se,Ee(N,2*V+2*L+1),N[2*V+2*L+2]+=C*se,Ee(N,2*V+2*L+2)}for(V=0;V<x;V++)N[V]=N[2*V+1]<<16|N[2*V];for(V=x;V<2*x;V++)N[V]=0;return new c(N,0)};function Ee(k,x){for(;(k[x]&65535)!=k[x];)k[x+1]+=k[x]>>>16,k[x]&=65535,x++}function oe(k,x){this.g=k,this.h=x}function de(k,x){if(P(x))throw Error("division by zero");if(P(k))return new oe(v,v);if(q(k))return x=de(Y(k),x),new oe(Y(x.g),Y(x.h));if(q(x))return x=de(k,Y(x)),new oe(Y(x.g),x.h);if(30<k.g.length){if(q(k)||q(x))throw Error("slowDivide_ only works with positive integers.");for(var N=T,V=x;0>=V.l(k);)N=Pe(N),V=Pe(V);var L=Re(N,1),C=Re(V,1);for(V=Re(V,2),N=Re(N,2);!P(V);){var A=C.add(V);0>=A.l(k)&&(L=L.add(N),C=A),V=Re(V,1),N=Re(N,1)}return x=le(k,L.j(x)),new oe(L,x)}for(L=v;0<=k.l(x);){for(N=Math.max(1,Math.floor(k.m()/x.m())),V=Math.ceil(Math.log(N)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),C=p(N),A=C.j(x);q(A)||0<A.l(k);)N-=V,C=p(N),A=C.j(x);P(C)&&(C=T),L=L.add(C),k=le(k,A)}return new oe(L,k)}n.A=function(k){return de(this,k).h},n.and=function(k){for(var x=Math.max(this.g.length,k.g.length),N=[],V=0;V<x;V++)N[V]=this.i(V)&k.i(V);return new c(N,this.h&k.h)},n.or=function(k){for(var x=Math.max(this.g.length,k.g.length),N=[],V=0;V<x;V++)N[V]=this.i(V)|k.i(V);return new c(N,this.h|k.h)},n.xor=function(k){for(var x=Math.max(this.g.length,k.g.length),N=[],V=0;V<x;V++)N[V]=this.i(V)^k.i(V);return new c(N,this.h^k.h)};function Pe(k){for(var x=k.g.length+1,N=[],V=0;V<x;V++)N[V]=k.i(V)<<1|k.i(V-1)>>>31;return new c(N,k.h)}function Re(k,x){var N=x>>5;x%=32;for(var V=k.g.length-N,L=[],C=0;C<V;C++)L[C]=0<x?k.i(C+N)>>>x|k.i(C+N+1)<<32-x:k.i(C+N);return new c(L,k.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,cx=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=_,ol=c}).apply(typeof RA<"u"?RA:typeof self<"u"?self:typeof window<"u"?window:{});var op=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ux,Xh,hx,vp,i0,dx,fx,mx;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,w){return f==Array.prototype||f==Object.prototype||(f[y]=w.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof op=="object"&&op];for(var y=0;y<f.length;++y){var w=f[y];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=t(this);function s(f,y){if(y)e:{var w=i;f=f.split(".");for(var S=0;S<f.length-1;S++){var B=f[S];if(!(B in w))break e;w=w[B]}f=f[f.length-1],S=w[f],y=y(S),y!=S&&y!=null&&e(w,f,{configurable:!0,writable:!0,value:y})}}function o(f,y){f instanceof String&&(f+="");var w=0,S=!1,B={next:function(){if(!S&&w<f.length){var Q=w++;return{value:y(Q,f[Q]),done:!1}}return S=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(f){return f||function(){return o(this,function(y,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},h=this||self;function d(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function p(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function _(f,y,w){return f.call.apply(f.bind,arguments)}function v(f,y,w){if(!f)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,S),f.apply(y,B)}}return function(){return f.apply(y,arguments)}}function T(f,y,w){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:v,T.apply(null,arguments)}function R(f,y){var w=Array.prototype.slice.call(arguments,1);return function(){var S=w.slice();return S.push.apply(S,arguments),f.apply(this,S)}}function P(f,y){function w(){}w.prototype=y.prototype,f.aa=y.prototype,f.prototype=new w,f.prototype.constructor=f,f.Qb=function(S,B,Q){for(var he=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)he[lt-2]=arguments[lt];return y.prototype[B].apply(S,he)}}function q(f){const y=f.length;if(0<y){const w=Array(y);for(let S=0;S<y;S++)w[S]=f[S];return w}return[]}function Y(f,y){for(let w=1;w<arguments.length;w++){const S=arguments[w];if(d(S)){const B=f.length||0,Q=S.length||0;f.length=B+Q;for(let he=0;he<Q;he++)f[B+he]=S[he]}else f.push(S)}}class le{constructor(y,w){this.i=y,this.j=w,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function Ee(f){return/^[\s\xa0]*$/.test(f)}function oe(){var f=h.navigator;return f&&(f=f.userAgent)?f:""}function de(f){return de[" "](f),f}de[" "]=function(){};var Pe=oe().indexOf("Gecko")!=-1&&!(oe().toLowerCase().indexOf("webkit")!=-1&&oe().indexOf("Edge")==-1)&&!(oe().indexOf("Trident")!=-1||oe().indexOf("MSIE")!=-1)&&oe().indexOf("Edge")==-1;function Re(f,y,w){for(const S in f)y.call(w,f[S],S,f)}function k(f,y){for(const w in f)y.call(void 0,f[w],w,f)}function x(f){const y={};for(const w in f)y[w]=f[w];return y}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(f,y){let w,S;for(let B=1;B<arguments.length;B++){S=arguments[B];for(w in S)f[w]=S[w];for(let Q=0;Q<N.length;Q++)w=N[Q],Object.prototype.hasOwnProperty.call(S,w)&&(f[w]=S[w])}}function L(f){var y=1;f=f.split(":");const w=[];for(;0<y&&f.length;)w.push(f.shift()),y--;return f.length&&w.push(f.join(":")),w}function C(f){h.setTimeout(()=>{throw f},0)}function A(){var f=Oe;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class se{constructor(){this.h=this.g=null}add(y,w){const S=Ae.get();S.set(y,w),this.h?this.h.next=S:this.g=S,this.h=S}}var Ae=new le(()=>new H,f=>f.reset());class H{constructor(){this.next=this.g=this.h=null}set(y,w){this.h=y,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,X=!1,Oe=new se,Be=()=>{const f=h.Promise.resolve(void 0);ee=()=>{f.then(O)}};var O=()=>{for(var f;f=A();){try{f.h.call(f.g)}catch(w){C(w)}var y=Ae;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}X=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var ae=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const w=()=>{};h.addEventListener("test",w,y),h.removeEventListener("test",w,y)}catch{}return f})();function me(f,y){if(ne.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var w=this.type=f.type,S=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(Pe){e:{try{de(y.nodeName);var B=!0;break e}catch{}B=!1}B||(y=null)}}else w=="mouseover"?y=f.fromElement:w=="mouseout"&&(y=f.toElement);this.relatedTarget=y,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:_e[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&me.aa.h.call(this)}}P(me,ne);var _e={2:"touch",3:"pen",4:"mouse"};me.prototype.h=function(){me.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Se="closure_listenable_"+(1e6*Math.random()|0),_t=0;function tt(f,y,w,S,B){this.listener=f,this.proxy=null,this.src=y,this.type=w,this.capture=!!S,this.ha=B,this.key=++_t,this.da=this.fa=!1}function hn(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function tr(f){this.src=f,this.g={},this.h=0}tr.prototype.add=function(f,y,w,S,B){var Q=f.toString();f=this.g[Q],f||(f=this.g[Q]=[],this.h++);var he=Ll(f,y,S,B);return-1<he?(y=f[he],w||(y.fa=!1)):(y=new tt(y,this.src,Q,!!S,B),y.fa=w,f.push(y)),y};function go(f,y){var w=y.type;if(w in f.g){var S=f.g[w],B=Array.prototype.indexOf.call(S,y,void 0),Q;(Q=0<=B)&&Array.prototype.splice.call(S,B,1),Q&&(hn(y),f.g[w].length==0&&(delete f.g[w],f.h--))}}function Ll(f,y,w,S){for(var B=0;B<f.length;++B){var Q=f[B];if(!Q.da&&Q.listener==y&&Q.capture==!!w&&Q.ha==S)return B}return-1}var nr="closure_lm_"+(1e6*Math.random()|0),_o={};function Ul(f,y,w,S,B){if(Array.isArray(y)){for(var Q=0;Q<y.length;Q++)Ul(f,y[Q],w,S,B);return null}return w=kf(w),f&&f[Se]?f.K(y,w,p(S)?!!S.capture:!1,B):u_(f,y,w,!1,S,B)}function u_(f,y,w,S,B,Q){if(!y)throw Error("Invalid event type");var he=p(B)?!!B.capture:!!B,lt=Pu(f);if(lt||(f[nr]=lt=new tr(f)),w=lt.add(y,w,S,he,Q),w.proxy)return w;if(S=Df(),w.proxy=S,S.src=f,S.listener=w,f.addEventListener)ae||(B=he),B===void 0&&(B=!1),f.addEventListener(y.toString(),S,B);else if(f.attachEvent)f.attachEvent(Fl(y.toString()),S);else if(f.addListener&&f.removeListener)f.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Df(){function f(w){return y.call(f.src,f.listener,w)}const y=h_;return f}function Bl(f,y,w,S,B){if(Array.isArray(y))for(var Q=0;Q<y.length;Q++)Bl(f,y[Q],w,S,B);else S=p(S)?!!S.capture:!!S,w=kf(w),f&&f[Se]?(f=f.i,y=String(y).toString(),y in f.g&&(Q=f.g[y],w=Ll(Q,w,S,B),-1<w&&(hn(Q[w]),Array.prototype.splice.call(Q,w,1),Q.length==0&&(delete f.g[y],f.h--)))):f&&(f=Pu(f))&&(y=f.g[y.toString()],f=-1,y&&(f=Ll(y,w,S,B)),(w=-1<f?y[f]:null)&&yo(w))}function yo(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[Se])go(y.i,f);else{var w=f.type,S=f.proxy;y.removeEventListener?y.removeEventListener(w,S,f.capture):y.detachEvent?y.detachEvent(Fl(w),S):y.addListener&&y.removeListener&&y.removeListener(S),(w=Pu(y))?(go(w,f),w.h==0&&(w.src=null,y[nr]=null)):hn(f)}}}function Fl(f){return f in _o?_o[f]:_o[f]="on"+f}function h_(f,y){if(f.da)f=!0;else{y=new me(y,this);var w=f.listener,S=f.ha||f.src;f.fa&&yo(f),f=w.call(S,y)}return f}function Pu(f){return f=f[nr],f instanceof tr?f:null}var Sn="__closure_events_fn_"+(1e9*Math.random()>>>0);function kf(f){return typeof f=="function"?f:(f[Sn]||(f[Sn]=function(y){return f.handleEvent(y)}),f[Sn])}function sn(){W.call(this),this.i=new tr(this),this.M=this,this.F=null}P(sn,W),sn.prototype[Se]=!0,sn.prototype.removeEventListener=function(f,y,w,S){Bl(this,f,y,w,S)};function dn(f,y){var w,S=f.F;if(S)for(w=[];S;S=S.F)w.push(S);if(f=f.M,S=y.type||y,typeof y=="string")y=new ne(y,f);else if(y instanceof ne)y.target=y.target||f;else{var B=y;y=new ne(S,f),V(y,B)}if(B=!0,w)for(var Q=w.length-1;0<=Q;Q--){var he=y.g=w[Q];B=Wr(he,S,!0,y)&&B}if(he=y.g=f,B=Wr(he,S,!0,y)&&B,B=Wr(he,S,!1,y)&&B,w)for(Q=0;Q<w.length;Q++)he=y.g=w[Q],B=Wr(he,S,!1,y)&&B}sn.prototype.N=function(){if(sn.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var w=f.g[y],S=0;S<w.length;S++)hn(w[S]);delete f.g[y],f.h--}}this.F=null},sn.prototype.K=function(f,y,w,S){return this.i.add(String(f),y,!1,w,S)},sn.prototype.L=function(f,y,w,S){return this.i.add(String(f),y,!0,w,S)};function Wr(f,y,w,S){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var B=!0,Q=0;Q<y.length;++Q){var he=y[Q];if(he&&!he.da&&he.capture==w){var lt=he.listener,Xt=he.ha||he.src;he.fa&&go(f.i,he),B=lt.call(Xt,S)!==!1&&B}}return B&&!S.defaultPrevented}function Pf(f,y,w){if(typeof f=="function")w&&(f=T(f,w));else if(f&&typeof f.handleEvent=="function")f=T(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:h.setTimeout(f,y||0)}function Ou(f){f.g=Pf(()=>{f.g=null,f.i&&(f.i=!1,Ou(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class d_ extends W{constructor(y,w){super(),this.m=y,this.l=w,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Ou(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vo(f){W.call(this),this.h=f,this.g={}}P(vo,W);var zs=[];function Vn(f){Re(f.g,function(y,w){this.g.hasOwnProperty(w)&&yo(y)},f),f.g={}}vo.prototype.N=function(){vo.aa.N.call(this),Vn(this)},vo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mi=h.JSON.stringify,zn=h.JSON.parse,f_=class{stringify(f){return h.JSON.stringify(f,void 0)}parse(f){return h.JSON.parse(f,void 0)}};function Mu(){}Mu.prototype.h=null;function Of(f){return f.h||(f.h=f.i())}function Eo(){}var gr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qs(){ne.call(this,"d")}P(qs,ne);function ir(){ne.call(this,"c")}P(ir,ne);var Vi={},Gs=null;function jl(){return Gs=Gs||new sn}Vi.La="serverreachability";function Vu(f){ne.call(this,Vi.La,f)}P(Vu,ne);function Yr(f){const y=jl();dn(y,new Vu(y))}Vi.STAT_EVENT="statevent";function Hs(f,y){ne.call(this,Vi.STAT_EVENT,f),this.stat=y}P(Hs,ne);function An(f){const y=jl();dn(y,new Hs(y,f))}Vi.Ma="timingevent";function Lu(f,y){ne.call(this,Vi.Ma,f),this.size=y}P(Lu,ne);function $s(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){f()},y)}function Ks(){this.g=!0}Ks.prototype.xa=function(){this.g=!1};function Uu(f,y,w,S,B,Q){f.info(function(){if(f.g)if(Q)for(var he="",lt=Q.split("&"),Xt=0;Xt<lt.length;Xt++){var je=lt[Xt].split("=");if(1<je.length){var mn=je[0];je=je[1];var pn=mn.split("_");he=2<=pn.length&&pn[1]=="type"?he+(mn+"="+je+"&"):he+(mn+"=redacted&")}}else he=null;else he=Q;return"XMLHTTP REQ ("+S+") [attempt "+B+"]: "+y+`
`+w+`
`+he})}function Bu(f,y,w,S,B,Q,he){f.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+B+"]: "+y+`
`+w+`
`+Q+" "+he})}function Xr(f,y,w,S){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+_r(f,w)+(S?" "+S:"")})}function Mf(f,y){f.info(function(){return"TIMEOUT: "+y})}Ks.prototype.info=function(){};function _r(f,y){if(!f.g)return y;if(!y)return null;try{var w=JSON.parse(y);if(w){for(f=0;f<w.length;f++)if(Array.isArray(w[f])){var S=w[f];if(!(2>S.length)){var B=S[1];if(Array.isArray(B)&&!(1>B.length)){var Q=B[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var he=1;he<B.length;he++)B[he]=""}}}}return Mi(w)}catch{return y}}var Vt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Cn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yr;function Qs(){}P(Qs,Mu),Qs.prototype.g=function(){return new XMLHttpRequest},Qs.prototype.i=function(){return{}},yr=new Qs;function vr(f,y,w,S){this.j=f,this.i=y,this.l=w,this.R=S||1,this.U=new vo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Vf}function Vf(){this.i=null,this.g="",this.h=!1}var Fu={},Jr={};function wo(f,y,w){f.L=1,f.v=Io(Lt(y)),f.m=w,f.P=!0,Zr(f,null)}function Zr(f,y){f.F=Date.now(),rr(f),f.A=Lt(f.v);var w=f.A,S=f.R;Array.isArray(S)||(S=[String(S)]),ns(w.i,"t",S),f.C=0,w=f.j.J,f.h=new Vf,f.g=Jf(f.j,w?y:null,!f.m),0<f.O&&(f.M=new d_(T(f.Y,f,f.g),f.O)),y=f.U,w=f.g,S=f.ca;var B="readystatechange";Array.isArray(B)||(B&&(zs[0]=B.toString()),B=zs);for(var Q=0;Q<B.length;Q++){var he=Ul(w,B[Q],S||y.handleEvent,!1,y.h||y);if(!he)break;y.g[he.key]=he}y=f.H?x(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),Yr(),Uu(f.i,f.u,f.A,f.l,f.R,f.m)}vr.prototype.ca=function(f){f=f.target;const y=this.M;y&&Hn(f)==3?y.j():this.Y(f)},vr.prototype.Y=function(f){try{if(f==this.g)e:{const pn=Hn(this.g);var y=this.g.Ba();const oa=this.g.Z();if(!(3>pn)&&(pn!=3||this.g&&(this.h.h||this.g.oa()||Co(this.g)))){this.J||pn!=4||y==7||(y==8||0>=oa?Yr(3):Yr(2)),zl(this);var w=this.g.Z();this.X=w;t:if(es(this)){var S=Co(this.g);f="";var B=S.length,Q=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qn(this),Ws(this);var he="";break t}this.h.i=new h.TextDecoder}for(y=0;y<B;y++)this.h.h=!0,f+=this.h.i.decode(S[y],{stream:!(Q&&y==B-1)});S.length=0,this.h.g+=f,this.C=0,he=this.h.g}else he=this.g.oa();if(this.o=w==200,Bu(this.i,this.u,this.A,this.l,this.R,pn,w),this.o){if(this.T&&!this.K){t:{if(this.g){var lt,Xt=this.g;if((lt=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ee(lt)){var je=lt;break t}}je=null}if(w=je)Xr(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Er(this,w);else{this.o=!1,this.s=3,An(12),qn(this),Ws(this);break e}}if(this.P){w=!0;let ii;for(;!this.J&&this.C<he.length;)if(ii=To(this,he),ii==Jr){pn==4&&(this.s=4,An(14),w=!1),Xr(this.i,this.l,null,"[Incomplete Response]");break}else if(ii==Fu){this.s=4,An(15),Xr(this.i,this.l,he,"[Invalid Chunk]"),w=!1;break}else Xr(this.i,this.l,ii,null),Er(this,ii);if(es(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pn!=4||he.length!=0||this.h.h||(this.s=1,An(16),w=!1),this.o=this.o&&w,!w)Xr(this.i,this.l,he,"[Invalid Chunked Response]"),qn(this),Ws(this);else if(0<he.length&&!this.W){this.W=!0;var mn=this.j;mn.g==this&&mn.ba&&!mn.M&&(mn.j.info("Great, no buffering proxy detected. Bytes received: "+he.length),Xu(mn),mn.M=!0,An(11))}}else Xr(this.i,this.l,he,null),Er(this,he);pn==4&&qn(this),this.o&&!this.J&&(pn==4?Wf(this.j,this):(this.o=!1,rr(this)))}else qf(this.g),w==400&&0<he.indexOf("Unknown SID")?(this.s=3,An(12)):(this.s=0,An(13)),qn(this),Ws(this)}}}catch{}finally{}};function es(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function To(f,y){var w=f.C,S=y.indexOf(`
`,w);return S==-1?Jr:(w=Number(y.substring(w,S)),isNaN(w)?Fu:(S+=1,S+w>y.length?Jr:(y=y.slice(S,S+w),f.C=S+w,y)))}vr.prototype.cancel=function(){this.J=!0,qn(this)};function rr(f){f.S=Date.now()+f.I,Ht(f,f.I)}function Ht(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=$s(T(f.ba,f),y)}function zl(f){f.B&&(h.clearTimeout(f.B),f.B=null)}vr.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(Mf(this.i,this.A),this.L!=2&&(Yr(),An(17)),qn(this),this.s=2,Ws(this)):Ht(this,this.S-f)};function Ws(f){f.j.G==0||f.J||Wf(f.j,f)}function qn(f){zl(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,Vn(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function Er(f,y){try{var w=f.j;if(w.G!=0&&(w.g==f||Ys(w.h,f))){if(!f.K&&Ys(w.h,f)&&w.G==3){try{var S=w.Da.g.parse(y)}catch{S=null}if(Array.isArray(S)&&S.length==3){var B=S;if(B[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<f.F)sa(w),ra(w);else break e;Yu(w),An(18)}}else w.za=B[1],0<w.za-w.T&&37500>B[2]&&w.F&&w.v==0&&!w.C&&(w.C=$s(T(w.Za,w),6e3));if(1>=Lf(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else rs(w,11)}else if((f.K||w.g==f)&&sa(w),!Ee(y))for(B=w.Da.g.parse(y),y=0;y<B.length;y++){let je=B[y];if(w.T=je[0],je=je[1],w.G==2)if(je[0]=="c"){w.K=je[1],w.ia=je[2];const mn=je[3];mn!=null&&(w.la=mn,w.j.info("VER="+w.la));const pn=je[4];pn!=null&&(w.Aa=pn,w.j.info("SVER="+w.Aa));const oa=je[5];oa!=null&&typeof oa=="number"&&0<oa&&(S=1.5*oa,w.L=S,w.j.info("backChannelRequestTimeoutMs_="+S)),S=w;const ii=f.g;if(ii){const No=ii.g?ii.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(No){var Q=S.h;Q.g||No.indexOf("spdy")==-1&&No.indexOf("quic")==-1&&No.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Xs(Q,Q.h),Q.h=null))}if(S.D){const ss=ii.g?ii.g.getResponseHeader("X-HTTP-Session-Id"):null;ss&&(S.ya=ss,nt(S.I,S.D,ss))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-f.F,w.j.info("Handshake RTT: "+w.R+"ms")),S=w;var he=f;if(S.qa=Xf(S,S.J?S.ia:null,S.W),he.K){Li(S.h,he);var lt=he,Xt=S.L;Xt&&(lt.I=Xt),lt.B&&(zl(lt),rr(lt)),S.g=he}else Kf(S);0<w.i.length&&Yl(w)}else je[0]!="stop"&&je[0]!="close"||rs(w,7);else w.G==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?rs(w,7):Qu(w):je[0]!="noop"&&w.l&&w.l.ta(je),w.v=0)}}Yr(4)}catch{}}var m_=class{constructor(f,y){this.g=f,this.map=y}};function ju(f){this.l=f||10,h.PerformanceNavigationTiming?(f=h.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zu(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Lf(f){return f.h?1:f.g?f.g.size:0}function Ys(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function Xs(f,y){f.g?f.g.add(y):f.h=y}function Li(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}ju.prototype.cancel=function(){if(this.i=Gn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Gn(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const w of f.g.values())y=y.concat(w.D);return y}return q(f.i)}function Uf(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(d(f)){for(var y=[],w=f.length,S=0;S<w;S++)y.push(f[S]);return y}y=[],w=0;for(S in f)y[w++]=f[S];return y}function p_(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(d(f)||typeof f=="string"){var y=[];f=f.length;for(var w=0;w<f;w++)y.push(w);return y}y=[],w=0;for(const S in f)y[w++]=S;return y}}}function ql(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(d(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var w=p_(f),S=Uf(f),B=S.length,Q=0;Q<B;Q++)y.call(void 0,S[Q],w&&w[Q],f)}var qu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Gl(f,y){if(f){f=f.split("&");for(var w=0;w<f.length;w++){var S=f[w].indexOf("="),B=null;if(0<=S){var Q=f[w].substring(0,S);B=f[w].substring(S+1)}else Q=f[w];y(Q,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function ts(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof ts){this.h=f.h,Js(this,f.j),this.o=f.o,this.g=f.g,bo(this,f.s),this.l=f.l;var y=f.i,w=new wr;w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),Hl(this,w),this.m=f.m}else f&&(y=String(f).match(qu))?(this.h=!1,Js(this,y[1]||"",!0),this.o=Zs(y[2]||""),this.g=Zs(y[3]||"",!0),bo(this,y[4]),this.l=Zs(y[5]||"",!0),Hl(this,y[6]||"",!0),this.m=Zs(y[7]||"")):(this.h=!1,this.i=new wr(null,this.h))}ts.prototype.toString=function(){var f=[],y=this.j;y&&f.push(Ui(y,Gu,!0),":");var w=this.g;return(w||y=="file")&&(f.push("//"),(y=this.o)&&f.push(Ui(y,Gu,!0),"@"),f.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&f.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&f.push("/"),f.push(Ui(w,w.charAt(0)=="/"?Hu:Bf,!0))),(w=this.i.toString())&&f.push("?",w),(w=this.m)&&f.push("#",Ui(w,y_)),f.join("")};function Lt(f){return new ts(f)}function Js(f,y,w){f.j=w?Zs(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function bo(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function Hl(f,y,w){y instanceof wr?(f.i=y,Ff(f.i,f.h)):(w||(y=Ui(y,__)),f.i=new wr(y,f.h))}function nt(f,y,w){f.i.set(y,w)}function Io(f){return nt(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Zs(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ui(f,y,w){return typeof f=="string"?(f=encodeURI(f).replace(y,g_),w&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function g_(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Gu=/[#\/\?@]/g,Bf=/[#\?:]/g,Hu=/[#\?]/g,__=/[#\?@]/g,y_=/#/g;function wr(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function fn(f){f.g||(f.g=new Map,f.h=0,f.i&&Gl(f.i,function(y,w){f.add(decodeURIComponent(y.replace(/\+/g," ")),w)}))}n=wr.prototype,n.add=function(f,y){fn(this),this.i=null,f=vi(this,f);var w=this.g.get(f);return w||this.g.set(f,w=[]),w.push(y),this.h+=1,this};function $l(f,y){fn(f),y=vi(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function Kl(f,y){return fn(f),y=vi(f,y),f.g.has(y)}n.forEach=function(f,y){fn(this),this.g.forEach(function(w,S){w.forEach(function(B){f.call(y,B,S,this)},this)},this)},n.na=function(){fn(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),w=[];for(let S=0;S<y.length;S++){const B=f[S];for(let Q=0;Q<B.length;Q++)w.push(y[S])}return w},n.V=function(f){fn(this);let y=[];if(typeof f=="string")Kl(this,f)&&(y=y.concat(this.g.get(vi(this,f))));else{f=Array.from(this.g.values());for(let w=0;w<f.length;w++)y=y.concat(f[w])}return y},n.set=function(f,y){return fn(this),this.i=null,f=vi(this,f),Kl(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},n.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function ns(f,y,w){$l(f,y),0<w.length&&(f.i=null,f.g.set(vi(f,y),q(w)),f.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var w=0;w<y.length;w++){var S=y[w];const Q=encodeURIComponent(String(S)),he=this.V(S);for(S=0;S<he.length;S++){var B=Q;he[S]!==""&&(B+="="+encodeURIComponent(String(he[S]))),f.push(B)}}return this.i=f.join("&")};function vi(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function Ff(f,y){y&&!f.j&&(fn(f),f.i=null,f.g.forEach(function(w,S){var B=S.toLowerCase();S!=B&&($l(this,S),ns(this,B,w))},f)),f.j=y}function $u(f,y){const w=new Ks;if(h.Image){const S=new Image;S.onload=R(ni,w,"TestLoadImage: loaded",!0,y,S),S.onerror=R(ni,w,"TestLoadImage: error",!1,y,S),S.onabort=R(ni,w,"TestLoadImage: abort",!1,y,S),S.ontimeout=R(ni,w,"TestLoadImage: timeout",!1,y,S),h.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=f}else y(!1)}function jf(f,y){const w=new Ks,S=new AbortController,B=setTimeout(()=>{S.abort(),ni(w,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:S.signal}).then(Q=>{clearTimeout(B),Q.ok?ni(w,"TestPingServer: ok",!0,y):ni(w,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(B),ni(w,"TestPingServer: error",!1,y)})}function ni(f,y,w,S,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),S(w)}catch{}}function sr(){this.g=new f_}function Ku(f,y,w){const S=w||"";try{ql(f,function(B,Q){let he=B;p(B)&&(he=Mi(B)),y.push(S+Q+"="+encodeURIComponent(he))})}catch(B){throw y.push(S+"type="+encodeURIComponent("_badmap")),B}}function Tr(f){this.l=f.Ub||null,this.j=f.eb||!1}P(Tr,Mu),Tr.prototype.g=function(){return new Ei(this.l,this.j)},Tr.prototype.i=(function(f){return function(){return f}})({});function Ei(f,y){sn.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(Ei,sn),n=Ei.prototype,n.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,ea(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||h).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,br(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,ea(this)),this.g&&(this.readyState=3,ea(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ql(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ql(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?br(this):ea(this),this.readyState==3&&Ql(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,br(this))},n.Qa=function(f){this.g&&(this.response=f,br(this))},n.ga=function(){this.g&&br(this)};function br(f){f.readyState=4,f.l=null,f.j=null,f.v=null,ea(f)}n.setRequestHeader=function(f,y){this.u.append(f,y)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var w=y.next();!w.done;)w=w.value,f.push(w[0]+": "+w[1]),w=y.next();return f.join(`\r
`)};function ea(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ei.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function So(f){let y="";return Re(f,function(w,S){y+=S,y+=":",y+=w,y+=`\r
`}),y}function ta(f,y,w){e:{for(S in w){var S=!1;break e}S=!0}S||(w=So(w),typeof f=="string"?w!=null&&encodeURIComponent(String(w)):nt(f,y,w))}function Tt(f){sn.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(Tt,sn);var Ln=/^https?$/i,is=["POST","PUT"];n=Tt.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,y,w,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yr.g(),this.v=this.o?Of(this.o):Of(yr),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(Q){Ao(this,Q);return}if(f=w||"",w=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var B in S)w.set(B,S[B]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const Q of S.keys())w.set(Q,S.get(Q));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(w.keys()).find(Q=>Q.toLowerCase()=="content-type"),B=h.FormData&&f instanceof h.FormData,!(0<=Array.prototype.indexOf.call(is,y,void 0))||S||B||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,he]of w)this.g.setRequestHeader(Q,he);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wl(this),this.u=!0,this.g.send(f),this.u=!1}catch(Q){Ao(this,Q)}};function Ao(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,na(f),ia(f)}function na(f){f.A||(f.A=!0,dn(f,"complete"),dn(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,dn(this,"complete"),dn(this,"abort"),ia(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ia(this,!0)),Tt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?zf(this):this.bb())},n.bb=function(){zf(this)};function zf(f){if(f.h&&typeof c<"u"&&(!f.v[1]||Hn(f)!=4||f.Z()!=2)){if(f.u&&Hn(f)==4)Pf(f.Ea,0,f);else if(dn(f,"readystatechange"),Hn(f)==4){f.h=!1;try{const he=f.Z();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var w;if(!(w=y)){var S;if(S=he===0){var B=String(f.D).match(qu)[1]||null;!B&&h.self&&h.self.location&&(B=h.self.location.protocol.slice(0,-1)),S=!Ln.test(B?B.toLowerCase():"")}w=S}if(w)dn(f,"complete"),dn(f,"success");else{f.m=6;try{var Q=2<Hn(f)?f.g.statusText:""}catch{Q=""}f.l=Q+" ["+f.Z()+"]",na(f)}}finally{ia(f)}}}}function ia(f,y){if(f.g){Wl(f);const w=f.g,S=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||dn(f,"ready");try{w.onreadystatechange=S}catch{}}}function Wl(f){f.I&&(h.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function Hn(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),zn(y)}};function Co(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function qf(f){const y={};f=(f.g&&2<=Hn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<f.length;S++){if(Ee(f[S]))continue;var w=L(f[S]);const B=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const Q=y[B]||[];y[B]=Q,Q.push(w)}k(y,function(S){return S.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ro(f,y,w){return w&&w.internalChannelParams&&w.internalChannelParams[f]||y}function Gf(f){this.Aa=0,this.i=[],this.j=new Ks,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ro("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ro("baseRetryDelayMs",5e3,f),this.cb=Ro("retryDelaySeedMs",1e4,f),this.Wa=Ro("forwardChannelMaxRetries",2,f),this.wa=Ro("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ju(f&&f.concurrentRequestLimit),this.Da=new sr,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Gf.prototype,n.la=8,n.G=1,n.connect=function(f,y,w,S){An(0),this.W=f,this.H=y||{},w&&S!==void 0&&(this.H.OSID=w,this.H.OAID=S),this.F=this.X,this.I=Xf(this,null,this.W),Yl(this)};function Qu(f){if(Hf(f),f.G==3){var y=f.U++,w=Lt(f.I);if(nt(w,"SID",f.K),nt(w,"RID",y),nt(w,"TYPE","terminate"),xo(f,w),y=new vr(f,f.j,y),y.L=2,y.v=Io(Lt(w)),w=!1,h.navigator&&h.navigator.sendBeacon)try{w=h.navigator.sendBeacon(y.v.toString(),"")}catch{}!w&&h.Image&&(new Image().src=y.v,w=!0),w||(y.g=Jf(y.j,null),y.g.ea(y.v)),y.F=Date.now(),rr(y)}Ju(f)}function ra(f){f.g&&(Xu(f),f.g.cancel(),f.g=null)}function Hf(f){ra(f),f.u&&(h.clearTimeout(f.u),f.u=null),sa(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&h.clearTimeout(f.s),f.s=null)}function Yl(f){if(!zu(f.h)&&!f.s){f.s=!0;var y=f.Ga;ee||Be(),X||(ee(),X=!0),Oe.add(y,f),f.B=0}}function v_(f,y){return Lf(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=$s(T(f.Ga,f,y),Yf(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const B=new vr(this,this.j,f);let Q=this.o;if(this.S&&(Q?(Q=x(Q),V(Q,this.S)):Q=this.S),this.m!==null||this.O||(B.H=Q,Q=null),this.P)e:{for(var y=0,w=0;w<this.i.length;w++){t:{var S=this.i[w];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(y+=S,4096<y){y=w;break e}if(y===4096||w===this.i.length-1){y=w+1;break e}}y=1e3}else y=1e3;y=Wu(this,B,y),w=Lt(this.I),nt(w,"RID",f),nt(w,"CVER",22),this.D&&nt(w,"X-HTTP-Session-Id",this.D),xo(this,w),Q&&(this.O?y="headers="+encodeURIComponent(String(So(Q)))+"&"+y:this.m&&ta(w,this.m,Q)),Xs(this.h,B),this.Ua&&nt(w,"TYPE","init"),this.P?(nt(w,"$req",y),nt(w,"SID","null"),B.T=!0,wo(B,w,null)):wo(B,w,y),this.G=2}}else this.G==3&&(f?$f(this,f):this.i.length==0||zu(this.h)||$f(this))};function $f(f,y){var w;y?w=y.l:w=f.U++;const S=Lt(f.I);nt(S,"SID",f.K),nt(S,"RID",w),nt(S,"AID",f.T),xo(f,S),f.m&&f.o&&ta(S,f.m,f.o),w=new vr(f,f.j,w,f.B+1),f.m===null&&(w.H=f.o),y&&(f.i=y.D.concat(f.i)),y=Wu(f,w,1e3),w.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Xs(f.h,w),wo(w,S,y)}function xo(f,y){f.H&&Re(f.H,function(w,S){nt(y,S,w)}),f.l&&ql({},function(w,S){nt(y,S,w)})}function Wu(f,y,w){w=Math.min(f.i.length,w);var S=f.l?T(f.l.Na,f.l,f):null;e:{var B=f.i;let Q=-1;for(;;){const he=["count="+w];Q==-1?0<w?(Q=B[0].g,he.push("ofs="+Q)):Q=0:he.push("ofs="+Q);let lt=!0;for(let Xt=0;Xt<w;Xt++){let je=B[Xt].g;const mn=B[Xt].map;if(je-=Q,0>je)Q=Math.max(0,B[Xt].g-100),lt=!1;else try{Ku(mn,he,"req"+je+"_")}catch{S&&S(mn)}}if(lt){S=he.join("&");break e}}}return f=f.i.splice(0,w),y.D=f,S}function Kf(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;ee||Be(),X||(ee(),X=!0),Oe.add(y,f),f.v=0}}function Yu(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=$s(T(f.Fa,f),Yf(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,Qf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=$s(T(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,An(10),ra(this),Qf(this))};function Xu(f){f.A!=null&&(h.clearTimeout(f.A),f.A=null)}function Qf(f){f.g=new vr(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=Lt(f.qa);nt(y,"RID","rpc"),nt(y,"SID",f.K),nt(y,"AID",f.T),nt(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&nt(y,"TO",f.ja),nt(y,"TYPE","xmlhttp"),xo(f,y),f.m&&f.o&&ta(y,f.m,f.o),f.L&&(f.g.I=f.L);var w=f.g;f=f.ia,w.L=1,w.v=Io(Lt(y)),w.m=null,w.P=!0,Zr(w,f)}n.Za=function(){this.C!=null&&(this.C=null,ra(this),Yu(this),An(19))};function sa(f){f.C!=null&&(h.clearTimeout(f.C),f.C=null)}function Wf(f,y){var w=null;if(f.g==y){sa(f),Xu(f),f.g=null;var S=2}else if(Ys(f.h,y))w=y.D,Li(f.h,y),S=1;else return;if(f.G!=0){if(y.o)if(S==1){w=y.m?y.m.length:0,y=Date.now()-y.F;var B=f.B;S=jl(),dn(S,new Lu(S,w)),Yl(f)}else Kf(f);else if(B=y.s,B==3||B==0&&0<y.X||!(S==1&&v_(f,y)||S==2&&Yu(f)))switch(w&&0<w.length&&(y=f.h,y.i=y.i.concat(w)),B){case 1:rs(f,5);break;case 4:rs(f,10);break;case 3:rs(f,6);break;default:rs(f,2)}}}function Yf(f,y){let w=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(w*=2),w*y}function rs(f,y){if(f.j.info("Error code "+y),y==2){var w=T(f.fb,f),S=f.Xa;const B=!S;S=new ts(S||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Js(S,"https"),Io(S),B?$u(S.toString(),w):jf(S.toString(),w)}else An(2);f.G=0,f.l&&f.l.sa(y),Ju(f),Hf(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),An(2)):(this.j.info("Failed to ping google.com"),An(1))};function Ju(f){if(f.G=0,f.ka=[],f.l){const y=Gn(f.h);(y.length!=0||f.i.length!=0)&&(Y(f.ka,y),Y(f.ka,f.i),f.h.i.length=0,q(f.i),f.i.length=0),f.l.ra()}}function Xf(f,y,w){var S=w instanceof ts?Lt(w):new ts(w);if(S.g!="")y&&(S.g=y+"."+S.g),bo(S,S.s);else{var B=h.location;S=B.protocol,y=y?y+"."+B.hostname:B.hostname,B=+B.port;var Q=new ts(null);S&&Js(Q,S),y&&(Q.g=y),B&&bo(Q,B),w&&(Q.l=w),S=Q}return w=f.D,y=f.ya,w&&y&&nt(S,w,y),nt(S,"VER",f.la),xo(f,S),S}function Jf(f,y,w){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new Tt(new Tr({eb:w})):new Tt(f.pa),y.Ha(f.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zf(){}n=Zf.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Xl(){}Xl.prototype.g=function(f,y){return new $n(f,y)};function $n(f,y){sn.call(this),this.g=new Gf(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!Ee(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!Ee(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new aa(this)}P($n,sn),$n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},$n.prototype.close=function(){Qu(this.g)},$n.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var w={};w.__data__=f,f=w}else this.u&&(w={},w.__data__=Mi(f),f=w);y.i.push(new m_(y.Ya++,f)),y.G==3&&Yl(y)},$n.prototype.N=function(){this.g.l=null,delete this.j,Qu(this.g),delete this.g,$n.aa.N.call(this)};function em(f){qs.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const w in y){f=w;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}P(em,qs);function tm(){ir.call(this),this.status=1}P(tm,ir);function aa(f){this.g=f}P(aa,Zf),aa.prototype.ua=function(){dn(this.g,"a")},aa.prototype.ta=function(f){dn(this.g,new em(f))},aa.prototype.sa=function(f){dn(this.g,new tm)},aa.prototype.ra=function(){dn(this.g,"b")},Xl.prototype.createWebChannel=Xl.prototype.g,$n.prototype.send=$n.prototype.o,$n.prototype.open=$n.prototype.m,$n.prototype.close=$n.prototype.close,mx=function(){return new Xl},fx=function(){return jl()},dx=Vi,i0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vt.NO_ERROR=0,Vt.TIMEOUT=8,Vt.HTTP_ERROR=6,vp=Vt,Cn.COMPLETE="complete",hx=Cn,Eo.EventType=gr,gr.OPEN="a",gr.CLOSE="b",gr.ERROR="c",gr.MESSAGE="d",sn.prototype.listen=sn.prototype.K,Xh=Eo,Tt.prototype.listenOnce=Tt.prototype.L,Tt.prototype.getLastError=Tt.prototype.Ka,Tt.prototype.getLastErrorCode=Tt.prototype.Ba,Tt.prototype.getStatus=Tt.prototype.Z,Tt.prototype.getResponseJson=Tt.prototype.Oa,Tt.prototype.getResponseText=Tt.prototype.oa,Tt.prototype.send=Tt.prototype.ea,Tt.prototype.setWithCredentials=Tt.prototype.Ha,ux=Tt}).apply(typeof op<"u"?op:typeof self<"u"?self:typeof window<"u"?window:{});const xA="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wu="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=new _u("@firebase/firestore");function Pc(){return Ya.logLevel}function a3(n){Ya.setLogLevel(n)}function re(n,...e){if(Ya.logLevel<=Ge.DEBUG){const t=e.map(kE);Ya.debug(`Firestore (${wu}): ${n}`,...t)}}function Qt(n,...e){if(Ya.logLevel<=Ge.ERROR){const t=e.map(kE);Ya.error(`Firestore (${wu}): ${n}`,...t)}}function Gr(n,...e){if(Ya.logLevel<=Ge.WARN){const t=e.map(kE);Ya.warn(`Firestore (${wu}): ${n}`,...t)}}function kE(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(n="Unexpected state"){const e=`FIRESTORE (${wu}) INTERNAL ASSERTION FAILED: `+n;throw Qt(e),new Error(e)}function be(n,e){n||ve()}function o3(n,e){n||ve()}function ge(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ie extends Jn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class l3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(En.UNAUTHENTICATED)))}shutdown(){}}class c3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class u3{constructor(e){this.t=e,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){be(this.o===void 0);let i=this.i;const s=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let o=new On;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new On,e.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},h=d=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((d=>h(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new On)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(be(typeof i.accessToken=="string"),new px(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string"),new En(e)}}class h3{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=En.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class d3{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new h3(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(En.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class f3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class m3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){be(this.o===void 0);const i=o=>{o.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.R;return this.R=o.token,re("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const s=o=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?s(o):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(be(typeof t.token=="string"),this.R=t.token,new f3(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const s=p3(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}}function Ve(n,e){return n<e?-1:n>e?1:0}function Jc(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function _x(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ie(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ie(K.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ie(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ie(K.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Dt.fromMillis(Date.now())}static fromDate(e){return Dt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Dt(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ce(e)}static min(){return new Ce(new Dt(0,0))}static max(){return new Ce(new Dt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,t,i){t===void 0?t=0:t>e.length&&ve(),i===void 0?i=e.length-t:i>e.length-t&&ve(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Rd.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Rd?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=e.get(s),c=t.get(s);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Xe extends Rd{construct(e,t,i){return new Xe(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ie(K.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new Xe(t)}static emptyPath(){return new Xe([])}}const g3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends Rd{construct(e,t,i){return new Rt(e,t,i)}static isValidIdentifier(e){return g3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Rt(["__name__"])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new ie(K.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new ie(K.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new ie(K.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,s+=2}else h==="`"?(c=!c,s++):h!=="."||c?(i+=h,s++):(o(),s++)}if(o(),c)throw new ie(K.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rt(t)}static emptyPath(){return new Rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(Xe.fromString(e))}static fromName(e){return new pe(Xe.fromString(e).popFirst(5))}static empty(){return new pe(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Xe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new Xe(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function r0(n){return n.fields.find((e=>e.kind===2))}function Qo(n){return n.fields.filter((e=>e.kind!==2))}Up.UNKNOWN_ID=-1;class Ep{constructor(e,t){this.fieldPath=e,this.kind=t}}class xd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new xd(0,Pi.min())}}function yx(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Ce.fromTimestamp(i===1e9?new Dt(t+1,0):new Dt(t,i));return new Pi(s,pe.empty(),e)}function vx(n){return new Pi(n.readTime,n.key,-1)}class Pi{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Pi(Ce.min(),pe.empty(),-1)}static max(){return new Pi(Ce.max(),pe.empty(),-1)}}function PE(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(n.documentKey,e.documentKey),t!==0?t:Ve(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uo(n){if(n.code!==K.FAILED_PRECONDITION||n.message!==Ex)throw n;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z(((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):z.reject(t)}static resolve(e){return new z(((t,i)=>{t(e)}))}static reject(e){return new z(((t,i)=>{i(e)}))}static waitFor(e){return new z(((t,i)=>{let s=0,o=0,c=!1;e.forEach((h=>{++s,h.next((()=>{++o,c&&o===s&&t()}),(d=>i(d)))})),c=!0,o===s&&t()}))}static or(e){let t=z.resolve(!1);for(const i of e)t=t.next((s=>s?z.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,o)=>{i.push(t.call(this,s,o))})),this.waitFor(i)}static mapArray(e,t){return new z(((i,s)=>{const o=e.length,c=new Array(o);let h=0;for(let d=0;d<o;d++){const p=d;t(e[p]).next((_=>{c[p]=_,++h,h===o&&i(c)}),(_=>s(_)))}}))}static doWhile(e,t){return new z(((i,s)=>{const o=()=>{e()===!0?t().next((()=>{o()}),s):i()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new On,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ad(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{const s=OE(i.target.error);this.V.reject(new ad(e,s))}}static open(e,t,i,s){try{return new bg(t,e.transaction(s,i))}catch(o){throw new ad(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(re("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new y3(t)}}class Fr{constructor(e,t,i){this.name=e,this.version=t,this.p=i,Fr.S(Ot())===12.2&&Qt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return re("SimpleDb","Removing database:",e),Yo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!yd())return!1;if(Fr.v())return!0;const e=Ot(),t=Fr.S(e),i=0<t&&t<10,s=Tx(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}async M(e){return this.db||(re("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const c=o.target.result;t(c)},s.onblocked=()=>{i(new ad(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const c=o.target.error;c.name==="VersionError"?i(new ie(K.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?i(new ie(K.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):i(new ad(e,c))},s.onupgradeneeded=o=>{re("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.p.O(c,s.transaction,o.oldVersion,this.version).next((()=>{re("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.M(e);const h=bg.open(this.db,e,o?"readonly":"readwrite",i),d=s(h).next((p=>(h.g(),p))).catch((p=>(h.abort(p),z.reject(p)))).toPromise();return d.catch((()=>{})),await h.m,d}catch(h){const d=h,p=d.name!=="FirebaseError"&&c<3;if(re("SimpleDb","Transaction failed with error:",d.message,"Retrying:",p),this.close(),!p)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Tx(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class _3{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Yo(this.B.delete())}}class ad extends ie{constructor(e,t){super(K.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ho(n){return n.name==="IndexedDbTransactionError"}class y3{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(re("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(re("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Yo(i)}add(e){return re("SimpleDb","ADD",this.store.name,e,e),Yo(this.store.add(e))}get(e){return Yo(this.store.get(e)).next((t=>(t===void 0&&(t=null),re("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return re("SimpleDb","DELETE",this.store.name,e),Yo(this.store.delete(e))}count(){return re("SimpleDb","COUNT",this.store.name),Yo(this.store.count())}U(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(i.range);return new z(((c,h)=>{o.onerror=d=>{h(d.target.error)},o.onsuccess=d=>{c(d.target.result)}}))}{const o=this.cursor(i),c=[];return this.W(o,((h,d)=>{c.push(d)})).next((()=>c))}}G(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new z(((s,o)=>{i.onerror=c=>{o(c.target.error)},i.onsuccess=c=>{s(c.target.result)}}))}j(e,t){re("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.H=!1;const s=this.cursor(i);return this.W(s,((o,c,h)=>h.delete()))}J(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.W(s,t)}Y(e){const t=this.cursor({});return new z(((i,s)=>{t.onerror=o=>{const c=OE(o.target.error);s(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((h=>{h?c.continue():i()})):i()}}))}W(e,t){const i=[];return new z(((s,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const h=c.target.result;if(!h)return void s();const d=new _3(h),p=t(h.primaryKey,h.value,d);if(p instanceof z){const _=p.catch((v=>(d.done(),z.reject(v))));i.push(_)}d.isDone?s():d.K===null?h.continue():h.continue(d.K)}})).next((()=>z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Yo(n){return new z(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=OE(i.target.error);t(s)}}))}let NA=!1;function OE(n){const e=Fr.S(Ot());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new ie("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return NA||(NA=!0,setTimeout((()=>{throw i}),0)),i}}return n}class v3{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){re("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{re("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){ho(t)?re("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await uo(t)}await this.X(6e4)}))}}class E3{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const i=new Set;let s=t,o=!0;return z.doWhile((()=>o===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!i.has(c))return re("IndexBackfiller",`Processing collection: ${c}`),this.ne(e,c,s).next((h=>{s-=h,i.add(c)}));o=!1})))).next((()=>t-s))}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this.re(s,o))).next((h=>(re("IndexBackfiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>c.size))}))))}re(e,t){let i=e;return t.changes.forEach(((s,o)=>{const c=vx(o);PE(c,i)>0&&(i=c)})),new Pi(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}di.oe=-1;function lf(n){return n==null}function Nd(n){return n===0&&1/n==-1/0}function bx(n){return typeof n=="number"&&Number.isInteger(n)&&!Nd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=DA(e)),e=w3(n.get(t),e);return DA(e)}function w3(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function DA(n){return n+""}function Or(n){const e=n.length;if(be(e>=2),e===2)return be(n.charAt(0)===""&&n.charAt(1)===""),Xe.emptyPath();const t=e-2,i=[];let s="";for(let o=0;o<e;){const c=n.indexOf("",o);switch((c<0||c>t)&&ve(),n.charAt(c+1)){case"":const h=n.substring(o,c);let d;s.length===0?d=h:(s+=h,d=s,s=""),i.push(d);break;case"":s+=n.substring(o,c),s+="\0";break;case"":s+=n.substring(o,c+1);break;default:ve()}o=c+2}return new Xe(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(n,e){return[n,Zn(e)]}function Ix(n,e,t){return[n,Zn(e),t]}const T3={},b3=["prefixPath","collectionGroup","readTime","documentId"],I3=["prefixPath","collectionGroup","documentId"],S3=["collectionGroup","readTime","prefixPath","documentId"],A3=["canonicalId","targetId"],C3=["targetId","path"],R3=["path","targetId"],x3=["collectionId","parent"],N3=["indexId","uid"],D3=["uid","sequenceNumber"],k3=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],P3=["indexId","uid","orderedDocumentKey"],O3=["userId","collectionPath","documentId"],M3=["userId","collectionPath","largestBatchId"],V3=["userId","collectionGroup","largestBatchId"],Sx=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],L3=[...Sx,"documentOverlays"],Ax=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Cx=Ax,ME=[...Cx,"indexConfiguration","indexState","indexEntries"],U3=ME,B3=[...ME,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0 extends wx{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function un(n,e){const t=ge(n);return Fr.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function xl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Rx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mt=class a0{constructor(e,t){this.comparator=e,this.root=t||qa.EMPTY}insert(e,t){return new a0(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qa.BLACK,null,null))}remove(e){return new a0(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lp(this.root,e,this.comparator,!1)}getReverseIterator(){return new lp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lp(this.root,e,this.comparator,!0)}},lp=class{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},qa=class ws{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??ws.RED,this.left=s??ws.EMPTY,this.right=o??ws.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new ws(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ws.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ws.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ws.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ws.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ve();const e=this.left.check();if(e!==this.right.check())throw ve();return e+(this.isRed()?0:1)}};qa.EMPTY=null,qa.RED=!0,qa.BLACK=!1;qa.EMPTY=new class{constructor(){this.size=0}get key(){throw ve()}get value(){throw ve()}get color(){throw ve()}get left(){throw ve()}get right(){throw ve()}copy(e,t,i,s,o){return this}insert(e,t,i){return new qa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.comparator=e,this.data=new Mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new OA(this.data.getIterator())}getIteratorFrom(e){return new OA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof gt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new gt(this.comparator);return t.data=e,t}}class OA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cc(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.fields=e,e.sort(Rt.comparator)}static empty(){return new fi([])}unionWith(e){let t=new gt(Rt.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new fi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F3(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new xx("Invalid base64 string: "+o):o}})(e);return new zt(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o})(e);return new zt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zt.EMPTY_BYTE_STRING=new zt("");const j3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ps(n){if(be(!!n),typeof n=="string"){let e=0;const t=j3.exec(n);if(be(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ct(n.seconds),nanos:Ct(n.nanos)}}function Ct(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xa(n){return typeof n=="string"?zt.fromBase64String(n):zt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function VE(n){const e=n.mapValue.fields.__previous_value__;return Ig(e)?VE(e):e}function Dd(n){const e=Ps(n.mapValue.fields.__local_write_time__.timestampValue);return new Dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,t,i,s,o,c,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=p}}class Ja{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ja("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ja&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Tp={nullValue:"NULL_VALUE"};function fl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ig(n)?4:Nx(n)?9007199254740991:Sg(n)?10:11:ve()}function Hr(n,e){if(n===e)return!0;const t=fl(n);if(t!==fl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dd(n).isEqual(Dd(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const c=Ps(s.timestampValue),h=Ps(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,o){return Xa(s.bytesValue).isEqual(Xa(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,o){return Ct(s.geoPointValue.latitude)===Ct(o.geoPointValue.latitude)&&Ct(s.geoPointValue.longitude)===Ct(o.geoPointValue.longitude)})(n,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Ct(s.integerValue)===Ct(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const c=Ct(s.doubleValue),h=Ct(o.doubleValue);return c===h?Nd(c)===Nd(h):isNaN(c)&&isNaN(h)}return!1})(n,e);case 9:return Jc(n.arrayValue.values||[],e.arrayValue.values||[],Hr);case 10:case 11:return(function(s,o){const c=s.mapValue.fields||{},h=o.mapValue.fields||{};if(PA(c)!==PA(h))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(h[d]===void 0||!Hr(c[d],h[d])))return!1;return!0})(n,e);default:return ve()}}function kd(n,e){return(n.values||[]).find((t=>Hr(t,e)))!==void 0}function Za(n,e){if(n===e)return 0;const t=fl(n),i=fl(e);if(t!==i)return Ve(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const h=Ct(o.integerValue||o.doubleValue),d=Ct(c.integerValue||c.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1})(n,e);case 3:return MA(n.timestampValue,e.timestampValue);case 4:return MA(Dd(n),Dd(e));case 5:return Ve(n.stringValue,e.stringValue);case 6:return(function(o,c){const h=Xa(o),d=Xa(c);return h.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const h=o.split("/"),d=c.split("/");for(let p=0;p<h.length&&p<d.length;p++){const _=Ve(h[p],d[p]);if(_!==0)return _}return Ve(h.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const h=Ve(Ct(o.latitude),Ct(c.latitude));return h!==0?h:Ve(Ct(o.longitude),Ct(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return VA(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var h,d,p,_;const v=o.fields||{},T=c.fields||{},R=(h=v.value)===null||h===void 0?void 0:h.arrayValue,P=(d=T.value)===null||d===void 0?void 0:d.arrayValue,q=Ve(((p=R==null?void 0:R.values)===null||p===void 0?void 0:p.length)||0,((_=P==null?void 0:P.values)===null||_===void 0?void 0:_.length)||0);return q!==0?q:VA(R,P)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===Ba.mapValue&&c===Ba.mapValue)return 0;if(o===Ba.mapValue)return 1;if(c===Ba.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),p=c.fields||{},_=Object.keys(p);d.sort(),_.sort();for(let v=0;v<d.length&&v<_.length;++v){const T=Ve(d[v],_[v]);if(T!==0)return T;const R=Za(h[d[v]],p[_[v]]);if(R!==0)return R}return Ve(d.length,_.length)})(n.mapValue,e.mapValue);default:throw ve()}}function MA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ve(n,e);const t=Ps(n),i=Ps(e),s=Ve(t.seconds,i.seconds);return s!==0?s:Ve(t.nanos,i.nanos)}function VA(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=Za(t[s],i[s]);if(o)return o}return Ve(t.length,i.length)}function Zc(n){return o0(n)}function o0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ps(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Xa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return pe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=o0(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const c of i)o?o=!1:s+=",",s+=`${c}:${o0(t.fields[c])}`;return s+"}"})(n.mapValue):ve()}function ml(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function l0(n){return!!n&&"integerValue"in n}function Pd(n){return!!n&&"arrayValue"in n}function LA(n){return!!n&&"nullValue"in n}function UA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bp(n){return!!n&&"mapValue"in n}function Sg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function od(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return xl(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=od(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=od(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Nx(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const Dx={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function q3(n){return"nullValue"in n?Tp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ml(Ja.empty(),pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Sg(n)?Dx:{mapValue:{}}:ve()}function G3(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ml(Ja.empty(),pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Dx:"mapValue"in n?Sg(n)?{mapValue:{}}:Ba:ve()}function BA(n,e){const t=Za(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function FA(n,e){const t=Za(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!bp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=od(t)}setAll(e){let t=Rt.emptyPath(),i={},s=[];e.forEach(((c,h)=>{if(!t.isImmediateParentOf(h)){const d=this.getFieldsMap(t);this.applyChanges(d,i,s),i={},s=[],t=h.popLast()}c?i[h.lastSegment()]=od(c):s.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());bp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];bp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){xl(t,((s,o)=>e[s]=o));for(const s of i)delete e[s]}clone(){return new Pn(od(this.value))}}function kx(n){const e=[];return xl(n.fields,((t,i)=>{const s=new Rt([t]);if(bp(i)){const o=kx(i.mapValue).fields;if(o.length===0)e.push(s);else for(const c of o)e.push(s.child(c))}else e.push(s)})),new fi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,t,i,s,o,c,h){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(e){return new St(e,0,Ce.min(),Ce.min(),Ce.min(),Pn.empty(),0)}static newFoundDocument(e,t,i,s){return new St(e,1,t,Ce.min(),i,s,0)}static newNoDocument(e,t){return new St(e,2,t,Ce.min(),Ce.min(),Pn.empty(),0)}static newUnknownDocument(e,t){return new St(e,3,t,Ce.min(),Ce.min(),Pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,t){this.position=e,this.inclusive=t}}function jA(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const o=e[s],c=n.position[s];if(o.field.isKeyField()?i=pe.comparator(pe.fromName(c.referenceValue),t.key):i=Za(c,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function zA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Hr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t="asc"){this.field=e,this.dir=t}}function H3(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px{}class Je extends Px{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new $3(e,t,i):t==="array-contains"?new W3(e,i):t==="in"?new Bx(e,i):t==="not-in"?new Y3(e,i):t==="array-contains-any"?new X3(e,i):new Je(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new K3(e,i):new Q3(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Za(t,this.value)):t!==null&&fl(this.value)===fl(t)&&this.matchesComparison(Za(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dt extends Px{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new dt(e,t)}matches(e){return eu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function eu(n){return n.op==="and"}function c0(n){return n.op==="or"}function LE(n){return Ox(n)&&eu(n)}function Ox(n){for(const e of n.filters)if(e instanceof dt)return!1;return!0}function u0(n){if(n instanceof Je)return n.field.canonicalString()+n.op.toString()+Zc(n.value);if(LE(n))return n.filters.map((e=>u0(e))).join(",");{const e=n.filters.map((t=>u0(t))).join(",");return`${n.op}(${e})`}}function Mx(n,e){return n instanceof Je?(function(i,s){return s instanceof Je&&i.op===s.op&&i.field.isEqual(s.field)&&Hr(i.value,s.value)})(n,e):n instanceof dt?(function(i,s){return s instanceof dt&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((o,c,h)=>o&&Mx(c,s.filters[h])),!0):!1})(n,e):void ve()}function Vx(n,e){const t=n.filters.concat(e);return dt.create(t,n.op)}function Lx(n){return n instanceof Je?(function(t){return`${t.field.canonicalString()} ${t.op} ${Zc(t.value)}`})(n):n instanceof dt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Lx).join(" ,")+"}"})(n):"Filter"}class $3 extends Je{constructor(e,t,i){super(e,t,i),this.key=pe.fromName(i.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class K3 extends Je{constructor(e,t){super(e,"in",t),this.keys=Ux("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Q3 extends Je{constructor(e,t){super(e,"not-in",t),this.keys=Ux("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ux(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>pe.fromName(i.referenceValue)))}class W3 extends Je{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Pd(t)&&kd(t.arrayValue,this.value)}}class Bx extends Je{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&kd(this.value.arrayValue,t)}}class Y3 extends Je{constructor(e,t){super(e,"not-in",t)}matches(e){if(kd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!kd(this.value.arrayValue,t)}}class X3 extends Je{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Pd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>kd(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e,t=null,i=[],s=[],o=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=c,this.endAt=h,this.ue=null}}function h0(n,e=null,t=[],i=[],s=null,o=null,c=null){return new J3(n,e,t,i,s,o,c)}function pl(n){const e=ge(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>u0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Zc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Zc(i))).join(",")),e.ue=t}return e.ue}function cf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!H3(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Mx(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!zA(n.startAt,e.startAt)&&zA(n.endAt,e.endAt)}function Bp(n){return pe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Fp(n,e){return n.filters.filter((t=>t instanceof Je&&t.field.isEqual(e)))}function qA(n,e,t){let i=Tp,s=!0;for(const o of Fp(n,e)){let c=Tp,h=!0;switch(o.op){case"<":case"<=":c=q3(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,h=!1;break;case"!=":case"not-in":c=Tp}BA({value:i,inclusive:s},{value:c,inclusive:h})<0&&(i=c,s=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];BA({value:i,inclusive:s},{value:c,inclusive:t.inclusive})<0&&(i=c,s=t.inclusive);break}}return{value:i,inclusive:s}}function GA(n,e,t){let i=Ba,s=!0;for(const o of Fp(n,e)){let c=Ba,h=!0;switch(o.op){case">=":case">":c=G3(o.value),h=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,h=!1;break;case"!=":case"not-in":c=Ba}FA({value:i,inclusive:s},{value:c,inclusive:h})>0&&(i=c,s=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];FA({value:i,inclusive:s},{value:c,inclusive:t.inclusive})>0&&(i=c,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,t=null,i=[],s=[],o=null,c="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Fx(n,e,t,i,s,o,c,h){return new Bs(n,e,t,i,s,o,c,h)}function Tu(n){return new Bs(n)}function HA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function UE(n){return n.collectionGroup!==null}function Gc(n){const e=ge(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new gt(Rt.comparator);return c.filters.forEach((d=>{d.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Od(o,i))})),t.has(Rt.keyField().canonicalString())||e.ce.push(new Od(Rt.keyField(),i))}return e.ce}function ei(n){const e=ge(n);return e.le||(e.le=Z3(e,Gc(n))),e.le}function Z3(n,e){if(n.limitType==="F")return h0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new Od(s.field,o)}));const t=n.endAt?new eo(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new eo(n.startAt.position,n.startAt.inclusive):null;return h0(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function d0(n,e){const t=n.filters.concat([e]);return new Bs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function jp(n,e,t){return new Bs(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uf(n,e){return cf(ei(n),ei(e))&&n.limitType===e.limitType}function jx(n){return`${pl(ei(n))}|lt:${n.limitType}`}function Oc(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>Lx(s))).join(", ")}]`),lf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>Zc(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>Zc(s))).join(",")),`Target(${i})`})(ei(n))}; limitType=${n.limitType})`}function hf(n,e){return e.isFoundDocument()&&(function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):pe.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,s){for(const o of Gc(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(c,h,d){const p=jA(c,h,d);return c.inclusive?p<=0:p<0})(i.startAt,Gc(i),s)||i.endAt&&!(function(c,h,d){const p=jA(c,h,d);return c.inclusive?p>=0:p>0})(i.endAt,Gc(i),s))})(n,e)}function zx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function qx(n){return(e,t)=>{let i=!1;for(const s of Gc(n)){const o=eB(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function eB(n,e,t){const i=n.field.isKeyField()?pe.comparator(e.key,t.key):(function(o,c,h){const d=c.data.field(o),p=h.data.field(o);return d!==null&&p!==null?Za(d,p):ve()})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){xl(this.inner,((t,i)=>{for(const[s,o]of i)e(s,o)}))}isEmpty(){return Rx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=new Mt(pe.comparator);function mi(){return tB}const Gx=new Mt(pe.comparator);function Jh(...n){let e=Gx;for(const t of n)e=e.insert(t.key,t);return e}function Hx(n){let e=Gx;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Mr(){return ld()}function $x(){return ld()}function ld(){return new fo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const nB=new Mt(pe.comparator),iB=new gt(pe.comparator);function Ue(...n){let e=iB;for(const t of n)e=e.add(t);return e}const rB=new gt(Ve);function BE(){return rB}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nd(e)?"-0":e}}function Kx(n){return{integerValue:""+n}}function Qx(n,e){return bx(e)?Kx(e):FE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(){this._=void 0}}function sB(n,e,t){return n instanceof tu?(function(s,o){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Ig(o)&&(o=VE(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}})(t,e):n instanceof gl?Yx(n,e):n instanceof _l?Xx(n,e):(function(s,o){const c=Wx(s,o),h=$A(c)+$A(s.Pe);return l0(c)&&l0(s.Pe)?Kx(h):FE(s.serializer,h)})(n,e)}function aB(n,e,t){return n instanceof gl?Yx(n,e):n instanceof _l?Xx(n,e):t}function Wx(n,e){return n instanceof nu?(function(i){return l0(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class tu extends Ag{}class gl extends Ag{constructor(e){super(),this.elements=e}}function Yx(n,e){const t=Jx(e);for(const i of n.elements)t.some((s=>Hr(s,i)))||t.push(i);return{arrayValue:{values:t}}}class _l extends Ag{constructor(e){super(),this.elements=e}}function Xx(n,e){let t=Jx(e);for(const i of n.elements)t=t.filter((s=>!Hr(s,i)));return{arrayValue:{values:t}}}class nu extends Ag{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function $A(n){return Ct(n.integerValue||n.doubleValue)}function Jx(n){return Pd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,t){this.field=e,this.transform=t}}function oB(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof gl&&s instanceof gl||i instanceof _l&&s instanceof _l?Jc(i.elements,s.elements,Hr):i instanceof nu&&s instanceof nu?Hr(i.Pe,s.Pe):i instanceof tu&&s instanceof tu})(n.transform,e.transform)}class lB{constructor(e,t){this.version=e,this.transformResults=t}}class xt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xt}static exists(e){return new xt(void 0,e)}static updateTime(e){return new xt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ip(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Cg{}function Zx(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Iu(n.key,xt.none()):new bu(n.key,n.data,xt.none());{const t=n.data,i=Pn.empty();let s=new gt(Rt.comparator);for(let o of e.fields)if(!s.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?i.delete(o):i.set(o,c),s=s.add(o)}return new Fs(n.key,i,new fi(s.toArray()),xt.none())}}function cB(n,e,t){n instanceof bu?(function(s,o,c){const h=s.value.clone(),d=QA(s.fieldTransforms,o,c.transformResults);h.setAll(d),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):n instanceof Fs?(function(s,o,c){if(!Ip(s.precondition,o))return void o.convertToUnknownDocument(c.version);const h=QA(s.fieldTransforms,o,c.transformResults),d=o.data;d.setAll(eN(s)),d.setAll(h),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):(function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function cd(n,e,t,i){return n instanceof bu?(function(o,c,h,d){if(!Ip(o.precondition,c))return h;const p=o.value.clone(),_=WA(o.fieldTransforms,d,c);return p.setAll(_),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof Fs?(function(o,c,h,d){if(!Ip(o.precondition,c))return h;const p=WA(o.fieldTransforms,d,c),_=c.data;return _.setAll(eN(o)),_.setAll(p),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(n,e,t,i):(function(o,c,h){return Ip(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(n,e,t)}function uB(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),o=Wx(i.transform,s||null);o!=null&&(t===null&&(t=Pn.empty()),t.set(i.field,o))}return t||null}function KA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Jc(i,s,((o,c)=>oB(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class bu extends Cg{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Fs extends Cg{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function eN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function QA(n,e,t){const i=new Map;be(n.length===t.length);for(let s=0;s<t.length;s++){const o=n[s],c=o.transform,h=e.data.field(o.field);i.set(o.field,aB(c,h,t[s]))}return i}function WA(n,e,t){const i=new Map;for(const s of n){const o=s.transform,c=t.data.field(s.field);i.set(s.field,sB(o,c,e))}return i}class Iu extends Cg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jE extends Cg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&cB(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=cd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=cd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=$x();return this.mutations.forEach((s=>{const o=e.get(s.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=t.has(s.key)?null:h;const d=Zx(c,h);d!==null&&i.set(s.key,d),c.isValidDocument()||c.convertToNoDocument(Ce.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ue())}isEqual(e){return this.batchId===e.batchId&&Jc(this.mutations,e.mutations,((t,i)=>KA(t,i)))&&Jc(this.baseMutations,e.baseMutations,((t,i)=>KA(t,i)))}}class qE{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){be(e.mutations.length===i.length);let s=(function(){return nB})();const o=e.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,i[c].version);return new qE(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hB{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nn,et;function tN(n){switch(n){default:return ve();case K.CANCELLED:case K.UNKNOWN:case K.DEADLINE_EXCEEDED:case K.RESOURCE_EXHAUSTED:case K.INTERNAL:case K.UNAVAILABLE:case K.UNAUTHENTICATED:return!1;case K.INVALID_ARGUMENT:case K.NOT_FOUND:case K.ALREADY_EXISTS:case K.PERMISSION_DENIED:case K.FAILED_PRECONDITION:case K.ABORTED:case K.OUT_OF_RANGE:case K.UNIMPLEMENTED:case K.DATA_LOSS:return!0}}function nN(n){if(n===void 0)return Qt("GRPC error has no .code"),K.UNKNOWN;switch(n){case nn.OK:return K.OK;case nn.CANCELLED:return K.CANCELLED;case nn.UNKNOWN:return K.UNKNOWN;case nn.DEADLINE_EXCEEDED:return K.DEADLINE_EXCEEDED;case nn.RESOURCE_EXHAUSTED:return K.RESOURCE_EXHAUSTED;case nn.INTERNAL:return K.INTERNAL;case nn.UNAVAILABLE:return K.UNAVAILABLE;case nn.UNAUTHENTICATED:return K.UNAUTHENTICATED;case nn.INVALID_ARGUMENT:return K.INVALID_ARGUMENT;case nn.NOT_FOUND:return K.NOT_FOUND;case nn.ALREADY_EXISTS:return K.ALREADY_EXISTS;case nn.PERMISSION_DENIED:return K.PERMISSION_DENIED;case nn.FAILED_PRECONDITION:return K.FAILED_PRECONDITION;case nn.ABORTED:return K.ABORTED;case nn.OUT_OF_RANGE:return K.OUT_OF_RANGE;case nn.UNIMPLEMENTED:return K.UNIMPLEMENTED;case nn.DATA_LOSS:return K.DATA_LOSS;default:return ve()}}(et=nn||(nn={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB=new ol([4294967295,4294967295],0);function YA(n){const e=iN().encode(n),t=new cx;return t.update(e),new Uint8Array(t.digest())}function XA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ol([t,i],0),new ol([s,o],0)]}class HE{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Zh(`Invalid padding: ${t}`);if(i<0)throw new Zh(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Zh(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Zh(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ol.fromNumber(this.Ie)}Ee(e,t,i){let s=e.add(t.multiply(ol.fromNumber(i)));return s.compare(dB)===1&&(s=new ol([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=YA(e),[i,s]=XA(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,s,o);if(!this.de(c))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new HE(o,s,t);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.Ie===0)return;const t=YA(e),[i,s]=XA(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,s,o);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Zh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,mf.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new ff(Ce.min(),s,new Mt(Ve),mi(),Ue())}}class mf{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new mf(i,t,Ue(),Ue(),Ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t,i,s){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=s}}class rN{constructor(e,t){this.targetId=e,this.me=t}}class sN{constructor(e,t,i=zt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class JA{constructor(){this.fe=0,this.ge=eC(),this.pe=zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ue(),t=Ue(),i=Ue();return this.ge.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:ve()}})),new mf(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=eC()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class fB{constructor(e){this.Le=e,this.Be=new Map,this.ke=mi(),this.qe=ZA(),this.Qe=new Mt(Ve)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:ve()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((i,s)=>{this.ze(s)&&t(s)}))}He(e){const t=e.targetId,i=e.me.count,s=this.Je(t);if(s){const o=s.target;if(Bp(o))if(i===0){const c=new pe(o.path);this.Ue(t,c,St.newNoDocument(c,Ce.min()))}else be(i===1);else{const c=this.Ye(t);if(c!==i){const h=this.Ze(e),d=h?this.Xe(h,e,c):1;if(d!==0){this.je(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,p)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let c,h;try{c=Xa(i).toUint8Array()}catch(d){if(d instanceof xx)return Gr("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new HE(c,s,o)}catch(d){return Gr(d instanceof Zh?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ie===0?null:h}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let s=0;return i.forEach((o=>{const c=this.Le.tt(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.Ue(t,o,null),s++)})),s}rt(e){const t=new Map;this.Be.forEach(((o,c)=>{const h=this.Je(c);if(h){if(o.current&&Bp(h.target)){const d=new pe(h.target.path);this.ke.get(d)!==null||this.it(c,d)||this.Ue(c,d,St.newNoDocument(d,e))}o.be&&(t.set(c,o.ve()),o.Ce())}}));let i=Ue();this.qe.forEach(((o,c)=>{let h=!0;c.forEachWhile((d=>{const p=this.Je(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(o))})),this.ke.forEach(((o,c)=>c.setReadTime(e)));const s=new ff(e,t,this.Qe,this.ke,i);return this.ke=mi(),this.qe=ZA(),this.Qe=new Mt(Ve),s}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new JA,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new gt(Ve),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||re("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new JA),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function ZA(){return new Mt(pe.comparator)}function eC(){return new Mt(pe.comparator)}const mB={asc:"ASCENDING",desc:"DESCENDING"},pB={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gB={and:"AND",or:"OR"};class _B{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function f0(n,e){return n.useProto3Json||lf(e)?e:{value:e}}function iu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function aN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function yB(n,e){return iu(n,e.toTimestamp())}function Wt(n){return be(!!n),Ce.fromTimestamp((function(t){const i=Ps(t);return new Dt(i.seconds,i.nanos)})(n))}function $E(n,e){return m0(n,e).canonicalString()}function m0(n,e){const t=(function(s){return new Xe(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function oN(n){const e=Xe.fromString(n);return be(_N(e)),e}function Md(n,e){return $E(n.databaseId,e.path)}function jr(n,e){const t=oN(e);if(t.get(1)!==n.databaseId.projectId)throw new ie(K.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ie(K.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pe(uN(t))}function lN(n,e){return $E(n.databaseId,e)}function cN(n){const e=oN(n);return e.length===4?Xe.emptyPath():uN(e)}function p0(n){return new Xe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function uN(n){return be(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function tC(n,e,t){return{name:Md(n,e),fields:t.value.mapValue.fields}}function hN(n,e,t){const i=jr(n,e.name),s=Wt(e.updateTime),o=e.createTime?Wt(e.createTime):Ce.min(),c=new Pn({mapValue:{fields:e.fields}}),h=St.newFoundDocument(i,s,o,c);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function vB(n,e){return"found"in e?(function(i,s){be(!!s.found),s.found.name,s.found.updateTime;const o=jr(i,s.found.name),c=Wt(s.found.updateTime),h=s.found.createTime?Wt(s.found.createTime):Ce.min(),d=new Pn({mapValue:{fields:s.found.fields}});return St.newFoundDocument(o,c,h,d)})(n,e):"missing"in e?(function(i,s){be(!!s.missing),be(!!s.readTime);const o=jr(i,s.missing),c=Wt(s.readTime);return St.newNoDocument(o,c)})(n,e):ve()}function EB(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ve()})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(p,_){return p.useProto3Json?(be(_===void 0||typeof _=="string"),zt.fromBase64String(_||"")):(be(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),zt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(p){const _=p.code===void 0?K.UNKNOWN:nN(p.code);return new ie(_,p.message||"")})(c);t=new sN(i,s,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=jr(n,i.document.name),o=Wt(i.document.updateTime),c=i.document.createTime?Wt(i.document.createTime):Ce.min(),h=new Pn({mapValue:{fields:i.document.fields}}),d=St.newFoundDocument(s,o,c,h),p=i.targetIds||[],_=i.removedTargetIds||[];t=new Sp(p,_,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=jr(n,i.document),o=i.readTime?Wt(i.readTime):Ce.min(),c=St.newNoDocument(s,o),h=i.removedTargetIds||[];t=new Sp([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=jr(n,i.document),o=i.removedTargetIds||[];t=new Sp([],o,s,null)}else{if(!("filter"in e))return ve();{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,c=new hB(s,o),h=i.targetId;t=new rN(h,c)}}return t}function Vd(n,e){let t;if(e instanceof bu)t={update:tC(n,e.key,e.value)};else if(e instanceof Iu)t={delete:Md(n,e.key)};else if(e instanceof Fs)t={update:tC(n,e.key,e.data),updateMask:AB(e.fieldMask)};else{if(!(e instanceof jE))return ve();t={verify:Md(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,c){const h=c.transform;if(h instanceof tu)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof gl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof _l)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof nu)return{fieldPath:c.field.canonicalString(),increment:h.Pe};throw ve()})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:yB(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ve()})(n,e.precondition)),t}function g0(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?xt.updateTime(Wt(o.updateTime)):o.exists!==void 0?xt.exists(o.exists):xt.none()})(e.currentDocument):xt.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(c,h){let d=null;if("setToServerValue"in h)be(h.setToServerValue==="REQUEST_TIME"),d=new tu;else if("appendMissingElements"in h){const _=h.appendMissingElements.values||[];d=new gl(_)}else if("removeAllFromArray"in h){const _=h.removeAllFromArray.values||[];d=new _l(_)}else"increment"in h?d=new nu(c,h.increment):ve();const p=Rt.fromServerFormat(h.fieldPath);return new df(p,d)})(n,s))):[];if(e.update){e.update.name;const s=jr(n,e.update.name),o=new Pn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(d){const p=d.fieldPaths||[];return new fi(p.map((_=>Rt.fromServerFormat(_))))})(e.updateMask);return new Fs(s,o,c,t,i)}return new bu(s,o,t,i)}if(e.delete){const s=jr(n,e.delete);return new Iu(s,t)}if(e.verify){const s=jr(n,e.verify);return new jE(s,t)}return ve()}function wB(n,e){return n&&n.length>0?(be(e!==void 0),n.map((t=>(function(s,o){let c=s.updateTime?Wt(s.updateTime):Wt(o);return c.isEqual(Ce.min())&&(c=Wt(o)),new lB(c,s.transformResults||[])})(t,e)))):[]}function dN(n,e){return{documents:[lN(n,e.path)]}}function fN(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=lN(n,s);const o=(function(p){if(p.length!==0)return gN(dt.create(p,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(p){if(p.length!==0)return p.map((_=>(function(T){return{field:Mc(T.field),direction:bB(T.dir)}})(_)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const h=f0(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{_t:t,parent:s}}function mN(n){let e=cN(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){be(i===1);const _=t.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let o=[];t.where&&(o=(function(v){const T=pN(v);return T instanceof dt&&LE(T)?T.getFilters():[T]})(t.where));let c=[];t.orderBy&&(c=(function(v){return v.map((T=>(function(P){return new Od(Vc(P.field),(function(Y){switch(Y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(T)))})(t.orderBy));let h=null;t.limit&&(h=(function(v){let T;return T=typeof v=="object"?v.value:v,lf(T)?null:T})(t.limit));let d=null;t.startAt&&(d=(function(v){const T=!!v.before,R=v.values||[];return new eo(R,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(v){const T=!v.before,R=v.values||[];return new eo(R,T)})(t.endAt)),Fx(e,s,c,o,h,"F",d,p)}function TB(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function pN(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Vc(t.unaryFilter.field);return Je.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Vc(t.unaryFilter.field);return Je.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Vc(t.unaryFilter.field);return Je.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Vc(t.unaryFilter.field);return Je.create(c,"!=",{nullValue:"NULL_VALUE"});default:return ve()}})(n):n.fieldFilter!==void 0?(function(t){return Je.create(Vc(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ve()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return dt.create(t.compositeFilter.filters.map((i=>pN(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ve()}})(t.compositeFilter.op))})(n):ve()}function bB(n){return mB[n]}function IB(n){return pB[n]}function SB(n){return gB[n]}function Mc(n){return{fieldPath:n.canonicalString()}}function Vc(n){return Rt.fromServerFormat(n.fieldPath)}function gN(n){return n instanceof Je?(function(t){if(t.op==="=="){if(UA(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NAN"}};if(LA(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(UA(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NOT_NAN"}};if(LA(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mc(t.field),op:IB(t.op),value:t.value}}})(n):n instanceof dt?(function(t){const i=t.getFilters().map((s=>gN(s)));return i.length===1?i[0]:{compositeFilter:{op:SB(t.op),filters:i}}})(n):ve()}function AB(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function _N(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t,i,s,o=Ce.min(),c=Ce.min(),h=zt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new Ss(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ss(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ss(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ss(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e){this.ct=e}}function CB(n,e){let t;if(e.document)t=hN(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=pe.fromSegments(e.noDocument.path),s=vl(e.noDocument.readTime);t=St.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ve();{const i=pe.fromSegments(e.unknownDocument.path),s=vl(e.unknownDocument.version);t=St.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const o=new Dt(s[0],s[1]);return Ce.fromTimestamp(o)})(e.readTime)),t}function nC(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:zp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(o,c){return{name:Md(o,c.key),fields:c.data.value.mapValue.fields,updateTime:iu(o,c.version.toTimestamp()),createTime:iu(o,c.createTime.toTimestamp())}})(n.ct,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:yl(e.version)};else{if(!e.isUnknownDocument())return ve();i.unknownDocument={path:t.path.toArray(),version:yl(e.version)}}return i}function zp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function yl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function vl(n){const e=new Dt(n.seconds,n.nanoseconds);return Ce.fromTimestamp(e)}function Xo(n,e){const t=(e.baseMutations||[]).map((o=>g0(n.ct,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];c.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map((o=>g0(n.ct,o))),s=Dt.fromMillis(e.localWriteTimeMs);return new zE(e.batchId,s,t,i)}function ed(n){const e=vl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?vl(n.lastLimboFreeSnapshotVersion):Ce.min();let i;return i=(function(o){return o.documents!==void 0})(n.query)?(function(o){return be(o.documents.length===1),ei(Tu(cN(o.documents[0])))})(n.query):(function(o){return ei(mN(o))})(n.query),new Ss(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,zt.fromBase64String(n.resumeToken))}function vN(n,e){const t=yl(e.snapshotVersion),i=yl(e.lastLimboFreeSnapshotVersion);let s;s=Bp(e.target)?dN(n.ct,e.target):fN(n.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:pl(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function KE(n){const e=mN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jp(e,e.limit,"L"):e}function xv(n,e){return new GE(e.largestBatchId,g0(n.ct,e.overlayMutation))}function iC(n,e){const t=e.path.lastSegment();return[n,Zn(e.path.popLast()),t]}function rC(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:yl(i.readTime),documentKey:Zn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RB{getBundleMetadata(e,t){return sC(e).get(t).next((i=>{if(i)return(function(o){return{id:o.bundleId,createTime:vl(o.createTime),version:o.version}})(i)}))}saveBundleMetadata(e,t){return sC(e).put((function(s){return{bundleId:s.id,createTime:yl(Wt(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return aC(e).get(t).next((i=>{if(i)return(function(o){return{name:o.name,query:KE(o.bundledQuery),readTime:vl(o.readTime)}})(i)}))}saveNamedQuery(e,t){return aC(e).put((function(s){return{name:s.name,readTime:yl(Wt(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function sC(n){return un(n,"bundles")}function aC(n){return un(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const i=t.uid||"";return new Rg(e,i)}getOverlay(e,t){return Bh(e).get(iC(this.userId,t)).next((i=>i?xv(this.serializer,i):null))}getOverlays(e,t){const i=Mr();return z.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((o,c)=>{const h=new GE(t,c);s.push(this.ht(e,h))})),z.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((c=>s.add(Zn(c.getCollectionPath()))));const o=[];return s.forEach((c=>{const h=IDBKeyRange.bound([this.userId,c,i],[this.userId,c,i+1],!1,!0);o.push(Bh(e).j("collectionPathOverlayIndex",h))})),z.waitFor(o)}getOverlaysForCollection(e,t,i){const s=Mr(),o=Zn(t),c=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Bh(e).U("collectionPathOverlayIndex",c).next((h=>{for(const d of h){const p=xv(this.serializer,d);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const o=Mr();let c;const h=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Bh(e).J({index:"collectionGroupOverlayIndex",range:h},((d,p,_)=>{const v=xv(this.serializer,p);o.size()<s||v.largestBatchId===c?(o.set(v.getKey(),v),c=v.largestBatchId):_.done()})).next((()=>o))}ht(e,t){return Bh(e).put((function(s,o,c){const[h,d,p]=iC(o,c.mutation.key);return{userId:o,collectionPath:d,documentId:p,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:Vd(s.ct,c.mutation)}})(this.serializer,this.userId,t))}}function Bh(n){return un(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xB{Pt(e){return un(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?zt.fromUint8Array(i):zt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ct(e.integerValue));else if("doubleValue"in e){const i=Ct(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),Nd(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=Ps(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Xa(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?Nx(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Sg(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):ve()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const i=e.fields||{};this.dt(t,55);for(const s of Object.keys(i))this.Vt(s,t),this.Tt(i[s],t)}wt(e,t){var i,s;const o=e.fields||{};this.dt(t,53);const c="value",h=((s=(i=o[c].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Ct(h)),this.Vt(c,t),this.Tt(o[c],t)}bt(e,t){const i=e.values||[];this.dt(t,50);for(const s of i)this.Tt(s,t)}yt(e,t){this.dt(t,37),pe.fromName(e).path.forEach((i=>{this.dt(t,60),this.Dt(i,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}Jo.vt=new Jo;function NB(n){if(n===0)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function oC(n){const e=64-(function(i){let s=0;for(let o=0;o<8;++o){const c=NB(255&i[o]);if(s+=c,c!==8)break}return s})(n);return Math.ceil(e/8)}class DB{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ft(i.value),i=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Ot(i.value),i=t.next();this.Nt()}Lt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Ot(i);else if(i<2048)this.Ot(960|i>>>6),this.Ot(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),i=oC(t);this.Qt(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),i=oC(t);this.Qt(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),i=(128&t[0])!=0;t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class kB{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class PB{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Fh{constructor(){this.jt=new DB,this.Ht=new kB(this.jt),this.Jt=new PB(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e,t,i,s){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new Zo(this.indexId,this.documentKey,this.arrayValue,i)}}function Da(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=lC(n.arrayValue,e.arrayValue),t!==0?t:(t=lC(n.directionalValue,e.directionalValue),t!==0?t:pe.comparator(n.documentKey,e.documentKey)))}function lC(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e){this.Xt=new gt(((t,i)=>Rt.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const i=t;i.isInequality()?this.Xt=this.Xt.add(i):this.tn.push(i)}}get nn(){return this.Xt.size>1}rn(e){if(be(e.collectionGroup===this.collectionId),this.nn)return!1;const t=r0(e);if(t!==void 0&&!this.sn(t))return!1;const i=Qo(e);let s=new Set,o=0,c=0;for(;o<i.length&&this.sn(i[o]);++o)s=s.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.Xt.size>0){const h=this.Xt.getIterator().getNext();if(!s.has(h.field.canonicalString())){const d=i[o];if(!this.on(h,d)||!this._n(this.en[c++],d))return!1}++o}for(;o<i.length;++o){const h=i[o];if(c>=this.en.length||!this._n(this.en[c++],h))return!1}return!0}an(){if(this.nn)return null;let e=new gt(Rt.comparator);const t=[];for(const i of this.tn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Ep(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Ep(i.field,0))}for(const i of this.en)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Ep(i.field,i.dir==="asc"?0:1)));return new Up(Up.UNKNOWN_ID,this.collectionId,t,xd.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(n){var e,t;if(be(n instanceof Je||n instanceof dt),n instanceof Je){if(n instanceof Bx){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((o=>Je.create(n.field,"==",o))))||[];return dt.create(s,"or")}return n}const i=n.filters.map((s=>EN(s)));return dt.create(i,n.op)}function OB(n){if(n.getFilters().length===0)return[];const e=v0(EN(n));return be(wN(e)),_0(e)||y0(e)?[e]:e.getFilters()}function _0(n){return n instanceof Je}function y0(n){return n instanceof dt&&LE(n)}function wN(n){return _0(n)||y0(n)||(function(t){if(t instanceof dt&&c0(t)){for(const i of t.getFilters())if(!_0(i)&&!y0(i))return!1;return!0}return!1})(n)}function v0(n){if(be(n instanceof Je||n instanceof dt),n instanceof Je)return n;if(n.filters.length===1)return v0(n.filters[0]);const e=n.filters.map((i=>v0(i)));let t=dt.create(e,n.op);return t=qp(t),wN(t)?t:(be(t instanceof dt),be(eu(t)),be(t.filters.length>1),t.filters.reduce(((i,s)=>QE(i,s))))}function QE(n,e){let t;return be(n instanceof Je||n instanceof dt),be(e instanceof Je||e instanceof dt),t=n instanceof Je?e instanceof Je?(function(s,o){return dt.create([s,o],"and")})(n,e):uC(n,e):e instanceof Je?uC(e,n):(function(s,o){if(be(s.filters.length>0&&o.filters.length>0),eu(s)&&eu(o))return Vx(s,o.getFilters());const c=c0(s)?s:o,h=c0(s)?o:s,d=c.filters.map((p=>QE(p,h)));return dt.create(d,"or")})(n,e),qp(t)}function uC(n,e){if(eu(e))return Vx(e,n.getFilters());{const t=e.filters.map((i=>QE(n,i)));return dt.create(t,"or")}}function qp(n){if(be(n instanceof Je||n instanceof dt),n instanceof Je)return n;const e=n.getFilters();if(e.length===1)return qp(e[0]);if(Ox(n))return n;const t=e.map((s=>qp(s))),i=[];return t.forEach((s=>{s instanceof Je?i.push(s):s instanceof dt&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:dt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MB{constructor(){this.un=new WE}addToCollectionParentIndex(e,t){return this.un.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(Pi.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(Pi.min())}updateCollectionGroup(e,t,i){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class WE{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new gt(Xe.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new gt(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp=new Uint8Array(0);class VB{constructor(e,t){this.databaseId=t,this.cn=new WE,this.ln=new fo((i=>pl(i)),((i,s)=>cf(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const o={collectionId:i,parent:Zn(s)};return hC(e).put(o)}return z.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[_x(t),""],!1,!0);return hC(e).U(s).next((o=>{for(const c of o){if(c.collectionId!==t)break;i.push(Or(c.parent))}return i}))}addFieldIndex(e,t){const i=jh(e),s=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((d=>[d.fieldPath.canonicalString(),d.kind]))}})(t);delete s.indexId;const o=i.add(s);if(t.indexState){const c=xc(e);return o.next((h=>{c.put(rC(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const i=jh(e),s=xc(e),o=Rc(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=jh(e),i=Rc(e),s=xc(e);return t.j().next((()=>i.j())).next((()=>s.j()))}createTargetIndexes(e,t){return z.forEach(this.hn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const o=new cC(i).an();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const i=Rc(e);let s=!0;const o=new Map;return z.forEach(this.hn(t),(c=>this.Pn(e,c).next((h=>{s&&(s=!!h),o.set(c,h)})))).next((()=>{if(s){let c=Ue();const h=[];return z.forEach(o,((d,p)=>{re("IndexedDbIndexManager",`Using index ${(function(oe){return`id=${oe.indexId}|cg=${oe.collectionGroup}|f=${oe.fields.map((de=>`${de.fieldPath}:${de.kind}`)).join(",")}`})(d)} to execute ${pl(t)}`);const _=(function(oe,de){const Pe=r0(de);if(Pe===void 0)return null;for(const Re of Fp(oe,Pe.fieldPath))switch(Re.op){case"array-contains-any":return Re.value.arrayValue.values||[];case"array-contains":return[Re.value]}return null})(p,d),v=(function(oe,de){const Pe=new Map;for(const Re of Qo(de))for(const k of Fp(oe,Re.fieldPath))switch(k.op){case"==":case"in":Pe.set(Re.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return Pe.set(Re.fieldPath.canonicalString(),k.value),Array.from(Pe.values())}return null})(p,d),T=(function(oe,de){const Pe=[];let Re=!0;for(const k of Qo(de)){const x=k.kind===0?qA(oe,k.fieldPath,oe.startAt):GA(oe,k.fieldPath,oe.startAt);Pe.push(x.value),Re&&(Re=x.inclusive)}return new eo(Pe,Re)})(p,d),R=(function(oe,de){const Pe=[];let Re=!0;for(const k of Qo(de)){const x=k.kind===0?GA(oe,k.fieldPath,oe.endAt):qA(oe,k.fieldPath,oe.endAt);Pe.push(x.value),Re&&(Re=x.inclusive)}return new eo(Pe,Re)})(p,d),P=this.In(d,p,T),q=this.In(d,p,R),Y=this.Tn(d,p,v),le=this.En(d.indexId,_,P,T.inclusive,q,R.inclusive,Y);return z.forEach(le,(Ee=>i.G(Ee,t.limit).next((oe=>{oe.forEach((de=>{const Pe=pe.fromSegments(de.documentKey);c.has(Pe)||(c=c.add(Pe),h.push(Pe))}))}))))})).next((()=>h))}return z.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=OB(dt.create(e.filters,"and")).map((i=>h0(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,i,s,o,c,h){const d=(t!=null?t.length:1)*Math.max(i.length,o.length),p=d/(t!=null?t.length:1),_=[];for(let v=0;v<d;++v){const T=t?this.dn(t[v/p]):cp,R=this.An(e,T,i[v%p],s),P=this.Rn(e,T,o[v%p],c),q=h.map((Y=>this.An(e,T,Y,!0)));_.push(...this.createRange(R,P,q))}return _}An(e,t,i,s){const o=new Zo(e,pe.empty(),t,i);return s?o:o.Zt()}Rn(e,t,i,s){const o=new Zo(e,pe.empty(),t,i);return s?o.Zt():o}Pn(e,t){const i=new cC(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((o=>{let c=null;for(const h of o)i.rn(h)&&(!c||h.fields.length>c.fields.length)&&(c=h);return c}))}getIndexType(e,t){let i=2;const s=this.hn(t);return z.forEach(s,(o=>this.Pn(e,o).next((c=>{c?i!==0&&c.fields.length<(function(d){let p=new gt(Rt.comparator),_=!1;for(const v of d.filters)for(const T of v.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:p=p.add(T.field));for(const v of d.orderBy)v.field.isKeyField()||(p=p.add(v.field));return p.size+(_?1:0)})(o)&&(i=1):i=0})))).next((()=>(function(c){return c.limit!==null})(t)&&s.length>1&&i===2?1:i))}Vn(e,t){const i=new Fh;for(const s of Qo(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const c=i.Yt(s.kind);Jo.vt.It(o,c)}return i.zt()}dn(e){const t=new Fh;return Jo.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const i=new Fh;return Jo.vt.It(ml(this.databaseId,t),i.Yt((function(o){const c=Qo(o);return c.length===0?0:c[c.length-1].kind})(e))),i.zt()}Tn(e,t,i){if(i===null)return[];let s=[];s.push(new Fh);let o=0;for(const c of Qo(e)){const h=i[o++];for(const d of s)if(this.fn(t,c.fieldPath)&&Pd(h))s=this.gn(s,c,h);else{const p=d.Yt(c.kind);Jo.vt.It(h,p)}}return this.pn(s)}In(e,t,i){return this.Tn(e,t,i.position)}pn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].zt();return t}gn(e,t,i){const s=[...e],o=[];for(const c of i.arrayValue.values||[])for(const h of s){const d=new Fh;d.seed(h.zt()),Jo.vt.It(c,d.Yt(t.kind)),o.push(d)}return o}fn(e,t){return!!e.filters.find((i=>i instanceof Je&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=jh(e),s=xc(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next((o=>{const c=[];return z.forEach(o,(h=>s.get([h.indexId,this.uid]).next((d=>{c.push((function(_,v){const T=v?new xd(v.sequenceNumber,new Pi(vl(v.readTime),new pe(Or(v.documentKey)),v.largestBatchId)):xd.empty(),R=_.fields.map((([P,q])=>new Ep(Rt.fromServerFormat(P),q)));return new Up(_.indexId,_.collectionGroup,R,T)})(h,d))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const o=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:Ve(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=jh(e),o=xc(e);return this.yn(e).next((c=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((h=>z.forEach(h,(d=>o.put(rC(d.indexId,this.uid,c,i))))))))}updateIndexEntries(e,t){const i=new Map;return z.forEach(t,((s,o)=>{const c=i.get(s.collectionGroup);return(c?z.resolve(c):this.getFieldIndexes(e,s.collectionGroup)).next((h=>(i.set(s.collectionGroup,h),z.forEach(h,(d=>this.wn(e,s,d).next((p=>{const _=this.Sn(o,d);return p.isEqual(_)?z.resolve():this.bn(e,o,d,p,_)})))))))}))}Dn(e,t,i,s){return Rc(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(i,t.key),documentKey:t.key.path.toArray()})}vn(e,t,i,s){return Rc(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(i,t.key),t.key.path.toArray()])}wn(e,t,i){const s=Rc(e);let o=new gt(Da);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.mn(i,t)])},((c,h)=>{o=o.add(new Zo(i.indexId,t,h.arrayValue,h.directionalValue))})).next((()=>o))}Sn(e,t){let i=new gt(Da);const s=this.Vn(t,e);if(s==null)return i;const o=r0(t);if(o!=null){const c=e.data.field(o.fieldPath);if(Pd(c))for(const h of c.arrayValue.values||[])i=i.add(new Zo(t.indexId,e.key,this.dn(h),s))}else i=i.add(new Zo(t.indexId,e.key,cp,s));return i}bn(e,t,i,s,o){re("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return(function(d,p,_,v,T){const R=d.getIterator(),P=p.getIterator();let q=Cc(R),Y=Cc(P);for(;q||Y;){let le=!1,Ee=!1;if(q&&Y){const oe=_(q,Y);oe<0?Ee=!0:oe>0&&(le=!0)}else q!=null?Ee=!0:le=!0;le?(v(Y),Y=Cc(P)):Ee?(T(q),q=Cc(R)):(q=Cc(R),Y=Cc(P))}})(s,o,Da,(h=>{c.push(this.Dn(e,t,i,h))}),(h=>{c.push(this.vn(e,t,i,h))})),z.waitFor(c)}yn(e){let t=1;return xc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,o)=>{o.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((c,h)=>Da(c,h))).filter(((c,h,d)=>!h||Da(c,d[h-1])!==0));const s=[];s.push(e);for(const c of i){const h=Da(c,e),d=Da(c,t);if(h===0)s[0]=e.Zt();else if(h>0&&d<0)s.push(c),s.push(c.Zt());else if(d>0)break}s.push(t);const o=[];for(let c=0;c<s.length;c+=2){if(this.Cn(s[c],s[c+1]))return[];const h=[s[c].indexId,this.uid,s[c].arrayValue,s[c].directionalValue,cp,[]],d=[s[c+1].indexId,this.uid,s[c+1].arrayValue,s[c+1].directionalValue,cp,[]];o.push(IDBKeyRange.bound(h,d))}return o}Cn(e,t){return Da(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(dC)}getMinOffset(e,t){return z.mapArray(this.hn(t),(i=>this.Pn(e,i).next((s=>s||ve())))).next(dC)}}function hC(n){return un(n,"collectionParents")}function Rc(n){return un(n,"indexEntries")}function jh(n){return un(n,"indexConfiguration")}function xc(n){return un(n,"indexState")}function dC(n){be(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;PE(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Pi(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ui{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new ui(e,ui.DEFAULT_COLLECTION_PERCENTILE,ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n,e,t){const i=n.store("mutations"),s=n.store("documentMutations"),o=[],c=IDBKeyRange.only(t.batchId);let h=0;const d=i.J({range:c},((_,v,T)=>(h++,T.delete())));o.push(d.next((()=>{be(h===1)})));const p=[];for(const _ of t.mutations){const v=Ix(e,_.key.path,t.batchId);o.push(s.delete(v)),p.push(_.key)}return z.waitFor(o).next((()=>p))}function Gp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ve();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ui.DEFAULT_COLLECTION_PERCENTILE=10,ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ui.DEFAULT=new ui(41943040,ui.DEFAULT_COLLECTION_PERCENTILE,ui.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ui.DISABLED=new ui(-1,0,0);class xg{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Fn={}}static lt(e,t,i,s){be(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new xg(o,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ka(e).J({index:"userMutationsIndex",range:i},((s,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const o=Lc(e),c=ka(e);return c.add({}).next((h=>{be(typeof h=="number");const d=new zE(h,t,i,s),p=(function(R,P,q){const Y=q.baseMutations.map((Ee=>Vd(R.ct,Ee))),le=q.mutations.map((Ee=>Vd(R.ct,Ee)));return{userId:P,batchId:q.batchId,localWriteTimeMs:q.localWriteTime.toMillis(),baseMutations:Y,mutations:le}})(this.serializer,this.userId,d),_=[];let v=new gt(((T,R)=>Ve(T.canonicalString(),R.canonicalString())));for(const T of s){const R=Ix(this.userId,T.key.path,h);v=v.add(T.key.path.popLast()),_.push(c.put(p)),_.push(o.put(R,T3))}return v.forEach((T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Fn[h]=d.keys()})),z.waitFor(_).next((()=>d))}))}lookupMutationBatch(e,t){return ka(e).get(t).next((i=>i?(be(i.userId===this.userId),Xo(this.serializer,i)):null))}Mn(e,t){return this.Fn[t]?z.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Fn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return ka(e).J({index:"userMutationsIndex",range:s},((c,h,d)=>{h.userId===this.userId&&(be(h.batchId>=i),o=Xo(this.serializer,h)),d.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return ka(e).J({index:"userMutationsIndex",range:t,reverse:!0},((s,o,c)=>{i=o.batchId,c.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ka(e).U("userMutationsIndex",t).next((i=>i.map((s=>Xo(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=wp(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=[];return Lc(e).J({range:s},((c,h,d)=>{const[p,_,v]=c,T=Or(_);if(p===this.userId&&t.path.isEqual(T))return ka(e).get(v).next((R=>{if(!R)throw ve();be(R.userId===this.userId),o.push(Xo(this.serializer,R))}));d.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new gt(Ve);const s=[];return t.forEach((o=>{const c=wp(this.userId,o.path),h=IDBKeyRange.lowerBound(c),d=Lc(e).J({range:h},((p,_,v)=>{const[T,R,P]=p,q=Or(R);T===this.userId&&o.path.isEqual(q)?i=i.add(P):v.done()}));s.push(d)})),z.waitFor(s).next((()=>this.xn(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,o=wp(this.userId,i),c=IDBKeyRange.lowerBound(o);let h=new gt(Ve);return Lc(e).J({range:c},((d,p,_)=>{const[v,T,R]=d,P=Or(T);v===this.userId&&i.isPrefixOf(P)?P.length===s&&(h=h.add(R)):_.done()})).next((()=>this.xn(e,h)))}xn(e,t){const i=[],s=[];return t.forEach((o=>{s.push(ka(e).get(o).next((c=>{if(c===null)throw ve();be(c.userId===this.userId),i.push(Xo(this.serializer,c))})))})),z.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return TN(e._e,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),z.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return z.resolve();const i=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),s=[];return Lc(e).J({range:i},((o,c,h)=>{if(o[0]===this.userId){const d=Or(o[1]);s.push(d)}else h.done()})).next((()=>{be(s.length===0)}))}))}containsKey(e,t){return bN(e,this.userId,t)}Nn(e){return IN(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function bN(n,e,t){const i=wp(e,t.path),s=i[1],o=IDBKeyRange.lowerBound(i);let c=!1;return Lc(n).J({range:o,H:!0},((h,d,p)=>{const[_,v,T]=h;_===e&&v===s&&(c=!0),p.done()})).next((()=>c))}function ka(n){return un(n,"mutations")}function Lc(n){return un(n,"documentMutations")}function IN(n){return un(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new El(0)}static kn(){return new El(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LB{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const i=new El(t.highestTargetId);return t.highestTargetId=i.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((t=>Ce.fromTimestamp(new Dt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.qn(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((i=>(i.targetCount+=1,this.$n(t,i),this.Qn(e,i))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Nc(e).delete(t.targetId))).next((()=>this.qn(e))).next((i=>(be(i.targetCount>0),i.targetCount-=1,this.Qn(e,i))))}removeTargets(e,t,i){let s=0;const o=[];return Nc(e).J(((c,h)=>{const d=ed(h);d.sequenceNumber<=t&&i.get(d.targetId)===null&&(s++,o.push(this.removeTargetData(e,d)))})).next((()=>z.waitFor(o))).next((()=>s))}forEachTarget(e,t){return Nc(e).J(((i,s)=>{const o=ed(s);t(o)}))}qn(e){return mC(e).get("targetGlobalKey").next((t=>(be(t!==null),t)))}Qn(e,t){return mC(e).put("targetGlobalKey",t)}Kn(e,t){return Nc(e).put(vN(this.serializer,t))}$n(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.qn(e).next((t=>t.targetCount))}getTargetData(e,t){const i=pl(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return Nc(e).J({range:s,index:"queryTargetsIndex"},((c,h,d)=>{const p=ed(h);cf(t,p.target)&&(o=p,d.done())})).next((()=>o))}addMatchingKeys(e,t,i){const s=[],o=Ma(e);return t.forEach((c=>{const h=Zn(c.path);s.push(o.put({targetId:i,path:h})),s.push(this.referenceDelegate.addReference(e,i,c))})),z.waitFor(s)}removeMatchingKeys(e,t,i){const s=Ma(e);return z.forEach(t,(o=>{const c=Zn(o.path);return z.waitFor([s.delete([i,c]),this.referenceDelegate.removeReference(e,i,o)])}))}removeMatchingKeysForTargetId(e,t){const i=Ma(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=Ma(e);let o=Ue();return s.J({range:i,H:!0},((c,h,d)=>{const p=Or(c[1]),_=new pe(p);o=o.add(_)})).next((()=>o))}containsKey(e,t){const i=Zn(t.path),s=IDBKeyRange.bound([i],[_x(i)],!1,!0);let o=0;return Ma(e).J({index:"documentTargetsIndex",H:!0,range:s},(([c,h],d,p)=>{c!==0&&(o++,p.done())})).next((()=>o>0))}ot(e,t){return Nc(e).get(t).next((i=>i?ed(i):null))}}function Nc(n){return un(n,"targets")}function mC(n){return un(n,"targetGlobal")}function Ma(n){return un(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC([n,e],[t,i]){const s=Ve(n,t);return s===0?Ve(e,i):s}class UB{constructor(e){this.Un=e,this.buffer=new gt(pC),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();pC(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class BB{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){re("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ho(t)?re("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await uo(t)}await this.Hn(3e5)}))}}class FB{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return z.resolve(di.oe);const i=new UB(t);return this.Jn.forEachTarget(e,(s=>i.zn(s.sequenceNumber))).next((()=>this.Jn.Zn(e,(s=>i.zn(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(re("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(fC)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fC):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let i,s,o,c,h,d,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,c=Date.now(),this.nthSequenceNumber(e,s)))).next((v=>(i=v,h=Date.now(),this.removeTargets(e,i,t)))).next((v=>(o=v,d=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(p=Date.now(),Pc()<=Ge.DEBUG&&re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${s} in `+(h-c)+`ms
	Removed ${o} targets in `+(d-h)+`ms
	Removed ${v} documents in `+(p-d)+`ms
Total Duration: ${p-_}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:v}))))}}function jB(n,e){return new FB(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e,t){this.db=e,this.garbageCollector=jB(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}er(e){let t=0;return this.Zn(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((i,s)=>t(s)))}addReference(e,t,i){return up(e,i)}removeReference(e,t,i){return up(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return up(e,t)}nr(e,t){return(function(s,o){let c=!1;return IN(s).Y((h=>bN(s,h,o).next((d=>(d&&(c=!0),z.resolve(!d)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.tr(e,((c,h)=>{if(h<=t){const d=this.nr(e,c).next((p=>{if(!p)return o++,i.getEntry(e,c).next((()=>(i.removeEntry(c,Ce.min()),Ma(e).delete((function(v){return[0,Zn(v.path)]})(c)))))}));s.push(d)}})).next((()=>z.waitFor(s))).next((()=>i.apply(e))).next((()=>o))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return up(e,t)}tr(e,t){const i=Ma(e);let s,o=di.oe;return i.J({index:"documentTargetsIndex"},(([c,h],{path:d,sequenceNumber:p})=>{c===0?(o!==di.oe&&t(new pe(Or(s)),o),o=p,s=d):o=di.oe})).next((()=>{o!==di.oe&&t(new pe(Or(s)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function up(n,e){return Ma(n).put((function(i,s){return{targetId:0,path:Zn(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(){this.changes=new fo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qB{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return $o(e).put(i)}removeEntry(e,t,i){return $o(e).delete((function(o,c){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],zp(c),h[h.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.rr(e,i))))}getEntry(e,t){let i=St.newInvalidDocument(t);return $o(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zh(t))},((s,o)=>{i=this.ir(t,o)})).next((()=>i))}sr(e,t){let i={size:0,document:St.newInvalidDocument(t)};return $o(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zh(t))},((s,o)=>{i={document:this.ir(t,o),size:Gp(o)}})).next((()=>i))}getEntries(e,t){let i=mi();return this._r(e,t,((s,o)=>{const c=this.ir(s,o);i=i.insert(s,c)})).next((()=>i))}ar(e,t){let i=mi(),s=new Mt(pe.comparator);return this._r(e,t,((o,c)=>{const h=this.ir(o,c);i=i.insert(o,h),s=s.insert(o,Gp(c))})).next((()=>({documents:i,ur:s})))}_r(e,t,i){if(t.isEmpty())return z.resolve();let s=new gt(yC);t.forEach((d=>s=s.add(d)));const o=IDBKeyRange.bound(zh(s.first()),zh(s.last())),c=s.getIterator();let h=c.getNext();return $o(e).J({index:"documentKeyIndex",range:o},((d,p,_)=>{const v=pe.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;h&&yC(h,v)<0;)i(h,null),h=c.getNext();h&&h.isEqual(v)&&(i(h,p),h=c.hasNext()?c.getNext():null),h?_.$(zh(h)):_.done()})).next((()=>{for(;h;)i(h,null),h=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,o){const c=t.path,h=[c.popLast().toArray(),c.lastSegment(),zp(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],d=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return $o(e).U(IDBKeyRange.bound(h,d,!0)).next((p=>{o==null||o.incrementDocumentReadCount(p.length);let _=mi();for(const v of p){const T=this.ir(pe.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);T.isFoundDocument()&&(hf(t,T)||s.has(T.key))&&(_=_.insert(T.key,T))}return _}))}getAllFromCollectionGroup(e,t,i,s){let o=mi();const c=_C(t,i),h=_C(t,Pi.max());return $o(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,h,!0)},((d,p,_)=>{const v=this.ir(pe.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(v.key,v),o.size===s&&_.done()})).next((()=>o))}newChangeBuffer(e){return new GB(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return gC(e).get("remoteDocumentGlobalKey").next((t=>(be(!!t),t)))}rr(e,t){return gC(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const i=CB(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ce.min())))return i}return St.newInvalidDocument(e)}}function AN(n){return new qB(n)}class GB extends SN{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new fo((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new gt(((o,c)=>Ve(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const h=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,h.readTime)),c.isValidDocument()){const d=nC(this.cr.serializer,c);s=s.add(o.path.popLast());const p=Gp(d);i+=p-h.size,t.push(this.cr.addEntry(e,o,d))}else if(i-=h.size,this.trackRemovals){const d=nC(this.cr.serializer,c.convertToNoDocument(Ce.min()));t.push(this.cr.addEntry(e,o,d))}})),s.forEach((o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.cr.updateMetadata(e,i)),z.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((i=>(this.lr.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((({documents:i,ur:s})=>(s.forEach(((o,c)=>{this.lr.set(o,{size:c,readTime:i.get(o).readTime})})),i)))}}function gC(n){return un(n,"remoteDocumentGlobal")}function $o(n){return un(n,"remoteDocumentsV14")}function zh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function _C(n,e){const t=e.documentKey.path.toArray();return[n,zp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function yC(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(s=Ve(t[o],i[o]),s)return s;return s=Ve(t.length,i.length),s||(s=Ve(t[t.length-2],i[i.length-2]),s||Ve(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&cd(i.mutation,s,fi.empty(),Dt.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ue()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ue()){const s=Mr();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((o=>{let c=Jh();return o.forEach(((h,d)=>{c=c.insert(h,d.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=Mr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ue())))}populateOverlays(e,t,i){const s=[];return i.forEach((o=>{t.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((c,h)=>{t.set(c,h)}))}))}computeViews(e,t,i,s){let o=mi();const c=ld(),h=(function(){return ld()})();return t.forEach(((d,p)=>{const _=i.get(p.key);s.has(p.key)&&(_===void 0||_.mutation instanceof Fs)?o=o.insert(p.key,p):_!==void 0?(c.set(p.key,_.mutation.getFieldMask()),cd(_.mutation,p,_.mutation.getFieldMask(),Dt.now())):c.set(p.key,fi.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((p,_)=>c.set(p,_))),t.forEach(((p,_)=>{var v;return h.set(p,new HB(_,(v=c.get(p))!==null&&v!==void 0?v:null))})),h)))}recalculateAndSaveOverlays(e,t){const i=ld();let s=new Mt(((c,h)=>c-h)),o=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const h of c)h.keys().forEach((d=>{const p=t.get(d);if(p===null)return;let _=i.get(d)||fi.empty();_=h.applyToLocalView(p,_),i.set(d,_);const v=(s.get(h.batchId)||Ue()).add(d);s=s.insert(h.batchId,v)}))})).next((()=>{const c=[],h=s.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),p=d.key,_=d.value,v=$x();_.forEach((T=>{if(!o.has(T)){const R=Zx(t.get(T),i.get(T));R!==null&&v.set(T,R),o=o.add(T)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,v))}return z.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(c){return pe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):UE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((o=>{const c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):z.resolve(Mr());let h=-1,d=o;return c.next((p=>z.forEach(p,((_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),o.get(_)?z.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{d=d.insert(_,T)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,d,p,Ue()))).next((_=>({batchId:h,changes:Hx(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next((i=>{let s=Jh();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let c=Jh();return this.indexManager.getCollectionParents(e,o).next((h=>z.forEach(h,(d=>{const p=(function(v,T){return new Bs(T,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,i,s).next((_=>{_.forEach(((v,T)=>{c=c.insert(v,T)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s)))).next((c=>{o.forEach(((d,p)=>{const _=p.getKey();c.get(_)===null&&(c=c.insert(_,St.newInvalidDocument(_)))}));let h=Jh();return c.forEach(((d,p)=>{const _=o.get(d);_!==void 0&&cd(_.mutation,p,fi.empty(),Dt.now()),hf(t,p)&&(h=h.insert(d,p))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $B{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return z.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Wt(s.createTime)}})(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(s){return{name:s.name,query:KE(s.bundledQuery),readTime:Wt(s.readTime)}})(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(){this.overlays=new Mt(pe.comparator),this.Ir=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Mr();return z.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,o)=>{this.ht(e,t,o)})),z.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.Ir.get(i);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.Ir.delete(i)),z.resolve()}getOverlaysForCollection(e,t,i){const s=Mr(),o=t.length+1,c=new pe(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const d=h.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&d.largestBatchId>i&&s.set(d.getKey(),d)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new Mt(((p,_)=>p-_));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=o.get(p.largestBatchId);_===null&&(_=Mr(),o=o.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const h=Mr(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((p,_)=>h.set(p,_))),!(h.size()>=s)););return z.resolve(h)}ht(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const c=this.Ir.get(s.largestBatchId).delete(i.key);this.Ir.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new GE(t,i));let o=this.Ir.get(t);o===void 0&&(o=Ue(),this.Ir.set(t,o)),this.Ir.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(){this.sessionToken=zt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(){this.Tr=new gt(yn.Er),this.dr=new gt(yn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const i=new yn(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Vr(new yn(e,t))}mr(e,t){e.forEach((i=>this.removeReference(i,t)))}gr(e){const t=new pe(new Xe([])),i=new yn(t,e),s=new yn(t,e+1),o=[];return this.dr.forEachInRange([i,s],(c=>{this.Vr(c),o.push(c.key)})),o}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new pe(new Xe([])),i=new yn(t,e),s=new yn(t,e+1);let o=Ue();return this.dr.forEachInRange([i,s],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new yn(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class yn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return pe.comparator(e.key,t.key)||Ve(e.wr,t.wr)}static Ar(e,t){return Ve(e.wr,t.wr)||pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WB{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new gt(yn.Er)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new zE(o,t,i,s);this.mutationQueue.push(c);for(const h of s)this.br=this.br.add(new yn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return z.resolve(c)}lookupMutationBatch(e,t){return z.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.vr(i),o=s<0?0:s;return z.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new yn(t,0),s=new yn(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,s],(c=>{const h=this.Dr(c.wr);o.push(h)})),z.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new gt(Ve);return t.forEach((s=>{const o=new yn(s,0),c=new yn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],(h=>{i=i.add(h.wr)}))})),z.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;pe.isDocumentKey(o)||(o=o.child(""));const c=new yn(new pe(o),0);let h=new gt(Ve);return this.br.forEachWhile((d=>{const p=d.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(h=h.add(d.wr)),!0)}),c),z.resolve(this.Cr(h))}Cr(e){const t=[];return e.forEach((i=>{const s=this.Dr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){be(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return z.forEach(t.mutations,(s=>{const o=new yn(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.br=i}))}On(e){}containsKey(e,t){const i=new yn(t,0),s=this.br.firstAfterOrEqual(i);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YB{constructor(e){this.Mr=e,this.docs=(function(){return new Mt(pe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,c=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return z.resolve(i?i.document.mutableCopy():St.newInvalidDocument(t))}getEntries(e,t){let i=mi();return t.forEach((s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():St.newInvalidDocument(s))})),z.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=mi();const c=t.path,h=new pe(c.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:p,value:{document:_}}=d.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||PE(vx(_),i)<=0||(s.has(_.key)||hf(t,_))&&(o=o.insert(_.key,_.mutableCopy()))}return z.resolve(o)}getAllFromCollectionGroup(e,t,i,s){ve()}Or(e,t){return z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new XB(this)}getSize(e){return z.resolve(this.size)}}class XB extends SN{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(i)})),z.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(e){this.persistence=e,this.Nr=new fo((t=>pl(t)),cf),this.lastRemoteSnapshotVersion=Ce.min(),this.highestTargetId=0,this.Lr=0,this.Br=new YE,this.targetCount=0,this.kr=El.Bn()}forEachTarget(e,t){return this.Nr.forEach(((i,s)=>t(s))),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),z.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new El(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.Kn(t),z.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.Nr.forEach(((c,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)})),z.waitFor(o).next((()=>s))}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const i=this.Nr.get(t)||null;return z.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),z.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach((c=>{o.push(s.markPotentiallyOrphaned(e,c))})),z.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Br.yr(t);return z.resolve(i)}containsKey(e,t){return z.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e,t){this.qr={},this.overlays={},this.Qr=new di(0),this.Kr=!1,this.Kr=!0,this.$r=new QB,this.referenceDelegate=e(this),this.Ur=new JB(this),this.indexManager=new MB,this.remoteDocumentCache=(function(s){return new YB(s)})((i=>this.referenceDelegate.Wr(i))),this.serializer=new yN(t),this.Gr=new $B(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KB,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new WB(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){re("MemoryPersistence","Starting transaction:",e);const s=new ZB(this.Qr.next());return this.referenceDelegate.zr(),i(s).next((o=>this.referenceDelegate.jr(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Hr(e,t){return z.or(Object.values(this.qr).map((i=>()=>i.containsKey(e,t))))}}class ZB extends wx{constructor(e){super(),this.currentSequenceNumber=e}}class Ng{constructor(e){this.persistence=e,this.Jr=new YE,this.Yr=null}static Zr(e){return new Ng(e)}get Xr(){if(this.Yr)return this.Yr;throw ve()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),z.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),z.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((s=>this.Xr.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((o=>this.Xr.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Xr,(i=>{const s=pe.fromPath(i);return this.ei(e,s).next((o=>{o||t.removeEntry(s,Ce.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return z.or([()=>z.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e){this.serializer=e}O(e,t,i,s){const o=new bg("createOrUpgrade",t);i<1&&s>=1&&((function(d){d.createObjectStore("owner")})(e),(function(d){d.createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",kA,{unique:!0}),d.createObjectStore("documentMutations")})(e),vC(e),(function(d){d.createObjectStore("remoteDocuments")})(e));let c=z.resolve();return i<3&&s>=3&&(i!==0&&((function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")})(e),vC(e)),c=c.next((()=>(function(d){const p=d.store("targetGlobal"),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ce.min().toTimestamp(),targetCount:0};return p.put("targetGlobalKey",_)})(o)))),i<4&&s>=4&&(i!==0&&(c=c.next((()=>(function(d,p){return p.store("mutations").U().next((_=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",kA,{unique:!0});const v=p.store("mutations"),T=_.map((R=>v.put(R)));return z.waitFor(T)}))})(e,o)))),c=c.next((()=>{(function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)}))),i<5&&s>=5&&(c=c.next((()=>this.ni(o)))),i<6&&s>=6&&(c=c.next((()=>((function(d){d.createObjectStore("remoteDocumentGlobal")})(e),this.ri(o))))),i<7&&s>=7&&(c=c.next((()=>this.ii(o)))),i<8&&s>=8&&(c=c.next((()=>this.si(e,o)))),i<9&&s>=9&&(c=c.next((()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(c=c.next((()=>this.oi(o)))),i<11&&s>=11&&(c=c.next((()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),(function(d){d.createObjectStore("namedQueries",{keyPath:"name"})})(e)}))),i<12&&s>=12&&(c=c.next((()=>{(function(d){const p=d.createObjectStore("documentOverlays",{keyPath:O3});p.createIndex("collectionPathOverlayIndex",M3,{unique:!1}),p.createIndex("collectionGroupOverlayIndex",V3,{unique:!1})})(e)}))),i<13&&s>=13&&(c=c.next((()=>(function(d){const p=d.createObjectStore("remoteDocumentsV14",{keyPath:b3});p.createIndex("documentKeyIndex",I3),p.createIndex("collectionGroupIndex",S3)})(e))).next((()=>this._i(e,o))).next((()=>e.deleteObjectStore("remoteDocuments")))),i<14&&s>=14&&(c=c.next((()=>this.ai(e,o)))),i<15&&s>=15&&(c=c.next((()=>(function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:N3}).createIndex("sequenceNumberIndex",D3,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:k3}).createIndex("documentKeyIndex",P3,{unique:!1})})(e)))),i<16&&s>=16&&(c=c.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),i<17&&s>=17&&(c=c.next((()=>{(function(d){d.createObjectStore("globals",{keyPath:"name"})})(e)}))),c}ri(e){let t=0;return e.store("remoteDocuments").J(((i,s)=>{t+=Gp(s)})).next((()=>{const i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)}))}ni(e){const t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next((s=>z.forEach(s,(o=>{const c=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",c).next((h=>z.forEach(h,(d=>{be(d.userId===o.userId);const p=Xo(this.serializer,d);return TN(e,o.userId,p).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((s=>{const o=[];return i.J(((c,h)=>{const d=new Xe(c),p=(function(v){return[0,Zn(v)]})(d);o.push(t.get(p).next((_=>_?z.resolve():(v=>t.put({targetId:0,path:Zn(v),sequenceNumber:s.highestListenSequenceNumber}))(d))))})).next((()=>z.waitFor(o)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:x3});const i=t.store("collectionParents"),s=new WE,o=c=>{if(s.add(c)){const h=c.lastSegment(),d=c.popLast();return i.put({collectionId:h,parent:Zn(d)})}};return t.store("remoteDocuments").J({H:!0},((c,h)=>{const d=new Xe(c);return o(d.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([c,h,d],p)=>{const _=Or(h);return o(_.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((i,s)=>{const o=ed(s),c=vN(this.serializer,o);return t.put(c)}))}_i(e,t){const i=t.store("remoteDocuments"),s=[];return i.J(((o,c)=>{const h=t.store("remoteDocumentsV14"),d=(function(v){return v.document?new pe(Xe.fromString(v.document.name).popFirst(5)):v.noDocument?pe.fromSegments(v.noDocument.path):v.unknownDocument?pe.fromSegments(v.unknownDocument.path):ve()})(c).path.toArray(),p={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};s.push(h.put(p))})).next((()=>z.waitFor(s)))}ai(e,t){const i=t.store("mutations"),s=AN(this.serializer),o=new RN(Ng.Zr,this.serializer.ct);return i.U().next((c=>{const h=new Map;return c.forEach((d=>{var p;let _=(p=h.get(d.userId))!==null&&p!==void 0?p:Ue();Xo(this.serializer,d).keys().forEach((v=>_=_.add(v))),h.set(d.userId,_)})),z.forEach(h,((d,p)=>{const _=new En(p),v=Rg.lt(this.serializer,_),T=o.getIndexManager(_),R=xg.lt(_,this.serializer,T,o.referenceDelegate);return new CN(s,R,v,T).recalculateAndSaveOverlaysForDocumentKeys(new s0(t,di.oe),d).next()}))}))}}function vC(n){n.createObjectStore("targetDocuments",{keyPath:C3}).createIndex("documentTargetsIndex",R3,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",A3,{unique:!0}),n.createObjectStore("targetGlobal")}const Nv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class XE{constructor(e,t,i,s,o,c,h,d,p,_,v=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.ui=o,this.window=c,this.document=h,this.ci=p,this.li=_,this.hi=v,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=T=>Promise.resolve(),!XE.D())throw new ie(K.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new zB(this,s),this.Ai=t+"main",this.serializer=new yN(d),this.Ri=new Fr(this.Ai,this.hi,new eF(this.serializer)),this.$r=new xB,this.Ur=new LB(this.referenceDelegate,this.serializer),this.remoteDocumentCache=AN(this.serializer),this.Gr=new RB,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,_===!1&&Qt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ie(K.FAILED_PRECONDITION,Nv);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new di(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>hp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(ho(e))return re("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return re("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return qh(e).get("owner").next((t=>z.resolve(this.vi(t))))}Ci(e){return hp(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=un(t,"clientMetadata");return i.U().next((s=>{const o=this.xi(s,18e5),c=s.filter((h=>o.indexOf(h)===-1));return z.forEach(c,(h=>i.delete(h.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?z.resolve(!0):qh(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ie(K.FAILED_PRECONDITION,Nv);return!1}}return!(!this.networkEnabled||!this.inForeground)||hp(e).U().next((i=>this.xi(i,5e3).find((s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,c=!this.inForeground&&s.inForeground,h=this.networkEnabled===s.networkEnabled;if(o||c&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&re("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new s0(e,di.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((i=>this.Mi(i.updateTimeMs,t)&&!this.Ni(i.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>hp(e).U().next((t=>this.xi(t,18e5).map((i=>i.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return xg.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new VB(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Rg.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,i){re("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=(function(d){return d===17?B3:d===16?U3:d===15?ME:d===14?Cx:d===13?Ax:d===12?L3:d===11?Sx:void ve()})(this.hi);let c;return this.Ri.runTransaction(e,s,o,(h=>(c=new s0(h,this.Qr?this.Qr.next():di.oe),t==="readwrite-primary"?this.wi(c).next((d=>!!d||this.Si(c))).next((d=>{if(!d)throw Qt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new ie(K.FAILED_PRECONDITION,Ex);return i(c)})).next((d=>this.Di(c).next((()=>d)))):this.Ki(c).next((()=>i(c)))))).then((h=>(c.raiseOnCommittedEvent(),h)))}Ki(e){return qh(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ie(K.FAILED_PRECONDITION,Nv)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return qh(e).put("owner",t)}static D(){return Fr.D()}bi(e){const t=qh(e);return t.get("owner").next((i=>this.vi(i)?(re("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):z.resolve()))}Mi(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Qt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;XR()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const i=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return re("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Qt("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Qt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function qh(n){return un(n,"owner")}function hp(n){return un(n,"clientMetadata")}function JE(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=s}static Wi(e,t){let i=Ue(),s=Ue();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new ZE(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return XR()?8:Tx(Ot())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.Yi(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.Zi(e,t,s,i).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new tF;return this.Xi(e,t,c).next((h=>{if(o.result=h,this.zi)return this.es(e,t,c,h.size)}))})).next((()=>o.result))}es(e,t,i,s){return i.documentReadCount<this.ji?(Pc()<=Ge.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",Oc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),z.resolve()):(Pc()<=Ge.DEBUG&&re("QueryEngine","Query:",Oc(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.Hi*s?(Pc()<=Ge.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",Oc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ei(t))):z.resolve())}Yi(e,t){if(HA(t))return z.resolve(null);let i=ei(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=jp(t,null,"F"),i=ei(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const c=Ue(...o);return this.Ji.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((d=>{const p=this.ts(t,h);return this.ns(t,p,c,d.readTime)?this.Yi(e,jp(t,null,"F")):this.rs(e,p,t,d)}))))})))))}Zi(e,t,i,s){return HA(t)||s.isEqual(Ce.min())?z.resolve(null):this.Ji.getDocuments(e,i).next((o=>{const c=this.ts(t,o);return this.ns(t,c,i,s)?z.resolve(null):(Pc()<=Ge.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Oc(t)),this.rs(e,c,t,yx(s,-1)).next((h=>h)))}))}ts(e,t){let i=new gt(qx(e));return t.forEach(((s,o)=>{hf(e,o)&&(i=i.add(o))})),i}ns(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Xi(e,t,i){return Pc()<=Ge.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",Oc(t)),this.Ji.getDocumentsMatchingQuery(e,t,Pi.min(),i)}rs(e,t,i,s){return this.Ji.getDocumentsMatchingQuery(e,i,s).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,t,i,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Mt(Ve),this._s=new fo((o=>pl(o)),cf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function NN(n,e,t,i){return new nF(n,e,t,i)}async function DN(n,e){const t=ge(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((o=>(s=o,t.ls(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const c=[],h=[];let d=Ue();for(const p of s){c.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}for(const p of o){h.push(p.batchId);for(const _ of p.mutations)d=d.add(_.key)}return t.localDocuments.getDocuments(i,d).next((p=>({hs:p,removedBatchIds:c,addedBatchIds:h})))}))}))}function iF(n,e){const t=ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return(function(h,d,p,_){const v=p.batch,T=v.keys();let R=z.resolve();return T.forEach((P=>{R=R.next((()=>_.getEntry(d,P))).next((q=>{const Y=p.docVersions.get(P);be(Y!==null),q.version.compareTo(Y)<0&&(v.applyToRemoteDocument(q,p),q.isValidDocument()&&(q.setReadTime(p.commitVersion),_.addEntry(q)))}))})),R.next((()=>h.mutationQueue.removeMutationBatch(d,v)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let d=Ue();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(d=d.add(h.batch.mutations[p].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function kN(n){const e=ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function rF(n,e){const t=ge(n),i=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const h=[];e.targetChanges.forEach(((_,v)=>{const T=s.get(v);if(!T)return;h.push(t.Ur.removeMatchingKeys(o,_.removedDocuments,v).next((()=>t.Ur.addMatchingKeys(o,_.addedDocuments,v))));let R=T.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?R=R.withResumeToken(zt.EMPTY_BYTE_STRING,Ce.min()).withLastLimboFreeSnapshotVersion(Ce.min()):_.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(_.resumeToken,i)),s=s.insert(v,R),(function(q,Y,le){return q.resumeToken.approximateByteSize()===0||Y.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=3e8?!0:le.addedDocuments.size+le.modifiedDocuments.size+le.removedDocuments.size>0})(T,R,_)&&h.push(t.Ur.updateTargetData(o,R))}));let d=mi(),p=Ue();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,_))})),h.push(PN(o,c,e.documentUpdates).next((_=>{d=_.Ps,p=_.Is}))),!i.isEqual(Ce.min())){const _=t.Ur.getLastRemoteSnapshotVersion(o).next((v=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i)));h.push(_)}return z.waitFor(h).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,p))).next((()=>d))})).then((o=>(t.os=s,o)))}function PN(n,e,t){let i=Ue(),s=Ue();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let c=mi();return t.forEach(((h,d)=>{const p=o.get(h);d.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(h)),d.isNoDocument()&&d.version.isEqual(Ce.min())?(e.removeEntry(h,d.readTime),c=c.insert(h,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),c=c.insert(h,d)):re("LocalStore","Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",d.version)})),{Ps:c,Is:s}}))}function sF(n,e){const t=ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function ru(n,e){const t=ge(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Ur.getTargetData(i,e).next((o=>o?(s=o,z.resolve(s)):t.Ur.allocateTargetId(i).next((c=>(s=new Ss(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.os.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i}))}async function su(n,e,t){const i=ge(n),s=i.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(c=>i.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!ho(c))throw c;re("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}i.os=i.os.remove(e),i._s.delete(s.target)}function Hp(n,e,t){const i=ge(n);let s=Ce.min(),o=Ue();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(d,p,_){const v=ge(d),T=v._s.get(_);return T!==void 0?z.resolve(v.os.get(T)):v.Ur.getTargetData(p,_)})(i,c,ei(e)).next((h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(c,h.targetId).next((d=>{o=d}))})).next((()=>i.ss.getDocumentsMatchingQuery(c,e,t?s:Ce.min(),t?o:Ue()))).next((h=>(VN(i,zx(e),h),{documents:h,Ts:o})))))}function ON(n,e){const t=ge(n),i=ge(t.Ur),s=t.os.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(o=>i.ot(o,e).next((c=>c?c.target:null))))}function MN(n,e){const t=ge(n),i=t.us.get(e)||Ce.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.cs.getAllFromCollectionGroup(s,e,yx(i,-1),Number.MAX_SAFE_INTEGER))).then((s=>(VN(t,e,s),s)))}function VN(n,e,t){let i=n.us.get(e)||Ce.min();t.forEach(((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.us.set(e,i)}async function aF(n,e,t,i){const s=ge(n);let o=Ue(),c=mi();for(const p of t){const _=e.Es(p.metadata.name);p.document&&(o=o.add(_));const v=e.ds(p);v.setReadTime(e.As(p.metadata.readTime)),c=c.insert(_,v)}const h=s.cs.newChangeBuffer({trackRemovals:!0}),d=await ru(s,(function(_){return ei(Tu(Xe.fromString(`__bundle__/docs/${_}`)))})(i));return s.persistence.runTransaction("Apply bundle documents","readwrite",(p=>PN(p,h,c).next((_=>(h.apply(p),_))).next((_=>s.Ur.removeMatchingKeysForTargetId(p,d.targetId).next((()=>s.Ur.addMatchingKeys(p,o,d.targetId))).next((()=>s.localDocuments.getLocalViewOfDocuments(p,_.Ps,_.Is))).next((()=>_.Ps))))))}async function oF(n,e,t=Ue()){const i=await ru(n,ei(KE(e.bundledQuery))),s=ge(n);return s.persistence.runTransaction("Save named query","readwrite",(o=>{const c=Wt(e.readTime);if(i.snapshotVersion.compareTo(c)>=0)return s.Gr.saveNamedQuery(o,e);const h=i.withResumeToken(zt.EMPTY_BYTE_STRING,c);return s.os=s.os.insert(h.targetId,h),s.Ur.updateTargetData(o,h).next((()=>s.Ur.removeMatchingKeysForTargetId(o,i.targetId))).next((()=>s.Ur.addMatchingKeys(o,t,i.targetId))).next((()=>s.Gr.saveNamedQuery(o,e)))}))}function EC(n,e){return`firestore_clients_${n}_${e}`}function wC(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Dv(n,e){return`firestore_targets_${n}_${e}`}class $p{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Rs(e,t,i){const s=JSON.parse(i);let o,c=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(o=new ie(s.error.code,s.error.message))),c?new $p(e,t,s.state,o):(Qt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ud{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Rs(e,t){const i=JSON.parse(t);let s,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new ie(i.error.code,i.error.message))),o?new ud(e,i.state,s):(Qt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Kp{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,o=BE();for(let c=0;s&&c<i.activeTargetIds.length;++c)s=bx(i.activeTargetIds[c]),o=o.add(i.activeTargetIds[c]);return s?new Kp(e,o):(Qt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class ew{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new ew(t.clientId,t.onlineState):(Qt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class E0{constructor(){this.activeTargetIds=BE()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kv{constructor(e,t,i,s,o){this.window=e,this.ui=t,this.persistenceKey=i,this.ps=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Mt(Ve),this.started=!1,this.bs=[];const c=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=EC(this.persistenceKey,this.ps),this.vs=(function(d){return`firestore_sequence_number_${d}`})(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new E0),this.Cs=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.xs=(function(d){return`firestore_online_state_${d}`})(this.persistenceKey),this.Os=(function(d){return`firestore_bundle_loaded_v2_${d}`})(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const i of e){if(i===this.ps)continue;const s=this.getItem(EC(this.persistenceKey,i));if(s){const o=Kp.Rs(i,s);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const i=this.Ls(t);i&&this.Bs(i)}for(const i of this.bs)this.ws(i);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,i){this.qs(e,t,i),this.Qs(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Dv(this.persistenceKey,e));if(s){const o=ud.Rs(e,s);o&&(i=o.state)}}return t&&this.Ks.fs(e),this.Ns(),i}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Dv(this.persistenceKey,e))}updateQueryState(e,t,i){this.$s(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Qs(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return re("SharedClientState","READ",e,t),t}setItem(e,t){re("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){re("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(re("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Qt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const i=this.Gs(t.key);return this.zs(i,null)}{const i=this.js(t.key,t.newValue);if(i)return this.zs(i.clientId,i)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const i=this.Hs(t.key,t.newValue);if(i)return this.Js(i)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const i=this.Ys(t.key,t.newValue);if(i)return this.Zs(i)}}else if(t.key===this.xs){if(t.newValue!==null){const i=this.Ls(t.newValue);if(i)return this.Bs(i)}}else if(t.key===this.vs){const i=(function(o){let c=di.oe;if(o!=null)try{const h=JSON.parse(o);be(typeof h=="number"),c=h}catch(h){Qt("SharedClientState","Failed to read sequence number from WebStorage",h)}return c})(t.newValue);i!==di.oe&&this.sequenceNumberHandler(i)}else if(t.key===this.Os){const i=this.Xs(t.newValue);await Promise.all(i.map((s=>this.syncEngine.eo(s))))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,i){const s=new $p(this.currentUser,e,t,i),o=wC(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Vs())}Qs(e){const t=wC(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,i){const s=Dv(this.persistenceKey,e),o=new ud(e,t,i);this.setItem(s,o.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const i=this.Gs(e);return Kp.Rs(i,t)}Hs(e,t){const i=this.Fs.exec(e),s=Number(i[1]),o=i[2]!==void 0?i[2]:null;return $p.Rs(new En(o),s,t)}Ys(e,t){const i=this.Ms.exec(e),s=Number(i[1]);return ud.Rs(s,t)}Ls(e){return ew.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);re("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const i=t?this.Ss.insert(e,t):this.Ss.remove(e),s=this.ks(this.Ss),o=this.ks(i),c=[],h=[];return o.forEach((d=>{s.has(d)||c.push(d)})),s.forEach((d=>{o.has(d)||h.push(d)})),this.syncEngine.io(c,h).then((()=>{this.Ss=i}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=BE();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class LN{constructor(){this.so=new E0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new E0,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dp=null;function Pv(){return dp===null?dp=(function(){return 268435456+Math.round(2147483648*Math.random())})():dp++,"0x"+dp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uF{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn="WebChannelConnection";class hF extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${s}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Fo(){return!1}Mo(t,i,s,o,c){const h=Pv(),d=this.xo(t,i.toUriEncodedString());re("RestConnection",`Sending RPC '${t}' ${h}:`,d,s);const p={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(p,o,c),this.No(t,d,p,s).then((_=>(re("RestConnection",`Received RPC '${t}' ${h}: `,_),_)),(_=>{throw Gr("RestConnection",`RPC '${t}' ${h} failed with error: `,_,"url: ",d,"request:",s),_}))}Lo(t,i,s,o,c,h){return this.Mo(t,i,s,o,c)}Oo(t,i,s){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+wu})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,c)=>t[c]=o)),s&&s.headers.forEach(((o,c)=>t[c]=o))}xo(t,i){const s=cF[t];return`${this.Do}/v1/${i}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,s){const o=Pv();return new Promise(((c,h)=>{const d=new ux;d.setWithCredentials(!0),d.listenOnce(hx.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case vp.NO_ERROR:const _=d.getResponseJson();re(Bn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(_)),c(_);break;case vp.TIMEOUT:re(Bn,`RPC '${e}' ${o} timed out`),h(new ie(K.DEADLINE_EXCEEDED,"Request time out"));break;case vp.HTTP_ERROR:const v=d.getStatus();if(re(Bn,`RPC '${e}' ${o} failed with status:`,v,"response text:",d.getResponseText()),v>0){let T=d.getResponseJson();Array.isArray(T)&&(T=T[0]);const R=T==null?void 0:T.error;if(R&&R.status&&R.message){const P=(function(Y){const le=Y.toLowerCase().replace(/_/g,"-");return Object.values(K).indexOf(le)>=0?le:K.UNKNOWN})(R.status);h(new ie(P,R.message))}else h(new ie(K.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new ie(K.UNAVAILABLE,"Connection failed."));break;default:ve()}}finally{re(Bn,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(s);re(Bn,`RPC '${e}' ${o} sending request:`,s),d.send(t,"POST",p,i,15)}))}Bo(e,t,i){const s=Pv(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=mx(),h=fx(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const _=o.join("");re(Bn,`Creating RPC '${e}' stream ${s}: ${_}`,d);const v=c.createWebChannel(_,d);let T=!1,R=!1;const P=new uF({Io:Y=>{R?re(Bn,`Not sending because RPC '${e}' stream ${s} is closed:`,Y):(T||(re(Bn,`Opening RPC '${e}' stream ${s} transport.`),v.open(),T=!0),re(Bn,`RPC '${e}' stream ${s} sending:`,Y),v.send(Y))},To:()=>v.close()}),q=(Y,le,Ee)=>{Y.listen(le,(oe=>{try{Ee(oe)}catch(de){setTimeout((()=>{throw de}),0)}}))};return q(v,Xh.EventType.OPEN,(()=>{R||(re(Bn,`RPC '${e}' stream ${s} transport opened.`),P.yo())})),q(v,Xh.EventType.CLOSE,(()=>{R||(R=!0,re(Bn,`RPC '${e}' stream ${s} transport closed`),P.So())})),q(v,Xh.EventType.ERROR,(Y=>{R||(R=!0,Gr(Bn,`RPC '${e}' stream ${s} transport errored:`,Y),P.So(new ie(K.UNAVAILABLE,"The operation could not be completed")))})),q(v,Xh.EventType.MESSAGE,(Y=>{var le;if(!R){const Ee=Y.data[0];be(!!Ee);const oe=Ee,de=oe.error||((le=oe[0])===null||le===void 0?void 0:le.error);if(de){re(Bn,`RPC '${e}' stream ${s} received error:`,de);const Pe=de.status;let Re=(function(N){const V=nn[N];if(V!==void 0)return nN(V)})(Pe),k=de.message;Re===void 0&&(Re=K.INTERNAL,k="Unknown error status: "+Pe+" with message "+de.message),R=!0,P.So(new ie(Re,k)),v.close()}else re(Bn,`RPC '${e}' stream ${s} received:`,Ee),P.bo(Ee)}})),q(h,dx.STAT_EVENT,(Y=>{Y.stat===i0.PROXY?re(Bn,`RPC '${e}' stream ${s} detected buffering proxy`):Y.stat===i0.NOPROXY&&re(Bn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.wo()}),0),P}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(){return typeof window<"u"?window:null}function Ap(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pf(n){return new _B(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t,i=1e3,s=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=s,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-i);s>0&&re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e,t,i,s,o,c,h,d){this.ui=e,this.Ho=i,this.Jo=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new tw(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===K.RESOURCE_EXHAUSTED?(Qt(t.toString()),Qt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===K.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.Yo===t&&this.P_(i,s)}),(i=>{e((()=>{const s=new ie(K.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(s)}))}))}P_(e,t){const i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{i((()=>this.listener.Eo()))})),this.stream.Ro((()=>{i((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((s=>{i((()=>this.I_(s)))})),this.stream.onMessage((s=>{i((()=>++this.e_==1?this.E_(s):this.onNext(s)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dF extends BN{constructor(e,t,i,s,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,c),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=EB(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Ce.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Ce.min():c.readTime?Wt(c.readTime):Ce.min()})(e);return this.listener.d_(t,i)}A_(e){const t={};t.database=p0(this.serializer),t.addTarget=(function(o,c){let h;const d=c.target;if(h=Bp(d)?{documents:dN(o,d)}:{query:fN(o,d)._t},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=aN(o,c.resumeToken);const p=f0(o,c.expectedCount);p!==null&&(h.expectedCount=p)}else if(c.snapshotVersion.compareTo(Ce.min())>0){h.readTime=iu(o,c.snapshotVersion.toTimestamp());const p=f0(o,c.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const i=TB(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){const t={};t.database=p0(this.serializer),t.removeTarget=e,this.a_(t)}}class fF extends BN{constructor(e,t,i,s,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return be(!!e.streamToken),this.lastStreamToken=e.streamToken,be(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=wB(e.writeResults,e.commitTime),i=Wt(e.commitTime);return this.listener.g_(i,t)}p_(){const e={};e.database=p0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Vd(this.serializer,i)))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF extends class{}{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ie(K.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Mo(e,m0(t,i),s,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ie(K.UNKNOWN,o.toString())}))}Lo(e,t,i,s,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Lo(e,m0(t,i),s,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===K.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ie(K.UNKNOWN,c.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class pF{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Qt(t),this.D_=!1):re("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o((c=>{i.enqueueAndForget((async()=>{mo(this)&&(re("RemoteStore","Restarting streams for network reachability change."),await(async function(d){const p=ge(d);p.L_.add(4),await Su(p),p.q_.set("Unknown"),p.L_.delete(4),await gf(p)})(this))}))})),this.q_=new pF(i,s)}}async function gf(n){if(mo(n))for(const e of n.B_)await e(!0)}async function Su(n){for(const e of n.B_)await e(!1)}function Dg(n,e){const t=ge(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),rw(t)?iw(t):Cu(t).r_()&&nw(t,e))}function au(n,e){const t=ge(n),i=Cu(t);t.N_.delete(e),i.r_()&&FN(t,e),t.N_.size===0&&(i.r_()?i.o_():mo(t)&&t.q_.set("Unknown"))}function nw(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ce.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Cu(n).A_(e)}function FN(n,e){n.Q_.xe(e),Cu(n).R_(e)}function iw(n){n.Q_=new fB({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Cu(n).start(),n.q_.v_()}function rw(n){return mo(n)&&!Cu(n).n_()&&n.N_.size>0}function mo(n){return ge(n).L_.size===0}function jN(n){n.Q_=void 0}async function _F(n){n.q_.set("Online")}async function yF(n){n.N_.forEach(((e,t)=>{nw(n,e)}))}async function vF(n,e){jN(n),rw(n)?(n.q_.M_(e),iw(n)):n.q_.set("Unknown")}async function EF(n,e,t){if(n.q_.set("Online"),e instanceof sN&&e.state===2&&e.cause)try{await(async function(s,o){const c=o.cause;for(const h of o.targetIds)s.N_.has(h)&&(await s.remoteSyncer.rejectListen(h,c),s.N_.delete(h),s.Q_.removeTarget(h))})(n,e)}catch(i){re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qp(n,i)}else if(e instanceof Sp?n.Q_.Ke(e):e instanceof rN?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ce.min()))try{const i=await kN(n.localStore);t.compareTo(i)>=0&&await(function(o,c){const h=o.Q_.rt(c);return h.targetChanges.forEach(((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const _=o.N_.get(p);_&&o.N_.set(p,_.withResumeToken(d.resumeToken,c))}})),h.targetMismatches.forEach(((d,p)=>{const _=o.N_.get(d);if(!_)return;o.N_.set(d,_.withResumeToken(zt.EMPTY_BYTE_STRING,_.snapshotVersion)),FN(o,d);const v=new Ss(_.target,d,p,_.sequenceNumber);nw(o,v)})),o.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(i){re("RemoteStore","Failed to raise snapshot:",i),await Qp(n,i)}}async function Qp(n,e,t){if(!ho(e))throw e;n.L_.add(1),await Su(n),n.q_.set("Offline"),t||(t=()=>kN(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{re("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await gf(n)}))}function zN(n,e){return e().catch((t=>Qp(n,t,e)))}async function Au(n){const e=ge(n),t=to(e);let i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;wF(e);)try{const s=await sF(e.localStore,i);if(s===null){e.O_.length===0&&t.o_();break}i=s.batchId,TF(e,s)}catch(s){await Qp(e,s)}qN(e)&&GN(e)}function wF(n){return mo(n)&&n.O_.length<10}function TF(n,e){n.O_.push(e);const t=to(n);t.r_()&&t.V_&&t.m_(e.mutations)}function qN(n){return mo(n)&&!to(n).n_()&&n.O_.length>0}function GN(n){to(n).start()}async function bF(n){to(n).p_()}async function IF(n){const e=to(n);for(const t of n.O_)e.m_(t.mutations)}async function SF(n,e,t){const i=n.O_.shift(),s=qE.from(i,e,t);await zN(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Au(n)}async function AF(n,e){e&&to(n).V_&&await(async function(i,s){if((function(c){return tN(c)&&c!==K.ABORTED})(s.code)){const o=i.O_.shift();to(i).s_(),await zN(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s))),await Au(i)}})(n,e),qN(n)&&GN(n)}async function bC(n,e){const t=ge(n);t.asyncQueue.verifyOperationInProgress(),re("RemoteStore","RemoteStore received new credentials");const i=mo(t);t.L_.add(3),await Su(t),i&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await gf(t)}async function w0(n,e){const t=ge(n);e?(t.L_.delete(2),await gf(t)):e||(t.L_.add(2),await Su(t),t.q_.set("Unknown"))}function Cu(n){return n.K_||(n.K_=(function(t,i,s){const o=ge(t);return o.w_(),new dF(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Eo:_F.bind(null,n),Ro:yF.bind(null,n),mo:vF.bind(null,n),d_:EF.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),rw(n)?iw(n):n.q_.set("Unknown")):(await n.K_.stop(),jN(n))}))),n.K_}function to(n){return n.U_||(n.U_=(function(t,i,s){const o=ge(t);return o.w_(),new fF(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:bF.bind(null,n),mo:AF.bind(null,n),f_:IF.bind(null,n),g_:SF.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await Au(n)):(await n.U_.stop(),n.O_.length>0&&(re("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new On,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const c=Date.now()+i,h=new sw(e,t,c,s,o);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ie(K.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ru(n,e){if(Qt("AsyncQueue",`${e}: ${n}`),ho(n))return new ie(K.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e){this.comparator=e?(t,i)=>e(t,i)||pe.comparator(t.key,i.key):(t,i)=>pe.comparator(t.key,i.key),this.keyedMap=Jh(),this.sortedSet=new Mt(this.comparator)}static emptySet(e){return new Hc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Hc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Hc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(){this.W_=new Mt(pe.comparator)}track(e){const t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ve():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ou{constructor(e,t,i,s,o,c,h,d,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,s,o){const c=[];return t.forEach((h=>{c.push({type:0,doc:h})})),new ou(e,t,Hc.emptySet(t),c,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class RF{constructor(){this.queries=SC(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){const s=ge(t),o=s.queries;s.queries=SC(),o.forEach(((c,h)=>{for(const d of h.j_)d.onError(i)}))})(this,new ie(K.ABORTED,"Firestore shutting down"))}}function SC(){return new fo((n=>jx(n)),uf)}async function aw(n,e){const t=ge(n);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.H_()&&e.J_()&&(i=2):(o=new CF,i=e.J_()?0:1);try{switch(i){case 0:o.z_=await t.onListen(s,!0);break;case 1:o.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(c){const h=Ru(c,`Initialization of query '${Oc(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&lw(t)}async function ow(n,e){const t=ge(n),i=e.query;let s=3;const o=t.queries.get(i);if(o){const c=o.j_.indexOf(e);c>=0&&(o.j_.splice(c,1),o.j_.length===0?s=e.J_()?0:1:!o.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function xF(n,e){const t=ge(n);let i=!1;for(const s of e){const o=s.query,c=t.queries.get(o);if(c){for(const h of c.j_)h.X_(s)&&(i=!0);c.z_=s}}i&&lw(t)}function NF(n,e,t){const i=ge(n),s=i.queries.get(e);if(s)for(const o of s.j_)o.onError(t);i.queries.delete(e)}function lw(n){n.Y_.forEach((e=>{e.next()}))}var T0,AC;(AC=T0||(T0={})).ea="default",AC.Cache="cache";class cw{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new ou(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ou.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==T0.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.serializer=e}Es(e){return jr(this.serializer,e)}ds(e){return e.metadata.exists?hN(this.serializer,e.document,!1):St.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Wt(e)}}class kF{constructor(e,t,i){this.ca=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=HN(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const i=Xe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,i=new CC(this.serializer);for(const s of e)if(s.metadata.queries){const o=i.Es(s.metadata.name);for(const c of s.metadata.queries){const h=(t.get(c)||Ue()).add(o);t.set(c,h)}}return t}async complete(){const e=await aF(this.localStore,new CC(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const i of this.queries)await oF(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function HN(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $N{constructor(e){this.key=e}}class KN{constructor(e){this.key=e}}class QN{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ue(),this.mutatedKeys=Ue(),this.Aa=qx(e),this.Ra=new Hc(this.Aa)}get Va(){return this.Ta}ma(e,t){const i=t?t.fa:new IC,s=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,c=s,h=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((_,v)=>{const T=s.get(_),R=hf(this.query,v)?v:null,P=!!T&&this.mutatedKeys.has(T.key),q=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let Y=!1;T&&R?T.data.isEqual(R.data)?P!==q&&(i.track({type:3,doc:R}),Y=!0):this.ga(T,R)||(i.track({type:2,doc:R}),Y=!0,(d&&this.Aa(R,d)>0||p&&this.Aa(R,p)<0)&&(h=!0)):!T&&R?(i.track({type:0,doc:R}),Y=!0):T&&!R&&(i.track({type:1,doc:T}),Y=!0,(d||p)&&(h=!0)),Y&&(R?(c=c.add(R),o=q?o.add(_):o.delete(_)):(c=c.delete(_),o=o.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),o=o.delete(_.key),i.track({type:1,doc:_})}return{Ra:c,fa:i,ns:h,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const c=e.fa.G_();c.sort(((_,v)=>(function(R,P){const q=Y=>{switch(Y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve()}};return q(R)-q(P)})(_.type,v.type)||this.Aa(_.doc,v.doc))),this.pa(i),s=s!=null&&s;const h=t&&!s?this.ya():[],d=this.da.size===0&&this.current&&!s?1:0,p=d!==this.Ea;return this.Ea=d,c.length!==0||p?{snapshot:new ou(this.query,e.Ra,o,c,e.mutatedKeys,d===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new IC,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ue(),this.Ra.forEach((i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))}));const t=[];return e.forEach((i=>{this.da.has(i)||t.push(new KN(i))})),this.da.forEach((i=>{e.has(i)||t.push(new $N(i))})),t}ba(e){this.Ta=e.Ts,this.da=Ue();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ou.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class PF{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class OF{constructor(e){this.key=e,this.va=!1}}class MF{constructor(e,t,i,s,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new fo((h=>jx(h)),uf),this.Ma=new Map,this.xa=new Set,this.Oa=new Mt(pe.comparator),this.Na=new Map,this.La=new YE,this.Ba={},this.ka=new Map,this.qa=El.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function VF(n,e,t=!0){const i=kg(n);let s;const o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.Da()):s=await WN(i,e,t,!0),s}async function LF(n,e){const t=kg(n);await WN(t,e,!0,!1)}async function WN(n,e,t,i){const s=await ru(n.localStore,ei(e)),o=s.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await uw(n,e,o,c==="current",s.resumeToken)),n.isPrimaryClient&&t&&Dg(n.remoteStore,s),h}async function uw(n,e,t,i,s){n.Ka=(v,T,R)=>(async function(q,Y,le,Ee){let oe=Y.view.ma(le);oe.ns&&(oe=await Hp(q.localStore,Y.query,!1).then((({documents:k})=>Y.view.ma(k,oe))));const de=Ee&&Ee.targetChanges.get(Y.targetId),Pe=Ee&&Ee.targetMismatches.get(Y.targetId)!=null,Re=Y.view.applyChanges(oe,q.isPrimaryClient,de,Pe);return b0(q,Y.targetId,Re.wa),Re.snapshot})(n,v,T,R);const o=await Hp(n.localStore,e,!0),c=new QN(e,o.Ts),h=c.ma(o.documents),d=mf.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),p=c.applyChanges(h,n.isPrimaryClient,d);b0(n,t,p.wa);const _=new PF(e,t,c);return n.Fa.set(e,_),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),p.snapshot}async function UF(n,e,t){const i=ge(n),s=i.Fa.get(e),o=i.Ma.get(s.targetId);if(o.length>1)return i.Ma.set(s.targetId,o.filter((c=>!uf(c,e)))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await su(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&au(i.remoteStore,s.targetId),lu(i,s.targetId)})).catch(uo)):(lu(i,s.targetId),await su(i.localStore,s.targetId,!0))}async function BF(n,e){const t=ge(n),i=t.Fa.get(e),s=t.Ma.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),au(t.remoteStore,i.targetId))}async function FF(n,e,t){const i=mw(n);try{const s=await(function(c,h){const d=ge(c),p=Dt.now(),_=h.reduce(((R,P)=>R.add(P.key)),Ue());let v,T;return d.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let P=mi(),q=Ue();return d.cs.getEntries(R,_).next((Y=>{P=Y,P.forEach(((le,Ee)=>{Ee.isValidDocument()||(q=q.add(le))}))})).next((()=>d.localDocuments.getOverlayedDocuments(R,P))).next((Y=>{v=Y;const le=[];for(const Ee of h){const oe=uB(Ee,v.get(Ee.key).overlayedDocument);oe!=null&&le.push(new Fs(Ee.key,oe,kx(oe.value.mapValue),xt.exists(!0)))}return d.mutationQueue.addMutationBatch(R,p,le,h)})).next((Y=>{T=Y;const le=Y.applyToLocalDocumentSet(v,q);return d.documentOverlayCache.saveOverlays(R,Y.batchId,le)}))})).then((()=>({batchId:T.batchId,changes:Hx(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(c,h,d){let p=c.Ba[c.currentUser.toKey()];p||(p=new Mt(Ve)),p=p.insert(h,d),c.Ba[c.currentUser.toKey()]=p})(i,s.batchId,t),await js(i,s.changes),await Au(i.remoteStore)}catch(s){const o=Ru(s,"Failed to persist write");t.reject(o)}}async function YN(n,e){const t=ge(n);try{const i=await rF(t.localStore,e);e.targetChanges.forEach(((s,o)=>{const c=t.Na.get(o);c&&(be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?c.va=!0:s.modifiedDocuments.size>0?be(c.va):s.removedDocuments.size>0&&(be(c.va),c.va=!1))})),await js(t,i,e)}catch(i){await uo(i)}}function RC(n,e,t){const i=ge(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Fa.forEach(((o,c)=>{const h=c.view.Z_(e);h.snapshot&&s.push(h.snapshot)})),(function(c,h){const d=ge(c);d.onlineState=h;let p=!1;d.queries.forEach(((_,v)=>{for(const T of v.j_)T.Z_(h)&&(p=!0)})),p&&lw(d)})(i.eventManager,e),s.length&&i.Ca.d_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function jF(n,e,t){const i=ge(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Na.get(e),o=s&&s.key;if(o){let c=new Mt(pe.comparator);c=c.insert(o,St.newNoDocument(o,Ce.min()));const h=Ue().add(o),d=new ff(Ce.min(),new Map,new Mt(Ve),c,h);await YN(i,d),i.Oa=i.Oa.remove(o),i.Na.delete(e),fw(i)}else await su(i.localStore,e,!1).then((()=>lu(i,e,t))).catch(uo)}async function zF(n,e){const t=ge(n),i=e.batch.batchId;try{const s=await iF(t.localStore,e);dw(t,i,null),hw(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await js(t,s)}catch(s){await uo(s)}}async function qF(n,e,t){const i=ge(n);try{const s=await(function(c,h){const d=ge(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return d.mutationQueue.lookupMutationBatch(p,h).next((v=>(be(v!==null),_=v.keys(),d.mutationQueue.removeMutationBatch(p,v)))).next((()=>d.mutationQueue.performConsistencyCheck(p))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(p,_,h))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>d.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);dw(i,e,t),hw(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await js(i,s)}catch(s){await uo(s)}}async function GF(n,e){const t=ge(n);mo(t.remoteStore)||re("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await(function(c){const h=ge(c);return h.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(d=>h.mutationQueue.getHighestUnacknowledgedBatchId(d)))})(t.localStore);if(i===-1)return void e.resolve();const s=t.ka.get(i)||[];s.push(e),t.ka.set(i,s)}catch(i){const s=Ru(i,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function hw(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function dw(n,e,t){const i=ge(n);let s=i.Ba[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Ba[i.currentUser.toKey()]=s}}function lu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((i=>{n.La.containsKey(i)||XN(n,i)}))}function XN(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(au(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),fw(n))}function b0(n,e,t){for(const i of t)i instanceof $N?(n.La.addReference(i.key,e),HF(n,i)):i instanceof KN?(re("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||XN(n,i.key)):ve()}function HF(n,e){const t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(re("SyncEngine","New document in limbo: "+t),n.xa.add(i),fw(n))}function fw(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new pe(Xe.fromString(e)),i=n.qa.next();n.Na.set(i,new OF(t)),n.Oa=n.Oa.insert(t,i),Dg(n.remoteStore,new Ss(ei(Tu(t.path)),i,"TargetPurposeLimboResolution",di.oe))}}async function js(n,e,t){const i=ge(n),s=[],o=[],c=[];i.Fa.isEmpty()||(i.Fa.forEach(((h,d)=>{c.push(i.Ka(d,e,t).then((p=>{var _;if((p||t)&&i.isPrimaryClient){const v=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(d.targetId))===null||_===void 0?void 0:_.current;i.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(p){s.push(p);const v=ZE.Wi(d.targetId,p);o.push(v)}})))})),await Promise.all(c),i.Ca.d_(s),await(async function(d,p){const _=ge(d);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>z.forEach(p,(T=>z.forEach(T.$i,(R=>_.persistence.referenceDelegate.addReference(v,T.targetId,R))).next((()=>z.forEach(T.Ui,(R=>_.persistence.referenceDelegate.removeReference(v,T.targetId,R)))))))))}catch(v){if(!ho(v))throw v;re("LocalStore","Failed to update sequence numbers: "+v)}for(const v of p){const T=v.targetId;if(!v.fromCache){const R=_.os.get(T),P=R.snapshotVersion,q=R.withLastLimboFreeSnapshotVersion(P);_.os=_.os.insert(T,q)}}})(i.localStore,o))}async function $F(n,e){const t=ge(n);if(!t.currentUser.isEqual(e)){re("SyncEngine","User change. New user:",e.toKey());const i=await DN(t.localStore,e);t.currentUser=e,(function(o,c){o.ka.forEach((h=>{h.forEach((d=>{d.reject(new ie(K.CANCELLED,c))}))})),o.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await js(t,i.hs)}}function KF(n,e){const t=ge(n),i=t.Na.get(e);if(i&&i.va)return Ue().add(i.key);{let s=Ue();const o=t.Ma.get(e);if(!o)return s;for(const c of o){const h=t.Fa.get(c);s=s.unionWith(h.view.Va)}return s}}async function QF(n,e){const t=ge(n),i=await Hp(t.localStore,e.query,!0),s=e.view.ba(i);return t.isPrimaryClient&&b0(t,e.targetId,s.wa),s}async function WF(n,e){const t=ge(n);return MN(t.localStore,e).then((i=>js(t,i)))}async function YF(n,e,t,i){const s=ge(n),o=await(function(h,d){const p=ge(h),_=ge(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(v=>_.Mn(v,d).next((T=>T?p.localDocuments.getDocuments(v,T):z.resolve(null)))))})(s.localStore,e);o!==null?(t==="pending"?await Au(s.remoteStore):t==="acknowledged"||t==="rejected"?(dw(s,e,i||null),hw(s,e),(function(h,d){ge(ge(h).mutationQueue).On(d)})(s.localStore,e)):ve(),await js(s,o)):re("SyncEngine","Cannot apply mutation batch with id: "+e)}async function XF(n,e){const t=ge(n);if(kg(t),mw(t),e===!0&&t.Qa!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await xC(t,i.toArray());t.Qa=!0,await w0(t.remoteStore,!0);for(const o of s)Dg(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){const i=[];let s=Promise.resolve();t.Ma.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?i.push(c):s=s.then((()=>(lu(t,c),su(t.localStore,c,!0)))),au(t.remoteStore,c)})),await s,await xC(t,i),(function(c){const h=ge(c);h.Na.forEach(((d,p)=>{au(h.remoteStore,p)})),h.La.pr(),h.Na=new Map,h.Oa=new Mt(pe.comparator)})(t),t.Qa=!1,await w0(t.remoteStore,!1)}}async function xC(n,e,t){const i=ge(n),s=[],o=[];for(const c of e){let h;const d=i.Ma.get(c);if(d&&d.length!==0){h=await ru(i.localStore,ei(d[0]));for(const p of d){const _=i.Fa.get(p),v=await QF(i,_);v.snapshot&&o.push(v.snapshot)}}else{const p=await ON(i.localStore,c);h=await ru(i.localStore,p),await uw(i,JN(p),c,!1,h.resumeToken)}s.push(h)}return i.Ca.d_(o),s}function JN(n){return Fx(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function JF(n){return(function(t){return ge(ge(t).persistence).Qi()})(ge(n).localStore)}async function ZF(n,e,t,i){const s=ge(n);if(s.Qa)return void re("SyncEngine","Ignoring unexpected query state notification.");const o=s.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await MN(s.localStore,zx(o[0])),h=ff.createSynthesizedRemoteEventForCurrentChange(e,t==="current",zt.EMPTY_BYTE_STRING);await js(s,c,h);break}case"rejected":await su(s.localStore,e,!0),lu(s,e,i);break;default:ve()}}async function ej(n,e,t){const i=kg(n);if(i.Qa){for(const s of e){if(i.Ma.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){re("SyncEngine","Adding an already active target "+s);continue}const o=await ON(i.localStore,s),c=await ru(i.localStore,o);await uw(i,JN(o),c.targetId,!1,c.resumeToken),Dg(i.remoteStore,c)}for(const s of t)i.Ma.has(s)&&await su(i.localStore,s,!1).then((()=>{au(i.remoteStore,s),lu(i,s)})).catch(uo)}}function kg(n){const e=ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=YN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jF.bind(null,e),e.Ca.d_=xF.bind(null,e.eventManager),e.Ca.$a=NF.bind(null,e.eventManager),e}function mw(n){const e=ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qF.bind(null,e),e}function tj(n,e,t){const i=ge(n);(async function(o,c,h){try{const d=await c.getMetadata();if(await(function(R,P){const q=ge(R),Y=Wt(P.createTime);return q.persistence.runTransaction("hasNewerBundle","readonly",(le=>q.Gr.getBundleMetadata(le,P.id))).then((le=>!!le&&le.createTime.compareTo(Y)>=0))})(o.localStore,d))return await c.close(),h._completeWith((function(R){return{taskState:"Success",documentsLoaded:R.totalDocuments,bytesLoaded:R.totalBytes,totalDocuments:R.totalDocuments,totalBytes:R.totalBytes}})(d)),Promise.resolve(new Set);h._updateProgress(HN(d));const p=new kF(d,o.localStore,c.serializer);let _=await c.Ua();for(;_;){const T=await p.la(_);T&&h._updateProgress(T),_=await c.Ua()}const v=await p.complete();return await js(o,v.Ia,void 0),await(function(R,P){const q=ge(R);return q.persistence.runTransaction("Save bundle","readwrite",(Y=>q.Gr.saveBundleMetadata(Y,P)))})(o.localStore,d),h._completeWith(v.progress),Promise.resolve(v.Pa)}catch(d){return Gr("SyncEngine",`Loading bundle failed with ${d}`),h._failWith(d),Promise.resolve(new Set)}})(i,e,t).then((s=>{i.sharedClientState.notifyBundleLoaded(s)}))}class Ld{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return NN(this.persistence,new xN,e.initialUser,this.serializer)}Ga(e){return new RN(Ng.Zr,this.serializer)}Wa(e){return new LN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ld.provider={build:()=>new Ld};class ZN extends Ld{constructor(e,t,i){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await mw(this.Ja.syncEngine),await Au(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return NN(this.persistence,new xN,e.initialUser,this.serializer)}ja(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new BB(i,e.asyncQueue,t)}Ha(e,t){const i=new E3(t,this.persistence);return new v3(e.asyncQueue,i)}Ga(e){const t=JE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ui.withCacheSize(this.cacheSizeBytes):ui.DEFAULT;return new XE(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,UN(),Ap(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new LN}}class nj extends ZN{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof kv&&(this.sharedClientState.syncEngine={no:YF.bind(null,t),ro:ZF.bind(null,t),io:ej.bind(null,t),Qi:JF.bind(null,t),eo:WF.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async i=>{await XF(this.Ja.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=UN();if(!kv.D(t))throw new ie(K.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=JE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new kv(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Ud{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>RC(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=$F.bind(null,this.syncEngine),await w0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RF})()}createDatastore(e){const t=pf(e.databaseInfo.databaseId),i=(function(o){return new hF(o)})(e.databaseInfo);return(function(o,c,h,d){return new mF(o,c,h,d)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,o,c,h){return new gF(i,s,o,c,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>RC(this.syncEngine,t,0)),(function(){return TC.D()?new TC:new lF})())}createSyncEngine(e,t){return(function(s,o,c,h,d,p,_){const v=new MF(s,o,c,h,d,p);return _&&(v.Qa=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const o=ge(s);re("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await Su(o),o.k_.shutdown(),o.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ud.provider={build:()=>new Ud};function NC(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Qt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new On,this.buffer=new Uint8Array,this.eu=(function(){return new TextDecoder("utf-8")})(),this.tu().then((i=>{i&&i.ua()?this.metadata.resolve(i.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.aa)}`))}),(i=>this.metadata.reject(i)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),i=Number(t);isNaN(i)&&this.ru(`length string (${t}) is not valid number`);const s=await this.iu(i);return new DF(JSON.parse(s),e.length+i)}su(){return this.buffer.findIndex((e=>e===123))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ie(K.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(s,o){const c=ge(s),h={documents:o.map((v=>Md(c.serializer,v)))},d=await c.Lo("BatchGetDocuments",c.serializer.databaseId,Xe.emptyPath(),h,o.length),p=new Map;d.forEach((v=>{const T=vB(c.serializer,v);p.set(T.key.toString(),T)}));const _=[];return o.forEach((v=>{const T=p.get(v.toString());be(!!T),_.push(T)})),_})(this.datastore,e);return t.forEach((i=>this.recordVersion(i))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Iu(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,i)=>{const s=pe.fromPath(i);this.mutations.push(new jE(s,this.precondition(s)))})),await(async function(i,s){const o=ge(i),c={writes:s.map((h=>Vd(o.serializer,h)))};await o.Mo("Commit",o.serializer.databaseId,Xe.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ve();t=Ce.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new ie(K.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ce.min())?xt.exists(!1):xt.updateTime(t):xt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ce.min()))throw new ie(K.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return xt.updateTime(t)}return xt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e,t,i,s,o){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=s,this.deferred=o,this._u=i.maxAttempts,this.t_=new tw(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new rj(this.datastore),t=this.cu(e);t&&t.then((i=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(i)})).catch((s=>{this.lu(s)}))))})).catch((i=>{this.lu(i)}))}))}cu(e){try{const t=this.updateFunction(e);return!lf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!tN(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=En.UNAUTHENTICATED,this.clientId=gx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async c=>{re("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(re("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new On;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ru(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Ov(n,e){n.asyncQueue.verifyOperationInProgress(),re("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await DN(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function DC(n,e){n.asyncQueue.verifyOperationInProgress();const t=await pw(n);re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>bC(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>bC(e.remoteStore,s))),n._onlineComponents=e}async function pw(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){re("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ov(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===K.FAILED_PRECONDITION||s.code===K.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Gr("Error using user provided cache. Falling back to memory cache: "+t),await Ov(n,new Ld)}}else re("FirestoreClient","Using default OfflineComponentProvider"),await Ov(n,new Ld);return n._offlineComponents}async function Og(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(re("FirestoreClient","Using user provided OnlineComponentProvider"),await DC(n,n._uninitializedComponentsProvider._online)):(re("FirestoreClient","Using default OnlineComponentProvider"),await DC(n,new Ud))),n._onlineComponents}function eD(n){return pw(n).then((e=>e.persistence))}function gw(n){return pw(n).then((e=>e.localStore))}function tD(n){return Og(n).then((e=>e.remoteStore))}function _w(n){return Og(n).then((e=>e.syncEngine))}function oj(n){return Og(n).then((e=>e.datastore))}async function cu(n){const e=await Og(n),t=e.eventManager;return t.onListen=VF.bind(null,e.syncEngine),t.onUnlisten=UF.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LF.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=BF.bind(null,e.syncEngine),t}function lj(n){return n.asyncQueue.enqueue((async()=>{const e=await eD(n),t=await tD(n);return e.setNetworkEnabled(!0),(function(s){const o=ge(s);return o.L_.delete(0),gf(o)})(t)}))}function cj(n){return n.asyncQueue.enqueue((async()=>{const e=await eD(n),t=await tD(n);return e.setNetworkEnabled(!1),(async function(s){const o=ge(s);o.L_.add(0),await Su(o),o.q_.set("Offline")})(t)}))}function uj(n,e){const t=new On;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,o,c){try{const h=await(function(p,_){const v=ge(p);return v.persistence.runTransaction("read document","readonly",(T=>v.localDocuments.getDocument(T,_)))})(s,o);h.isFoundDocument()?c.resolve(h):h.isNoDocument()?c.resolve(null):c.reject(new ie(K.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const d=Ru(h,`Failed to get document '${o} from cache`);c.reject(d)}})(await gw(n),e,t))),t.promise}function nD(n,e,t={}){const i=new On;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,p){const _=new Pg({next:T=>{_.Za(),c.enqueueAndForget((()=>ow(o,v)));const R=T.docs.has(h);!R&&T.fromCache?p.reject(new ie(K.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&T.fromCache&&d&&d.source==="server"?p.reject(new ie(K.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new cw(Tu(h.path),_,{includeMetadataChanges:!0,_a:!0});return aw(o,v)})(await cu(n),n.asyncQueue,e,t,i))),i.promise}function hj(n,e){const t=new On;return n.asyncQueue.enqueueAndForget((async()=>(async function(s,o,c){try{const h=await Hp(s,o,!0),d=new QN(o,h.Ts),p=d.ma(h.documents),_=d.applyChanges(p,!1);c.resolve(_.snapshot)}catch(h){const d=Ru(h,`Failed to execute query '${o} against cache`);c.reject(d)}})(await gw(n),e,t))),t.promise}function iD(n,e,t={}){const i=new On;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,p){const _=new Pg({next:T=>{_.Za(),c.enqueueAndForget((()=>ow(o,v))),T.fromCache&&d.source==="server"?p.reject(new ie(K.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),v=new cw(h,_,{includeMetadataChanges:!0,_a:!0});return aw(o,v)})(await cu(n),n.asyncQueue,e,t,i))),i.promise}function dj(n,e){const t=new Pg(e);return n.asyncQueue.enqueueAndForget((async()=>(function(s,o){ge(s).Y_.add(o),o.next()})(await cu(n),t))),()=>{t.Za(),n.asyncQueue.enqueueAndForget((async()=>(function(s,o){ge(s).Y_.delete(o)})(await cu(n),t)))}}function fj(n,e,t,i){const s=(function(c,h){let d;return d=typeof c=="string"?iN().encode(c):c,(function(_,v){return new ij(_,v)})((function(_,v){if(_ instanceof Uint8Array)return NC(_,v);if(_ instanceof ArrayBuffer)return NC(new Uint8Array(_),v);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(d),h)})(t,pf(e));n.asyncQueue.enqueueAndForget((async()=>{tj(await _w(n),s,i)}))}function mj(n,e){return n.asyncQueue.enqueue((async()=>(function(i,s){const o=ge(i);return o.persistence.runTransaction("Get named query","readonly",(c=>o.Gr.getNamedQuery(c,s)))})(await gw(n),e)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(n,e,t){if(!t)throw new ie(K.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function sD(n,e,t,i){if(e===!0&&i===!0)throw new ie(K.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function PC(n){if(!pe.isDocumentKey(n))throw new ie(K.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function OC(n){if(pe.isDocumentKey(n))throw new ie(K.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Mg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ve()}function at(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ie(K.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Mg(n);throw new ie(K.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function aD(n,e){if(e<=0)throw new ie(K.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new ie(K.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ie(K.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rD((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ie(K.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ie(K.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ie(K.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _f{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new MC({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ie(K.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ie(K.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new MC(e),e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new l3;switch(i.type){case"firstParty":return new d3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ie(K.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=kC.get(t);i&&(re("ComponentProvider","Removing Datastore"),kC.delete(t),i.terminate())})(this),Promise.resolve()}}function pj(n,e,t,i={}){var s;const o=(n=at(n,_f))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&Gr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=En.MOCK_USER;else{h=KR(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new ie(K.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new En(p)}n._authCredentials=new c3(new px(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ti=class oD{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new oD(this.firestore,e,this._query)}},Pt=class lD{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ga(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new lD(this.firestore,e,this._key)}},Ga=class cD extends ti{constructor(e,t,i){super(e,t,Tu(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pt(this.firestore,null,new pe(e))}withConverter(e){return new cD(this.firestore,e,this._path)}};function uD(n,e,...t){if(n=we(n),yw("collection","path",e),n instanceof _f){const i=Xe.fromString(e,...t);return OC(i),new Ga(n,null,i)}{if(!(n instanceof Pt||n instanceof Ga))throw new ie(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Xe.fromString(e,...t));return OC(i),new Ga(n.firestore,null,i)}}function gj(n,e){if(n=at(n,_f),yw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ie(K.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ti(n,null,(function(i){return new Bs(Xe.emptyPath(),i)})(e))}function Wp(n,e,...t){if(n=we(n),arguments.length===1&&(e=gx.newId()),yw("doc","path",e),n instanceof _f){const i=Xe.fromString(e,...t);return PC(i),new Pt(n,null,new pe(i))}{if(!(n instanceof Pt||n instanceof Ga))throw new ie(K.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Xe.fromString(e,...t));return PC(i),new Pt(n.firestore,n instanceof Ga?n.converter:null,new pe(i))}}function hD(n,e){return n=we(n),e=we(e),(n instanceof Pt||n instanceof Ga)&&(e instanceof Pt||e instanceof Ga)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function dD(n,e){return n=we(n),e=we(e),n instanceof ti&&e instanceof ti&&n.firestore===e.firestore&&uf(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new tw(this,"async_queue_retry"),this.Vu=()=>{const i=Ap();i&&re("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const t=Ap();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Ap();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new On;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ho(e))throw e;re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((i=>{this.Eu=i,this.du=!1;const s=(function(c){let h=c.message||"";return c.stack&&(h=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),h})(i);throw Qt("INTERNAL UNHANDLED ERROR: ",s),i})).then((i=>(this.du=!1,i))))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=sw.createAndSchedule(this,e,t,i,(o=>this.yu(o)));return this.Tu.push(s),s}fu(){this.Eu&&ve()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function I0(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1})(n,["next","error","complete"])}class _j{constructor(){this._progressObserver={},this._taskCompletionResolver=new On,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=-1;let Yt=class extends _f{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new VC,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new VC(e),this._firestoreClient=void 0,await e}}};function jn(n){if(n._terminated)throw new ie(K.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fD(n),n._firestoreClient}function fD(n){var e,t,i;const s=n._freezeSettings(),o=(function(h,d,p,_){return new z3(h,d,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,rD(_.experimentalLongPollingOptions),_.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new aj(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(h){const d=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(d),_online:d}})(n._componentsProvider))}function vj(n,e){Gr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return mD(n,Ud.provider,{build:i=>new ZN(i,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function Ej(n){Gr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();mD(n,Ud.provider,{build:t=>new nj(t,e.cacheSizeBytes)})}function mD(n,e,t){if((n=at(n,Yt))._firestoreClient||n._terminated)throw new ie(K.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ie(K.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},fD(n)}function wj(n){if(n._initialized&&!n._terminated)throw new ie(K.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new On;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(i){if(!Fr.D())return Promise.resolve();const s=i+"main";await Fr.delete(s)})(JE(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function Tj(n){return(function(t){const i=new On;return t.asyncQueue.enqueueAndForget((async()=>GF(await _w(t),i))),i.promise})(jn(n=at(n,Yt)))}function bj(n){return lj(jn(n=at(n,Yt)))}function Ij(n){return cj(jn(n=at(n,Yt)))}function Sj(n,e){const t=jn(n=at(n,Yt)),i=new _j;return fj(t,n._databaseId,e,i),i}function Aj(n,e){return mj(jn(n=at(n,Yt)),e).then((t=>t?new ti(n,null,t.query):null))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $r(zt.fromBase64String(e))}catch(t){throw new ie(K.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new $r(zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ie(K.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nl=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ie(K.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ie(K.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0})(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj=/^__.*__$/;class Rj{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Fs(e,this.data,this.fieldMask,t,this.fieldTransforms):new bu(e,this.data,t,this.fieldTransforms)}}class pD{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Fs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function gD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve()}}class Lg{constructor(e,t,i,s,o,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Lg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.Ou(e),s}Nu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(gD(this.Cu)&&Cj.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class xj{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||pf(e)}Qu(e,t,i,s=!1){return new Lg({Cu:e,methodName:t,qu:i,path:Rt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dl(n){const e=n._freezeSettings(),t=pf(n._databaseId);return new xj(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ug(n,e,t,i,s,o={}){const c=n.Qu(o.merge||o.mergeFields?2:0,e,t,s);Aw("Data must be an object, but it was:",c,i);const h=vD(i,c);let d,p;if(o.merge)d=new fi(c.fieldMask),p=c.fieldTransforms;else if(o.mergeFields){const _=[];for(const v of o.mergeFields){const T=S0(e,v,t);if(!c.contains(T))throw new ie(K.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);wD(_,T)||_.push(T)}d=new fi(_),p=c.fieldTransforms.filter((v=>d.covers(v.field)))}else d=null,p=c.fieldTransforms;return new Rj(new Pn(h),d,p)}class yf extends Nl{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yf}}function _D(n,e,t){return new Lg({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ew extends Nl{_toFieldTransform(e){return new df(e.path,new tu)}isEqual(e){return e instanceof Ew}}class ww extends Nl{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=_D(this,e,!0),i=this.Ku.map((o=>kl(o,t))),s=new gl(i);return new df(e.path,s)}isEqual(e){return e instanceof ww&&Ed(this.Ku,e.Ku)}}class Tw extends Nl{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=_D(this,e,!0),i=this.Ku.map((o=>kl(o,t))),s=new _l(i);return new df(e.path,s)}isEqual(e){return e instanceof Tw&&Ed(this.Ku,e.Ku)}}class bw extends Nl{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new nu(e.serializer,Qx(e.serializer,this.$u));return new df(e.path,t)}isEqual(e){return e instanceof bw&&this.$u===e.$u}}function Iw(n,e,t,i){const s=n.Qu(1,e,t);Aw("Data must be an object, but it was:",s,i);const o=[],c=Pn.empty();xl(i,((d,p)=>{const _=Cw(e,d,t);p=we(p);const v=s.Nu(_);if(p instanceof yf)o.push(_);else{const T=kl(p,v);T!=null&&(o.push(_),c.set(_,T))}}));const h=new fi(o);return new pD(c,h,s.fieldTransforms)}function Sw(n,e,t,i,s,o){const c=n.Qu(1,e,t),h=[S0(e,i,t)],d=[s];if(o.length%2!=0)throw new ie(K.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<o.length;T+=2)h.push(S0(e,o[T])),d.push(o[T+1]);const p=[],_=Pn.empty();for(let T=h.length-1;T>=0;--T)if(!wD(p,h[T])){const R=h[T];let P=d[T];P=we(P);const q=c.Nu(R);if(P instanceof yf)p.push(R);else{const Y=kl(P,q);Y!=null&&(p.push(R),_.set(R,Y))}}const v=new fi(p);return new pD(_,v,c.fieldTransforms)}function yD(n,e,t,i=!1){return kl(t,n.Qu(i?4:3,e))}function kl(n,e){if(ED(n=we(n)))return Aw("Unsupported field value:",e,n),vD(n,e);if(n instanceof Nl)return(function(i,s){if(!gD(s.Cu))throw s.Bu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(i,s){const o=[];let c=0;for(const h of i){let d=kl(h,s.Lu(c));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),c++}return{arrayValue:{values:o}}})(n,e)}return(function(i,s){if((i=we(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Qx(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Dt.fromDate(i);return{timestampValue:iu(s.serializer,o)}}if(i instanceof Dt){const o=new Dt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:iu(s.serializer,o)}}if(i instanceof Vg)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof $r)return{bytesValue:aN(s.serializer,i._byteString)};if(i instanceof Pt){const o=s.databaseId,c=i.firestore._databaseId;if(!c.isEqual(o))throw s.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:$E(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof vw)return(function(c,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map((d=>{if(typeof d!="number")throw h.Bu("VectorValues must only contain numeric values.");return FE(h.serializer,d)}))}}}}}})(i,s);throw s.Bu(`Unsupported field value: ${Mg(i)}`)})(n,e)}function vD(n,e){const t={};return Rx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):xl(n,((i,s)=>{const o=kl(s,e.Mu(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function ED(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Dt||n instanceof Vg||n instanceof $r||n instanceof Pt||n instanceof Nl||n instanceof vw)}function Aw(n,e,t){if(!ED(t)||!(function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)})(t)){const i=Mg(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function S0(n,e,t){if((e=we(e))instanceof no)return e._internalPath;if(typeof e=="string")return Cw(n,e);throw Yp("Field path arguments must be of type string or ",n,!1,void 0,t)}const Nj=new RegExp("[~\\*/\\[\\]]");function Cw(n,e,t){if(e.search(Nj)>=0)throw Yp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new no(...e.split("."))._internalPath}catch{throw Yp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yp(n,e,t,i,s){const o=i&&!i.isEmpty(),c=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||c)&&(d+=" (found",o&&(d+=` in field ${i}`),c&&(d+=` in document ${s}`),d+=")"),new ie(K.INVALID_ARGUMENT,h+n+d)}function wD(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Dj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Bg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Dj extends Bd{data(){return super.data()}}function Bg(n,e){return typeof e=="string"?Cw(n,e):e instanceof no?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ie(K.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Rw{}let vf=class extends Rw{};function Pa(n,e,...t){let i=[];e instanceof Rw&&i.push(e),i=i.concat(t),(function(o){const c=o.filter((d=>d instanceof xw)).length,h=o.filter((d=>d instanceof Fg)).length;if(c>1||c>0&&h>0)throw new ie(K.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class Fg extends vf{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Fg(e,t,i)}_apply(e){const t=this._parse(e);return RD(e._query,t),new ti(e.firestore,e.converter,d0(e._query,t))}_parse(e){const t=Dl(e.firestore);return(function(o,c,h,d,p,_,v){let T;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ie(K.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){UC(v,_);const R=[];for(const P of v)R.push(LC(d,o,P));T={arrayValue:{values:R}}}else T=LC(d,o,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||UC(v,_),T=yD(h,c,v,_==="in"||_==="not-in");return Je.create(p,_,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function kj(n,e,t){const i=e,s=Bg("where",n);return Fg._create(s,i,t)}class xw extends Rw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new xw(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:dt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,o){let c=s;const h=o.getFlattenedFilters();for(const d of h)RD(c,d),c=d0(c,d)})(e._query,t),new ti(e.firestore,e.converter,d0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nw extends vf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Nw(e,t)}_apply(e){const t=(function(s,o,c){if(s.startAt!==null)throw new ie(K.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ie(K.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Od(o,c)})(e._query,this._field,this._direction);return new ti(e.firestore,e.converter,(function(s,o){const c=s.explicitOrderBy.concat([o]);return new Bs(s.path,s.collectionGroup,c,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function Pj(n,e="asc"){const t=e,i=Bg("orderBy",n);return Nw._create(i,t)}class jg extends vf{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new jg(e,t,i)}_apply(e){return new ti(e.firestore,e.converter,jp(e._query,this._limit,this._limitType))}}function Oj(n){return aD("limit",n),jg._create("limit",n,"F")}function Mj(n){return aD("limitToLast",n),jg._create("limitToLast",n,"L")}let bD=class ID extends vf{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new ID(e,t,i)}_apply(e){const t=CD(e,this.type,this._docOrFields,this._inclusive);return new ti(e.firestore,e.converter,(function(s,o){return new Bs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,o,s.endAt)})(e._query,t))}};function Vj(...n){return bD._create("startAt",n,!0)}function Lj(...n){return bD._create("startAfter",n,!1)}let SD=class AD extends vf{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new AD(e,t,i)}_apply(e){const t=CD(e,this.type,this._docOrFields,this._inclusive);return new ti(e.firestore,e.converter,(function(s,o){return new Bs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,o)})(e._query,t))}};function Uj(...n){return SD._create("endBefore",n,!1)}function Bj(...n){return SD._create("endAt",n,!0)}function CD(n,e,t,i){if(t[0]=we(t[0]),t[0]instanceof Bd)return(function(o,c,h,d,p){if(!d)throw new ie(K.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const _=[];for(const v of Gc(o))if(v.field.isKeyField())_.push(ml(c,d.key));else{const T=d.data.field(v.field);if(Ig(T))throw new ie(K.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+v.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const R=v.field.canonicalString();throw new ie(K.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${R}' (used as the orderBy) does not exist.`)}_.push(T)}return new eo(_,p)})(n._query,n.firestore._databaseId,e,t[0]._document,i);{const s=Dl(n.firestore);return(function(c,h,d,p,_,v){const T=c.explicitOrderBy;if(_.length>T.length)throw new ie(K.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const R=[];for(let P=0;P<_.length;P++){const q=_[P];if(T[P].field.isKeyField()){if(typeof q!="string")throw new ie(K.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof q}`);if(!UE(c)&&q.indexOf("/")!==-1)throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${q}' contains a slash.`);const Y=c.path.child(Xe.fromString(q));if(!pe.isDocumentKey(Y))throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${Y}' is not because it contains an odd number of segments.`);const le=new pe(Y);R.push(ml(h,le))}else{const Y=yD(d,p,q);R.push(Y)}}return new eo(R,v)})(n._query,n.firestore._databaseId,s,e,t,i)}}function LC(n,e,t){if(typeof(t=we(t))=="string"){if(t==="")throw new ie(K.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!UE(e)&&t.indexOf("/")!==-1)throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Xe.fromString(t));if(!pe.isDocumentKey(i))throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return ml(n,new pe(i))}if(t instanceof Pt)return ml(n,t._key);throw new ie(K.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Mg(t)}.`)}function UC(n,e){if(!Array.isArray(n)||n.length===0)throw new ie(K.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function RD(n,e){const t=(function(s,o){for(const c of s)for(const h of c.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ie(K.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ie(K.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Dw{convertValue(e,t="none"){switch(fl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ve()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return xl(e,((s,o)=>{i[s]=this.convertValue(o,t)})),i}convertVectorValue(e){var t,i,s;const o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map((c=>Ct(c.doubleValue)));return new vw(o)}convertGeoPoint(e){return new Vg(Ct(e.latitude),Ct(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=VE(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Dd(e));default:return null}}convertTimestamp(e){const t=Ps(e);return new Dt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Xe.fromString(e);be(_N(i));const s=new Ja(i.get(1),i.get(3)),o=new pe(i.popFirst(5));return s.isEqual(t)||Qt(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Fj extends Dw{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pt(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Os=class extends Bd{constructor(e,t,i,s,o,c){super(e,t,i,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new hd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Bg("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},hd=class extends Os{data(e={}){return super.data(e)}},io=class{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new nl(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new hd(this._firestore,this._userDataWriter,i.key,i,new nl(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ie(K.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((h=>{const d=new hd(s._firestore,s._userDataWriter,h.doc.key,h.doc,new nl(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const d=new hd(s._firestore,s._userDataWriter,h.doc.key,h.doc,new nl(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,_=-1;return h.type!==0&&(p=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:jj(h.type),doc:d,oldIndex:p,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function jj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve()}}function xD(n,e){return n instanceof Os&&e instanceof Os?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof io&&e instanceof io&&n._firestore===e._firestore&&dD(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(n){n=at(n,Pt);const e=at(n.firestore,Yt);return nD(jn(e),n._key).then((t=>kw(e,n,t)))}class Pl extends Dw{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pt(this.firestore,null,t)}}function qj(n){n=at(n,Pt);const e=at(n.firestore,Yt),t=jn(e),i=new Pl(e);return uj(t,n._key).then((s=>new Os(e,i,n._key,s,new nl(s!==null&&s.hasLocalMutations,!0),n.converter)))}function Gj(n){n=at(n,Pt);const e=at(n.firestore,Yt);return nD(jn(e),n._key,{source:"server"}).then((t=>kw(e,n,t)))}function Hj(n){n=at(n,ti);const e=at(n.firestore,Yt),t=jn(e),i=new Pl(e);return TD(n._query),iD(t,n._query).then((s=>new io(e,i,n,s)))}function $j(n){n=at(n,ti);const e=at(n.firestore,Yt),t=jn(e),i=new Pl(e);return hj(t,n._query).then((s=>new io(e,i,n,s)))}function Kj(n){n=at(n,ti);const e=at(n.firestore,Yt),t=jn(e),i=new Pl(e);return iD(t,n._query,{source:"server"}).then((s=>new io(e,i,n,s)))}function BC(n,e,t){n=at(n,Pt);const i=at(n.firestore,Yt),s=zg(n.converter,e,t);return Ef(i,[Ug(Dl(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,xt.none())])}function FC(n,e,t,...i){n=at(n,Pt);const s=at(n.firestore,Yt),o=Dl(s);let c;return c=typeof(e=we(e))=="string"||e instanceof no?Sw(o,"updateDoc",n._key,e,t,i):Iw(o,"updateDoc",n._key,e),Ef(s,[c.toMutation(n._key,xt.exists(!0))])}function Qj(n){return Ef(at(n.firestore,Yt),[new Iu(n._key,xt.none())])}function Wj(n,e){const t=at(n.firestore,Yt),i=Wp(n),s=zg(n.converter,e);return Ef(t,[Ug(Dl(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,xt.exists(!1))]).then((()=>i))}function ND(n,...e){var t,i,s;n=we(n);let o={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||I0(e[c])||(o=e[c],c++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(I0(e[c])){const v=e[c];e[c]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[c+1]=(i=v.error)===null||i===void 0?void 0:i.bind(v),e[c+2]=(s=v.complete)===null||s===void 0?void 0:s.bind(v)}let d,p,_;if(n instanceof Pt)p=at(n.firestore,Yt),_=Tu(n._key.path),d={next:v=>{e[c]&&e[c](kw(p,n,v))},error:e[c+1],complete:e[c+2]};else{const v=at(n,ti);p=at(v.firestore,Yt),_=v._query;const T=new Pl(p);d={next:R=>{e[c]&&e[c](new io(p,T,v,R))},error:e[c+1],complete:e[c+2]},TD(n._query)}return(function(T,R,P,q){const Y=new Pg(q),le=new cw(R,Y,P);return T.asyncQueue.enqueueAndForget((async()=>aw(await cu(T),le))),()=>{Y.Za(),T.asyncQueue.enqueueAndForget((async()=>ow(await cu(T),le)))}})(jn(p),_,h,d)}function Yj(n,e){return dj(jn(n=at(n,Yt)),I0(e)?e:{next:e})}function Ef(n,e){return(function(i,s){const o=new On;return i.asyncQueue.enqueueAndForget((async()=>FF(await _w(i),s,o))),o.promise})(jn(n),e)}function kw(n,e,t){const i=t.docs.get(e._key),s=new Pl(n);return new Os(n,s,e._key,i,new nl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jj=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Dl(e)}set(e,t,i){this._verifyNotCommitted();const s=Va(e,this._firestore),o=zg(s.converter,t,i),c=Ug(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,i);return this._mutations.push(c.toMutation(s._key,xt.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const o=Va(e,this._firestore);let c;return c=typeof(t=we(t))=="string"||t instanceof no?Sw(this._dataReader,"WriteBatch.update",o._key,t,i,s):Iw(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,xt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Va(e,this._firestore);return this._mutations=this._mutations.concat(new Iu(t._key,xt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ie(K.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Va(n,e){if((n=we(n)).firestore!==e)throw new ie(K.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zj=class extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=Dl(t)}get(t){const i=Va(t,this._firestore),s=new Fj(this._firestore);return this._transaction.lookup([i._key]).then((o=>{if(!o||o.length!==1)return ve();const c=o[0];if(c.isFoundDocument())return new Bd(this._firestore,s,c.key,c,i.converter);if(c.isNoDocument())return new Bd(this._firestore,s,i._key,null,i.converter);throw ve()}))}set(t,i,s){const o=Va(t,this._firestore),c=zg(o.converter,i,s),h=Ug(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,s);return this._transaction.set(o._key,h),this}update(t,i,s,...o){const c=Va(t,this._firestore);let h;return h=typeof(i=we(i))=="string"||i instanceof no?Sw(this._dataReader,"Transaction.update",c._key,i,s,o):Iw(this._dataReader,"Transaction.update",c._key,i),this._transaction.update(c._key,h),this}delete(t){const i=Va(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Va(e,this._firestore),i=new Pl(this._firestore);return super.get(e).then((s=>new Os(this._firestore,i,t._key,s._document,new nl(!1,!1),t.converter)))}};function e6(n,e,t){n=at(n,Yt);const i=Object.assign(Object.assign({},Xj),t);return(function(o){if(o.maxAttempts<1)throw new ie(K.INVALID_ARGUMENT,"Max attempts must be at least 1")})(i),(function(o,c,h){const d=new On;return o.asyncQueue.enqueueAndForget((async()=>{const p=await oj(o);new sj(o.asyncQueue,p,h,c,d).au()})),d.promise})(jn(n),(s=>e(new Zj(n,s))),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t6(){return new yf("deleteField")}function n6(){return new Ew("serverTimestamp")}function i6(...n){return new ww("arrayUnion",n)}function r6(...n){return new Tw("arrayRemove",n)}function s6(n){return new bw("increment",n)}(function(e,t=!0){(function(s){wu=s})(Vs),Ds(new _i("firestore",((i,{instanceIdentifier:s,options:o})=>{const c=i.getProvider("app").getImmediate(),h=new Yt(new u3(i.getProvider("auth-internal")),new m3(i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ie(K.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ja(p.options.projectId,_)})(c,s),c);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),Di(xA,"4.7.3",e),Di(xA,"4.7.3","esm2017")})();const a6="@firebase/firestore-compat",o6="0.3.38";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ie("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(){if(typeof Uint8Array>"u")throw new ie("unimplemented","Uint8Arrays are not available in this environment.")}function zC(){if(!F3())throw new ie("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Fd{constructor(e){this._delegate=e}static fromBase64String(e){return zC(),new Fd($r.fromBase64String(e))}static fromUint8Array(e){return jC(),new Fd($r.fromUint8Array(e))}toBase64(){return zC(),this._delegate.toBase64()}toUint8Array(){return jC(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(n){return l6(n,["next","error","complete"])}function l6(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{enableIndexedDbPersistence(e,t){return vj(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Ej(e._delegate)}clearIndexedDbPersistence(e){return wj(e._delegate)}}class DD{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ja||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Gr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){pj(this._delegate,e,t,i)}enableNetwork(){return bj(this._delegate)}disableNetwork(){return Ij(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,sD("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Tj(this._delegate)}onSnapshotsInSync(e){return Yj(this._delegate,e)}get app(){if(!this._appCompat)throw new ie("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new uu(this,uD(this._delegate,e))}catch(t){throw Qn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Qi(this,Wp(this._delegate,e))}catch(t){throw Qn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new qd(this,gj(this._delegate,e))}catch(t){throw Qn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return e6(this._delegate,t=>e(new kD(this,t)))}batch(){return jn(this._delegate),new PD(new Jj(this._delegate,e=>Ef(this._delegate,e)))}loadBundle(e){return Sj(this._delegate,e)}namedQuery(e){return Aj(this._delegate,e).then(t=>t?new qd(this,t):null)}}class qg extends Dw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fd(new $r(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Qi.forKey(t,this.firestore,null)}}function u6(n){a3(n)}class kD{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new qg(e)}get(e){const t=il(e);return this._delegate.get(t).then(i=>new jd(this._firestore,new Os(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const s=il(e);return i?(Pw("Transaction.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const o=il(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...s),this}delete(e){const t=il(e);return this._delegate.delete(t),this}}class PD{constructor(e){this._delegate=e}set(e,t,i){const s=il(e);return i?(Pw("WriteBatch.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const o=il(e);return arguments.length===2?this._delegate.update(o,t):this._delegate.update(o,t,i,...s),this}delete(e){const t=il(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class wl{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new hd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zd(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=wl.INSTANCES;let s=i.get(e);s||(s=new WeakMap,i.set(e,s));let o=s.get(t);return o||(o=new wl(e,new qg(e),t),s.set(t,o)),o}}wl.INSTANCES=new WeakMap;class Qi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qg(e)}static forPath(e,t,i){if(e.length%2!==0)throw new ie("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Qi(t,new Pt(t._delegate,i,new pe(e)))}static forKey(e,t,i){return new Qi(t,new Pt(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new uu(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new uu(this.firestore,uD(this._delegate,e))}catch(t){throw Qn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=we(e),e instanceof Pt?hD(this._delegate,e):!1}set(e,t){t=Pw("DocumentReference.set",t);try{return t?BC(this._delegate,e,t):BC(this._delegate,e)}catch(i){throw Qn(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?FC(this._delegate,e):FC(this._delegate,e,t,...i)}catch(s){throw Qn(s,"updateDoc()","DocumentReference.update()")}}delete(){return Qj(this._delegate)}onSnapshot(...e){const t=OD(e),i=MD(e,s=>new jd(this.firestore,new Os(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return ND(this._delegate,t,i)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=qj(this._delegate):(e==null?void 0:e.source)==="server"?t=Gj(this._delegate):t=zj(this._delegate),t.then(i=>new jd(this.firestore,new Os(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new Qi(this.firestore,e?this._delegate.withConverter(wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Qn(n,e,t){return n.message=n.message.replace(e,t),n}function OD(n){for(const e of n)if(typeof e=="object"&&!A0(e))return e;return{}}function MD(n,e){var t,i;let s;return A0(n[0])?s=n[0]:A0(n[1])?s=n[1]:typeof n[0]=="function"?s={next:n[0],error:n[1],complete:n[2]}:s={next:n[1],error:n[2],complete:n[3]},{next:o=>{s.next&&s.next(e(o))},error:(t=s.error)===null||t===void 0?void 0:t.bind(s),complete:(i=s.complete)===null||i===void 0?void 0:i.bind(s)}}class jd{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Qi(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return xD(this._delegate,e._delegate)}}class zd extends jd{data(e){const t=this._delegate.data(e);return this._delegate._converter||o3(t!==void 0),t}}let qd=class Rr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qg(e)}where(e,t,i){try{return new Rr(this.firestore,Pa(this._delegate,kj(e,t,i)))}catch(s){throw Qn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Rr(this.firestore,Pa(this._delegate,Pj(e,t)))}catch(i){throw Qn(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Rr(this.firestore,Pa(this._delegate,Oj(e)))}catch(t){throw Qn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Rr(this.firestore,Pa(this._delegate,Mj(e)))}catch(t){throw Qn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Rr(this.firestore,Pa(this._delegate,Vj(...e)))}catch(t){throw Qn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Rr(this.firestore,Pa(this._delegate,Lj(...e)))}catch(t){throw Qn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Rr(this.firestore,Pa(this._delegate,Uj(...e)))}catch(t){throw Qn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Rr(this.firestore,Pa(this._delegate,Bj(...e)))}catch(t){throw Qn(t,"endAt()","Query.endAt()")}}isEqual(e){return dD(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=$j(this._delegate):(e==null?void 0:e.source)==="server"?t=Kj(this._delegate):t=Hj(this._delegate),t.then(i=>new C0(this.firestore,new io(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=OD(e),i=MD(e,s=>new C0(this.firestore,new io(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return ND(this._delegate,t,i)}withConverter(e){return new Rr(this.firestore,e?this._delegate.withConverter(wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};class h6{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new zd(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class C0{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new qd(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new zd(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new h6(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new zd(this._firestore,i))})}isEqual(e){return xD(this._delegate,e._delegate)}}class uu extends qd{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Qi(this.firestore,e):null}doc(e){try{return e===void 0?new Qi(this.firestore,Wp(this._delegate)):new Qi(this.firestore,Wp(this._delegate,e))}catch(t){throw Qn(t,"doc()","CollectionReference.doc()")}}add(e){return Wj(this._delegate,e).then(t=>new Qi(this.firestore,t))}isEqual(e){return hD(this._delegate,e._delegate)}withConverter(e){return new uu(this.firestore,e?this._delegate.withConverter(wl.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function il(n){return at(n,Pt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(...e){this._delegate=new no(...e)}static documentId(){return new Ow(Rt.keyField().canonicalString())}isEqual(e){return e=we(e),e instanceof no?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this._delegate=e}static serverTimestamp(){const e=n6();return e._methodName="FieldValue.serverTimestamp",new el(e)}static delete(){const e=t6();return e._methodName="FieldValue.delete",new el(e)}static arrayUnion(...e){const t=i6(...e);return t._methodName="FieldValue.arrayUnion",new el(t)}static arrayRemove(...e){const t=r6(...e);return t._methodName="FieldValue.arrayRemove",new el(t)}static increment(e){const t=s6(e);return t._methodName="FieldValue.increment",new el(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6={Firestore:DD,GeoPoint:Vg,Timestamp:Dt,Blob:Fd,Transaction:kD,WriteBatch:PD,DocumentReference:Qi,DocumentSnapshot:jd,Query:qd,QueryDocumentSnapshot:zd,QuerySnapshot:C0,CollectionReference:uu,FieldPath:Ow,FieldValue:el,setLogLevel:u6,CACHE_SIZE_UNLIMITED:yj};function f6(n,e){n.INTERNAL.registerComponent(new _i("firestore-compat",t=>{const i=t.getProvider("app-compat").getImmediate(),s=t.getProvider("firestore").getImmediate();return e(i,s)},"PUBLIC").setServiceProps(Object.assign({},d6)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(n){f6(n,(e,t)=>new DD(e,t,new c6)),n.registerVersion(a6,o6)}m6(Ye);var qC={};const GC="@firebase/database",HC="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VD="";function LD(n){VD=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),on(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:vd(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return ki(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new p6(e)}}catch{}return new g6},rl=UD("localStorage"),R0=UD("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=new _u("@firebase/database"),BD=(function(){let n=1;return function(){return n++}})(),FD=function(n){const e=OM(n),t=new DM;t.update(e);const i=t.digest();return nE.encodeByteArray(i)},wf=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=wf.apply(null,i):typeof i=="object"?e+=on(i):e+=i,e+=" "}return e};let ll=null,$C=!0;const jD=function(n,e){ue(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?($c.logLevel=Ge.VERBOSE,ll=$c.log.bind($c),e&&R0.set("logging_enabled",!0)):typeof n=="function"?ll=n:(ll=null,R0.remove("logging_enabled"))},Tn=function(...n){if($C===!0&&($C=!1,ll===null&&R0.get("logging_enabled")===!0&&jD(!0)),ll){const e=wf.apply(null,n);ll(e)}},Tf=function(n){return function(...e){Tn(n,...e)}},x0=function(...n){const e="FIREBASE INTERNAL ERROR: "+wf(...n);$c.error(e)},Kr=function(...n){const e=`FIREBASE FATAL ERROR: ${wf(...n)}`;throw $c.error(e),new Error(e)},Fn=function(...n){const e="FIREBASE WARNING: "+wf(...n);$c.warn(e)},_6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Fn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Gg=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},y6=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ro="[MIN_NAME]",Ms="[MAX_NAME]",Ol=function(n,e){if(n===e)return 0;if(n===ro||e===Ms)return-1;if(e===ro||n===Ms)return 1;{const t=KC(n),i=KC(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},v6=function(n,e){return n===e?0:n<e?-1:1},Gh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+on(e))},Mw=function(n){if(typeof n!="object"||n===null)return on(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=on(e[i]),t+=":",t+=Mw(n[e[i]]);return t+="}",t},zD=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function In(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const qD=function(n){ue(!Gg(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,c,h,d;n===0?(o=0,c=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=h+i,c=Math.round(n*Math.pow(2,t-h)-Math.pow(2,t))):(o=0,c=Math.round(n/Math.pow(2,1-i-t))));const p=[];for(d=t;d;d-=1)p.push(c%2?1:0),c=Math.floor(c/2);for(d=e;d;d-=1)p.push(o%2?1:0),o=Math.floor(o/2);p.push(s?1:0),p.reverse();const _=p.join("");let v="";for(d=0;d<64;d+=8){let T=parseInt(_.substr(d,8),2).toString(16);T.length===1&&(T="0"+T),v=v+T}return v.toLowerCase()},E6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},w6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function T6(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const b6=new RegExp("^-?(0*)\\d{1,10}$"),I6=-2147483648,S6=2147483647,KC=function(n){if(b6.test(n)){const e=Number(n);if(e>=I6&&e<=S6)return e}return null},xu=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Fn("Exception was thrown by user callback.",t),e},Math.floor(0))}},A6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},dd=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Fn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Tn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Fn(e)}}class Kc{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Kc.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="5",GD="v",HD="s",$D="r",KD="f",QD=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,WD="ls",YD="p",N0="ac",XD="websocket",JD="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e,t,i,s,o=!1,c="",h=!1,d=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=rl.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&rl.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function x6(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function ek(n,e,t){ue(typeof e=="string","typeof type must == string"),ue(typeof t=="object","typeof params must == object");let i;if(e===XD)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===JD)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);x6(n)&&(t.ns=n.namespace);const s=[];return In(t,(o,c)=>{s.push(o+"="+c)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(){this.counters_={}}incrementCounter(e,t=1){ki(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return gM(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv={},Vv={};function Lw(n){const e=n.toString();return Mv[e]||(Mv[e]=new N6),Mv[e]}function D6(n,e){const t=n.toString();return Vv[t]||(Vv[t]=e()),Vv[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&xu(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="start",P6="close",O6="pLPCommand",M6="pRTLPCB",tk="id",nk="pw",ik="ser",V6="cb",L6="seg",U6="ts",B6="d",F6="dframe",rk=1870,sk=30,j6=rk-sk,z6=25e3,q6=3e4;class Fa{constructor(e,t,i,s,o,c,h){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Tf(e),this.stats_=Lw(t),this.urlFn=d=>(this.appCheckToken&&(d[N0]=this.appCheckToken),ek(t,JD,d))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new k6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(q6)),y6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Uw((...o)=>{const[c,h,d,p,_]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===QC)this.id=h,this.password=d;else if(c===P6)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...o)=>{const[c,h]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const i={};i[QC]="t",i[ik]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[V6]=this.scriptTagHolder.uniqueCallbackIdentifier),i[GD]=Vw,this.transportSessionId&&(i[HD]=this.transportSessionId),this.lastSessionId&&(i[WD]=this.lastSessionId),this.applicationId&&(i[YD]=this.applicationId),this.appCheckToken&&(i[N0]=this.appCheckToken),typeof location<"u"&&location.hostname&&QD.test(location.hostname)&&(i[$D]=KD);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Fa.forceAllow_=!0}static forceDisallow(){Fa.forceDisallow_=!0}static isAvailable(){return Fa.forceAllow_?!0:!Fa.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!E6()&&!w6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=on(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=GR(t),s=zD(i,j6);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[F6]="t",i[tk]=e,i[nk]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=on(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Uw{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=BD(),window[O6+this.uniqueCallbackIdentifier]=e,window[M6+this.uniqueCallbackIdentifier]=t,this.myIFrame=Uw.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){Tn("frame writing exception"),h.stack&&Tn(h.stack),Tn(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Tn("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[tk]=this.myID,e[nk]=this.myPW,e[ik]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+sk+i.length<=rk;){const c=this.pendingSegs.shift();i=i+"&"+L6+s+"="+c.seg+"&"+U6+s+"="+c.ts+"&"+B6+s+"="+c.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(z6)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Tn("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6=16384,H6=45e3;let Xp=null;typeof MozWebSocket<"u"?Xp=MozWebSocket:typeof WebSocket<"u"&&(Xp=WebSocket);class Ki{constructor(e,t,i,s,o,c,h){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Tf(this.connId),this.stats_=Lw(t),this.connURL=Ki.connectionURL_(t,c,h,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const c={};return c[GD]=Vw,typeof location<"u"&&location.hostname&&QD.test(location.hostname)&&(c[$D]=KD),t&&(c[HD]=t),i&&(c[WD]=i),s&&(c[N0]=s),o&&(c[YD]=o),ek(e,XD,c)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,rl.set("previous_websocket_failure",!0);try{let i;IM(),this.mySock=new Xp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Ki.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Xp!==null&&!Ki.forceDisallow_}static previouslyFailed(){return rl.isInMemoryStorage||rl.get("previous_websocket_failure")===!0}markConnectionHealthy(){rl.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=vd(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ue(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=on(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=zD(t,G6);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(H6))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ki.responsesRequiredToBeHealthy=2;Ki.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Fa,Ki]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Ki&&Ki.isAvailable();let i=t&&!Ki.previouslyFailed();if(e.webSocketOnly&&(t||Fn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ki];else{const s=this.transports_=[];for(const o of hu.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);hu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}hu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6=6e4,K6=5e3,Q6=10*1024,W6=100*1024,Lv="t",WC="d",Y6="s",YC="r",X6="e",XC="o",JC="a",ZC="n",eR="p",J6="h";class Z6{constructor(e,t,i,s,o,c,h,d,p,_){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=d,this.onKill_=p,this.lastSessionId=_,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Tf("c:"+this.id+":"),this.transportManager_=new hu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=dd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>W6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Q6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Lv in e){const t=e[Lv];t===JC?this.upgradeIfSecondaryHealthy_():t===YC?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===XC&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Gh("t",e),i=Gh("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:eR,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:JC,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:ZC,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Gh("t",e),i=Gh("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Gh(Lv,e);if(WC in e){const i=e[WC];if(t===J6){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===ZC){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Y6?this.onConnectionShutdown_(i):t===YC?this.onReset_(i):t===X6?x0("Server Error: "+i):t===XC?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):x0("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Vw!==i&&Fn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),dd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor($6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):dd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(K6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:eR,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(rl.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.allowedEvents_=e,this.listeners_={},ue(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){ue(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp extends ok{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!rE()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Jp}getInitialEvent(e){return ue(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR=32,nR=768;class ct{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function st(){return new ct("")}function ze(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function so(n){return n.pieces_.length-n.pieceNum_}function vt(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ct(n.pieces_,e)}function Bw(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function ez(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Gd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function lk(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ct(e,0)}function Nt(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof ct)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new ct(t,0)}function qe(n){return n.pieceNum_>=n.pieces_.length}function Yn(n,e){const t=ze(n),i=ze(e);if(t===null)return e;if(t===i)return Yn(vt(n),vt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function tz(n,e){const t=Gd(n,0),i=Gd(e,0);for(let s=0;s<t.length&&s<i.length;s++){const o=Ol(t[s],i[s]);if(o!==0)return o}return t.length===i.length?0:t.length<i.length?-1:1}function Fw(n,e){if(so(n)!==so(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Wi(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(so(n)>so(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class nz{constructor(e,t){this.errorPrefix_=t,this.parts_=Gd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=hg(this.parts_[i]);ck(this)}}function iz(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=hg(e),ck(n)}function rz(n){const e=n.parts_.pop();n.byteLength_-=hg(e),n.parts_.length>0&&(n.byteLength_-=1)}function ck(n){if(n.byteLength_>nR)throw new Error(n.errorPrefix_+"has a key path longer than "+nR+" bytes ("+n.byteLength_+").");if(n.parts_.length>tR)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+tR+") or object contains a cycle "+Wo(n))}function Wo(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw extends ok{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new jw}getInitialEvent(e){return ue(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hh=1e3,sz=300*1e3,iR=30*1e3,az=1.3,oz=3e4,lz="server_kill",rR=3;class xs extends ak{constructor(e,t,i,s,o,c,h,d){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=xs.nextPersistentConnectionId_++,this.log_=Tf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Hh,this.maxReconnectDelay_=sz,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");jw.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Jp.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(on(o)),ue(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new hi,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:c=>{const h=c.d;c.s==="ok"?t.resolve(h):t.reject(h)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,c=e._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ue(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const h={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(c).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},c="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(c,o,h=>{const d=h.d,p=h.s;xs.warnOnListenWarnings_(d,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",h),p!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(p,d))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&ki(e,"w")){const i=cl(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Fn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||NM(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=iR)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=xM(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,c=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},c="n";s&&(o.q=i,o.t=s),this.sendRequest(c,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const c={p:t,d:i};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:e,request:c,onComplete:s}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+on(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):x0("Unrecognized action received from server: "+on(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ue(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Hh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Hh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>oz&&(this.reconnectDelay_=Hh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*az)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+xs.nextConnectionId_++,o=this.lastSessionId;let c=!1,h=null;const d=function(){h?h.close():(c=!0,i())},p=function(v){ue(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(v)};this.realtime_={close:d,sendRequest:p};const _=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[v,T]=await Promise.all([this.authTokenProvider_.getToken(_),this.appCheckTokenProvider_.getToken(_)]);c?Tn("getToken() completed but was canceled"):(Tn("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=T&&T.token,h=new Z6(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,R=>{Fn(R+" ("+this.repoInfo_.toString()+")"),this.interrupt(lz)},o))}catch(v){this.log_("Failed to get token: "+v),c||(this.repoInfo_.nodeAdmin&&Fn(v),d())}}}interrupt(e){Tn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Tn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Np(this.interruptReasons_)&&(this.reconnectDelay_=Hh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>Mw(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new ct(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){Tn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=rR&&(this.reconnectDelay_=iR,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Tn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=rR&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+VD.replace(/\./g,"-")]=1,rE()?e["framework.cordova"]=1:ug()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Jp.getInstance().currentlyOnline();return Np(this.interruptReasons_)&&e}}xs.nextPersistentConnectionId_=0;xs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new He(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new He(ro,e),s=new He(ro,t);return this.compare(i,s)!==0}minPost(){return He.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fp;class uk extends Hg{static get __EMPTY_NODE(){return fp}static set __EMPTY_NODE(e){fp=e}compare(e,t){return Ol(e.name,t.name)}isDefinedOn(e){throw gu("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return He.MIN}maxPost(){return new He(Ms,fp)}makePost(e,t){return ue(typeof e=="string","KeyIndex indexValue must always be a string."),new He(e,fp)}toString(){return".key"}}const zr=new uk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let c=1;for(;!e.isEmpty();)if(e=e,c=t?i(e.key,t):1,s&&(c*=-1),c<0)this.isReverse_?e=e.left:e=e.right;else if(c===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class wn{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??wn.RED,this.left=s??pi.EMPTY_NODE,this.right=o??pi.EMPTY_NODE}copy(e,t,i,s,o){return new wn(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return pi.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return pi.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}wn.RED=!0;wn.BLACK=!1;class cz{copy(e,t,i,s,o){return this}insert(e,t,i){return new wn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class pi{constructor(e,t=pi.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new pi(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,wn.BLACK,null,null))}remove(e){return new pi(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,wn.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new mp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new mp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new mp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new mp(this.root_,null,this.comparator_,!0,e)}}pi.EMPTY_NODE=new cz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(n,e){return Ol(n.name,e.name)}function zw(n,e){return Ol(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D0;function hz(n){D0=n}const hk=function(n){return typeof n=="number"?"number:"+qD(n):"string:"+n},dk=function(n){if(n.isLeafNode()){const e=n.val();ue(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ki(e,".sv"),"Priority must be a string or number.")}else ue(n===D0||n.isEmpty(),"priority of unexpected type.");ue(n===D0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sR;class _n{constructor(e,t=_n.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ue(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),dk(this.priorityNode_)}static set __childrenNodeConstructor(e){sR=e}static get __childrenNodeConstructor(){return sR}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new _n(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:_n.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return qe(e)?this:ze(e)===".priority"?this.priorityNode_:_n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:_n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=ze(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(ue(i!==".priority"||so(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,_n.__childrenNodeConstructor.EMPTY_NODE.updateChild(vt(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+hk(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=qD(this.value_):e+=this.value_,this.lazyHash_=FD(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===_n.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof _n.__childrenNodeConstructor?-1:(ue(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=_n.VALUE_TYPE_ORDER.indexOf(t),o=_n.VALUE_TYPE_ORDER.indexOf(i);return ue(s>=0,"Unknown leaf type: "+t),ue(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}_n.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fk,mk;function dz(n){fk=n}function fz(n){mk=n}class mz extends Hg{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Ol(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return He.MIN}maxPost(){return new He(Ms,new _n("[PRIORITY-POST]",mk))}makePost(e,t){const i=fk(e);return new He(t,new _n("[PRIORITY-POST]",i))}toString(){return".priority"}}const wt=new mz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pz=Math.log(2);class gz{constructor(e){const t=o=>parseInt(Math.log(o)/pz,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Zp=function(n,e,t,i){n.sort(e);const s=function(d,p){const _=p-d;let v,T;if(_===0)return null;if(_===1)return v=n[d],T=t?t(v):v,new wn(T,v.node,wn.BLACK,null,null);{const R=parseInt(_/2,10)+d,P=s(d,R),q=s(R+1,p);return v=n[R],T=t?t(v):v,new wn(T,v.node,wn.BLACK,P,q)}},o=function(d){let p=null,_=null,v=n.length;const T=function(P,q){const Y=v-P,le=v;v-=P;const Ee=s(Y+1,le),oe=n[Y],de=t?t(oe):oe;R(new wn(de,oe.node,q,null,Ee))},R=function(P){p?(p.left=P,p=P):(_=P,p=P)};for(let P=0;P<d.count;++P){const q=d.nextBitIsOne(),Y=Math.pow(2,d.count-(P+1));q?T(Y,wn.BLACK):(T(Y,wn.BLACK),T(Y,wn.RED))}return _},c=new gz(n.length),h=o(c);return new pi(i||e,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uv;const Dc={};class As{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ue(Dc&&wt,"ChildrenNode.ts has not been loaded"),Uv=Uv||new As({".priority":Dc},{".priority":wt}),Uv}get(e){const t=cl(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof pi?t:null}hasIndex(e){return ki(this.indexSet_,e.toString())}addIndex(e,t){ue(e!==zr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(He.Wrap);let c=o.getNext();for(;c;)s=s||e.isDefinedOn(c.node),i.push(c),c=o.getNext();let h;s?h=Zp(i,e.getCompare()):h=Dc;const d=e.toString(),p=Object.assign({},this.indexSet_);p[d]=e;const _=Object.assign({},this.indexes_);return _[d]=h,new As(_,p)}addToIndexes(e,t){const i=Dp(this.indexes_,(s,o)=>{const c=cl(this.indexSet_,o);if(ue(c,"Missing index implementation for "+o),s===Dc)if(c.isDefinedOn(e.node)){const h=[],d=t.getIterator(He.Wrap);let p=d.getNext();for(;p;)p.name!==e.name&&h.push(p),p=d.getNext();return h.push(e),Zp(h,c.getCompare())}else return Dc;else{const h=t.get(e.name);let d=s;return h&&(d=d.remove(new He(e.name,h))),d.insert(e,e.node)}});return new As(i,this.indexSet_)}removeFromIndexes(e,t){const i=Dp(this.indexes_,s=>{if(s===Dc)return s;{const o=t.get(e.name);return o?s.remove(new He(e.name,o)):s}});return new As(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $h;class De{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&dk(this.priorityNode_),this.children_.isEmpty()&&ue(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return $h||($h=new De(new pi(zw),null,As.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$h}updatePriority(e){return this.children_.isEmpty()?this:new De(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?$h:t}}getChild(e){const t=ze(e);return t===null?this:this.getImmediateChild(t).getChild(vt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ue(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new He(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const c=s.isEmpty()?$h:this.priorityNode_;return new De(s,c,o)}}updateChild(e,t){const i=ze(e);if(i===null)return t;{ue(ze(e)!==".priority"||so(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(vt(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(wt,(c,h)=>{t[c]=h.val(e),i++,o&&De.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):o=!1}),!e&&o&&s<2*i){const c=[];for(const h in t)c[h]=t[h];return c}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+hk(this.getPriority().val())+":"),this.forEachChild(wt,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":FD(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new He(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new He(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new He(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,He.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,He.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===bf?-1:0}withIndex(e){if(e===zr||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new De(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===zr||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(wt),s=t.getIterator(wt);let o=i.getNext(),c=s.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=i.getNext(),c=s.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(e){return e===zr?null:this.indexMap_.get(e.toString())}}De.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class _z extends De{constructor(){super(new pi(zw),De.EMPTY_NODE,As.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return De.EMPTY_NODE}isEmpty(){return!1}}const bf=new _z;Object.defineProperties(He,{MIN:{value:new He(ro,De.EMPTY_NODE)},MAX:{value:new He(Ms,bf)}});uk.__EMPTY_NODE=De.EMPTY_NODE;_n.__childrenNodeConstructor=De;hz(bf);fz(bf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz=!0;function kt(n,e=null){if(n===null)return De.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ue(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new _n(t,kt(e))}if(!(n instanceof Array)&&yz){const t=[];let i=!1;if(In(n,(c,h)=>{if(c.substring(0,1)!=="."){const d=kt(h);d.isEmpty()||(i=i||!d.getPriority().isEmpty(),t.push(new He(c,d)))}}),t.length===0)return De.EMPTY_NODE;const o=Zp(t,uz,c=>c.name,zw);if(i){const c=Zp(t,wt.getCompare());return new De(o,kt(e),new As({".priority":c},{".priority":wt}))}else return new De(o,kt(e),As.Default)}else{let t=De.EMPTY_NODE;return In(n,(i,s)=>{if(ki(n,i)&&i.substring(0,1)!=="."){const o=kt(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(kt(e))}}dz(kt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw extends Hg{constructor(e){super(),this.indexPath_=e,ue(!qe(e)&&ze(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Ol(e.name,t.name):o}makePost(e,t){const i=kt(e),s=De.EMPTY_NODE.updateChild(this.indexPath_,i);return new He(t,s)}maxPost(){const e=De.EMPTY_NODE.updateChild(this.indexPath_,bf);return new He(Ms,e)}toString(){return Gd(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vz extends Hg{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Ol(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return He.MIN}maxPost(){return He.MAX}makePost(e,t){const i=kt(e);return new He(t,i)}toString(){return".value"}}const Gw=new vz;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(n){return{type:"value",snapshotNode:n}}function du(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Hd(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function $d(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Ez(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.index_=e}updateChild(e,t,i,s,o,c){ue(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(s).equals(i.getChild(s))&&h.isEmpty()===i.isEmpty()||(c!=null&&(i.isEmpty()?e.hasChild(t)?c.trackChildChange(Hd(t,h)):ue(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(du(t,i)):c.trackChildChange($d(t,i,h))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(wt,(s,o)=>{t.hasChild(s)||i.trackChildChange(Hd(s,o))}),t.isLeafNode()||t.forEachChild(wt,(s,o)=>{if(e.hasChild(s)){const c=e.getImmediateChild(s);c.equals(o)||i.trackChildChange($d(s,o,c))}else i.trackChildChange(du(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?De.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e){this.indexedFilter_=new Hw(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Kd.getStartPost_(e),this.endPost_=Kd.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,c){return this.matches(new He(t,i))||(i=De.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,c)}updateFullNode(e,t,i){t.isLeafNode()&&(t=De.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(De.EMPTY_NODE);const o=this;return t.forEachChild(wt,(c,h)=>{o.matches(new He(c,h))||(s=s.updateImmediateChild(c,De.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wz{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Kd(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,c){return this.rangedFilter_.matches(new He(t,i))||(i=De.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,c):this.fullLimitUpdateChild_(e,t,i,o,c)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=De.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=De.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;o.hasNext()&&c<this.limit_;){const h=o.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))s=s.updateImmediateChild(h.name,h.node),c++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(De.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let c=0;for(;o.hasNext();){const h=o.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:s=s.updateImmediateChild(h.name,De.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let c;if(this.reverse_){const v=this.index_.getCompare();c=(T,R)=>v(R,T)}else c=this.index_.getCompare();const h=e;ue(h.numChildren()===this.limit_,"");const d=new He(t,i),p=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),_=this.rangedFilter_.matches(d);if(h.hasChild(t)){const v=h.getImmediateChild(t);let T=s.getChildAfterChild(this.index_,p,this.reverse_);for(;T!=null&&(T.name===t||h.hasChild(T.name));)T=s.getChildAfterChild(this.index_,T,this.reverse_);const R=T==null?1:c(T,d);if(_&&!i.isEmpty()&&R>=0)return o!=null&&o.trackChildChange($d(t,i,v)),h.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(Hd(t,v));const q=h.updateImmediateChild(t,De.EMPTY_NODE);return T!=null&&this.rangedFilter_.matches(T)?(o!=null&&o.trackChildChange(du(T.name,T.node)),q.updateImmediateChild(T.name,T.node)):q}}else return i.isEmpty()?e:_&&c(p,d)>=0?(o!=null&&(o.trackChildChange(Hd(p.name,p.node)),o.trackChildChange(du(t,i))),h.updateImmediateChild(t,i).updateImmediateChild(p.name,De.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=wt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ue(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ue(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ro}hasEnd(){return this.endSet_}getIndexEndValue(){return ue(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ue(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ms}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ue(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===wt}copy(){const e=new $g;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Tz(n){return n.loadsAllData()?new Hw(n.getIndex()):n.hasLimit()?new wz(n):new Kd(n)}function bz(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function Iz(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function k0(n,e,t){const i=n.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,t!=null?(i.startNameSet_=!0,i.indexStartName_=t):(i.startNameSet_=!1,i.indexStartName_=""),i}function Sz(n,e,t){let i;return n.index_===zr||t?i=k0(n,e,t):i=k0(n,e,Ms),i.startAfterSet_=!0,i}function P0(n,e,t){const i=n.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,t!==void 0?(i.endNameSet_=!0,i.indexEndName_=t):(i.endNameSet_=!1,i.indexEndName_=""),i}function Az(n,e,t){let i;return n.index_===zr||t?i=P0(n,e,t):i=P0(n,e,ro),i.endBeforeSet_=!0,i}function Kg(n,e){const t=n.copy();return t.index_=e,t}function aR(n){const e={};if(n.isDefault())return e;let t;if(n.index_===wt?t="$priority":n.index_===Gw?t="$value":n.index_===zr?t="$key":(ue(n.index_ instanceof qw,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=on(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=on(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+on(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=on(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+on(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function oR(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==wt&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg extends ak{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=Tf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ue(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const c=eg.getListenId_(e,i),h={};this.listens_[c]=h;const d=aR(e._queryParams);this.restRequest_(o+".json",d,(p,_)=>{let v=_;if(p===404&&(v=null,p=null),p===null&&this.onDataUpdate_(o,v,!1,i),cl(this.listens_,c)===h){let T;p?p===401?T="permission_denied":T="rest_error:"+p:T="ok",s(T,null)}})}unlisten(e,t){const i=eg.getListenId_(e,t);delete this.listens_[i]}get(e){const t=aR(e._queryParams),i=e._path.toString(),s=new hi;return this.restRequest_(i+".json",t,(o,c)=>{let h=c;o===404&&(h=null,o=null),o===null?(this.onDataUpdate_(i,h,!1,null),s.resolve(h)):s.reject(new Error(h))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Cl(t);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(i&&h.readyState===4){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let d=null;if(h.status>=200&&h.status<300){try{d=vd(h.responseText)}catch{Fn("Failed to parse JSON response for "+c+": "+h.responseText)}i(null,d)}else h.status!==401&&h.status!==404&&Fn("Got unsuccessful REST response for "+c+" Status: "+h.status),i(h.status);i=null}},h.open("GET",c,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cz{constructor(){this.rootNode_=De.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(){return{value:null,children:new Map}}function Nu(n,e,t){if(qe(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=ze(e);n.children.has(i)||n.children.set(i,tg());const s=n.children.get(i);e=vt(e),Nu(s,e,t)}}function O0(n,e){if(qe(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(wt,(i,s)=>{Nu(n,new ct(i),s)}),O0(n,e)}}else if(n.children.size>0){const t=ze(e);return e=vt(e),n.children.has(t)&&O0(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function M0(n,e,t){n.value!==null?t(e,n.value):Rz(n,(i,s)=>{const o=new ct(e.toString()+"/"+i);M0(s,o,t)})}function Rz(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xz{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&In(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=10*1e3,Nz=30*1e3,Dz=300*1e3;class kz{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new xz(e);const i=lR+(Nz-lR)*Math.random();dd(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;In(e,(s,o)=>{o>0&&ki(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),dd(this.reportStats_.bind(this),Math.floor(Math.random()*2*Dz))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ur;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ur||(ur={}));function $w(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Kw(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Qw(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=ur.ACK_USER_WRITE,this.source=$w()}operationForChild(e){if(qe(this.path)){if(this.affectedTree.value!=null)return ue(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ct(e));return new ng(st(),t,this.revert)}}else return ue(ze(this.path)===e,"operationForChild called for unrelated child."),new ng(vt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,t){this.source=e,this.path=t,this.type=ur.LISTEN_COMPLETE}operationForChild(e){return qe(this.path)?new Qd(this.source,st()):new Qd(this.source,vt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=ur.OVERWRITE}operationForChild(e){return qe(this.path)?new Tl(this.source,st(),this.snap.getImmediateChild(e)):new Tl(this.source,vt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=ur.MERGE}operationForChild(e){if(qe(this.path)){const t=this.children.subtree(new ct(e));return t.isEmpty()?null:t.value?new Tl(this.source,st(),t.value):new fu(this.source,st(),t)}else return ue(ze(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new fu(this.source,vt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(qe(e))return this.isFullyInitialized()&&!this.filtered_;const t=ze(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pz{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Oz(n,e,t,i){const s=[],o=[];return e.forEach(c=>{c.type==="child_changed"&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&o.push(Ez(c.childName,c.snapshotNode))}),Kh(n,s,"child_removed",e,i,t),Kh(n,s,"child_added",e,i,t),Kh(n,s,"child_moved",o,i,t),Kh(n,s,"child_changed",e,i,t),Kh(n,s,"value",e,i,t),s}function Kh(n,e,t,i,s,o){const c=i.filter(h=>h.type===t);c.sort((h,d)=>Vz(n,h,d)),c.forEach(h=>{const d=Mz(n,h,o);s.forEach(p=>{p.respondsTo(h.type)&&e.push(p.createEvent(d,n.query_))})})}function Mz(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Vz(n,e,t){if(e.childName==null||t.childName==null)throw gu("Should only compare child_ events.");const i=new He(e.childName,e.snapshotNode),s=new He(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(n,e){return{eventCache:n,serverCache:e}}function fd(n,e,t,i){return Qg(new ao(e,t,i),n.serverCache)}function gk(n,e,t,i){return Qg(n.eventCache,new ao(e,t,i))}function ig(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function bl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bv;const Lz=()=>(Bv||(Bv=new pi(v6)),Bv);class Et{constructor(e,t=Lz()){this.value=e,this.children=t}static fromObject(e){let t=new Et(null);return In(e,(i,s)=>{t=t.set(new ct(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:st(),value:this.value};if(qe(e))return null;{const i=ze(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(vt(e),t);return o!=null?{path:Nt(new ct(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(qe(e))return this;{const t=ze(e),i=this.children.get(t);return i!==null?i.subtree(vt(e)):new Et(null)}}set(e,t){if(qe(e))return new Et(t,this.children);{const i=ze(e),o=(this.children.get(i)||new Et(null)).set(vt(e),t),c=this.children.insert(i,o);return new Et(this.value,c)}}remove(e){if(qe(e))return this.children.isEmpty()?new Et(null):new Et(null,this.children);{const t=ze(e),i=this.children.get(t);if(i){const s=i.remove(vt(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Et(null):new Et(this.value,o)}else return this}}get(e){if(qe(e))return this.value;{const t=ze(e),i=this.children.get(t);return i?i.get(vt(e)):null}}setTree(e,t){if(qe(e))return t;{const i=ze(e),o=(this.children.get(i)||new Et(null)).setTree(vt(e),t);let c;return o.isEmpty()?c=this.children.remove(i):c=this.children.insert(i,o),new Et(this.value,c)}}fold(e){return this.fold_(st(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(Nt(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,st(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(qe(e))return null;{const o=ze(e),c=this.children.get(o);return c?c.findOnPath_(vt(e),Nt(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,st(),t)}foreachOnPath_(e,t,i){if(qe(e))return this;{this.value&&i(t,this.value);const s=ze(e),o=this.children.get(s);return o?o.foreachOnPath_(vt(e),Nt(t,s),i):new Et(null)}}foreach(e){this.foreach_(st(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(Nt(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.writeTree_=e}static empty(){return new dr(new Et(null))}}function md(n,e,t){if(qe(e))return new dr(new Et(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const c=Yn(s,e);return o=o.updateChild(c,t),new dr(n.writeTree_.set(s,o))}else{const s=new Et(t),o=n.writeTree_.setTree(e,s);return new dr(o)}}}function V0(n,e,t){let i=n;return In(t,(s,o)=>{i=md(i,Nt(e,s),o)}),i}function cR(n,e){if(qe(e))return dr.empty();{const t=n.writeTree_.setTree(e,new Et(null));return new dr(t)}}function L0(n,e){return Ml(n,e)!=null}function Ml(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Yn(t.path,e)):null}function uR(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(wt,(i,s)=>{e.push(new He(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new He(i,s.value))}),e}function Ha(n,e){if(qe(e))return n;{const t=Ml(n,e);return t!=null?new dr(new Et(t)):new dr(n.writeTree_.subtree(e))}}function U0(n){return n.writeTree_.isEmpty()}function mu(n,e){return _k(st(),n.writeTree_,e)}function _k(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(ue(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=_k(Nt(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(Nt(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(n,e){return wk(e,n)}function Uz(n,e,t,i,s){ue(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=md(n.visibleWrites,e,t)),n.lastWriteId=i}function Bz(n,e,t,i){ue(i>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:i,visible:!0}),n.visibleWrites=V0(n.visibleWrites,e,t),n.lastWriteId=i}function Fz(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function jz(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);ue(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,c=n.allWrites.length-1;for(;s&&c>=0;){const h=n.allWrites[c];h.visible&&(c>=t&&zz(h,i.path)?s=!1:Wi(i.path,h.path)&&(o=!0)),c--}if(s){if(o)return qz(n),!0;if(i.snap)n.visibleWrites=cR(n.visibleWrites,i.path);else{const h=i.children;In(h,d=>{n.visibleWrites=cR(n.visibleWrites,Nt(i.path,d))})}return!0}else return!1}function zz(n,e){if(n.snap)return Wi(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Wi(Nt(n.path,t),e))return!0;return!1}function qz(n){n.visibleWrites=yk(n.allWrites,Gz,st()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Gz(n){return n.visible}function yk(n,e,t){let i=dr.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const c=o.path;let h;if(o.snap)Wi(t,c)?(h=Yn(t,c),i=md(i,h,o.snap)):Wi(c,t)&&(h=Yn(c,t),i=md(i,st(),o.snap.getChild(h)));else if(o.children){if(Wi(t,c))h=Yn(t,c),i=V0(i,h,o.children);else if(Wi(c,t))if(h=Yn(c,t),qe(h))i=V0(i,st(),o.children);else{const d=cl(o.children,ze(h));if(d){const p=d.getChild(vt(h));i=md(i,st(),p)}}}else throw gu("WriteRecord should have .snap or .children")}}return i}function vk(n,e,t,i,s){if(!i&&!s){const o=Ml(n.visibleWrites,e);if(o!=null)return o;{const c=Ha(n.visibleWrites,e);if(U0(c))return t;if(t==null&&!L0(c,st()))return null;{const h=t||De.EMPTY_NODE;return mu(c,h)}}}else{const o=Ha(n.visibleWrites,e);if(!s&&U0(o))return t;if(!s&&t==null&&!L0(o,st()))return null;{const c=function(p){return(p.visible||s)&&(!i||!~i.indexOf(p.writeId))&&(Wi(p.path,e)||Wi(e,p.path))},h=yk(n.allWrites,c,e),d=t||De.EMPTY_NODE;return mu(h,d)}}}function Hz(n,e,t){let i=De.EMPTY_NODE;const s=Ml(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(wt,(o,c)=>{i=i.updateImmediateChild(o,c)}),i;if(t){const o=Ha(n.visibleWrites,e);return t.forEachChild(wt,(c,h)=>{const d=mu(Ha(o,new ct(c)),h);i=i.updateImmediateChild(c,d)}),uR(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}else{const o=Ha(n.visibleWrites,e);return uR(o).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}}function $z(n,e,t,i,s){ue(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=Nt(e,t);if(L0(n.visibleWrites,o))return null;{const c=Ha(n.visibleWrites,o);return U0(c)?s.getChild(t):mu(c,s.getChild(t))}}function Kz(n,e,t,i){const s=Nt(e,t),o=Ml(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const c=Ha(n.visibleWrites,s);return mu(c,i.getNode().getImmediateChild(t))}else return null}function Qz(n,e){return Ml(n.visibleWrites,e)}function Wz(n,e,t,i,s,o,c){let h;const d=Ha(n.visibleWrites,e),p=Ml(d,st());if(p!=null)h=p;else if(t!=null)h=mu(d,t);else return[];if(h=h.withIndex(c),!h.isEmpty()&&!h.isLeafNode()){const _=[],v=c.getCompare(),T=o?h.getReverseIteratorFrom(i,c):h.getIteratorFrom(i,c);let R=T.getNext();for(;R&&_.length<s;)v(R,i)!==0&&_.push(R),R=T.getNext();return _}else return[]}function Yz(){return{visibleWrites:dr.empty(),allWrites:[],lastWriteId:-1}}function rg(n,e,t,i){return vk(n.writeTree,n.treePath,e,t,i)}function Ww(n,e){return Hz(n.writeTree,n.treePath,e)}function hR(n,e,t,i){return $z(n.writeTree,n.treePath,e,t,i)}function sg(n,e){return Qz(n.writeTree,Nt(n.treePath,e))}function Xz(n,e,t,i,s,o){return Wz(n.writeTree,n.treePath,e,t,i,s,o)}function Yw(n,e,t){return Kz(n.writeTree,n.treePath,e,t)}function Ek(n,e){return wk(Nt(n.treePath,e),n.writeTree)}function wk(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jz{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;ue(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ue(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,$d(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,Hd(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,du(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,$d(i,e.snapshotNode,s.oldSnap));else throw gu("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const Tk=new Zz;class Xw{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new ao(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Yw(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:bl(this.viewCache_),o=Xz(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e9(n){return{filter:n}}function t9(n,e){ue(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ue(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function n9(n,e,t,i,s){const o=new Jz;let c,h;if(t.type===ur.OVERWRITE){const p=t;p.source.fromUser?c=B0(n,e,p.path,p.snap,i,s,o):(ue(p.source.fromServer,"Unknown source."),h=p.source.tagged||e.serverCache.isFiltered()&&!qe(p.path),c=ag(n,e,p.path,p.snap,i,s,h,o))}else if(t.type===ur.MERGE){const p=t;p.source.fromUser?c=r9(n,e,p.path,p.children,i,s,o):(ue(p.source.fromServer,"Unknown source."),h=p.source.tagged||e.serverCache.isFiltered(),c=F0(n,e,p.path,p.children,i,s,h,o))}else if(t.type===ur.ACK_USER_WRITE){const p=t;p.revert?c=o9(n,e,p.path,i,s,o):c=s9(n,e,p.path,p.affectedTree,i,s,o)}else if(t.type===ur.LISTEN_COMPLETE)c=a9(n,e,t.path,i,o);else throw gu("Unknown operation type: "+t.type);const d=o.getChanges();return i9(e,c,d),{viewCache:c,changes:d}}function i9(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=ig(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(pk(ig(e)))}}function bk(n,e,t,i,s,o){const c=e.eventCache;if(sg(i,t)!=null)return e;{let h,d;if(qe(t))if(ue(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const p=bl(e),_=p instanceof De?p:De.EMPTY_NODE,v=Ww(i,_);h=n.filter.updateFullNode(e.eventCache.getNode(),v,o)}else{const p=rg(i,bl(e));h=n.filter.updateFullNode(e.eventCache.getNode(),p,o)}else{const p=ze(t);if(p===".priority"){ue(so(t)===1,"Can't have a priority with additional path components");const _=c.getNode();d=e.serverCache.getNode();const v=hR(i,t,_,d);v!=null?h=n.filter.updatePriority(_,v):h=c.getNode()}else{const _=vt(t);let v;if(c.isCompleteForChild(p)){d=e.serverCache.getNode();const T=hR(i,t,c.getNode(),d);T!=null?v=c.getNode().getImmediateChild(p).updateChild(_,T):v=c.getNode().getImmediateChild(p)}else v=Yw(i,p,e.serverCache);v!=null?h=n.filter.updateChild(c.getNode(),p,v,_,s,o):h=c.getNode()}}return fd(e,h,c.isFullyInitialized()||qe(t),n.filter.filtersNodes())}}function ag(n,e,t,i,s,o,c,h){const d=e.serverCache;let p;const _=c?n.filter:n.filter.getIndexedFilter();if(qe(t))p=_.updateFullNode(d.getNode(),i,null);else if(_.filtersNodes()&&!d.isFiltered()){const R=d.getNode().updateChild(t,i);p=_.updateFullNode(d.getNode(),R,null)}else{const R=ze(t);if(!d.isCompleteForPath(t)&&so(t)>1)return e;const P=vt(t),Y=d.getNode().getImmediateChild(R).updateChild(P,i);R===".priority"?p=_.updatePriority(d.getNode(),Y):p=_.updateChild(d.getNode(),R,Y,P,Tk,null)}const v=gk(e,p,d.isFullyInitialized()||qe(t),_.filtersNodes()),T=new Xw(s,v,o);return bk(n,v,t,s,T,h)}function B0(n,e,t,i,s,o,c){const h=e.eventCache;let d,p;const _=new Xw(s,e,o);if(qe(t))p=n.filter.updateFullNode(e.eventCache.getNode(),i,c),d=fd(e,p,!0,n.filter.filtersNodes());else{const v=ze(t);if(v===".priority")p=n.filter.updatePriority(e.eventCache.getNode(),i),d=fd(e,p,h.isFullyInitialized(),h.isFiltered());else{const T=vt(t),R=h.getNode().getImmediateChild(v);let P;if(qe(T))P=i;else{const q=_.getCompleteChild(v);q!=null?Bw(T)===".priority"&&q.getChild(lk(T)).isEmpty()?P=q:P=q.updateChild(T,i):P=De.EMPTY_NODE}if(R.equals(P))d=e;else{const q=n.filter.updateChild(h.getNode(),v,P,T,_,c);d=fd(e,q,h.isFullyInitialized(),n.filter.filtersNodes())}}}return d}function dR(n,e){return n.eventCache.isCompleteForChild(e)}function r9(n,e,t,i,s,o,c){let h=e;return i.foreach((d,p)=>{const _=Nt(t,d);dR(e,ze(_))&&(h=B0(n,h,_,p,s,o,c))}),i.foreach((d,p)=>{const _=Nt(t,d);dR(e,ze(_))||(h=B0(n,h,_,p,s,o,c))}),h}function fR(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function F0(n,e,t,i,s,o,c,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let d=e,p;qe(t)?p=i:p=new Et(null).setTree(t,i);const _=e.serverCache.getNode();return p.children.inorderTraversal((v,T)=>{if(_.hasChild(v)){const R=e.serverCache.getNode().getImmediateChild(v),P=fR(n,R,T);d=ag(n,d,new ct(v),P,s,o,c,h)}}),p.children.inorderTraversal((v,T)=>{const R=!e.serverCache.isCompleteForChild(v)&&T.value===null;if(!_.hasChild(v)&&!R){const P=e.serverCache.getNode().getImmediateChild(v),q=fR(n,P,T);d=ag(n,d,new ct(v),q,s,o,c,h)}}),d}function s9(n,e,t,i,s,o,c){if(sg(s,t)!=null)return e;const h=e.serverCache.isFiltered(),d=e.serverCache;if(i.value!=null){if(qe(t)&&d.isFullyInitialized()||d.isCompleteForPath(t))return ag(n,e,t,d.getNode().getChild(t),s,o,h,c);if(qe(t)){let p=new Et(null);return d.getNode().forEachChild(zr,(_,v)=>{p=p.set(new ct(_),v)}),F0(n,e,t,p,s,o,h,c)}else return e}else{let p=new Et(null);return i.foreach((_,v)=>{const T=Nt(t,_);d.isCompleteForPath(T)&&(p=p.set(_,d.getNode().getChild(T)))}),F0(n,e,t,p,s,o,h,c)}}function a9(n,e,t,i,s){const o=e.serverCache,c=gk(e,o.getNode(),o.isFullyInitialized()||qe(t),o.isFiltered());return bk(n,c,t,i,Tk,s)}function o9(n,e,t,i,s,o){let c;if(sg(i,t)!=null)return e;{const h=new Xw(i,e,s),d=e.eventCache.getNode();let p;if(qe(t)||ze(t)===".priority"){let _;if(e.serverCache.isFullyInitialized())_=rg(i,bl(e));else{const v=e.serverCache.getNode();ue(v instanceof De,"serverChildren would be complete if leaf node"),_=Ww(i,v)}_=_,p=n.filter.updateFullNode(d,_,o)}else{const _=ze(t);let v=Yw(i,_,e.serverCache);v==null&&e.serverCache.isCompleteForChild(_)&&(v=d.getImmediateChild(_)),v!=null?p=n.filter.updateChild(d,_,v,vt(t),h,o):e.eventCache.getNode().hasChild(_)?p=n.filter.updateChild(d,_,De.EMPTY_NODE,vt(t),h,o):p=d,p.isEmpty()&&e.serverCache.isFullyInitialized()&&(c=rg(i,bl(e)),c.isLeafNode()&&(p=n.filter.updateFullNode(p,c,o)))}return c=e.serverCache.isFullyInitialized()||sg(i,st())!=null,fd(e,p,c,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new Hw(i.getIndex()),o=Tz(i);this.processor_=e9(o);const c=t.serverCache,h=t.eventCache,d=s.updateFullNode(De.EMPTY_NODE,c.getNode(),null),p=o.updateFullNode(De.EMPTY_NODE,h.getNode(),null),_=new ao(d,c.isFullyInitialized(),s.filtersNodes()),v=new ao(p,h.isFullyInitialized(),o.filtersNodes());this.viewCache_=Qg(v,_),this.eventGenerator_=new Pz(this.query_)}get query(){return this.query_}}function c9(n){return n.viewCache_.serverCache.getNode()}function u9(n){return ig(n.viewCache_)}function h9(n,e){const t=bl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!qe(e)&&!t.getImmediateChild(ze(e)).isEmpty())?t.getChild(e):null}function mR(n){return n.eventRegistrations_.length===0}function d9(n,e){n.eventRegistrations_.push(e)}function pR(n,e,t){const i=[];if(t){ue(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const c=o.createCancelEvent(t,s);c&&i.push(c)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const c=n.eventRegistrations_[o];if(!c.matches(e))s.push(c);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function gR(n,e,t,i){e.type===ur.MERGE&&e.source.queryId!==null&&(ue(bl(n.viewCache_),"We should always have a full cache before handling merges"),ue(ig(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=n9(n.processor_,s,e,t,i);return t9(n.processor_,o.viewCache),ue(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,Ik(n,o.changes,o.viewCache.eventCache.getNode(),null)}function f9(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(wt,(o,c)=>{i.push(du(o,c))}),t.isFullyInitialized()&&i.push(pk(t.getNode())),Ik(n,i,t.getNode(),e)}function Ik(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Oz(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let og;class Sk{constructor(){this.views=new Map}}function m9(n){ue(!og,"__referenceConstructor has already been defined"),og=n}function p9(){return ue(og,"Reference.ts has not been loaded"),og}function g9(n){return n.views.size===0}function Jw(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return ue(o!=null,"SyncTree gave us an op for an invalid query."),gR(o,e,t,i)}else{let o=[];for(const c of n.views.values())o=o.concat(gR(c,e,t,i));return o}}function Ak(n,e,t,i,s){const o=e._queryIdentifier,c=n.views.get(o);if(!c){let h=rg(t,s?i:null),d=!1;h?d=!0:i instanceof De?(h=Ww(t,i),d=!1):(h=De.EMPTY_NODE,d=!1);const p=Qg(new ao(h,d,!1),new ao(i,s,!1));return new l9(e,p)}return c}function _9(n,e,t,i,s,o){const c=Ak(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,c),d9(c,t),f9(c,t)}function y9(n,e,t,i){const s=e._queryIdentifier,o=[];let c=[];const h=oo(n);if(s==="default")for(const[d,p]of n.views.entries())c=c.concat(pR(p,t,i)),mR(p)&&(n.views.delete(d),p.query._queryParams.loadsAllData()||o.push(p.query));else{const d=n.views.get(s);d&&(c=c.concat(pR(d,t,i)),mR(d)&&(n.views.delete(s),d.query._queryParams.loadsAllData()||o.push(d.query)))}return h&&!oo(n)&&o.push(new(p9())(e._repo,e._path)),{removed:o,events:c}}function Ck(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function $a(n,e){let t=null;for(const i of n.views.values())t=t||h9(i,e);return t}function Rk(n,e){if(e._queryParams.loadsAllData())return Yg(n);{const i=e._queryIdentifier;return n.views.get(i)}}function xk(n,e){return Rk(n,e)!=null}function oo(n){return Yg(n)!=null}function Yg(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lg;function v9(n){ue(!lg,"__referenceConstructor has already been defined"),lg=n}function E9(){return ue(lg,"Reference.ts has not been loaded"),lg}let w9=1;class _R{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Et(null),this.pendingWriteTree_=Yz(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Zw(n,e,t,i,s){return Uz(n.pendingWriteTree_,e,t,i,s),s?Du(n,new Tl($w(),e,t)):[]}function T9(n,e,t,i){Bz(n.pendingWriteTree_,e,t,i);const s=Et.fromObject(t);return Du(n,new fu($w(),e,s))}function ja(n,e,t=!1){const i=Fz(n.pendingWriteTree_,e);if(jz(n.pendingWriteTree_,e)){let o=new Et(null);return i.snap!=null?o=o.set(st(),!0):In(i.children,c=>{o=o.set(new ct(c),!0)}),Du(n,new ng(i.path,o,t))}else return[]}function If(n,e,t){return Du(n,new Tl(Kw(),e,t))}function b9(n,e,t){const i=Et.fromObject(t);return Du(n,new fu(Kw(),e,i))}function I9(n,e){return Du(n,new Qd(Kw(),e))}function S9(n,e,t){const i=eT(n,t);if(i){const s=tT(i),o=s.path,c=s.queryId,h=Yn(o,e),d=new Qd(Qw(c),h);return nT(n,o,d)}else return[]}function cg(n,e,t,i,s=!1){const o=e._path,c=n.syncPointTree_.get(o);let h=[];if(c&&(e._queryIdentifier==="default"||xk(c,e))){const d=y9(c,e,t,i);g9(c)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const p=d.removed;if(h=d.events,!s){const _=p.findIndex(T=>T._queryParams.loadsAllData())!==-1,v=n.syncPointTree_.findOnPath(o,(T,R)=>oo(R));if(_&&!v){const T=n.syncPointTree_.subtree(o);if(!T.isEmpty()){const R=R9(T);for(let P=0;P<R.length;++P){const q=R[P],Y=q.query,le=Pk(n,q);n.listenProvider_.startListening(pd(Y),Wd(n,Y),le.hashFn,le.onComplete)}}}!v&&p.length>0&&!i&&(_?n.listenProvider_.stopListening(pd(e),null):p.forEach(T=>{const R=n.queryToTagMap.get(Jg(T));n.listenProvider_.stopListening(pd(T),R)}))}x9(n,p)}return h}function Nk(n,e,t,i){const s=eT(n,i);if(s!=null){const o=tT(s),c=o.path,h=o.queryId,d=Yn(c,e),p=new Tl(Qw(h),d,t);return nT(n,c,p)}else return[]}function A9(n,e,t,i){const s=eT(n,i);if(s){const o=tT(s),c=o.path,h=o.queryId,d=Yn(c,e),p=Et.fromObject(t),_=new fu(Qw(h),d,p);return nT(n,c,_)}else return[]}function j0(n,e,t,i=!1){const s=e._path;let o=null,c=!1;n.syncPointTree_.foreachOnPath(s,(T,R)=>{const P=Yn(T,s);o=o||$a(R,P),c=c||oo(R)});let h=n.syncPointTree_.get(s);h?(c=c||oo(h),o=o||$a(h,st())):(h=new Sk,n.syncPointTree_=n.syncPointTree_.set(s,h));let d;o!=null?d=!0:(d=!1,o=De.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((R,P)=>{const q=$a(P,st());q&&(o=o.updateImmediateChild(R,q))}));const p=xk(h,e);if(!p&&!e._queryParams.loadsAllData()){const T=Jg(e);ue(!n.queryToTagMap.has(T),"View does not exist, but we have a tag");const R=N9();n.queryToTagMap.set(T,R),n.tagToQueryMap.set(R,T)}const _=Wg(n.pendingWriteTree_,s);let v=_9(h,e,t,_,o,d);if(!p&&!c&&!i){const T=Rk(h,e);v=v.concat(D9(n,e,T))}return v}function Xg(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(c,h)=>{const d=Yn(c,e),p=$a(h,d);if(p)return p});return vk(s,e,o,t,!0)}function C9(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(p,_)=>{const v=Yn(p,t);i=i||$a(_,v)});let s=n.syncPointTree_.get(t);s?i=i||$a(s,st()):(s=new Sk,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,c=o?new ao(i,!0,!1):null,h=Wg(n.pendingWriteTree_,e._path),d=Ak(s,e,h,o?c.getNode():De.EMPTY_NODE,o);return u9(d)}function Du(n,e){return Dk(e,n.syncPointTree_,null,Wg(n.pendingWriteTree_,st()))}function Dk(n,e,t,i){if(qe(n.path))return kk(n,e,t,i);{const s=e.get(st());t==null&&s!=null&&(t=$a(s,st()));let o=[];const c=ze(n.path),h=n.operationForChild(c),d=e.children.get(c);if(d&&h){const p=t?t.getImmediateChild(c):null,_=Ek(i,c);o=o.concat(Dk(h,d,p,_))}return s&&(o=o.concat(Jw(s,n,i,t))),o}}function kk(n,e,t,i){const s=e.get(st());t==null&&s!=null&&(t=$a(s,st()));let o=[];return e.children.inorderTraversal((c,h)=>{const d=t?t.getImmediateChild(c):null,p=Ek(i,c),_=n.operationForChild(c);_&&(o=o.concat(kk(_,h,d,p)))}),s&&(o=o.concat(Jw(s,n,i,t))),o}function Pk(n,e){const t=e.query,i=Wd(n,t);return{hashFn:()=>(c9(e)||De.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?S9(n,t._path,i):I9(n,t._path);{const o=T6(s,t);return cg(n,t,null,o)}}}}function Wd(n,e){const t=Jg(e);return n.queryToTagMap.get(t)}function Jg(n){return n._path.toString()+"$"+n._queryIdentifier}function eT(n,e){return n.tagToQueryMap.get(e)}function tT(n){const e=n.indexOf("$");return ue(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ct(n.substr(0,e))}}function nT(n,e,t){const i=n.syncPointTree_.get(e);ue(i,"Missing sync point for query tag that we're tracking");const s=Wg(n.pendingWriteTree_,e);return Jw(i,t,s,null)}function R9(n){return n.fold((e,t,i)=>{if(t&&oo(t))return[Yg(t)];{let s=[];return t&&(s=Ck(t)),In(i,(o,c)=>{s=s.concat(c)}),s}})}function pd(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(E9())(n._repo,n._path):n}function x9(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=Jg(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function N9(){return w9++}function D9(n,e,t){const i=e._path,s=Wd(n,e),o=Pk(n,t),c=n.listenProvider_.startListening(pd(e),s,o.hashFn,o.onComplete),h=n.syncPointTree_.subtree(i);if(s)ue(!oo(h.value),"If we're adding a query, it shouldn't be shadowed");else{const d=h.fold((p,_,v)=>{if(!qe(p)&&_&&oo(_))return[Yg(_).query];{let T=[];return _&&(T=T.concat(Ck(_).map(R=>R.query))),In(v,(R,P)=>{T=T.concat(P)}),T}});for(let p=0;p<d.length;++p){const _=d[p];n.listenProvider_.stopListening(pd(_),Wd(n,_))}}return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new iT(t)}node(){return this.node_}}class rT{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Nt(this.path_,e);return new rT(this.syncTree_,t)}node(){return Xg(this.syncTree_,this.path_)}}const k9=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},yR=function(n,e,t){if(!n||typeof n!="object")return n;if(ue(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return P9(n[".sv"],e,t);if(typeof n[".sv"]=="object")return O9(n[".sv"],e);ue(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},P9=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ue(!1,"Unexpected server value: "+n)}},O9=function(n,e,t){n.hasOwnProperty("increment")||ue(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&ue(!1,"Unexpected increment value: "+i);const s=e.node();if(ue(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const c=s.getValue();return typeof c!="number"?i:c+i},Ok=function(n,e,t,i){return aT(e,new rT(t,n),i)},sT=function(n,e,t){return aT(n,new iT(e),t)};function aT(n,e,t){const i=n.getPriority().val(),s=yR(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const c=n,h=yR(c.getValue(),e,t);return h!==c.getValue()||s!==c.getPriority().val()?new _n(h,kt(s)):n}else{const c=n;return o=c,s!==c.getPriority().val()&&(o=o.updatePriority(new _n(s))),c.forEachChild(wt,(h,d)=>{const p=aT(d,e.getImmediateChild(h),t);p!==d&&(o=o.updateImmediateChild(h,p))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function Zg(n,e){let t=e instanceof ct?e:new ct(e),i=n,s=ze(t);for(;s!==null;){const o=cl(i.node.children,s)||{children:{},childCount:0};i=new oT(s,i,o),t=vt(t),s=ze(t)}return i}function Vl(n){return n.node.value}function lT(n,e){n.node.value=e,z0(n)}function Mk(n){return n.node.childCount>0}function M9(n){return Vl(n)===void 0&&!Mk(n)}function e_(n,e){In(n.node.children,(t,i)=>{e(new oT(t,n,i))})}function Vk(n,e,t,i){t&&e(n),e_(n,s=>{Vk(s,e,!0)})}function V9(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Sf(n){return new ct(n.parent===null?n.name:Sf(n.parent)+"/"+n.name)}function z0(n){n.parent!==null&&L9(n.parent,n.name,n)}function L9(n,e,t){const i=M9(t),s=ki(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,z0(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,z0(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U9=/[\[\].#$\/\u0000-\u001F\u007F]/,B9=/[\[\].#$\u0000-\u001F\u007F]/,Fv=10*1024*1024,t_=function(n){return typeof n=="string"&&n.length!==0&&!U9.test(n)},Lk=function(n){return typeof n=="string"&&n.length!==0&&!B9.test(n)},F9=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Lk(n)},Yd=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!Gg(n)||n&&typeof n=="object"&&ki(n,".sv")},Qr=function(n,e,t,i){i&&e===void 0||Af(gi(n,"value"),e,t)},Af=function(n,e,t){const i=t instanceof ct?new nz(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Wo(i));if(typeof e=="function")throw new Error(n+"contains a function "+Wo(i)+" with contents = "+e.toString());if(Gg(e))throw new Error(n+"contains "+e.toString()+" "+Wo(i));if(typeof e=="string"&&e.length>Fv/3&&hg(e)>Fv)throw new Error(n+"contains a string greater than "+Fv+" utf8 bytes "+Wo(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(In(e,(c,h)=>{if(c===".value")s=!0;else if(c!==".priority"&&c!==".sv"&&(o=!0,!t_(c)))throw new Error(n+" contains an invalid key ("+c+") "+Wo(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);iz(i,c),Af(n,h,i),rz(i)}),s&&o)throw new Error(n+' contains ".value" child '+Wo(i)+" in addition to actual children.")}},j9=function(n,e){let t,i;for(t=0;t<e.length;t++){i=e[t];const o=Gd(i);for(let c=0;c<o.length;c++)if(!(o[c]===".priority"&&c===o.length-1)){if(!t_(o[c]))throw new Error(n+"contains an invalid key ("+o[c]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(tz);let s=null;for(t=0;t<e.length;t++){if(i=e[t],s!==null&&Wi(s,i))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},Uk=function(n,e,t,i){const s=gi(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const o=[];In(e,(c,h)=>{const d=new ct(c);if(Af(s,h,Nt(t,d)),Bw(d)===".priority"&&!Yd(h))throw new Error(s+"contains an invalid value for '"+d.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(d)}),j9(s,o)},cT=function(n,e,t){if(Gg(e))throw new Error(gi(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Yd(e))throw new Error(gi(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Cf=function(n,e,t,i){if(t!==void 0&&!t_(t))throw new Error(gi(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Xd=function(n,e,t,i){if(!Lk(t))throw new Error(gi(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},z9=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Xd(n,e,t)},Yi=function(n,e){if(ze(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},Bk=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!t_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!F9(t))throw new Error(gi(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function n_(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!Fw(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Fk(n,e,t){n_(n,t),jk(n,i=>Fw(i,e))}function Oi(n,e,t){n_(n,t),jk(n,i=>Wi(i,e)||Wi(e,i))}function jk(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(G9(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function G9(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();ll&&Tn("event: "+t.toString()),xu(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk="repo_interrupt",H9=25;class $9{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new q9,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tg(),this.transactionQueueTree_=new oT,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function K9(n,e,t){if(n.stats_=Lw(n.repoInfo_),n.forceRestClient_||A6())n.server_=new eg(n.repoInfo_,(i,s,o,c)=>{vR(n,i,s,o,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>ER(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{on(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new xs(n.repoInfo_,e,(i,s,o,c)=>{vR(n,i,s,o,c)},i=>{ER(n,i)},i=>{Q9(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=D6(n.repoInfo_,()=>new kz(n.stats_,n.server_)),n.infoData_=new Cz,n.infoSyncTree_=new _R({startListening:(i,s,o,c)=>{let h=[];const d=n.infoData_.getNode(i._path);return d.isEmpty()||(h=If(n.infoSyncTree_,i._path,d),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),uT(n,"connected",!1),n.serverSyncTree_=new _R({startListening:(i,s,o,c)=>(n.server_.listen(i,o,s,(h,d)=>{const p=c(h,d);Oi(n.eventQueue_,i._path,p)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function qk(n){const t=n.infoData_.getNode(new ct(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Rf(n){return k9({timestamp:qk(n)})}function vR(n,e,t,i,s){n.dataUpdateCount++;const o=new ct(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let c=[];if(s)if(i){const d=Dp(t,p=>kt(p));c=A9(n.serverSyncTree_,o,d,s)}else{const d=kt(t);c=Nk(n.serverSyncTree_,o,d,s)}else if(i){const d=Dp(t,p=>kt(p));c=b9(n.serverSyncTree_,o,d)}else{const d=kt(t);c=If(n.serverSyncTree_,o,d)}let h=o;c.length>0&&(h=pu(n,o)),Oi(n.eventQueue_,h,c)}function ER(n,e){uT(n,"connected",e),e===!1&&X9(n)}function Q9(n,e){In(e,(t,i)=>{uT(n,t,i)})}function uT(n,e,t){const i=new ct("/.info/"+e),s=kt(t);n.infoData_.updateSnapshot(i,s);const o=If(n.infoSyncTree_,i,s);Oi(n.eventQueue_,i,o)}function i_(n){return n.nextWriteId_++}function W9(n,e,t){const i=C9(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=kt(s).withIndex(e._queryParams.getIndex());j0(n.serverSyncTree_,e,t,!0);let c;if(e._queryParams.loadsAllData())c=If(n.serverSyncTree_,e._path,o);else{const h=Wd(n.serverSyncTree_,e);c=Nk(n.serverSyncTree_,e._path,o,h)}return Oi(n.eventQueue_,e._path,c),cg(n.serverSyncTree_,e,t,null,!0),o},s=>(ku(n,"get for query "+on(e)+" failed: "+s),Promise.reject(new Error(s))))}function hT(n,e,t,i,s){ku(n,"set",{path:e.toString(),value:t,priority:i});const o=Rf(n),c=kt(t,i),h=Xg(n.serverSyncTree_,e),d=sT(c,h,o),p=i_(n),_=Zw(n.serverSyncTree_,e,d,p,!0);n_(n.eventQueue_,_),n.server_.put(e.toString(),c.val(!0),(T,R)=>{const P=T==="ok";P||Fn("set at "+e+" failed: "+T);const q=ja(n.serverSyncTree_,p,!P);Oi(n.eventQueue_,e,q),lo(n,s,T,R)});const v=fT(n,e);pu(n,v),Oi(n.eventQueue_,v,[])}function Y9(n,e,t,i){ku(n,"update",{path:e.toString(),value:t});let s=!0;const o=Rf(n),c={};if(In(t,(h,d)=>{s=!1,c[h]=Ok(Nt(e,h),kt(d),n.serverSyncTree_,o)}),s)Tn("update() called with empty data.  Don't do anything."),lo(n,i,"ok",void 0);else{const h=i_(n),d=T9(n.serverSyncTree_,e,c,h);n_(n.eventQueue_,d),n.server_.merge(e.toString(),t,(p,_)=>{const v=p==="ok";v||Fn("update at "+e+" failed: "+p);const T=ja(n.serverSyncTree_,h,!v),R=T.length>0?pu(n,e):e;Oi(n.eventQueue_,R,T),lo(n,i,p,_)}),In(t,p=>{const _=fT(n,Nt(e,p));pu(n,_)}),Oi(n.eventQueue_,e,[])}}function X9(n){ku(n,"onDisconnectEvents");const e=Rf(n),t=tg();M0(n.onDisconnect_,st(),(s,o)=>{const c=Ok(s,o,n.serverSyncTree_,e);Nu(t,s,c)});let i=[];M0(t,st(),(s,o)=>{i=i.concat(If(n.serverSyncTree_,s,o));const c=fT(n,s);pu(n,c)}),n.onDisconnect_=tg(),Oi(n.eventQueue_,st(),i)}function J9(n,e,t){n.server_.onDisconnectCancel(e.toString(),(i,s)=>{i==="ok"&&O0(n.onDisconnect_,e),lo(n,t,i,s)})}function wR(n,e,t,i){const s=kt(t);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,c)=>{o==="ok"&&Nu(n.onDisconnect_,e,s),lo(n,i,o,c)})}function Z9(n,e,t,i,s){const o=kt(t,i);n.server_.onDisconnectPut(e.toString(),o.val(!0),(c,h)=>{c==="ok"&&Nu(n.onDisconnect_,e,o),lo(n,s,c,h)})}function eq(n,e,t,i){if(Np(t)){Tn("onDisconnect().update() called with empty data.  Don't do anything."),lo(n,i,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(s,o)=>{s==="ok"&&In(t,(c,h)=>{const d=kt(h);Nu(n.onDisconnect_,Nt(e,c),d)}),lo(n,i,s,o)})}function tq(n,e,t){let i;ze(e._path)===".info"?i=j0(n.infoSyncTree_,e,t):i=j0(n.serverSyncTree_,e,t),Fk(n.eventQueue_,e._path,i)}function q0(n,e,t){let i;ze(e._path)===".info"?i=cg(n.infoSyncTree_,e,t):i=cg(n.serverSyncTree_,e,t),Fk(n.eventQueue_,e._path,i)}function Gk(n){n.persistentConnection_&&n.persistentConnection_.interrupt(zk)}function nq(n){n.persistentConnection_&&n.persistentConnection_.resume(zk)}function ku(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Tn(t,...e)}function lo(n,e,t,i){e&&xu(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const c=new Error(o);c.code=s,e(c)}})}function iq(n,e,t,i,s,o){ku(n,"transaction on "+e);const c={path:e,update:t,onComplete:i,status:null,order:BD(),applyLocally:o,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=dT(n,e,void 0);c.currentInputSnapshot=h;const d=c.update(h.val());if(d===void 0)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Af("transaction failed: Data returned ",d,c.path),c.status=0;const p=Zg(n.transactionQueueTree_,e),_=Vl(p)||[];_.push(c),lT(p,_);let v;typeof d=="object"&&d!==null&&ki(d,".priority")?(v=cl(d,".priority"),ue(Yd(v),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):v=(Xg(n.serverSyncTree_,e)||De.EMPTY_NODE).getPriority().val();const T=Rf(n),R=kt(d,v),P=sT(R,h,T);c.currentOutputSnapshotRaw=R,c.currentOutputSnapshotResolved=P,c.currentWriteId=i_(n);const q=Zw(n.serverSyncTree_,e,P,c.currentWriteId,c.applyLocally);Oi(n.eventQueue_,e,q),r_(n,n.transactionQueueTree_)}}function dT(n,e,t){return Xg(n.serverSyncTree_,e,t)||De.EMPTY_NODE}function r_(n,e=n.transactionQueueTree_){if(e||s_(n,e),Vl(e)){const t=$k(n,e);ue(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&rq(n,Sf(e),t)}else Mk(e)&&e_(e,t=>{r_(n,t)})}function rq(n,e,t){const i=t.map(p=>p.currentWriteId),s=dT(n,e,i);let o=s;const c=s.hash();for(let p=0;p<t.length;p++){const _=t[p];ue(_.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),_.status=1,_.retryCount++;const v=Yn(e,_.path);o=o.updateChild(v,_.currentOutputSnapshotRaw)}const h=o.val(!0),d=e;n.server_.put(d.toString(),h,p=>{ku(n,"transaction put response",{path:d.toString(),status:p});let _=[];if(p==="ok"){const v=[];for(let T=0;T<t.length;T++)t[T].status=2,_=_.concat(ja(n.serverSyncTree_,t[T].currentWriteId)),t[T].onComplete&&v.push(()=>t[T].onComplete(null,!0,t[T].currentOutputSnapshotResolved)),t[T].unwatcher();s_(n,Zg(n.transactionQueueTree_,e)),r_(n,n.transactionQueueTree_),Oi(n.eventQueue_,e,_);for(let T=0;T<v.length;T++)xu(v[T])}else{if(p==="datastale")for(let v=0;v<t.length;v++)t[v].status===3?t[v].status=4:t[v].status=0;else{Fn("transaction at "+d.toString()+" failed: "+p);for(let v=0;v<t.length;v++)t[v].status=4,t[v].abortReason=p}pu(n,e)}},c)}function pu(n,e){const t=Hk(n,e),i=Sf(t),s=$k(n,t);return sq(n,s,i),i}function sq(n,e,t){if(e.length===0)return;const i=[];let s=[];const c=e.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const d=e[h],p=Yn(t,d.path);let _=!1,v;if(ue(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),d.status===4)_=!0,v=d.abortReason,s=s.concat(ja(n.serverSyncTree_,d.currentWriteId,!0));else if(d.status===0)if(d.retryCount>=H9)_=!0,v="maxretry",s=s.concat(ja(n.serverSyncTree_,d.currentWriteId,!0));else{const T=dT(n,d.path,c);d.currentInputSnapshot=T;const R=e[h].update(T.val());if(R!==void 0){Af("transaction failed: Data returned ",R,d.path);let P=kt(R);typeof R=="object"&&R!=null&&ki(R,".priority")||(P=P.updatePriority(T.getPriority()));const Y=d.currentWriteId,le=Rf(n),Ee=sT(P,T,le);d.currentOutputSnapshotRaw=P,d.currentOutputSnapshotResolved=Ee,d.currentWriteId=i_(n),c.splice(c.indexOf(Y),1),s=s.concat(Zw(n.serverSyncTree_,d.path,Ee,d.currentWriteId,d.applyLocally)),s=s.concat(ja(n.serverSyncTree_,Y,!0))}else _=!0,v="nodata",s=s.concat(ja(n.serverSyncTree_,d.currentWriteId,!0))}Oi(n.eventQueue_,t,s),s=[],_&&(e[h].status=2,(function(T){setTimeout(T,Math.floor(0))})(e[h].unwatcher),e[h].onComplete&&(v==="nodata"?i.push(()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot)):i.push(()=>e[h].onComplete(new Error(v),!1,null))))}s_(n,n.transactionQueueTree_);for(let h=0;h<i.length;h++)xu(i[h]);r_(n,n.transactionQueueTree_)}function Hk(n,e){let t,i=n.transactionQueueTree_;for(t=ze(e);t!==null&&Vl(i)===void 0;)i=Zg(i,t),e=vt(e),t=ze(e);return i}function $k(n,e){const t=[];return Kk(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Kk(n,e,t){const i=Vl(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);e_(e,s=>{Kk(n,s,t)})}function s_(n,e){const t=Vl(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,lT(e,t.length>0?t:void 0)}e_(e,i=>{s_(n,i)})}function fT(n,e){const t=Sf(Hk(n,e)),i=Zg(n.transactionQueueTree_,e);return V9(i,s=>{jv(n,s)}),jv(n,i),Vk(i,s=>{jv(n,s)}),t}function jv(n,e){const t=Vl(e);if(t){const i=[];let s=[],o=-1;for(let c=0;c<t.length;c++)t[c].status===3||(t[c].status===1?(ue(o===c-1,"All SENT items should be at beginning of queue."),o=c,t[c].status=3,t[c].abortReason="set"):(ue(t[c].status===0,"Unexpected transaction status in abort"),t[c].unwatcher(),s=s.concat(ja(n.serverSyncTree_,t[c].currentWriteId,!0)),t[c].onComplete&&i.push(t[c].onComplete.bind(null,new Error("set"),!1,null))));o===-1?lT(e,void 0):t.length=o+1,Oi(n.eventQueue_,Sf(e),s);for(let c=0;c<i.length;c++)xu(i[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aq(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function oq(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Fn(`Invalid query segment '${t}' in query '${n}'`)}return e}const G0=function(n,e){const t=lq(n),i=t.namespace;t.domain==="firebase.com"&&Kr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Kr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||_6();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new ZD(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new ct(t.pathString)}},lq=function(n){let e="",t="",i="",s="",o="",c=!0,h="https",d=443;if(typeof n=="string"){let p=n.indexOf("//");p>=0&&(h=n.substring(0,p-1),n=n.substring(p+2));let _=n.indexOf("/");_===-1&&(_=n.length);let v=n.indexOf("?");v===-1&&(v=n.length),e=n.substring(0,Math.min(_,v)),_<v&&(s=aq(n.substring(_,v)));const T=oq(n.substring(Math.min(n.length,v)));p=e.indexOf(":"),p>=0?(c=h==="https"||h==="wss",d=parseInt(e.substring(p+1),10)):p=e.length;const R=e.slice(0,p);if(R.toLowerCase()==="localhost")t="localhost";else if(R.split(".").length<=2)t=R;else{const P=e.indexOf(".");i=e.substring(0,P).toLowerCase(),t=e.substring(P+1),o=i}"ns"in T&&(o=T.ns)}return{host:e,port:d,domain:t,subdomain:i,secure:c,scheme:h,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",cq=(function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=TR.charAt(t%64),t=Math.floor(t/64);ue(t===0,"Cannot push at time == 0");let c=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)c+=TR.charAt(e[s]);return ue(c.length===20,"nextPushId: Length should be 20."),c}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+on(this.snapshot.exportVal())}}class Wk{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ue(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uq=class{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new hi;return J9(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Yi("OnDisconnect.remove",this._path);const e=new hi;return wR(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Yi("OnDisconnect.set",this._path),Qr("OnDisconnect.set",e,this._path,!1);const t=new hi;return wR(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Yi("OnDisconnect.setWithPriority",this._path),Qr("OnDisconnect.setWithPriority",e,this._path,!1),cT("OnDisconnect.setWithPriority",t);const i=new hi;return Z9(this._repo,this._path,e,t,i.wrapCallback(()=>{})),i.promise}update(e){Yi("OnDisconnect.update",this._path),Uk("OnDisconnect.update",e,this._path);const t=new hi;return eq(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return qe(this._path)?null:Bw(this._path)}get ref(){return new er(this._repo,this._path)}get _queryIdentifier(){const e=oR(this._queryParams),t=Mw(e);return t==="{}"?"default":t}get _queryObject(){return oR(this._queryParams)}isEqual(e){if(e=we(e),!(e instanceof yi))return!1;const t=this._repo===e._repo,i=Fw(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+ez(this._path)}}function a_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function po(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===zr){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ro)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==Ms)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===wt){if(e!=null&&!Yd(e)||t!=null&&!Yd(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ue(n.getIndex()instanceof qw||n.getIndex()===Gw,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function o_(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class er extends yi{constructor(e,t){super(e,t,new $g,!1)}get parent(){const e=lk(this._path);return e===null?null:new er(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}let l_=class H0{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ct(e),i=Il(this.ref,e);return new H0(this._node.getChild(t),i,wt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new H0(s,Il(this.ref,i),wt)))}hasChild(e){const t=new ct(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Yk(n,e){return n=we(n),n._checkNotDeleted("ref"),e!==void 0?Il(n._root,e):n._root}function bR(n,e){n=we(n),n._checkNotDeleted("refFromURL");const t=G0(e,n._repo.repoInfo_.nodeAdmin);Bk("refFromURL",t);const i=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&i.host!==n._repo.repoInfo_.host&&Kr("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+n._repo.repoInfo_.host+")"),Yk(n,t.path.toString())}function Il(n,e){return n=we(n),ze(n._path)===null?z9("child","path",e):Xd("child","path",e),new er(n._repo,Nt(n._path,e))}function hq(n,e){n=we(n),Yi("push",n._path),Qr("push",e,n._path,!0);const t=qk(n._repo),i=cq(t),s=Il(n,i),o=Il(n,i);let c;return e!=null?c=pT(o,e).then(()=>o):c=Promise.resolve(o),s.then=c.then.bind(c),s.catch=c.then.bind(c,void 0),s}function dq(n){return Yi("remove",n._path),pT(n,null)}function pT(n,e){n=we(n),Yi("set",n._path),Qr("set",e,n._path,!1);const t=new hi;return hT(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function fq(n,e){n=we(n),Yi("setPriority",n._path),cT("setPriority",e);const t=new hi;return hT(n._repo,Nt(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function mq(n,e,t){if(Yi("setWithPriority",n._path),Qr("setWithPriority",e,n._path,!1),cT("setWithPriority",t),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";const i=new hi;return hT(n._repo,n._path,e,t,i.wrapCallback(()=>{})),i.promise}function pq(n,e){Uk("update",e,n._path);const t=new hi;return Y9(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function gq(n){n=we(n);const e=new mT(()=>{}),t=new xf(e);return W9(n._repo,n,t).then(i=>new l_(i,new er(n._repo,n._path),n._queryParams.getIndex()))}class xf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new Qk("value",this,new l_(e.snapshotNode,new er(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Wk(this,e,t):null}matches(e){return e instanceof xf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class c_{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Wk(this,e,t):null}createEvent(e,t){ue(e.childName!=null,"Child events should have a childName.");const i=Il(new er(t._repo,t._path),e.childName),s=t._queryParams.getIndex();return new Qk(e.type,this,new l_(e.snapshotNode,i,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof c_?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Nf(n,e,t,i,s){let o;if(typeof i=="object"&&(o=void 0,s=i),typeof i=="function"&&(o=i),s&&s.onlyOnce){const d=t,p=(_,v)=>{q0(n._repo,n,h),d(_,v)};p.userCallback=t.userCallback,p.context=t.context,t=p}const c=new mT(t,o||void 0),h=e==="value"?new xf(c):new c_(e,c);return tq(n._repo,n,h),()=>q0(n._repo,n,h)}function $0(n,e,t,i){return Nf(n,"value",e,t,i)}function IR(n,e,t,i){return Nf(n,"child_added",e,t,i)}function SR(n,e,t,i){return Nf(n,"child_changed",e,t,i)}function AR(n,e,t,i){return Nf(n,"child_moved",e,t,i)}function CR(n,e,t,i){return Nf(n,"child_removed",e,t,i)}function RR(n,e,t){let i=null;const s=t?new mT(t):null;e==="value"?i=new xf(s):e&&(i=new c_(e,s)),q0(n._repo,n,i)}class pr{}class Xk extends pr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Qr("endAt",this._value,e._path,!0);const t=P0(e._queryParams,this._value,this._key);if(o_(t),po(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}function _q(n,e){return Cf("endAt","key",e),new Xk(n,e)}class yq extends pr{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Qr("endBefore",this._value,e._path,!1);const t=Az(e._queryParams,this._value,this._key);if(o_(t),po(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}function vq(n,e){return Cf("endBefore","key",e),new yq(n,e)}class Jk extends pr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Qr("startAt",this._value,e._path,!0);const t=k0(e._queryParams,this._value,this._key);if(o_(t),po(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}function Eq(n=null,e){return Cf("startAt","key",e),new Jk(n,e)}class wq extends pr{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Qr("startAfter",this._value,e._path,!1);const t=Sz(e._queryParams,this._value,this._key);if(o_(t),po(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}function Tq(n,e){return Cf("startAfter","key",e),new wq(n,e)}class bq extends pr{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new yi(e._repo,e._path,bz(e._queryParams,this._limit),e._orderByCalled)}}function Iq(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new bq(n)}class Sq extends pr{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new yi(e._repo,e._path,Iz(e._queryParams,this._limit),e._orderByCalled)}}function Aq(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Sq(n)}class Cq extends pr{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){a_(e,"orderByChild");const t=new ct(this._path);if(qe(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new qw(t),s=Kg(e._queryParams,i);return po(s),new yi(e._repo,e._path,s,!0)}}function Rq(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Xd("orderByChild","path",n),new Cq(n)}class xq extends pr{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){a_(e,"orderByKey");const t=Kg(e._queryParams,zr);return po(t),new yi(e._repo,e._path,t,!0)}}function Nq(){return new xq}class Dq extends pr{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){a_(e,"orderByPriority");const t=Kg(e._queryParams,wt);return po(t),new yi(e._repo,e._path,t,!0)}}function kq(){return new Dq}class Pq extends pr{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){a_(e,"orderByValue");const t=Kg(e._queryParams,Gw);return po(t),new yi(e._repo,e._path,t,!0)}}function Oq(){return new Pq}class Mq extends pr{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Qr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Xk(this._value,this._key)._apply(new Jk(this._value,this._key)._apply(e))}}function Vq(n,e){return Cf("equalTo","key",e),new Mq(n,e)}function cr(n,...e){let t=we(n);for(const i of e)t=i._apply(t);return t}m9(er);v9(er);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lq="FIREBASE_DATABASE_EMULATOR_HOST",K0={};let Uq=!1;function Bq(n,e,t,i){n.repoInfo_=new ZD(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function Zk(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Kr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tn("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c=G0(o,s),h=c.repoInfo,d,p;typeof process<"u"&&qC&&(p=qC[Lq]),p?(d=!0,o=`http://${p}?ns=${h.namespace}`,c=G0(o,s),h=c.repoInfo):d=!c.repoInfo.secure;const _=s&&d?new Kc(Kc.OWNER):new R6(n.name,n.options,e);Bk("Invalid Firebase Database URL",c),qe(c.path)||Kr("Database URL must point to the root of a Firebase Database (not including a child path).");const v=jq(h,n,_,new C6(n.name,t));return new zq(v,n)}function Fq(n,e){const t=K0[e];(!t||t[n.key]!==n)&&Kr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Gk(n),delete t[n.key]}function jq(n,e,t,i){let s=K0[e.name];s||(s={},K0[e.name]=s);let o=s[n.toURLString()];return o&&Kr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new $9(n,Uq,t,i),s[n.toURLString()]=o,o}let zq=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(K9(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new er(this._repo,st())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Fq(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Kr("Cannot call "+e+" on a deleted database.")}};function eP(){hu.IS_TRANSPORT_INITIALIZED&&Fn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function qq(){eP(),Fa.forceDisallow()}function Gq(){eP(),Ki.forceDisallow(),Fa.forceAllow()}function Hq(n,e,t,i={}){n=we(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Kr("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Kr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Kc(Kc.OWNER);else if(i.mockUserToken){const c=typeof i.mockUserToken=="string"?i.mockUserToken:KR(i.mockUserToken,n.app.options.projectId);o=new Kc(c)}Bq(s,e,t,o)}function $q(n){n=we(n),n._checkNotDeleted("goOffline"),Gk(n._repo)}function Kq(n){n=we(n),n._checkNotDeleted("goOnline"),nq(n._repo)}function Qq(n,e){jD(n,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wq(n){LD(Vs),Ds(new _i("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return Zk(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Di(GC,HC,n),Di(GC,HC,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yq={".sv":"timestamp"};function Xq(){return Yq}function Jq(n){return{".sv":{increment:n}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zq=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function e8(n,e,t){var i;if(n=we(n),Yi("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";const s=(i=t==null?void 0:t.applyLocally)!==null&&i!==void 0?i:!0,o=new hi,c=(d,p,_)=>{let v=null;d?o.reject(d):(v=new l_(_,new er(n._repo,n._path),wt),o.resolve(new Zq(p,v)))},h=$0(n,()=>{});return iq(n._repo,n._path,e,c,h,s),o.promise}xs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};xs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};Wq();const t8="@firebase/database-compat",n8="1.0.8";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=new _u("@firebase/database-compat"),tP=function(n){const e="FIREBASE WARNING: "+n;i8.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r8=function(n,e,t,i){if(t!==void 0&&typeof t!="boolean")throw new Error(gi(n,e)+"must be a boolean.")},s8=function(n,e,t){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(gi(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a8{constructor(e){this._delegate=e}cancel(e){ke("OnDisconnect.cancel",0,1,arguments.length),vn("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),i=>e(i)),t}remove(e){ke("OnDisconnect.remove",0,1,arguments.length),vn("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),i=>e(i)),t}set(e,t){ke("OnDisconnect.set",1,2,arguments.length),vn("OnDisconnect.set","onComplete",t,!0);const i=this._delegate.set(e);return t&&i.then(()=>t(null),s=>t(s)),i}setWithPriority(e,t,i){ke("OnDisconnect.setWithPriority",2,3,arguments.length),vn("OnDisconnect.setWithPriority","onComplete",i,!0);const s=this._delegate.setWithPriority(e,t);return i&&s.then(()=>i(null),o=>i(o)),s}update(e,t){if(ke("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,tP("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vn("OnDisconnect.update","onComplete",t,!0);const i=this._delegate.update(e);return t&&i.then(()=>t(null),s=>t(s)),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ke("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,t){this._database=e,this._delegate=t}val(){return ke("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ke("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ke("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ke("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ke("DataSnapshot.child",0,1,arguments.length),e=String(e),Xd("DataSnapshot.child","path",e),new Ka(this._database,this._delegate.child(e))}hasChild(e){return ke("DataSnapshot.hasChild",1,1,arguments.length),Xd("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)}getPriority(){return ke("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ke("DataSnapshot.forEach",1,1,arguments.length),vn("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Ka(this._database,t)))}hasChildren(){return ke("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ke("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ke("DataSnapshot.ref",0,0,arguments.length),new xi(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class kn{constructor(e,t){this.database=e,this._delegate=t}on(e,t,i,s){var o;ke("Query.on",2,4,arguments.length),vn("Query.on","callback",t,!1);const c=kn.getCancelAndContextArgs_("Query.on",i,s),h=(p,_)=>{t.call(c.context,new Ka(this.database,p),_)};h.userCallback=t,h.context=c.context;const d=(o=c.cancel)===null||o===void 0?void 0:o.bind(c.context);switch(e){case"value":return $0(this._delegate,h,d),t;case"child_added":return IR(this._delegate,h,d),t;case"child_removed":return CR(this._delegate,h,d),t;case"child_changed":return SR(this._delegate,h,d),t;case"child_moved":return AR(this._delegate,h,d),t;default:throw new Error(gi("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,i){if(ke("Query.off",0,3,arguments.length),s8("Query.off",e),vn("Query.off","callback",t,!0),ZS("Query.off","context",i),t){const s=()=>{};s.userCallback=t,s.context=i,RR(this._delegate,e,s)}else RR(this._delegate,e)}get(){return gq(this._delegate).then(e=>new Ka(this.database,e))}once(e,t,i,s){ke("Query.once",1,4,arguments.length),vn("Query.once","callback",t,!0);const o=kn.getCancelAndContextArgs_("Query.once",i,s),c=new hi,h=(p,_)=>{const v=new Ka(this.database,p);t&&t.call(o.context,v,_),c.resolve(v)};h.userCallback=t,h.context=o.context;const d=p=>{o.cancel&&o.cancel.call(o.context,p),c.reject(p)};switch(e){case"value":$0(this._delegate,h,d,{onlyOnce:!0});break;case"child_added":IR(this._delegate,h,d,{onlyOnce:!0});break;case"child_removed":CR(this._delegate,h,d,{onlyOnce:!0});break;case"child_changed":SR(this._delegate,h,d,{onlyOnce:!0});break;case"child_moved":AR(this._delegate,h,d,{onlyOnce:!0});break;default:throw new Error(gi("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise}limitToFirst(e){return ke("Query.limitToFirst",1,1,arguments.length),new kn(this.database,cr(this._delegate,Iq(e)))}limitToLast(e){return ke("Query.limitToLast",1,1,arguments.length),new kn(this.database,cr(this._delegate,Aq(e)))}orderByChild(e){return ke("Query.orderByChild",1,1,arguments.length),new kn(this.database,cr(this._delegate,Rq(e)))}orderByKey(){return ke("Query.orderByKey",0,0,arguments.length),new kn(this.database,cr(this._delegate,Nq()))}orderByPriority(){return ke("Query.orderByPriority",0,0,arguments.length),new kn(this.database,cr(this._delegate,kq()))}orderByValue(){return ke("Query.orderByValue",0,0,arguments.length),new kn(this.database,cr(this._delegate,Oq()))}startAt(e=null,t){return ke("Query.startAt",0,2,arguments.length),new kn(this.database,cr(this._delegate,Eq(e,t)))}startAfter(e=null,t){return ke("Query.startAfter",0,2,arguments.length),new kn(this.database,cr(this._delegate,Tq(e,t)))}endAt(e=null,t){return ke("Query.endAt",0,2,arguments.length),new kn(this.database,cr(this._delegate,_q(e,t)))}endBefore(e=null,t){return ke("Query.endBefore",0,2,arguments.length),new kn(this.database,cr(this._delegate,vq(e,t)))}equalTo(e,t){return ke("Query.equalTo",1,2,arguments.length),new kn(this.database,cr(this._delegate,Vq(e,t)))}toString(){return ke("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ke("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ke("Query.isEqual",1,1,arguments.length),!(e instanceof kn)){const t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,i){const s={cancel:void 0,context:void 0};if(t&&i)s.cancel=t,vn(e,"cancel",s.cancel,!0),s.context=i,ZS(e,"context",s.context);else if(t)if(typeof t=="object"&&t!==null)s.context=t;else if(typeof t=="function")s.cancel=t;else throw new Error(gi(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new xi(this.database,new er(this._delegate._repo,this._delegate._path))}}class xi extends kn{constructor(e,t){super(e,new yi(t._repo,t._path,new $g,!1)),this.database=e,this._delegate=t}getKey(){return ke("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ke("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new xi(this.database,Il(this._delegate,e))}getParent(){ke("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new xi(this.database,e):null}getRoot(){return ke("Reference.root",0,0,arguments.length),new xi(this.database,this._delegate.root)}set(e,t){ke("Reference.set",1,2,arguments.length),vn("Reference.set","onComplete",t,!0);const i=pT(this._delegate,e);return t&&i.then(()=>t(null),s=>t(s)),i}update(e,t){if(ke("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,tP("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Yi("Reference.update",this._delegate._path),vn("Reference.update","onComplete",t,!0);const i=pq(this._delegate,e);return t&&i.then(()=>t(null),s=>t(s)),i}setWithPriority(e,t,i){ke("Reference.setWithPriority",2,3,arguments.length),vn("Reference.setWithPriority","onComplete",i,!0);const s=mq(this._delegate,e,t);return i&&s.then(()=>i(null),o=>i(o)),s}remove(e){ke("Reference.remove",0,1,arguments.length),vn("Reference.remove","onComplete",e,!0);const t=dq(this._delegate);return e&&t.then(()=>e(null),i=>e(i)),t}transaction(e,t,i){ke("Reference.transaction",1,3,arguments.length),vn("Reference.transaction","transactionUpdate",e,!1),vn("Reference.transaction","onComplete",t,!0),r8("Reference.transaction","applyLocally",i);const s=e8(this._delegate,e,{applyLocally:i}).then(o=>new o8(o.committed,new Ka(this.database,o.snapshot)));return t&&s.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),s}setPriority(e,t){ke("Reference.setPriority",1,2,arguments.length),vn("Reference.setPriority","onComplete",t,!0);const i=fq(this._delegate,e);return t&&i.then(()=>t(null),s=>t(s)),i}push(e,t){ke("Reference.push",0,2,arguments.length),vn("Reference.push","onComplete",t,!0);const i=hq(this._delegate,e),s=i.then(c=>new xi(this.database,c));t&&s.then(()=>t(null),c=>t(c));const o=new xi(this.database,i);return o.then=s.then.bind(s),o.catch=s.catch.bind(s,void 0),o}onDisconnect(){return Yi("Reference.onDisconnect",this._delegate._path),new a8(new uq(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:qq,forceLongPolling:Gq}}useEmulator(e,t,i={}){Hq(this._delegate,e,t,i)}ref(e){if(ke("database.ref",0,1,arguments.length),e instanceof xi){const t=bR(this._delegate,e.toString());return new xi(this,t)}else{const t=Yk(this._delegate,e);return new xi(this,t)}}refFromURL(e){ke("database.refFromURL",1,1,arguments.length);const i=bR(this._delegate,e);return new xi(this,i)}goOffline(){return ke("database.goOffline",0,0,arguments.length),$q(this._delegate)}goOnline(){return ke("database.goOnline",0,0,arguments.length),Kq(this._delegate)}}Jd.ServerValue={TIMESTAMP:Xq(),increment:n=>Jq(n)};function l8({app:n,url:e,version:t,customAuthImpl:i,customAppCheckImpl:s,namespace:o,nodeAdmin:c=!1}){LD(t);const h=new aE("database-standalone"),d=new Hv("auth-internal",h);d.setComponent(new _i("auth-internal",()=>i,"PRIVATE"));let p;return s&&(p=new Hv("app-check-internal",h),p.setComponent(new _i("app-check-internal",()=>s,"PRIVATE"))),{instance:new Jd(Zk(n,d,p,e,c),n),namespace:o}}var c8=Object.freeze({__proto__:null,initStandalone:l8});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u8=Jd.ServerValue;function h8(n){n.INTERNAL.registerComponent(new _i("database-compat",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:t});return new Jd(s,i)},"PUBLIC").setServiceProps({Reference:xi,Query:kn,Database:Jd,DataSnapshot:Ka,enableLogging:Qq,INTERNAL:c8,ServerValue:u8}).setMultipleInstances(!0)),n.registerVersion(t8,n8)}h8(Ye);const d8={apiKey:"AIzaSyCuzYej9NGg1NwI2yi86RUjzGHw3gqxWIU",authDomain:"caro-ai-arena-bk.firebaseapp.com",databaseURL:"https://caro-ai-arena-bk-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"caro-ai-arena-bk",storageBucket:"caro-ai-arena-bk.firebasestorage.app",messagingSenderId:"1081664228289",appId:"1:1081664228289:web:58e2878225f50a0f243d40",measurementId:"G-CP84LEHFSC"};Ye.initializeApp(d8);const xR=Ye.auth(),fe=Ye.firestore(),gd=Ye.database(),wG=()=>fe.enableNetwork(),f8=()=>fe.disableNetwork(),m8=fr.filter(n=>n.type==="emoji"&&n.price===0).map(n=>n.id),zv=n=>{const e=n.getFullYear(),t=(n.getMonth()+1).toString().padStart(2,"0"),i=n.getDate().toString().padStart(2,"0"),s=n.getHours().toString().padStart(2,"0"),o=n.getMinutes().toString().padStart(2,"0"),c=n.getSeconds().toString().padStart(2,"0");return`${e}-${t}-${i} ${s}:${o}:${c}`},TG=n=>{if(!n)return"";if(typeof n=="number")return zv(new Date(n));if(n.toDate&&typeof n.toDate=="function")return zv(n.toDate());try{const e=new Date(n);if(!isNaN(e.getTime()))return zv(e)}catch{}return""},Q0=n=>{const e={};for(let t=0;t<n.length;t++)for(let i=0;i<n[t].length;i++)n[t][i]&&(e[`${t}_${i}`]=n[t][i]);return e},p8=n=>{const e=Array(La).fill(null).map(()=>Array(La).fill(null));for(const t in n){const[i,s]=t.split("_").map(Number);e[i][s]=n[t]}return e},bG=(n,e)=>{for(let t=0;t<La;t++)for(let i=0;i<La;i++)if(n[t][i]===null&&e[t][i]!==null)return{row:t,col:i};return null},g8=(n,e)=>{const t=[{r:0,c:1},{r:1,c:0},{r:1,c:1},{r:1,c:-1}];for(let i=0;i<La;i++)for(let s=0;s<La;s++)if(n[i][s]===e)for(const o of t){const c=[];for(let h=0;h<$S;h++){const d=i+h*o.r,p=s+h*o.c;if(d>=0&&d<La&&p>=0&&p<La&&n[d][p]===e)c.push({row:d,col:p});else break}if(c.length===$S)return c}return null},IG=()=>{const n=jR.filter(e=>!["😠","😭","💀","🤡"].includes(e.emoji));return n[Math.floor(Math.random()*n.length)]},_8=async(n,e)=>{console.log(`[createUserProfile] Called for UID: ${n.uid}. Auth displayName: "${n.displayName}", name param: "${e}"`);const t=fe.collection("users").doc(n.uid),i=await t.get();if(i.exists){console.log("[createUserProfile] Profile already exists. Checking for name update.");const c=i.data(),h=e.trim()||n.displayName;c.name.startsWith("Player_")&&h&&!h.startsWith("Player_")?(console.log(`[createUserProfile] Correcting default name "${c.name}" to "${h}".`),await t.update({name:h})):console.log(`[createUserProfile] Existing name "${c.name}" is not default. No action taken.`);return}console.log("[createUserProfile] Profile does not exist. Creating new one.");let s=e.trim();if(n.isAnonymous){let c=await Y0(s),h=0;for(;c&&h<10;)s=`Player_${Math.floor(1e3+Math.random()*9e3)}`,c=await Y0(s),h++;c&&(s=`User_${n.uid.substring(0,5)}`)}else s=e.trim()||n.displayName||`Player_${Math.floor(1e3+Math.random()*9e3)}`;console.log(`[createUserProfile] Final name for new profile: "${s}".`);const o={uid:n.uid,name:s,email:n.email,isAnonymous:n.isAnonymous,level:1,xp:0,coins:500,cp:0,onlineWins:0,onlineLosses:0,onlineDraws:0,pveWins:0,pveLosses:0,pveDraws:0,ownedCosmeticIds:[Cs.id,Wn.id,Xn.id,Lr.id,Ur.id,Br.id,hr.id,...m8],emojiInventory:{emoji_wave:10,emoji_think:10},botStats:{},activeThemeId:Cs.id,activePieceId:Wn.id,activeAvatarId:Xn.id,activeEffectId:Lr.id,activeVictoryEffectId:Ur.id,activeBoomEffectId:Br.id,activeBoardId:hr.id,statusMessage:"Available for a match!",showThreats:!1};await t.set(o)},Zd=async n=>{const t=await fe.collection("users").doc(n).get();return t.exists?t.data():null},W0=async(n,e)=>{await fe.collection("users").doc(n).set(e,{merge:!0})},y8=async(n,e,t,i,s,o,c,h,d)=>{const p=fe.collection("users").doc(n);try{await fe.runTransaction(async _=>{const v=await _.get(p);if(!v.exists)throw"Document does not exist!";const T=v.data();if(h&&Array.isArray(T.processedGameIds)&&T.processedGameIds.includes(h)){console.log(`[updateProfileWithGameResult] Game ${h} already processed. Skipping.`);return}const R={level:s,xp:o,coins:Ye.firestore.FieldValue.increment(i)};if(t){if(e==="win"?R.pveWins=Ye.firestore.FieldValue.increment(1):e==="loss"?R.pveLosses=Ye.firestore.FieldValue.increment(1):e==="draw"&&(R.pveDraws=Ye.firestore.FieldValue.increment(1)),d){const P=e==="win"?"wins":e==="loss"?"losses":"draws";if(!T.botStats||!T.botStats[d]){const q={...T.botStats||{}};q[d]={wins:0,losses:0,draws:0},q[d][P]=1,R.botStats=q}else R[`botStats.${d}.${P}`]=Ye.firestore.FieldValue.increment(1)}}else if(e==="win"?R.onlineWins=Ye.firestore.FieldValue.increment(1):e==="loss"?R.onlineLosses=Ye.firestore.FieldValue.increment(1):e==="draw"&&(R.onlineDraws=Ye.firestore.FieldValue.increment(1)),c!==0){const P=T.cp||0;R.cp=Math.max(0,P+c)}h&&(R.processedGameIds=Ye.firestore.FieldValue.arrayUnion(h)),_.update(p,R)})}catch(_){console.error("Failed to update user profile after game:",_)}},v8=async(n,e)=>{await W0(n.uid,{name:e});const t=fe.collection("onlineUsers").doc(n.uid);try{(await t.get()).exists&&await t.update({name:e})}catch{console.warn("Could not update online user name, document may not exist yet.")}},Y0=async n=>!(await fe.collection("users").where("name","==",n.trim()).limit(1).get()).empty,E8=async(n,e)=>{const t=e.trim();if(t.length<3||t.length>15)return{success:!1,message:"Name must be 3-15 characters."};if(await Y0(t))return{success:!1,message:"This name is already taken."};try{return await v8(n,t),{success:!0,message:"Name updated successfully!"}}catch(s){return console.error("Error updating name:",s),{success:!1,message:s.message||"Failed to update name."}}},w8=async(n,e)=>{const t=fe.collection("users").doc(n);try{return await fe.runTransaction(async i=>{const s=await i.get(t);if(!s.exists)throw new Error("User profile not found.");const o=s.data();if(o.coins<e.price)throw new Error("Not enough coins.");const c=e.type==="emoji"||e.type==="animated_emoji";if(!c&&o.ownedCosmeticIds.includes(e.id))throw new Error("Item already owned.");const h={coins:o.coins-e.price};if(c){const p={...o.emojiInventory};p[e.id]=(p[e.id]||0)+1,h.emojiInventory=p}else switch(h.ownedCosmeticIds=Ye.firestore.FieldValue.arrayUnion(e.id),e.type){case"theme":h.activeThemeId=e.item.id;break;case"piece":h.activePieceId=e.item.id;break;case"avatar":h.activeAvatarId=e.item.id;break;case"effect":h.activeEffectId=e.item.id;break;case"victory":h.activeVictoryEffectId=e.item.id;break;case"boom":h.activeBoomEffectId=e.item.id;break;case"board":h.activeBoardId=e.item.id;break}i.update(t,h);const d=fe.collection(`users/${n}/purchaseHistory`).doc();i.set(d,{cosmeticId:e.id,cosmeticName:e.name,price:e.price,timestamp:Ye.firestore.FieldValue.serverTimestamp()})}),{success:!0,message:"Purchase successful!"}}catch(i){return console.error("Purchase transaction failed: ",i),{success:!1,message:i.message||"Purchase failed."}}},T8=async(n,e,t,i,s)=>{var T;const o=n.uid,c=gd.ref(`/status/${o}`),h=fe.collection("onlineUsers").doc(o),d=await h.get(),p=d.exists?(T=d.data())==null?void 0:T.status:"idle";if(p==="in_game"||p==="in_queue"){gd.ref(".info/connected").on("value",R=>{R.val()!==!1&&c.onDisconnect().set({state:"offline",last_changed:Ye.database.ServerValue.TIMESTAMP}).then(()=>{c.set({state:"online",last_changed:Ye.database.ServerValue.TIMESTAMP})})}),console.log(`Presence system: User is '${p}'. Preserving status.`);return}const _={state:"online",last_changed:Ye.database.ServerValue.TIMESTAMP},v={state:"offline",last_changed:Ye.database.ServerValue.TIMESTAMP};gd.ref(".info/connected").on("value",R=>{R.val()!==!1&&c.onDisconnect().set(v).then(async()=>{await c.set(_);const P=await Zd(o),q={uid:o,name:i,level:e,avatarUrl:t,status:"idle",cp:(P==null?void 0:P.cp)||0,statusMessage:s||"Available for a match!"};await h.set(q),console.log("Presence system: User status set to 'idle'.")})})},b8=async(n,e)=>{const t=fe.collection("onlineUsers").doc(n),i=fe.collection("users").doc(n);try{await t.update({statusMessage:e}),await i.update({statusMessage:e})}catch(s){console.warn("Could not update status message, user might be offline.",s)}},I8=async n=>{const e=fe.collection("onlineUsers").doc(n);try{await e.delete()}catch(i){console.error("Error deleting online user doc:",i)}await gd.ref(`/status/${n}`).set({state:"offline",last_changed:Ye.database.ServerValue.TIMESTAMP})},SG=n=>{const e=fe.collection("onlineUsers"),t=gd.ref("status");let i=[],s={},o=null,c=!1,h=!1;const d=()=>{if(!c||!h)return;const _=[],v=[];i.forEach(T=>{const R=s[T.uid];R&&R.state==="online"?_.push(T):v.push(T.uid)}),n(_)};o=e.onSnapshot(_=>{i=_.docs.map(v=>v.data()),c=!0,d()},_=>console.error("Firestore listener error:",_));const p=_=>{s=_.val()||{},h=!0,d()};return t.on("value",p,_=>console.error("RTDB listener error:",_)),()=>{o&&o(),t.off("value",p)}},S8=async n=>{const t=await fe.collection("onlineUsers").doc(n).get();return t.exists?t.data():null},AG=async n=>{const t=await fe.collection("matchmakingQueue").where("uid","!=",n.uid).limit(1).get();if(t.empty)return await fe.collection("matchmakingQueue").doc(n.uid).set({uid:n.uid,joinedAt:Ye.firestore.FieldValue.serverTimestamp()}),await fe.collection("onlineUsers").doc(n.uid).update({status:"in_queue"}),null;{const i=t.docs[0],s=i.id,o=await nP(n.uid,s),c=fe.batch();return c.delete(fe.collection("matchmakingQueue").doc(i.id)),c.update(fe.collection("onlineUsers").doc(n.uid),{status:"in_game",gameId:o}),c.update(fe.collection("onlineUsers").doc(s),{status:"in_game",gameId:o}),await c.commit(),o}},CG=async n=>{if(n)try{await fe.collection("matchmakingQueue").doc(n).delete(),await fe.collection("onlineUsers").doc(n).update({status:"idle"})}catch{console.warn("Could not cancel matchmaking, user might have already found a game.")}},RG=async(n=100)=>(await fe.collection("users").orderBy("cp","desc").limit(n).get()).docs.map(s=>{var c;const o=s.data();return{uid:o.uid,name:o.name,level:o.level,avatarUrl:(((c=fr.find(h=>h.id===o.activeAvatarId))==null?void 0:c.item)||Xn).url,status:"idle",cp:o.cp}}),A8=async(n,e,t)=>{await fe.collection(`users/${n}/matchHistory`).doc(e).set({id:e,...t})},xG=async n=>(await fe.collection(`users/${n}/matchHistory`).orderBy("timestamp","desc").limit(10).get()).docs.map(s=>s.data()),C8=async(n,e)=>{await fe.collection(`users/${n}/pveMatchHistory`).doc(e.id).set(e)},R8=async n=>(await fe.collection(`users/${n}/pveMatchHistory`).orderBy("timestamp","desc").limit(50).get()).docs.map(s=>s.data()),NG=async(n,e,t)=>{await fe.collection("invitations").doc(t).set({from:n.uid,fromName:e,timestamp:Date.now()})},x8=(n,e)=>fe.collection("invitations").doc(n).onSnapshot(t=>{e(t.exists?t.data():null)}),N8=async(n,e)=>{const t=await nP(n.uid,e.from),i=fe.batch();return i.update(fe.collection("onlineUsers").doc(n.uid),{status:"in_game",gameId:t}),i.update(fe.collection("onlineUsers").doc(e.from),{status:"in_game",gameId:t}),i.delete(fe.collection("invitations").doc(n.uid)),await i.commit(),t},D8=async n=>{await fe.collection("invitations").doc(n).delete()},nP=async(n,e)=>{var d,p;const t=`game_${Date.now()}_${Math.random().toString(36).substring(2,7)}`,i=fe.collection("games").doc(t),[s,o]=await Promise.all([Zd(n),Zd(e)]),c=Math.random()<.5?{X:n,O:e}:{X:e,O:n},h={id:t,players:c,playerDetails:{[n]:{name:(s==null?void 0:s.name)||"Player 1",avatarUrl:(s!=null&&s.activeAvatarId?(d=fr.find(_=>_.id===s.activeAvatarId))==null?void 0:d.item:Xn).url,level:(s==null?void 0:s.level)||1,pieceId:(s==null?void 0:s.activePieceId)||Wn.id,cp:(s==null?void 0:s.cp)||0},[e]:{name:(o==null?void 0:o.name)||"Player 2",avatarUrl:(o!=null&&o.activeAvatarId?(p=fr.find(_=>_.id===o.activeAvatarId))==null?void 0:p.item:Xn).url,level:(o==null?void 0:o.level)||1,pieceId:(o==null?void 0:o.activePieceId)||Wn.id,cp:(o==null?void 0:o.cp)||0}},board:{},currentPlayer:"X",status:"in_progress",winner:null,winningLine:null,createdAt:Date.now(),updatedAt:Date.now(),playerTimes:{X:KS,O:KS},turnStartedAt:Date.now(),chatId:t};return await i.set(h),t},DG=async(n,e,t)=>{const i=fe.collection("games").doc(n);try{await i.update({emotes:{uid:e,emoji:t,timestamp:Date.now()}})}catch(s){console.error("Failed to send emote:",s)}},k8=async n=>{const t=await fe.collection("games").doc(n).get();return t.exists?t.data():null},kG=(n,e)=>fe.collection("onlineUsers").doc(n).onSnapshot(t=>{e(t.exists?t.data():null)}),PG=(n,e)=>fe.collection("games").doc(n).onSnapshot(t=>{e(t.exists?t.data():null)}),OG=async(n,e,t,i)=>{const s=fe.collection("games").doc(n);try{await fe.runTransaction(async o=>{const c=await o.get(s);if(!c.exists)return;const h=c.data();if(h.status!=="in_progress"||h.currentPlayer!==i)return;const d=p8(h.board);if(d[e][t]!==null)return;d[e][t]=i;const p=Math.round((Date.now()-h.turnStartedAt)/1e3),_={...h.playerTimes};_[i]=Math.max(0,_[i]-p);const v=g8(d,i),T=d.every(P=>P.every(q=>q!==null))&&!v,R={board:Q0(d),currentPlayer:i==="X"?"O":"X",updatedAt:Date.now(),status:v||T?"finished":"in_progress",winner:v?i:T?"draw":null,winningLine:v||null,playerTimes:_,turnStartedAt:Date.now()};o.update(s,R)})}catch(o){console.error("Make move transaction failed:",o)}},MG=async(n,e)=>{const t=fe.collection("games").doc(n);try{await fe.runTransaction(async i=>{var c;const s=await i.get(t);if(!s.exists||((c=s.data())==null?void 0:c.status)!=="in_progress")return;const o=s.data();if(o.currentPlayer!==e){const h=(Date.now()-o.turnStartedAt)/1e3;o.playerTimes[o.currentPlayer]-h<0&&(console.log(`Player ${e} is claiming a timeout victory.`),i.update(t,{status:"finished",winner:e}))}})}catch(i){console.error("Error claiming timeout victory:",i)}},VG=async(n,e,t)=>{const i=fe.collection("games").doc(n);try{await i.update({[`playerDetails.${e}.pieceId`]:t})}catch(s){console.log("Could not update piece skin (game may be over):",s)}},LG=async(n,e)=>{const t=fe.collection("games").doc(n);try{await fe.runTransaction(async i=>{var o;const s=await i.get(t);!s.exists||((o=s.data())==null?void 0:o.status)!=="in_progress"||i.update(t,{status:"finished",winner:e==="X"?"O":"X"})})}catch(i){console.error("Resignation transaction failed: ",i)}},NR=async n=>{const e=fe.collection("onlineUsers").doc(n);try{(await e.get()).exists&&await e.update({status:"idle",gameId:null})}catch(t){console.error("Failed to return user to lobby:",t)}},UG=(n,e)=>[n,e].sort().join("_"),BG=async(n,e,t,i)=>{const o=await fe.collection(`chats/${n}/messages`).add({senderId:e,text:i,timestamp:Ye.firestore.FieldValue.serverTimestamp()}),c=n.split("_").find(h=>h!==e);if(c){let h=i;if(i.startsWith("REACT:")){const[,p]=i.split(":");if(p)h=`reacted with ${p}`;else return}await fe.collection(`users/${c}/notifications`).doc(o.id).set({type:"message",text:h,senderId:e,senderName:t,timestamp:Ye.firestore.FieldValue.serverTimestamp(),seen:!1})}},FG=(n,e)=>fe.collection(`chats/${n}/messages`).orderBy("timestamp","desc").limit(100).onSnapshot(s=>{const o=s.docs.map(c=>({id:c.id,...c.data()}));e(o.reverse())}),jG=(n,e,t)=>{const s=fe.collection(`chats/${n}/messages`).orderBy("timestamp","desc").limit(1);let o=!0;return s.onSnapshot(c=>{if(o){o=!1;return}c.docChanges().forEach(h=>{if(h.type==="added"){const d={id:h.doc.id,...h.doc.data()};d.senderId!==e&&t(d)}})})},P8=(n,e)=>fe.collection(`users/${n}/notifications`).orderBy("timestamp","desc").limit(50).onSnapshot(s=>{const o=s.docs.map(c=>({id:c.id,...c.data()}));e(o)}),zG=async(n,e)=>{await fe.collection(`users/${n}/notifications`).doc(e).update({seen:!0})},qG=async(n,e)=>{await fe.collection(`users/${n}/notifications`).doc(e).delete()},GG=async(n,e,t,i)=>{await fe.collection(`users/${t}/notifications`).doc().set({type:"tease",text:"teased you!",senderId:n,senderName:e,emoji:i,timestamp:Ye.firestore.FieldValue.serverTimestamp(),seen:!1})},HG=async(n,e,t)=>{const i=fe.collection(`users/${n}/friends`).doc(e),s=fe.collection(`users/${e}/friends`).doc(n),o=fe.batch();t==="accept"?(o.update(i,{status:"friends"}),o.update(s,{status:"friends"})):(o.delete(i),o.delete(s)),await o.commit()},$G=async(n,e)=>{const t=fe.batch();t.delete(fe.collection(`users/${n}/friends`).doc(e)),t.delete(fe.collection(`users/${e}/friends`).doc(n)),await t.commit()},O8=(n,e)=>fe.collection(`users/${n}/friends`).onSnapshot(i=>{const s=i.docs.map(o=>({...o.data(),uid:o.id}));e(s)}),KG=(n,e)=>fe.collection(`users/${n}/locker`).orderBy("receivedAt","desc").onSnapshot(s=>{const o=s.docs.map(c=>({id:c.id,...c.data()}));e(o)}),QG=async(n,e)=>{var _,v;const t=await Zd(n),i=await Zd(e);if(!t||!i){console.error("Could not find user profile for friend request.");return}const s=fe.batch(),o=fe.collection(`users/${n}/friends`).doc(e),c=fe.collection(`users/${e}/friends`).doc(n),h={uid:e,name:i.name,avatarUrl:(((_=fr.find(T=>T.id===i.activeAvatarId))==null?void 0:_.item)||Xn).url,level:i.level,status:"pending"},d={uid:n,name:t.name,avatarUrl:(((v=fr.find(T=>T.id===t.activeAvatarId))==null?void 0:v.item)||Xn).url,level:t.level,status:"received"};s.set(o,h),s.set(c,d);const p=fe.collection(`users/${e}/notifications`).doc();s.set(p,{type:"friend_request",text:"sent you a friend request.",senderId:n,senderName:t.name,timestamp:Ye.firestore.FieldValue.serverTimestamp(),seen:!1}),await s.commit()},WG=async(n,e,t,i)=>{const s=fr.find(c=>c.id===i);if(!s)throw new Error(`Cosmetic with id ${i} not found!`);const o=fe.collection("users").doc(t);await fe.runTransaction(async c=>{var T;const h=await c.get(o);if(!h.exists)throw new Error("Recipient user not found.");const d=h.data(),p=s.type==="emoji"||s.type==="animated_emoji";if(!p){if(d.ownedCosmeticIds.includes(i))throw new Error("Recipient already owns this item.");if((T=d.pendingGiftIds)!=null&&T.includes(i))throw new Error("Recipient has this gift pending claim.")}const _=fe.collection(`users/${t}/locker`).doc();c.set(_,{cosmeticId:i,fromUid:n,fromName:e,receivedAt:Ye.firestore.FieldValue.serverTimestamp(),isClaimed:!1}),p||c.update(o,{pendingGiftIds:Ye.firestore.FieldValue.arrayUnion(i)});const v=fe.collection(`users/${t}/notifications`).doc();c.set(v,{type:"gift",text:`sent you a gift: ${s.name}!`,senderId:n,senderName:e,timestamp:Ye.firestore.FieldValue.serverTimestamp(),seen:!1,cosmeticId:i})})},M8=async(n,e)=>{const t=fe.collection(`users/${n}/locker`).doc(e),i=fe.collection("users").doc(n);try{return await fe.runTransaction(async s=>{const o=await s.get(t),c=await s.get(i);if(!o.exists||!c.exists)throw"Gift or user does not exist!";const h=o.data();if(h.isClaimed)return;const d=fr.find(T=>T.id===h.cosmeticId);if(!d)throw`Cosmetic with id ${h.cosmeticId} not found!`;const p=c.data(),_=p.ownedCosmeticIds.includes(d.id),v=d.type==="emoji"||d.type==="animated_emoji";if(!_||v)if(v){const T={...p.emojiInventory};T[d.id]=(T[d.id]||0)+1,s.update(i,{emojiInventory:T})}else s.update(i,{ownedCosmeticIds:[...p.ownedCosmeticIds,d.id]});s.update(t,{isClaimed:!0}),v||s.update(i,{pendingGiftIds:Ye.firestore.FieldValue.arrayRemove(d.id)})}),{success:!0,message:"Gift claimed!"}}catch(s){return console.error("Gift claim transaction failed: ",s),{success:!1,message:`Error: ${s}`}}},YG=async n=>(await fe.collection(`users/${n}/purchaseHistory`).orderBy("timestamp","desc").limit(50).get()).docs.map(s=>({id:s.id,...s.data()})),XG=async(n,e,t,i)=>{await fe.collection(`users/${n}/giftHistory`).add({cosmeticId:i.id,cosmeticName:i.name,recipientId:e,recipientName:t,timestamp:Ye.firestore.FieldValue.serverTimestamp()})},JG=async n=>(await fe.collection(`users/${n}/giftHistory`).orderBy("timestamp","desc").limit(50).get()).docs.map(s=>({id:s.id,...s.data()})),iP=ye.createContext(void 0),V8=({children:n})=>{const[e,t]=ye.useState(null),[i,s]=ye.useState(!0);ye.useEffect(()=>{const h=M5(xR,d=>{t(d),s(!1)});return()=>h()},[]);const c={user:e,loading:i,logOut:async()=>{e&&await I8(e.uid),await f8(),await V5(xR)}};return I.jsx(iP.Provider,{value:c,children:!i&&n})},gT=()=>{const n=ye.useContext(iP);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},X0="caroGameState_v9_guest",rP=ye.createContext(void 0),Oa=n=>{if(!n)return null;const{component:e,previewComponent:t,decoratorComponent:i,...s}=n;return s},DR=()=>({coins:500,cp:0,playerName:`Player_${Math.floor(1e3+Math.random()*9e3)}`,pveWins:0,pveLosses:0,pveDraws:0,onlineWins:0,onlineLosses:0,onlineDraws:0,playerLevel:1,playerXp:0,ownedCosmeticIds:[Cs.id,Wn.id,Vr.id,Xn.id,Lr.id,Ur.id,Br.id,hr.id],emojiInventory:{emoji_wave:10,emoji_think:10,anim_emoji_laugh:5},botStats:{},pveMatchHistory:[],purchaseHistory:[],activeTheme:Cs,activePieceX:Wn,activePieceO:Vr,activeAvatar:Xn,activeEffect:Lr,activeVictoryEffect:Ur,activeBoomEffect:Br,activeBoard:hr,isSoundOn:!0,isMusicOn:!0,soundVolume:1,musicVolume:1,activeMusicUrl:fM[0].url,statusMessage:"Available for a match!",toast:null,friends:[],notifications:[],messageToast:null,activeTease:null,showThreats:!1}),kR=()=>{try{const n=localStorage.getItem(X0);if(n){const e=JSON.parse(n),t=[Wn,Vr,...Ts],i=[Xn,...Cp],s=[Lr,...tE],o=[Ur,...td],c=[Br,...nd],h=[hr,...eE],d=Z0.find(oe=>{var de;return oe.id===((de=e.activeTheme)==null?void 0:de.id)})||Cs,p=t.find(oe=>{var de;return oe.id===((de=e.activePieceX)==null?void 0:de.id)})||Wn,_=t.find(oe=>{var de;return oe.id===((de=e.activePieceO)==null?void 0:de.id)})||Vr,v=i.find(oe=>{var de;return oe.id===((de=e.activeAvatar)==null?void 0:de.id)})||Xn,T=s.find(oe=>{var de;return oe.id===((de=e.activeEffect)==null?void 0:de.id)})||Lr,R=o.find(oe=>{var de;return oe.id===((de=e.activeVictoryEffect)==null?void 0:de.id)})||Ur,P=c.find(oe=>{var de;return oe.id===((de=e.activeBoomEffect)==null?void 0:de.id)})||Br,q=h.find(oe=>{var de;return oe.id===((de=e.activeBoard)==null?void 0:de.id)})||hr,Y=e.pveWins??e.wins??0,le=e.pveLosses??e.losses??0,Ee=e.pveDraws??e.draws??0;return{...DR(),...e,pveWins:Y,pveLosses:le,pveDraws:Ee,onlineWins:e.onlineWins??0,onlineLosses:e.onlineLosses??0,onlineDraws:e.onlineDraws??0,cp:e.cp??0,statusMessage:e.statusMessage||"Available for a match!",pveMatchHistory:e.pveMatchHistory||[],purchaseHistory:e.purchaseHistory||[],activeTheme:d,activePieceX:p,activePieceO:_,activeAvatar:v,activeEffect:T,activeVictoryEffect:R,activeBoomEffect:P,activeBoard:q,showThreats:e.showThreats??!1}}}catch(n){console.error("Failed to parse guest state",n)}return DR()},L8=({children:n})=>{const{user:e}=gT(),[t,i]=ye.useState(kR),[s,o]=ye.useState(null),c=ye.useRef(null),h=ye.useRef(null),d=ye.useRef(null),p=ye.useRef(null),_=ye.useRef(new Set),v=ye.useCallback((C,A="success",se)=>{h.current&&clearTimeout(h.current),i(Ae=>({...Ae,toast:{id:Date.now(),message:C,type:A,cosmeticId:se}})),h.current=setTimeout(()=>{i(Ae=>({...Ae,toast:null})),h.current=null},4e3)},[]);ye.useEffect(()=>{let C=[];if(e){if(c.current===e.uid)return;c.current=e.uid;const A={current:!1},se=fe.collection("users").doc(e.uid).onSnapshot(async ee=>{if(console.log("[GameStateContext] Profile snapshot received."),ee.exists){const X=ee.data(),Oe=Z0.find(Se=>Se.id===X.activeThemeId)||Cs,Be=Ts.find(Se=>Se.id===X.activePieceId)||Wn,O=Cp.find(Se=>Se.id===X.activeAvatarId)||Xn,W=tE.find(Se=>Se.id===X.activeEffectId)||Lr,ne=td.find(Se=>Se.id===X.activeVictoryEffectId)||Ur,ae=nd.find(Se=>Se.id===X.activeBoomEffectId)||Br,_e=[hr,...eE].find(Se=>Se.id===X.activeBoardId)||hr;if(i(Se=>({...Se,playerName:X.name,coins:X.coins,cp:X.cp??0,onlineWins:X.onlineWins,onlineLosses:X.onlineLosses,onlineDraws:X.onlineDraws,pveWins:X.pveWins,pveLosses:X.pveLosses,pveDraws:X.pveDraws,playerLevel:X.level,playerXp:X.xp,ownedCosmeticIds:X.ownedCosmeticIds||[],emojiInventory:X.emojiInventory||{},statusMessage:X.statusMessage||"Available for a match!",activeTheme:Oe,activePieceX:Be,activePieceO:Be,activeAvatar:O,activeEffect:W,activeVictoryEffect:ne,activeBoomEffect:ae,activeBoard:_e,botStats:X.botStats||{},showThreats:X.showThreats??!1})),!A.current){A.current=!0;const Se=await R8(e.uid);i(_t=>({..._t,pveMatchHistory:Se})),await T8(e,X.level,O.url,X.name,X.statusMessage)}}else e.isAnonymous?(console.log("[GameStateContext] Creating profile for new guest user."),await _8(e,`Player_${Math.floor(1e3+Math.random()*9e3)}`)):console.log("[GameStateContext] Waiting for new user profile to be created by AuthScreen...")});C.push(se);const Ae=O8(e.uid,ee=>{i(X=>({...X,friends:ee}))});C.push(Ae);const H=P8(e.uid,ee=>{i(X=>{const Oe=X.notifications,Be=ee.filter(ae=>!Oe.some(me=>me.id===ae.id));let O=X.messageToast,W=null;Be.forEach(ae=>{var tt;const me=ae.timestamp,_e=typeof me=="number"?me:((tt=me==null?void 0:me.toMillis)==null?void 0:tt.call(me))||0,Se=_e>Date.now()-15e3,_t=X.friends.some(hn=>hn.uid===ae.senderId&&hn.status==="friends");Se&&((ae.type==="message"&&_t||ae.type==="friend_request"||ae.type==="gift"||ae.type==="tease")&&(O=ae),ae.type==="tease"&&ae.emoji&&(W={senderId:ae.senderId,emoji:ae.emoji,key:_e}))});let ne={...X,notifications:ee};return O&&O!==X.messageToast&&(d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{i(ae=>({...ae,messageToast:null}))},5e3),ne={...ne,messageToast:O}),W&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{i(ae=>({...ae,activeTease:null}))},8e3),ne={...ne,activeTease:W}),ne})});C.push(H)}else c.current&&(localStorage.removeItem(X0),_.current.clear()),i(kR()),c.current=null;return()=>{C.forEach(A=>A()),c.current=null}},[e]),ye.useEffect(()=>{if(!e)try{const C={...t,toast:null,activeTheme:Oa(t.activeTheme),activePieceX:Oa(t.activePieceX),activePieceO:Oa(t.activePieceO),activeAvatar:Oa(t.activeAvatar),activeEffect:Oa(t.activeEffect),activeVictoryEffect:Oa(t.activeVictoryEffect),activeBoomEffect:Oa(t.activeBoomEffect),activeBoard:Oa(t.activeBoard)};localStorage.setItem(X0,JSON.stringify(C))}catch(C){console.error("Failed to save guest state",C)}},[t,e]);const T=ye.useCallback((C,A)=>{i(se=>{const Ae={},H={};switch(C){case"theme":Ae.activeTheme=A,H.activeThemeId=A.id;break;case"piece":Ae.activePieceX=A,H.activePieceId=A.id;break;case"avatar":Ae.activeAvatar=A,H.activeAvatarId=A.id;break;case"effect":Ae.activeEffect=A,H.activeEffectId=A.id;break;case"victory":Ae.activeVictoryEffect=A,H.activeVictoryEffectId=A.id;break;case"boom":Ae.activeBoomEffect=A,H.activeBoomEffectId=A.id;break;case"board":Ae.activeBoard=A,H.activeBoardId=A.id;break}return e&&!e.isAnonymous&&Object.keys(H).length>0&&W0(e.uid,H),{...se,...Ae}})},[e]),R=ye.useCallback(async C=>{const A=C.trim();if(e&&!e.isAnonymous){if(t.coins<100)return{success:!1,message:"Not enough coins!"};const se=await E8(e,A);return se.success&&i(Ae=>({...Ae,coins:Ae.coins-100})),se}return{success:!1,message:"Guests cannot change their display name."}},[e,t.coins]),P=ye.useCallback(C=>{const A=C.trim().slice(0,45);i(se=>({...se,statusMessage:A})),e&&b8(e.uid,A)},[e]),q=ye.useCallback(C=>t.coins<C?!1:(i(A=>({...A,coins:A.coins-C})),!0),[t.coins]),Y=ye.useCallback(C=>{if(t.coins<C.price){v("Not enough coins!","error");return}const A=(C.type==="emoji"||C.type==="animated_emoji")&&C.price>0;if(!A&&t.ownedCosmeticIds.includes(C.id)){v("You already own this item!","error");return}e&&!e.isAnonymous?w8(e.uid,C).then(se=>{se.success?v(`Successfully purchased ${C.name}!`,"success",C.id):v(se.message,"error")}):(i(se=>{const Ae={...se};if(Ae.coins=se.coins-C.price,A){const ee={...se.emojiInventory};ee[C.id]=(ee[C.id]||0)+1,Ae.emojiInventory=ee}else switch(Ae.ownedCosmeticIds=[...se.ownedCosmeticIds,C.id],C.type){case"theme":Ae.activeTheme=C.item;break;case"piece":Ae.activePieceX=C.item;break;case"avatar":Ae.activeAvatar=C.item;break;case"effect":Ae.activeEffect=C.item;break;case"victory":Ae.activeVictoryEffect=C.item;break;case"boom":Ae.activeBoomEffect=C.item;break;case"board":Ae.activeBoard=C.item;break}const H={id:`${Date.now()}-${C.id}`,cosmeticId:C.id,cosmeticName:C.name,price:C.price,timestamp:Date.now()};return Ae.purchaseHistory=[H,...se.purchaseHistory||[]],Ae}),v(`Successfully purchased ${C.name}!`,"success",C.id))},[t.coins,t.ownedCosmeticIds,t.emojiInventory,e,v]),le=ye.useCallback((C,A,se,Ae=0)=>{const H=se.id;if(H&&_.current.has(H)){console.log(`[applyGameResult] DUPLICATE call for game ID: ${H}. Skipping.`);return}H&&_.current.add(H);let ee=null;i(X=>{const Oe=YO[C],Be=WO[C];let O=X.playerXp+Oe,W=X.playerLevel,ne=QS(W);for(;O>=ne;)O-=ne,W++,ne=QS(W);const ae=se.isPVE,me=WS(X.cp),_e=ae?X.cp:Math.max(0,X.cp+Ae),Se=WS(_e);let _t=null;if(ae){const hn=YS.find(tr=>tr.id===A);hn&&se.boardState&&(_t={id:se.id||`${Date.now()}`,opponentName:hn.name,opponentAvatar:hn.avatar,opponentLevel:hn.level,result:C,timestamp:Date.now(),boardState:Q0(se.boardState),duration:se.duration||0,winningLine:se.winningLine||null,opponentCp:se.opponentCp,playerLevel:se.playerLevel||X.playerLevel,playerXPieceId:se.playerXPieceId||Wn.id,playerOPieceId:se.playerOPieceId||Vr.id})}const tt={...X.botStats};return ae&&(tt[A]||(tt[A]={wins:0,losses:0,draws:0}),C==="win"?tt[A].wins++:C==="draw"?tt[A].draws++:tt[A].losses++),ee={coinsToAdd:Be,newLevel:W,newXp:O,newCp:_e,oldRank:me,newRank:Se},{...X,coins:X.coins+Be,playerXp:O,playerLevel:W,pveWins:ae&&C==="win"?X.pveWins+1:X.pveWins,pveLosses:ae&&C==="loss"?X.pveLosses+1:X.pveLosses,pveDraws:ae&&C==="draw"?X.pveDraws+1:X.pveDraws,onlineWins:!ae&&C==="win"?X.onlineWins+1:X.onlineWins,onlineLosses:!ae&&C==="loss"?X.onlineLosses+1:X.onlineLosses,onlineDraws:!ae&&C==="draw"?X.onlineDraws+1:X.onlineDraws,cp:_e,botStats:tt,pveMatchHistory:_t?[_t,...X.pveMatchHistory]:X.pveMatchHistory}}),Promise.resolve().then(()=>{if(ee&&(ee.newRank.name!==ee.oldRank.name&&!se.isPVE&&o({type:Ae>0?"up":"down",from:ee.oldRank,to:ee.newRank}),e&&!e.isAnonymous)){if(y8(e.uid,C,se.isPVE,ee.coinsToAdd,ee.newLevel,ee.newXp,Ae,se.id,A),se.isPVE){const X=YS.find(Oe=>Oe.id===A);if(X&&se.boardState){const Oe={id:se.id||`${Date.now()}`,opponentName:X.name,opponentAvatar:X.avatar,opponentLevel:X.level,result:C,timestamp:Date.now(),boardState:Q0(se.boardState),duration:se.duration||0,winningLine:se.winningLine||null,opponentCp:se.opponentCp,playerLevel:se.playerLevel||ee.newLevel,playerXPieceId:se.playerXPieceId||Wn.id,playerOPieceId:se.playerOPieceId||Vr.id};C8(e.uid,Oe)}}else if(!se.isPVE&&se.id&&se.opponentDetails){const X={id:se.id,opponentId:A,opponentName:se.opponentDetails.name,opponentAvatarUrl:se.opponentDetails.avatarUrl,opponentLevel:se.opponentDetails.level,opponentCp:se.opponentDetails.cp,result:C,cpChange:Ae,timestamp:Date.now(),duration:Math.round(((se.updatedAt||Date.now())-(se.createdAt||Date.now()))/1e3),chatId:se.chatId||se.id||"",boardState:se.boardState,winningLine:se.winningLine,playerLevel:se.playerLevel||ee.newLevel,playerXPieceId:se.playerXPieceId||Wn.id,playerOPieceId:se.playerOPieceId||Vr.id,playerMark:se.playerMark};A8(e.uid,se.id,X)}}})},[e,o]),Ee=ye.useCallback(C=>{i(A=>{const se={...A.emojiInventory};return se[C]>0&&(se[C]-=1,se[C]===0&&delete se[C]),{...A,emojiInventory:se}})},[]),oe=ye.useCallback(()=>i(C=>({...C,isSoundOn:!C.isSoundOn})),[]),de=ye.useCallback(()=>i(C=>({...C,isMusicOn:!C.isMusicOn})),[]),Pe=ye.useCallback(C=>i(A=>({...A,soundVolume:C})),[]),Re=ye.useCallback(C=>i(A=>({...A,musicVolume:C})),[]),k=ye.useCallback(C=>i(A=>({...A,activeMusicUrl:C})),[]),x=ye.useCallback(()=>o(null),[]),N=ye.useCallback(()=>{i(C=>{const A=!C.showThreats;return e&&W0(e.uid,{showThreats:A}),{...C,showThreats:A}})},[e]),V=ye.useCallback(async C=>{if(!e)return{success:!1,message:"User not logged in"};const A=await M8(e.uid,C.id);if(A.success){const se=fr.find(ee=>ee.id===C.cosmeticId);if(!se)return v(`Claimed an item from ${C.fromName}.`,"success"),A;const Ae=se.type==="emoji"||se.type==="animated_emoji",H=!Ae&&t.ownedCosmeticIds.includes(C.cosmeticId);H||i(ee=>{if(Ae){const X={...ee.emojiInventory};return X[se.id]=(X[se.id]||0)+1,{...ee,emojiInventory:X}}else return{...ee,ownedCosmeticIds:[...ee.ownedCosmeticIds,se.id]}}),v(H?`You already own ${se.name}. Gift claimed.`:`You received ${se.name} from ${C.fromName}!`,"success",C.cosmeticId)}else v(A.message,"error");return A},[e,v,t.ownedCosmeticIds,t.emojiInventory]),L=ye.useCallback(C=>{i(A=>{const se=typeof C=="function"?C(A.notifications):C;return{...A,notifications:se}})},[]);return I.jsx(rP.Provider,{value:{gameState:t,rankNotification:s,clearRankNotification:x,setPlayerName:R,applyGameResult:le,spendCoins:q,purchaseCosmetic:Y,consumeEmoji:Ee,equipTheme:C=>T("theme",C),equipPiece:C=>T("piece",C),equipAvatar:C=>T("avatar",C),equipEffect:C=>T("effect",C),equipVictoryEffect:C=>T("victory",C),equipBoomEffect:C=>T("boom",C),equipBoard:C=>T("board",C),toggleSound:oe,toggleMusic:de,setSoundVolume:Pe,setMusicVolume:Re,equipMusic:k,claimGift:V,setStatusMessage:P,showToast:v,setNotifications:L,toggleShowThreats:N},children:n})},sP=()=>{const n=ye.useContext(rP);if(!n)throw new Error("useGameState must be used within a GameStateProvider");return n},PR={move:"assets/sounds/move.mp3",win:"assets/sounds/win.mp3",lose:"assets/sounds/lose.mp3",click:"assets/sounds/click.mp3",announce_win:"assets/sounds/announce_win.mp3",announce_lose:"assets/sounds/announce_lose.mp3",check:"assets/sounds/check.mp3",first_move_player:"assets/sounds/first_move_player.mp3",first_move_ai:"assets/sounds/first_move_ai.mp3",deciding:"assets/sounds/deciding.mp3",boom:"assets/sounds/boom.mp3",select:"assets/sounds/select.mp3",confirm:"assets/sounds/confirm.mp3",summary:"assets/sounds/summary.mp3"},qv=new Map,OR=(n,e=!1)=>{if(qv.has(n))return qv.get(n);const t=new Audio(n);return t.loop=e,qv.set(n,t),t},MR=(n,e,t)=>{n!==void 0&&n.catch(i=>{i.name!=="AbortError"&&(i.name==="NotAllowedError"?console.warn("Music playback was prevented because the user hasn't interacted with the page yet. It will start automatically after the first user action."):i.name==="NotSupportedError"?console.warn(`Audio file for "${e}" not found or format not supported. Please add the file to the path: ${t}. See README.md for instructions.`):console.error(`Sound play failed for ${e}:`,i))})},aP=()=>{const{gameState:n}=sP(),e=ye.useRef(null),t=ye.useCallback(o=>{if(n.isSoundOn)try{const c=OR(PR[o]);c.currentTime=0;const h=o==="click"||o==="move"||o==="select"?.7:1;c.volume=n.soundVolume*h;const d=c.play();MR(d,o,PR[o])}catch(c){console.error(`Could not play sound ${o}:`,c)}},[n.isSoundOn,n.soundVolume]),i=ye.useCallback(()=>{if(n.isMusicOn)try{const o=new URL(n.activeMusicUrl,window.location.origin).href;(!e.current||e.current.src!==o)&&(e.current&&e.current.pause(),e.current=OR(n.activeMusicUrl,!0)),e.current.volume=n.musicVolume;const c=e.current.play();MR(c,"music",n.activeMusicUrl)}catch(o){console.error("Could not play music:",o)}},[n.isMusicOn,n.activeMusicUrl,n.musicVolume]),s=ye.useCallback(()=>{e.current&&(e.current.pause(),e.current.currentTime=0)},[]);return ye.useEffect(()=>{e.current&&(e.current.volume=n.musicVolume)},[n.musicVolume]),ye.useEffect(()=>{n.isMusicOn||s()},[n.isMusicOn,s]),ye.useEffect(()=>{const o=()=>{document.hidden?e.current&&e.current.pause():n.isMusicOn&&i()};return document.addEventListener("visibilitychange",o),()=>{document.removeEventListener("visibilitychange",o)}},[i,n.isMusicOn]),{playSound:t,playMusic:i,stopMusic:s}},U8=({isOpen:n,onClose:e,title:t,children:i,hideCloseButton:s=!1,size:o="sm"})=>{if(!n)return null;const c={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-2xl"};return I.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center z-50 transition-opacity duration-300",onClick:e,children:[I.jsxs("div",{className:`bg-[#1e293b] rounded-2xl shadow-2xl p-4 m-4 w-full ${c[o]} border border-slate-700 transform transition-transform duration-300 scale-95 animate-scale-in`,onClick:h=>h.stopPropagation(),children:[t?I.jsxs("div",{className:"flex justify-between items-center mb-4",children:[I.jsx("div",{children:t}),!s&&e&&I.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors","aria-label":"Close modal",children:I.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):!s&&e&&I.jsx("div",{className:"flex justify-end -mt-2 -mr-2",children:I.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors","aria-label":"Close modal",children:I.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),I.jsx("div",{children:i})]}),I.jsx("style",{children:`
        @keyframes scale-in {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .animate-scale-in {
            animation: scale-in 0.3s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
        }
      `})]})},B8=({notification:n,onClose:e})=>{const[t,i]=ye.useState("idle"),{playSound:s}=aP();if(ye.useEffect(()=>{if(n){s(n.type==="up"?"win":"lose"),i("in");const v=setTimeout(()=>{i("out"),setTimeout(e,500)},4e3);return()=>clearTimeout(v)}},[n,e,s]),!n)return null;const{type:o,from:c,to:h}=n,d=o==="up",p=d?"PROMOTION!":"DEMOTION",_=d?"text-green-400":"text-red-500";return I.jsxs("div",{className:`fixed inset-0 bg-black/80 flex items-center justify-center z-[100] transition-opacity duration-300 ${t==="in"?"opacity-100":"opacity-0"}`,children:[I.jsxs("div",{className:`relative w-full max-w-sm bg-slate-900 border-2 rounded-2xl p-8 text-center overflow-hidden animate-scale-in ${d?"border-green-500":"border-red-500"}`,style:d?{boxShadow:"0 0 30px rgba(74, 222, 128, 0.5)"}:{boxShadow:"0 0 30px rgba(239, 68, 68, 0.5)"},children:[I.jsx("h2",{className:`text-5xl font-black mb-6 animate-fade-in-down ${_}`,children:p}),I.jsxs("div",{className:"relative h-28 flex items-center justify-center",children:[I.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center animate-rank-out",children:[I.jsx("div",{className:"text-6xl",children:c.icon}),I.jsx("p",{className:"text-xl font-bold text-slate-400",children:c.name})]}),I.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center opacity-0 animate-rank-in",children:[I.jsx("div",{className:"text-7xl",children:h.icon}),I.jsx("p",{className:`text-2xl font-bold ${_}`,children:h.name})]})]}),I.jsx("div",{className:"absolute -bottom-24 -left-24 w-60 h-60 rounded-full bg-gradient-radial from-slate-700/50 to-transparent blur-xl"}),I.jsx("div",{className:"absolute -top-24 -right-24 w-60 h-60 rounded-full bg-gradient-radial from-slate-700/50 to-transparent blur-xl"})]}),I.jsx("style",{children:`
                @keyframes scale-in { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
                .animate-scale-in { animation: scale-in 0.5s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
                
                @keyframes fade-in-down { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
                .animate-fade-in-down { animation: fade-in-down 0.5s ease-out 0.2s forwards; }

                @keyframes rank-out {
                    0% { transform: scale(1) translateY(0); opacity: 1; }
                    100% { transform: scale(0.7) translateY(-30px); opacity: 0; }
                }
                .animate-rank-out { animation: rank-out 0.8s ease-in-out 0.5s forwards; }

                @keyframes rank-in {
                    0% { transform: scale(0.7) translateY(30px); opacity: 0; }
                    100% { transform: scale(1); opacity: 1; }
                }
                .animate-rank-in { animation: rank-in 0.8s ease-in-out 1.5s forwards; }
            `})]})},F8=cn.lazy(()=>Sl(()=>import("./MainMenu-BO84kNvb.js"),__vite__mapDeps([0,1,2]))),VR=cn.lazy(()=>Sl(()=>import("./GameScreen-Qui9wBU6.js"),__vite__mapDeps([3,1,4]))),LR=cn.lazy(()=>Sl(()=>import("./Shop-CJgib8es.js"),[])),UR=cn.lazy(()=>Sl(()=>import("./Inventory-B9a0IaLz.js"),[])),j8=cn.lazy(()=>Sl(()=>import("./AuthScreen-CalQl_tn.js"),[])),z8=cn.lazy(()=>Sl(()=>import("./OnlineLobby-CwYVoEcU.js"),__vite__mapDeps([5,1,4,2]))),q8=cn.lazy(()=>Sl(()=>import("./VersusScreen-xtlA91A2.js"),[])),Gv="caroActivePveGame_bot",BR="caroGameState_inProgress",G8=1440*60*1e3,Bc=()=>I.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 flex flex-col items-center justify-center text-center",children:[I.jsxs("h1",{className:"text-6xl md:text-8xl font-black text-white mb-2",children:["Caro ",I.jsx("span",{className:"text-cyan-400",children:"AI Arena"})]}),I.jsx("p",{className:"text-slate-400 text-xl mt-4",children:"Loading..."})]}),oP=cn.memo(({cosmetic:n})=>{switch(n.type){case"piece":{const e=n.item.component;return I.jsx(e,{className:"w-full h-full text-cyan-300"})}case"avatar":return I.jsx("img",{src:n.item.url,alt:n.name,className:"w-full h-full rounded-md object-cover bg-slate-700"});case"emoji":return I.jsx("span",{className:"text-3xl",children:n.item.emoji});case"animated_emoji":return I.jsx("img",{src:n.item.url,alt:n.name,className:"w-full h-full"});case"theme":{const e=n.item;return I.jsx("div",{className:`w-full h-full rounded-md flex items-center justify-center p-1 bg-cover bg-center ${e.boardBg}`,style:e.boardBgImage?{backgroundImage:`url(${e.boardBgImage})`}:{},children:I.jsx("div",{className:`w-8 h-8 rounded-sm ${e.cellBg} border ${e.gridColor}`})})}case"board":{const e=n.item;return I.jsx("div",{className:"w-full h-full rounded-md flex items-center justify-center p-1 border",style:{backgroundColor:e.style.backgroundColor,borderColor:e.style.borderColor,boxShadow:e.style.boxShadow},children:I.jsx("div",{className:"w-full h-full grid grid-cols-2 gap-px bg-slate-500/50 p-px",children:Array(4).fill(0).map((t,i)=>I.jsx("div",{className:"bg-slate-800/50"},i))})})}case"effect":{const e=n.item.previewComponent;return I.jsx("div",{className:"w-full h-full flex items-center justify-center text-cyan-300",children:I.jsx(e,{})})}case"victory":{const e=n.item.previewComponent;return I.jsx("div",{className:"w-full h-full flex items-center justify-center text-cyan-300",children:I.jsx(e,{})})}case"boom":{const e=n.item.previewComponent;return I.jsx("div",{className:"w-full h-full flex items-center justify-center text-cyan-300",children:I.jsx(e,{})})}default:return I.jsx("span",{className:"text-3xl",children:"🎁"})}}),H8=({toast:n})=>{const{message:e,type:t="success",cosmeticId:i}=n,s=i?fr.find(h=>h.id===i):null,o=t==="success"?"border-cyan-500":"border-red-500",c=t==="success"?I.jsx("svg",{className:"w-6 h-6 text-cyan-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):I.jsx("svg",{className:"w-6 h-6 text-red-400 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:I.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});return I.jsxs("div",{className:`fixed top-[50%] -translate-y-1/2 left-1/2 -translate-x-1/2 bg-slate-800/80 backdrop-blur-md border ${o} shadow-lg rounded-xl p-3 w-full max-w-sm animate-toast-in-out z-[101] flex items-center gap-4`,style:{textShadow:"0 1px 3px rgba(0,0,0,0.5)"},children:[c,s&&I.jsx("div",{className:"w-12 h-12 flex-shrink-0 flex items-center justify-center bg-slate-700/50 rounded-md p-1 border border-slate-600",children:I.jsx(oP,{cosmetic:s})}),I.jsx("p",{className:"text-sm text-white font-semibold flex-grow text-left",children:e}),I.jsx("style",{children:`
                @keyframes toast-in-out {
                    0% { transform: translate(-50%, 50%); opacity: 0; }
                    10%, 90% { transform: translate(-50%, -50%); opacity: 1; }
                    100% { transform: translate(-50%, -150%); opacity: 0; }
                }
                .animate-toast-in-out { animation: toast-in-out 4s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
            `})]})},$8=({toast:n})=>{if(!n)return null;const e=n.type==="gift",t=n.cosmeticId?fr.find(s=>s.id===n.cosmeticId):null,i=ye.useMemo(()=>{if(!n)return"";if(n.type==="tease"&&n.emoji){const s=n.emoji.startsWith("assets/");return I.jsxs(I.Fragment,{children:[` ${n.text} `,s?I.jsx("img",{src:n.emoji,alt:"emoji",className:"inline-block w-5 h-5 align-middle"}):I.jsx("span",{className:"align-middle",children:n.emoji})]})}return n.type==="message"&&!n.text.startsWith("reacted with")?` says: "${n.text}"`:` ${n.text}`},[n]);return I.jsxs("div",{className:"fixed top-[122px] left-1/2 -translate-x-1/2 bg-slate-900/80 backdrop-blur-sm border border-cyan-500/50 shadow-lg rounded-lg p-3 w-full max-w-sm animate-toast-fade z-[101] flex items-center",children:[e&&t&&I.jsx("div",{className:"w-10 h-10 flex-shrink-0 flex items-center justify-center bg-slate-700/50 rounded-md p-1 border border-slate-600 mr-3",children:I.jsx(oP,{cosmetic:t})}),I.jsxs("p",{className:"text-sm text-slate-200",children:[I.jsx("strong",{className:"text-cyan-400",children:n.senderName}),i]}),I.jsx("style",{children:`
                @keyframes toast-fade {
                    0%, 100% { opacity: 0; }
                    10%, 90% { opacity: 1; }
                }
                .animate-toast-fade { animation: toast-fade 5s ease-in-out; }
            `})]})},K8=()=>{const{user:n,logOut:e}=gT(),[t,i]=ye.useState("menu"),[s,o]=ye.useState(null),[c,h]=ye.useState(null),[d,p]=ye.useState(null),[_,v]=ye.useState(null),[T,R]=ye.useState(!0),{gameState:P,rankNotification:q,clearRankNotification:Y}=sP(),{playSound:le,playMusic:Ee,stopMusic:oe}=aP(),[de,Pe]=ye.useState(null),[Re,k]=ye.useState(10),x=ye.useRef(!1),N=ye.useRef(null),V=ye.useCallback(()=>{n&&(console.log("User has been idle for 24 hours. Logging out."),e())},[n,e]),L=ye.useCallback(()=>{N.current&&clearTimeout(N.current),N.current=setTimeout(V,G8)},[V]);ye.useEffect(()=>{if(!n){N.current&&clearTimeout(N.current);return}const me=["mousemove","keydown","click","scroll","touchstart"];return L(),me.forEach(_e=>{window.addEventListener(_e,L)}),()=>{N.current&&clearTimeout(N.current),me.forEach(_e=>{window.removeEventListener(_e,L)})}},[L,n]),ye.useEffect(()=>{(async()=>{if(n){const _e=await S8(n.uid);if((_e==null?void 0:_e.status)==="in_game"&&_e.gameId){console.log(`Rejoining active online game: ${_e.gameId}`),Oe(_e.gameId),R(!1);return}}try{const _e=localStorage.getItem(Gv),Se=localStorage.getItem(BR);if(_e&&Se){const _t=JSON.parse(_e);o(_t),i("pve_game"),R(!1);return}}catch{localStorage.removeItem(Gv),localStorage.removeItem(BR)}i("menu"),R(!1)})()},[n]),ye.useEffect(()=>{t==="menu"||t==="pve_game"||t==="lobby"||t==="online_game"?Ee():oe()},[t,Ee,oe]),ye.useEffect(()=>{if(!n)return;const me=x8(n.uid,_e=>{_e&&le("select"),Pe(_e)});return()=>me()},[n,le]);const C=ye.useCallback(()=>{n&&(le("select"),D8(n.uid),Pe(null))},[n,le]);ye.useEffect(()=>{if(de){k(10);const me=setInterval(()=>{k(_e=>_e<=1?(clearInterval(me),C(),0):_e-1)},1e3);return()=>clearInterval(me)}},[de,C]);const A=async()=>{if(!n||!de)return;const me=await N8(n,de);me&&Oe(me),Pe(null)},se=ye.useCallback(me=>{try{le("select"),localStorage.setItem(Gv,JSON.stringify(me)),o(me),i("pve_game")}catch(_e){console.error("Failed to save active bot:",_e)}},[le]),Ae=ye.useCallback(()=>{le("select"),i("shop")},[le]),H=ye.useCallback(()=>{le("select"),i("inventory")},[le]),ee=ye.useCallback(()=>{le("select"),i("menu"),o(null),v(null),h(null),p(null)},[le]),X=()=>{le("select"),i("lobby")},Oe=ye.useCallback(async me=>{const _e=await k8(me);_e?(x.current=!1,p(_e),h(me),i("versus_game"),le("confirm")):(console.error(`Failed to start game: Game data for ${me} not found.`),n&&NR(n.uid),i("lobby"))},[n,i,p,h,le]),Be=()=>{le("select"),v("shop")},O=()=>{le("select"),v("inventory")},W=()=>{le("select"),v(null)},ne=ye.useCallback(()=>{t==="online_game"||t==="versus_game"?(x.current=!0,n&&NR(n.uid),i("lobby"),h(null),p(null)):ee()},[t,ee,n]);if(T)return I.jsx(Bc,{});const ae=()=>{switch(t){case"lobby":return I.jsx(z8,{onStartGame:Oe,onBack:ee});case"versus_game":return!d||!n?(i("lobby"),I.jsx(Bc,{})):I.jsx(q8,{game:d,currentUserId:n.uid,onGameStart:()=>i("online_game")});case"online_game":return!c||!n?(i("lobby"),I.jsx(Bc,{})):I.jsx(VR,{gameMode:"online",onlineGameId:c,onExit:ne,theme:P.activeTheme,pieces:{X:P.activePieceX,O:P.activePieceO},playerInfo:{name:P.playerName,level:P.playerLevel,avatar:P.activeAvatar,xp:P.playerXp,wins:P.onlineWins,losses:P.onlineLosses},activeEffect:P.activeEffect,activeVictoryEffect:P.activeVictoryEffect,activeBoomEffect:P.activeBoomEffect,activeBoard:P.activeBoard,isPaused:!!_,onOpenShop:Be,onOpenInventory:O},c);case"pve_game":return s?I.jsx(VR,{gameMode:"pve",bot:s,onExit:ne,theme:P.activeTheme,pieces:{X:P.activePieceX,O:P.activePieceO},playerInfo:{name:P.playerName,level:P.playerLevel,avatar:P.activeAvatar,xp:P.playerXp,wins:P.pveWins,losses:P.pveLosses},activeEffect:P.activeEffect,activeVictoryEffect:P.activeVictoryEffect,activeBoomEffect:P.activeBoomEffect,activeBoard:P.activeBoard,isPaused:!!_,onOpenShop:Be,onOpenInventory:O},s.id):(ee(),null);case"shop":return I.jsx(LR,{onBack:ee});case"inventory":return I.jsx(UR,{onBack:ee});case"menu":default:return I.jsx(F8,{onStartGame:se,onGoToShop:Ae,onGoToInventory:H,onGoToOnline:X})}};return I.jsxs("div",{className:"bg-slate-900 relative animate-app-fade-in",children:[I.jsxs(ye.Suspense,{fallback:I.jsx(Bc,{}),children:[ae(),_&&I.jsxs("div",{className:"fixed inset-0 z-50 bg-black/70 p-4 sm:p-8 overflow-y-auto",children:[_==="shop"&&I.jsx(LR,{onBack:W}),_==="inventory"&&I.jsx(UR,{onBack:W})]})]}),I.jsx(U8,{isOpen:!!de,title:"Incoming Challenge!",children:de&&I.jsxs("div",{className:"text-center",children:[I.jsxs("p",{className:"text-slate-300 mb-6",children:[I.jsx("strong",{className:"text-white",children:de.fromName})," has challenged you to a match! ",I.jsxs("span",{className:"text-slate-400",children:["(",Re,"s)"]})]}),I.jsxs("div",{className:"flex justify-center gap-4",children:[I.jsx("button",{onClick:C,className:"bg-red-600 hover:bg-red-500 font-bold py-2 px-6 rounded-lg transition-colors",children:"Decline"}),I.jsx("button",{onClick:A,className:"bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Accept"})]})]})}),I.jsx(B8,{notification:q,onClose:Y}),P.toast&&I.jsx(H8,{toast:P.toast},P.toast.id),I.jsx($8,{toast:P.messageToast}),I.jsx("style",{children:`
                @keyframes app-fade-in {
                    from { opacity: 0; transform: scale(0.97); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-app-fade-in { animation: app-fade-in 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
            `})]})},Q8=()=>{const{user:n,loading:e}=gT();return e?I.jsx(Bc,{}):I.jsx(ye.Suspense,{fallback:I.jsx(Bc,{}),children:n?I.jsx(K8,{}):I.jsx(j8,{})})};function W8(){return I.jsx(V8,{children:I.jsx(L8,{children:I.jsx(Q8,{})})})}const lP=document.getElementById("root");if(!lP)throw new Error("Could not find root element to mount to");const Y8=$O.createRoot(lP);Y8.render(I.jsx(cn.StrictMode,{children:I.jsx(W8,{})}));export{Ur as $,fr as A,YS as B,WO as C,Vr as D,eG as E,Zd as F,KG as G,Cp as H,KS as I,jR as J,O2 as K,Z0 as L,U8 as M,eE as N,tE as O,Ts as P,td as Q,cn as R,nd as S,X8 as T,Xn as U,tG as V,$S as W,YO as X,Cs as Y,hr as Z,Lr as _,aP as a,Br as a0,d5 as a1,xR as a2,_5 as a3,wG as a4,Y0 as a5,g5 as a6,A5 as a7,_8 as a8,l5 as a9,$G as aa,GG as ab,HG as ac,SG as ad,kG as ae,J8 as af,UG as ag,CG as ah,zG as ai,qG as aj,RG as ak,QG as al,NG as am,AG as an,xG as ao,FG as ap,BG as aq,fM as ar,gT as b,QS as c,La as d,PG as e,TG as f,WS as g,LG as h,MG as i,I as j,OG as k,jG as l,p8 as m,bG as n,VG as o,IG as p,Wn as q,ye as r,DG as s,Z8 as t,sP as u,YG as v,JG as w,O8 as x,WG as y,XG as z};
