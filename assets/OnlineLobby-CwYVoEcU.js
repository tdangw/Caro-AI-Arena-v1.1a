import{b as ie,u as Y,a as Q,r,A as V,j as e,M as B,g as G,aa as Me,ab as Le,ac as Ie,ad as Fe,ae as Pe,f as re,af as $e,ag as Oe,ah as Te,ai as ne,aj as Ee,ak as Re,al as Ae,am as De,an as Ge,ao as ze,q as We,D as _e}from"./index-iVqpNyTX.js";import{S as Be}from"./GameModals-aTi5PvrA.js";import{C as qe}from"./ChatBox-CVwkBmzV.js";import{G as He}from"./GameReviewModal-N_rHnb-G.js";const Ue=({isOpen:c,onClose:g,onStartChat:a,friends:b,onInvite:o})=>{const{user:p}=ie(),{gameState:N,consumeEmoji:d}=Y(),{playSound:h}=Q(),[l,j]=r.useState("friends"),[x,t]=r.useState(null),[v,$]=r.useState(new Set),[k,y]=r.useState(null),A=r.useMemo(()=>{const i=[],n=V.filter(f=>f.type==="emoji"||f.type==="animated_emoji");for(const f of n){const S=N.ownedCosmeticIds.includes(f.id),P=N.emojiInventory[f.id]||0;(S||P>0)&&i.push(f.item)}return i},[N.ownedCosmeticIds,N.emojiInventory]),C=(i,n)=>{p&&(h("select"),Ie(p.uid,i,n))},O=()=>{!p||!x||(h("confirm"),Me(p.uid,x.uid),t(null))},I=i=>{h("select"),o(i),$(n=>new Set(n).add(i.uid)),setTimeout(()=>{$(n=>{const f=new Set(n);return f.delete(i.uid),f})},15e3)},T=i=>{if(p&&k){h("select");const n="emoji"in i?i.emoji:i.url;Le(p.uid,N.playerName,k.uid,n);const f=V.find(S=>S.id===i.id);f&&f.price>0&&d(i.id),y(null)}},w=b.filter(i=>i.status==="friends"),E=b.filter(i=>i.status==="received"),z=i=>e.jsx("div",{className:"space-y-2",children:i.map(n=>{var P;const f=G(0),S=v.has(n.uid);return e.jsxs("div",{className:"flex items-center justify-between bg-slate-800/50 p-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:n.avatarUrl,alt:n.name,className:"w-10 h-10 rounded-full object-cover bg-slate-700"}),n.onlineStatus&&n.onlineStatus!=="offline"&&e.jsx("span",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-slate-800"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"font-semibold text-white",children:n.name}),e.jsxs("p",{className:"text-xs text-cyan-400",children:["Lv. ",n.level]})]}),e.jsx("p",{className:"text-xs text-slate-400 capitalize truncate italic",title:n.statusMessage,children:n.onlineStatus!=="offline"&&n.statusMessage?`"${n.statusMessage}"`:`${f.icon} ${f.name} (${((P=n.onlineStatus)==null?void 0:P.replace("_"," "))||"Offline"})`})]})]}),e.jsxs("div",{className:"flex gap-1.5 items-center",children:[e.jsx("button",{onClick:()=>{a({uid:n.uid,name:n.name})},className:"bg-blue-500 text-xs text-white font-bold px-2 py-1 rounded hover:bg-blue-400",children:"Chat"}),e.jsx("button",{onClick:()=>I(n),disabled:n.onlineStatus!=="idle"||S,className:"text-xs text-white font-bold px-2 py-1 rounded bg-purple-500 hover:bg-purple-400 disabled:bg-slate-600 disabled:cursor-not-allowed",children:S?"Invited":"Invite"}),e.jsx("button",{onClick:()=>{h("select"),y(n)},className:"bg-yellow-500 text-xs text-black font-bold px-2 py-1 rounded hover:bg-yellow-400",children:"Tease"}),e.jsx("button",{onClick:()=>t(n),className:"text-slate-500 hover:text-red-500 transition-colors p-1 rounded-full hover:bg-red-500/10",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]})]},n.uid)})}),F=i=>e.jsx("div",{className:"space-y-2",children:i.map(n=>e.jsxs("div",{className:"flex items-center justify-between bg-slate-800/50 p-2 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:n.avatarUrl,alt:n.name,className:"w-10 h-10 rounded-full object-cover bg-slate-700"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"font-semibold text-white",children:n.name}),e.jsxs("p",{className:"text-xs text-cyan-400",children:["Lv. ",n.level]})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Wants to be friends"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>C(n.uid,"accept"),className:"bg-green-500 text-xs text-white font-bold px-2 py-1 rounded",children:"Accept"}),e.jsx("button",{onClick:()=>C(n.uid,"decline"),className:"bg-slate-600 text-xs text-white font-bold px-2 py-1 rounded",children:"Decline"})]})]},n.uid))});return e.jsxs(B,{isOpen:c,onClose:g,title:"Friends",size:"xl",children:[e.jsxs("div",{className:"flex border-b border-slate-700 mb-4",children:[e.jsxs("button",{onClick:()=>j("friends"),className:`py-2 px-4 font-semibold ${l==="friends"?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400"}`,children:["Friends (",w.length,")"]}),e.jsxs("button",{onClick:()=>j("requests"),className:`py-2 px-4 font-semibold ${l==="requests"?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400"}`,children:["Requests (",E.length,")"]})]}),e.jsxs("div",{className:"max-h-[50vh] overflow-y-auto pr-2 scrollbar-hide",children:[l==="friends"&&(w.length>0?z(w):e.jsx("p",{className:"text-slate-500 text-center py-8",children:"Your friends list is empty."})),l==="requests"&&(E.length>0?F(E):e.jsx("p",{className:"text-slate-500 text-center py-8",children:"No new friend requests."}))]}),x&&e.jsx(B,{isOpen:!!x,onClose:()=>t(null),title:"Remove Friend",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-slate-300 mb-6",children:["Are you sure you want to remove ",e.jsx("strong",{className:"text-white",children:x.name})," from your friends?"]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:()=>t(null),className:"bg-slate-600 hover:bg-slate-500 font-bold py-2 px-6 rounded-lg",children:"Cancel"}),e.jsx("button",{onClick:O,className:"bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-6 rounded-lg",children:"Remove"})]})]})}),k&&e.jsx(B,{isOpen:!!k,onClose:()=>y(null),title:`Tease ${k.name}`,children:e.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-60 overflow-y-auto p-2",children:A.map(i=>{const n="url"in i;return e.jsx("button",{onClick:()=>T(i),className:"text-3xl w-14 h-14 flex items-center justify-center rounded-md hover:bg-slate-700/50 hover:scale-110 transition-all",children:n?e.jsx("img",{src:i.url,alt:i.name,className:"w-10 h-10"}):i.emoji},i.id)})})})]})},oe=({currentPage:c,totalPages:g,onPageChange:a})=>{if(g<=1)return null;const b="px-3 py-1 text-sm rounded-md transition-colors ",o="bg-cyan-500 text-black font-bold",p="bg-slate-700 hover:bg-slate-600 text-white",N=()=>{const d=[];if(g<=5){for(let t=1;t<=g;t++)d.push(e.jsx("button",{onClick:()=>a(t),className:`${b} ${c===t?o:p}`,children:t},t));return d}const l=new Set;l.add(1),l.add(g),l.add(c),c>1&&l.add(c-1),c<g&&l.add(c+1);const j=Array.from(l).sort((t,v)=>t-v);let x=0;for(const t of j)x!==0&&t>x+1&&d.push(e.jsx("span",{className:"px-2 text-slate-400",children:"..."},`ellipsis-${x}`)),d.push(e.jsx("button",{onClick:()=>a(t),className:`${b} ${c===t?o:p}`,children:t},t)),x=t;return d};return e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>a(c-1),disabled:c===1,className:"px-3 py-1 text-sm rounded-md transition-colors bg-slate-700 hover:bg-slate-600 text-white disabled:bg-slate-800 disabled:text-slate-500 disabled:cursor-not-allowed",children:"<"}),N(),e.jsx("button",{onClick:()=>a(c+1),disabled:c===g,className:"px-3 py-1 text-sm rounded-md transition-colors bg-slate-700 hover:bg-slate-600 text-white disabled:bg-slate-800 disabled:text-slate-500 disabled:cursor-not-allowed",children:">"})]})},Xe=({onCancel:c})=>{const[g,a]=r.useState(30),b=r.useRef(null),o=r.useMemo(()=>{const l=[];return[{radius:75,count:8,color:"bg-white",size:"w-[3px] h-[3px]"},{radius:93,count:12,color:"bg-sky-400",size:"w-0.5 h-0.5"}].forEach((x,t)=>{for(let v=0;v<x.count;v++)l.push({key:`${t}-${v}`,size:x.size,color:x.color,radius:x.radius,animationDuration:20+Math.random()*20,animationDelay:Math.random()*-40,animationDirection:Math.random()>.5?"normal":"reverse"})}),l},[]);r.useEffect(()=>{let l;const j=x=>{b.current===null&&(b.current=x);const t=x-b.current,v=Math.max(0,30-t/1e3);a(v),v>0?l=requestAnimationFrame(j):c()};return l=requestAnimationFrame(j),()=>cancelAnimationFrame(l)},[c]);const p=Math.ceil(g),d=2*Math.PI*60,h=d-g/30*d;return e.jsxs("div",{className:"fixed inset-0 bg-slate-900/90 flex flex-col items-center justify-center z-50 backdrop-blur-sm animate-fade-in",children:[e.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[e.jsx("div",{className:"absolute w-full h-full",children:o.map(l=>e.jsx("div",{className:"absolute inset-0",style:{animation:`orbital-rotate ${l.animationDuration}s ${l.animationDelay}s linear ${l.animationDirection} infinite`},children:e.jsx("div",{className:"absolute top-1/2 left-1/2",style:{transform:`translate(-50%, -50%) translateY(-${l.radius}px)`},children:e.jsx("div",{className:`${l.size} ${l.color} rounded-full particle-glow`})})},l.key))}),e.jsx("div",{className:"absolute w-full h-full rounded-full border-2 border-sky-400/80 animate-ripple-stroke",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute w-full h-full rounded-full border-2 border-sky-400/80 animate-ripple-stroke",style:{animationDelay:"2s"}}),e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 140 140",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"goldGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#FBBF24"}),e.jsx("stop",{offset:"100%",stopColor:"#F59E0B"})]}),e.jsxs("linearGradient",{id:"blueGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#38bdf8"}),e.jsx("stop",{offset:"100%",stopColor:"#0ea5e9"})]}),e.jsxs("filter",{id:"glow",children:[e.jsx("feGaussianBlur",{stdDeviation:"3.5",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("circle",{cx:"70",cy:"70",r:"68",stroke:"url(#goldGradient)",strokeWidth:"2",fill:"transparent"}),e.jsx("circle",{cx:"70",cy:"70",r:"60",stroke:"rgba(0,0,0,0.5)",strokeWidth:"8",fill:"transparent"}),e.jsx("circle",{cx:"70",cy:"70",r:60,stroke:"url(#blueGradient)",strokeWidth:"8",fill:"transparent",strokeLinecap:"round",strokeDasharray:d,strokeDashoffset:h,className:"transform -rotate-90 origin-center",style:{filter:"url(#glow)"}})]}),e.jsx("div",{className:"absolute flex flex-col items-center justify-center text-white",children:e.jsx("span",{className:"text-5xl font-bold tracking-tighter",style:{textShadow:"0 0 10px rgba(255,255,255,0.7)"},children:p})})]}),e.jsx("h2",{className:"text-3xl font-bold text-white mt-8 animate-text-glow",children:"Finding Opponent"}),e.jsx("button",{onClick:c,className:"mt-8 bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Cancel"}),e.jsx("style",{children:`
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fade-in 0.3s ease-out; }
        
        @keyframes ripple-stroke-effect {
            0% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        .animate-ripple-stroke {
            animation: ripple-stroke-effect 4s cubic-bezier(0.25, 0.8, 0.25, 1) infinite;
            background: transparent;
        }

        @keyframes orbital-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .particle-glow {
            box-shadow: 0 0 8px currentColor, 0 0 12px currentColor, 0 0 16px currentColor;
            opacity: 0.8;
        }
        
        @keyframes text-glow-pulse {
            0%, 100% { text-shadow: 0 0 8px rgba(56, 189, 248, 0.7); }
            50% { text-shadow: 0 0 20px rgba(56, 189, 248, 1), 0 0 10px rgba(56, 189, 248, 0.8); }
        }
        .animate-text-glow {
            animation: text-glow-pulse 2.5s infinite ease-in-out;
        }
      `})]})},Ve=()=>{const[c,g]=r.useState([]),[a,b]=r.useState(1),o=10;r.useEffect(()=>{Re(100).then(g)},[]);const p=Math.ceil(c.length/o),N=c.slice((a-1)*o,a*o);return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 h-[75vh] flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4 text-left",children:"Leaderboard ðŸ†"}),e.jsx("div",{className:"flex-grow overflow-y-auto pr-2 scrollbar-hide",children:N.map((d,h)=>{const l=(a-1)*o+h,j=G(d.cp),x=l===0?"text-yellow-400":l===1?"text-slate-300":l===2?"text-orange-400":"text-slate-500";return e.jsxs("div",{className:"flex items-center gap-3 bg-slate-900/50 p-2 rounded-lg mb-2",children:[e.jsx("span",{className:`text-lg font-bold w-6 text-center ${x}`,children:l+1}),e.jsx("img",{src:d.avatarUrl,alt:d.name,className:"w-9 h-9 rounded-full object-cover bg-slate-700"}),e.jsxs("div",{className:"flex-grow overflow-hidden",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"font-semibold text-white text-sm truncate",children:d.name}),e.jsxs("p",{className:"text-xs text-cyan-400",children:["Lv. ",d.level]})]}),e.jsxs("p",{className:"text-slate-400 text-xs truncate",children:[j.icon," ",j.name]})]}),e.jsxs("p",{className:"text-cyan-400 text-sm font-semibold",children:[d.cp," CP"]})]},`${d.uid}-${l}`)})}),e.jsx(oe,{currentPage:a,totalPages:p,onPageChange:b})]})},Ye=({isOpen:c,onClose:g,userId:a,onViewChat:b})=>{const[o,p]=r.useState([]),[N,d]=r.useState(!0),[h,l]=r.useState(null),{gameState:j}=Y(),{playSound:x}=Q();return r.useEffect(()=>{c&&a&&(d(!0),ze(a).then(t=>{p(t),d(!1)}))},[c,a]),e.jsxs(B,{isOpen:c,onClose:g,title:"Match History",size:"xl",children:[e.jsx("div",{className:"max-h-[60vh] overflow-y-auto pr-2 scrollbar-hide",children:N?e.jsx("p",{className:"text-slate-400",children:"Loading history..."}):o.length===0?e.jsx("p",{className:"text-slate-400",children:"No online matches played yet."}):o.map(t=>{var T;const v=t.result==="win"?"text-green-400":t.result==="loss"?"text-red-500":"text-yellow-400",$=`${Math.floor(t.duration/60)}m ${t.duration%60}s`,k=G(t.opponentCp),y=t.playerMark==="X"?"O":"X",A=y==="X"?t.playerXPieceId:t.playerOPieceId,C=V.find(w=>w.id===A&&w.type==="piece"),O=C?C.item.component:y==="X"?We.component:_e.component,I=t.boardState?Object.values(t.boardState).filter(w=>w===y).length:0;return e.jsxs("div",{className:"bg-slate-800/50 p-3 rounded-lg mb-3 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-2/5 min-w-0",children:[e.jsx("img",{src:t.opponentAvatarUrl,alt:t.opponentName,className:"w-12 h-12 rounded-full object-cover bg-slate-700 flex-shrink-0"}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"font-semibold text-white truncate",children:t.opponentName}),e.jsxs("p",{className:"text-xs text-cyan-400",children:["Lv. ",t.opponentLevel]})]}),e.jsxs("p",{className:"text-xs text-slate-400 truncate flex items-center gap-2",title:`Room: ${(T=t.id.split("_").pop())==null?void 0:T.substring(0,6)}`,children:[e.jsxs("span",{children:[k.icon," ",k.name]}),O&&e.jsx("span",{className:`w-4 h-4 ${y==="X"?"text-cyan-400":"text-pink-500"}`,children:e.jsx(O,{})}),I>0&&e.jsx("span",{className:"text-slate-400 text-xs font-bold",children:I})]})]})]}),e.jsxs("div",{className:"text-center text-sm flex-grow",children:[e.jsxs("div",{className:"flex items-baseline justify-center gap-3",children:[e.jsxs("span",{className:`font-bold text-base ${v}`,children:[t.cpChange>=0?`+${t.cpChange}`:t.cpChange," CP"]}),e.jsx("div",{className:"flex items-center gap-1 text-slate-400 text-xs",children:e.jsxs("span",{children:["â±ï¸ ",$]})})]}),e.jsx("div",{className:"text-slate-400 text-xs mt-1",children:e.jsx("p",{children:re(t.timestamp)})})]}),e.jsxs("div",{className:"flex flex-col gap-1 flex-shrink-0 w-16 items-end",children:[e.jsx("button",{onClick:()=>b(t),className:"p-1.5 rounded-md text-xs bg-slate-700 hover:bg-slate-600 transition-colors w-full text-center",title:"View Chat",children:"Chat"}),t.boardState&&e.jsx("button",{onClick:()=>{x("select"),l(t)},className:"p-1.5 rounded-md text-xs bg-slate-700 hover:bg-slate-600 transition-colors w-full text-center",title:"Review Game",children:"Review"})]})]},t.id)})}),h&&e.jsx(He,{isOpen:!!h,onClose:()=>l(null),game:h,playerProfile:j})]})},es=({onStartGame:c,onBack:g})=>{const{user:a,logOut:b}=ie(),{gameState:o,setStatusMessage:p,setNotifications:N}=Y(),{friends:d,notifications:h}=o,[l,j]=r.useState([]),[x,t]=r.useState(!1),[v,$]=r.useState(!1),[k,y]=r.useState(!1),[A,C]=r.useState(!1),[O,I]=r.useState(!1),[T,w]=r.useState(!1),[E,z]=r.useState(o.statusMessage||""),[F,i]=r.useState(null),[n,f]=r.useState(new Set),[S,P]=r.useState(!1),[J,K]=r.useState(10),[D,Z]=r.useState(1),W=10,{playSound:M}=Q(),q=r.useCallback(s=>{t(!1),c(s)},[c]);r.useEffect(()=>{if(!a)return;const s=Fe(u=>{const L=u.filter(X=>X.uid!==a.uid);j(L);const _=Math.ceil(L.length/W);D>_&&Z(Math.max(1,_))}),m=Pe(a.uid,u=>{x&&(u==null?void 0:u.status)==="in_game"&&u.gameId&&q(u.gameId)});return()=>{s(),m()}},[a,x,q,D]);const ce=r.useMemo(()=>d.map(s=>{const m=l.find(u=>u.uid===s.uid);return{...s,onlineStatus:m?m.status:"offline",statusMessage:m?m.statusMessage:void 0}}),[d,l]),ee=s=>{a&&(M("select"),De(a,o.playerName,s.uid),f(m=>new Set(m).add(s.uid)),setTimeout(()=>{f(m=>{const u=new Set(m);return u.delete(s.uid),u})},15e3))},de=async()=>{if(!a)return;t(!0),M("select");const s=await Ge(a);s&&q(s)},xe=()=>{a&&(M("select"),Te(a.uid),t(!1))},me=s=>{a&&(M("select"),Ae(a.uid,s.uid))},H=s=>{i(s),I(!0),a&&h.forEach(m=>{m.type==="message"&&m.senderId===s.uid&&!m.seen&&ne(a.uid,m.id)})},ue=s=>{const m=d.find(u=>u.uid===s);return m?m.status==="friends"?"friend":m.status:"none"},he=()=>{p(E),w(!1)},pe=s=>{z(s),p(s),w(!1)},se=h.filter(s=>!s.seen).length,fe=()=>{M("select"),P(s=>!s),S||K(10)},ge=s=>{a&&ne(a.uid,s.id),s.type==="message"?(H({uid:s.senderId,name:s.senderName}),P(!1)):s.type==="friend_request"&&(C(!0),P(!1))},be=(s,m)=>{s.stopPropagation(),a&&Ee(a.uid,m)},je=s=>{M("select"),i({uid:s.opponentId,name:s.opponentName,chatId:s.chatId,isReadOnly:!0}),I(!0)},{onlineWins:U,onlineLosses:te,cp:ve,playerLevel:Ne,coins:we}=o,ae=U+te+(o.onlineDraws||0),ye=ae>0?(U/ae*100).toFixed(2):"0.00",R=G(ve),le=R.name==="ThÃ¡ch Äáº¥u",ke=le?100:R.cpInTier/100*100,Ce=Math.ceil(l.length/W),Se=l.slice((D-1)*W,D*W);return e.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-4 sm:p-6 flex flex-col items-center justify-center relative",children:[x&&e.jsx(Xe,{onCancel:xe}),e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%2D%2240%22%20height%3D%2240%22%20viewBox%3D%220%200%2040%2040%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22%231e293b%22%20fill-opacity%3D%220.4%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M0%2040L40%200H20L0%2020M40%2040V20L20%2040%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E')] opacity-50"}),e.jsxs("div",{className:"w-full max-w-6xl z-10",children:[e.jsxs("header",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-cyan-400",children:"Online Lobby"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:fe,className:"bg-slate-700/80 p-2 rounded-full hover:bg-slate-600 transition-colors","aria-label":"Notifications",children:[e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),se>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full border-2 border-slate-900 flex items-center justify-center",children:se})]}),S&&e.jsxs("div",{className:"absolute top-12 right-0 w-80 bg-slate-900 border border-slate-700 rounded-lg shadow-lg z-20 flex flex-col",children:[e.jsx("div",{className:"flex-grow p-2 max-h-80 overflow-y-auto scrollbar-hide",children:h.length>0?h.slice(0,J).map(s=>{const m=s.text.startsWith("reacted with");let u;if(s.type==="tease"&&s.emoji){const L=s.emoji.startsWith("assets/");u=e.jsxs(e.Fragment,{children:[` ${s.text} `,L?e.jsx("img",{src:s.emoji,alt:"emoji",className:"inline-block w-4 h-4 align-middle"}):e.jsx("span",{className:"align-middle",children:s.emoji})]})}else m?u=e.jsxs(e.Fragment,{children:[" ",s.text]}):u=e.jsxs(e.Fragment,{children:[' says: "',s.text,'"']});return e.jsxs("div",{className:`relative group/notif text-sm p-2 rounded-md hover:bg-slate-800 cursor-pointer ${s.seen?"":"bg-blue-900/30"}`,onClick:()=>ge(s),children:[e.jsx("button",{onClick:L=>be(L,s.id),className:"absolute top-0 right-0 p-2 rounded-full text-slate-500 hover:text-white hover:bg-slate-700 hidden group-hover/notif:block","aria-label":"Delete notification",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-cyan-400",children:s.senderName}),u]}),e.jsx("time",{className:"text-xs text-slate-500",children:re(s.timestamp)})]},s.id)}):e.jsx("p",{className:"text-xs text-slate-500 p-4 text-center",children:"No new notifications."})}),h.length>J&&e.jsx("button",{onClick:()=>K(s=>s+10),className:"w-full text-center p-2 text-xs font-semibold text-cyan-400 hover:bg-slate-800 rounded-b-lg border-t border-slate-700",children:"Load More"})]})]}),e.jsx("button",{onClick:()=>{M("select"),y(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"History"}),e.jsx("button",{onClick:()=>{M("select"),C(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Friends"}),e.jsx("button",{onClick:g,className:"bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:"Menu"}),e.jsx("button",{onClick:()=>{M("select"),$(!0)},className:"bg-slate-700/80 p-2 rounded-full hover:bg-slate-600 transition-colors","aria-label":"Settings",children:e.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066 2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[350px_1fr_350px] gap-6",children:[e.jsx(Ve,{}),e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-4 h-[75vh] flex flex-col",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white mb-4 text-left",children:["Players Online (",l.length,")"]}),e.jsx("div",{className:"flex-grow overflow-y-auto pr-2 scrollbar-hide",children:Se.map(s=>{const m=ue(s.uid),u=n.has(s.uid),L=G(s.cp),_=a==null?void 0:a.isAnonymous,X=s.name.startsWith("Player_");return e.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 min-w-0",children:[e.jsx("img",{src:s.avatarUrl,alt:s.name,className:"w-10 h-10 rounded-full object-cover bg-slate-700 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"font-semibold text-white text-left truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-cyan-400 whitespace-nowrap",children:["Lv. ",s.level]})]}),e.jsxs("p",{className:"text-slate-400 text-xs text-left",children:[L.icon," ",L.name]})]})]}),e.jsxs("div",{className:"text-right flex flex-col items-end gap-1 flex-shrink-0",children:[e.jsx("p",{className:`text-sm font-semibold ${s.status==="idle"?"text-green-400":"text-yellow-400"}`,children:s.status.replace("_"," ")}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>H(s),className:"text-xs text-white font-bold px-2 py-1 rounded bg-blue-500 hover:bg-blue-400",children:"Chat"}),m==="none"&&!_&&!X&&e.jsx("button",{onClick:()=>me(s),className:"text-xs text-white font-bold px-2 py-1 rounded bg-green-500 hover:bg-green-400",children:"Add"}),m==="pending"&&e.jsx("button",{disabled:!0,className:"text-xs text-slate-300 font-bold px-2 py-1 rounded bg-slate-600 cursor-not-allowed",children:"Pending"}),e.jsx("button",{onClick:()=>ee(s),disabled:s.status!=="idle"||u,className:"text-xs text-white font-bold px-2 py-1 rounded bg-purple-500 hover:bg-purple-400 disabled:bg-slate-600 disabled:cursor-not-allowed",children:u?"Invited":"Invite"})]})]})]}),s.statusMessage&&e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-slate-400 text-xs text-left italic break-words",children:['"',s.statusMessage,'"']})})]},s.uid)})}),e.jsx(oe,{currentPage:D,totalPages:Ce,onPageChange:Z})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"relative bg-slate-800/50 border border-slate-700 rounded-xl p-4",children:[e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("div",{className:"relative group/status",children:[e.jsx("button",{onClick:()=>w(s=>!s),className:"p-1 rounded-full hover:bg-slate-600",children:e.jsx("svg",{className:"w-4 h-4 text-slate-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L16.732 3.732z"})})}),T&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-slate-800 border border-slate-700 rounded-lg shadow-lg z-20 p-2",children:[e.jsx("form",{onSubmit:s=>{s.preventDefault(),he()},children:e.jsx("input",{type:"text",value:E,onChange:s=>z(s.target.value),className:"w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white text-sm",maxLength:45,autoFocus:!0})}),e.jsx("div",{className:"text-xs text-slate-400 my-2",children:"Or select a preset:"}),e.jsx("div",{className:"space-y-1",children:$e.map(s=>e.jsx("button",{onClick:()=>pe(s),className:"w-full text-left text-sm p-1 rounded hover:bg-slate-700",children:s},s))})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:o.activeAvatar.url,alt:"Your Avatar",className:"w-16 h-16 rounded-full flex-shrink-0 border-2 border-slate-600 object-cover bg-slate-700"}),o.activeTease&&e.jsx("div",{className:"absolute -top-4 -right-4 text-4xl animate-tease-pop z-10",children:o.activeTease.emoji.startsWith("assets/")?e.jsx("img",{src:o.activeTease.emoji,alt:"tease",className:"w-10 h-10"}):e.jsx("span",{children:o.activeTease.emoji})})]}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h2",{className:"text-xl font-bold text-white truncate pr-8",children:o.playerName}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[e.jsxs("span",{className:"font-semibold text-cyan-400 text-sm",children:["Level ",Ne]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-yellow-400 font-bold text-sm",children:we}),e.jsx("span",{className:"text-yellow-400",children:"ðŸ’°"})]})]})]})]}),e.jsx("p",{className:"text-xs text-slate-400 italic truncate mt-2 pr-8",title:o.statusMessage,children:o.statusMessage?`"${o.statusMessage}"`:""}),e.jsx("div",{className:"mt-3 space-y-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-baseline text-xs text-slate-400 mb-1 px-1",children:[e.jsxs("span",{children:[R.icon," ",R.name]}),e.jsx("span",{children:le?`${R.cpInTier} CP`:`${R.cpInTier} / 100`})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full",style:{width:`${ke}%`}})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center mt-3",children:[e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-green-400 font-bold text-lg",children:U}),e.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Wins"})]}),e.jsxs("div",{className:"p-1",children:[e.jsx("p",{className:"text-red-400 font-bold text-lg",children:te}),e.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Losses"})]}),e.jsxs("div",{className:"p-1",children:[e.jsxs("p",{className:"text-cyan-400 font-bold text-lg",children:[ye,"%"]}),e.jsx("p",{className:"text-slate-400 text-[10px] leading-tight uppercase tracking-wider",children:"Win Rate"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-xl p-6 flex flex-col justify-center items-center flex-grow",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Matchmaking"}),e.jsx("p",{className:"text-slate-400 mb-6",children:"Find a random opponent and jump right into a game."}),e.jsx("button",{onClick:de,className:"w-full bg-green-500 hover:bg-green-400 text-black font-bold py-3 px-4 rounded-lg transition-all text-lg mt-auto",children:"Find Match"})]})]})]})]}),e.jsx(Be,{isOpen:v,onClose:()=>$(!1),onLogOut:b}),a&&e.jsx(Ye,{isOpen:k,onClose:()=>y(!1),userId:a.uid,onViewChat:je}),a&&e.jsx(Ue,{isOpen:A,onClose:()=>C(!1),onStartChat:H,friends:ce,onInvite:ee}),a&&F&&e.jsx(qe,{isOpen:O,onClose:()=>I(!1),chatId:F.chatId||Oe(a.uid,F.uid),currentUserId:a.uid,senderName:o.playerName,recipientName:F.name,recipientId:F.uid,isReadOnly:!!F.isReadOnly}),e.jsx("style",{children:`
          @keyframes tease-pop-anim {
              0% { transform: scale(0.5) rotate(15deg); opacity: 0; }
              30% { transform: scale(1.2) rotate(-10deg); opacity: 1; }
              50% { transform: scale(1.1) rotate(5deg); opacity: 1; }
              100% { transform: scale(0) rotate(-15deg); opacity: 0; }
          }
          .animate-tease-pop {
              animation: tease-pop-anim 8s ease-out forwards;
          }
      `})]})};export{es as default};
